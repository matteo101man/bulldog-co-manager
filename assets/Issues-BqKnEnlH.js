import{r as l,j as a}from"./react-vendor-C8iBsMnn.js";import{c as f}from"./attendanceService-BpGXN45O.js";import{g}from"./cadetService-BXy_--2f.js";import{g as b,a as N,c as j}from"./dates-Da0E0fI-.js";import"./vendor-C6jWcdt9.js";import"./firebase-vendor-u2jlvS72.js";import"./index-DKB6D4ej.js";function E({onBack:p}){const[o,h]=l.useState([]),[x,m]=l.useState(!0),y=b(),r=N(y);l.useEffect(()=>{c()},[]);async function c(){m(!0);try{const t=await g("Master"),i=await f(y),n=[];t.forEach(s=>{const e=i.get(s.id),d={tuesday:r.tuesday,wednesday:r.wednesday,thursday:r.thursday};((e==null?void 0:e.ptTuesday)===null||(e==null?void 0:e.ptTuesday)===void 0)&&n.push({cadetName:`${s.firstName} ${s.lastName}`,day:"tuesday",date:d.tuesday,attendanceType:"PT"}),((e==null?void 0:e.ptWednesday)===null||(e==null?void 0:e.ptWednesday)===void 0)&&n.push({cadetName:`${s.firstName} ${s.lastName}`,day:"wednesday",date:d.wednesday,attendanceType:"PT"}),((e==null?void 0:e.ptThursday)===null||(e==null?void 0:e.ptThursday)===void 0)&&n.push({cadetName:`${s.firstName} ${s.lastName}`,day:"thursday",date:d.thursday,attendanceType:"PT"}),((e==null?void 0:e.labThursday)===null||(e==null?void 0:e.labThursday)===void 0)&&n.push({cadetName:`${s.firstName} ${s.lastName}`,day:"thursday",date:d.thursday,attendanceType:"Lab"})}),n.sort((s,e)=>{const d=s.cadetName.localeCompare(e.cadetName);if(d!==0)return d;const u={tuesday:1,wednesday:2,thursday:3};return u[s.day]-u[e.day]}),h(n)}catch(t){console.error("Error loading issues:",t),alert(`Error loading issues: ${t instanceof Error?t.message:"Unknown error"}`)}finally{m(!1)}}return a.jsxs("div",{className:"min-h-screen bg-gray-50 pb-safe-area-inset-bottom",children:[a.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-10 safe-area-inset-top",children:a.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[a.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Issues"}),a.jsx("button",{onClick:p,className:"text-sm text-blue-600 font-medium touch-manipulation",style:{minHeight:"44px",minWidth:"44px"},children:"Home"})]})}),a.jsx("main",{className:"px-4 py-4",children:x?a.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading..."}):a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Attendance"}),o.length===0?a.jsx("div",{className:"text-center py-8 text-gray-500",children:"No missing attendance data for the current week."}):a.jsx("div",{className:"space-y-2",children:o.map((t,i)=>{const n=j(t.date);return a.jsxs("div",{className:"text-red-600 text-sm py-2 border-b border-gray-100 last:border-b-0",children:[t.cadetName," is missing ",t.attendanceType," attendance for ",n]},`${t.cadetName}-${t.day}-${t.attendanceType}-${i}`)})})]}),a.jsx("button",{onClick:c,className:"w-full py-3 px-4 rounded-lg font-semibold bg-blue-600 text-white hover:bg-blue-700 active:bg-blue-800 touch-manipulation min-h-[44px]",children:"Refresh"})]})})]})}export{E as default};
