var pA=Object.defineProperty;var mA=(r,t,s)=>t in r?pA(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s;var vb=(r,t,s)=>mA(r,typeof t!="symbol"?t+"":t,s);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const e of n)if(e.type==="childList")for(const p of e.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&i(p)}).observe(document,{childList:!0,subtree:!0});function s(n){const e={};return n.integrity&&(e.integrity=n.integrity),n.referrerPolicy&&(e.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?e.credentials="include":n.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function i(n){if(n.ep)return;n.ep=!0;const e=s(n);fetch(n.href,e)}})();var gA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yA(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function vA(r){if(r.__esModule)return r;var t=r.default;if(typeof t=="function"){var s=function i(){return this instanceof i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};s.prototype=t.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(r).forEach(function(i){var n=Object.getOwnPropertyDescriptor(r,i);Object.defineProperty(s,i,n.get?n:{enumerable:!0,get:function(){return r[i]}})}),s}var $w={exports:{}},f0={},Ww={exports:{}},ur={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Af=Symbol.for("react.element"),xA=Symbol.for("react.portal"),bA=Symbol.for("react.fragment"),wA=Symbol.for("react.strict_mode"),_A=Symbol.for("react.profiler"),TA=Symbol.for("react.provider"),EA=Symbol.for("react.context"),SA=Symbol.for("react.forward_ref"),AA=Symbol.for("react.suspense"),CA=Symbol.for("react.memo"),kA=Symbol.for("react.lazy"),xb=Symbol.iterator;function FA(r){return r===null||typeof r!="object"?null:(r=xb&&r[xb]||r["@@iterator"],typeof r=="function"?r:null)}var zw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Hw=Object.assign,Gw={};function Cc(r,t,s){this.props=r,this.context=t,this.refs=Gw,this.updater=s||zw}Cc.prototype.isReactComponent={};Cc.prototype.setState=function(r,t){if(typeof r!="object"&&typeof r!="function"&&r!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,r,t,"setState")};Cc.prototype.forceUpdate=function(r){this.updater.enqueueForceUpdate(this,r,"forceUpdate")};function qw(){}qw.prototype=Cc.prototype;function pg(r,t,s){this.props=r,this.context=t,this.refs=Gw,this.updater=s||zw}var mg=pg.prototype=new qw;mg.constructor=pg;Hw(mg,Cc.prototype);mg.isPureReactComponent=!0;var bb=Array.isArray,Kw=Object.prototype.hasOwnProperty,gg={current:null},Yw={key:!0,ref:!0,__self:!0,__source:!0};function Qw(r,t,s){var i,n={},e=null,p=null;if(t!=null)for(i in t.ref!==void 0&&(p=t.ref),t.key!==void 0&&(e=""+t.key),t)Kw.call(t,i)&&!Yw.hasOwnProperty(i)&&(n[i]=t[i]);var x=arguments.length-2;if(x===1)n.children=s;else if(1<x){for(var w=Array(x),E=0;E<x;E++)w[E]=arguments[E+2];n.children=w}if(r&&r.defaultProps)for(i in x=r.defaultProps,x)n[i]===void 0&&(n[i]=x[i]);return{$$typeof:Af,type:r,key:e,ref:p,props:n,_owner:gg.current}}function NA(r,t){return{$$typeof:Af,type:r.type,key:t,ref:r.ref,props:r.props,_owner:r._owner}}function yg(r){return typeof r=="object"&&r!==null&&r.$$typeof===Af}function IA(r){var t={"=":"=0",":":"=2"};return"$"+r.replace(/[=:]/g,function(s){return t[s]})}var wb=/\/+/g;function Jp(r,t){return typeof r=="object"&&r!==null&&r.key!=null?IA(""+r.key):t.toString(36)}function fd(r,t,s,i,n){var e=typeof r;(e==="undefined"||e==="boolean")&&(r=null);var p=!1;if(r===null)p=!0;else switch(e){case"string":case"number":p=!0;break;case"object":switch(r.$$typeof){case Af:case xA:p=!0}}if(p)return p=r,n=n(p),r=i===""?"."+Jp(p,0):i,bb(n)?(s="",r!=null&&(s=r.replace(wb,"$&/")+"/"),fd(n,t,s,"",function(E){return E})):n!=null&&(yg(n)&&(n=NA(n,s+(!n.key||p&&p.key===n.key?"":(""+n.key).replace(wb,"$&/")+"/")+r)),t.push(n)),1;if(p=0,i=i===""?".":i+":",bb(r))for(var x=0;x<r.length;x++){e=r[x];var w=i+Jp(e,x);p+=fd(e,t,s,w,n)}else if(w=FA(r),typeof w=="function")for(r=w.call(r),x=0;!(e=r.next()).done;)e=e.value,w=i+Jp(e,x++),p+=fd(e,t,s,w,n);else if(e==="object")throw t=String(r),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return p}function Wh(r,t,s){if(r==null)return r;var i=[],n=0;return fd(r,i,"","",function(e){return t.call(s,e,n++)}),i}function DA(r){if(r._status===-1){var t=r._result;t=t(),t.then(function(s){(r._status===0||r._status===-1)&&(r._status=1,r._result=s)},function(s){(r._status===0||r._status===-1)&&(r._status=2,r._result=s)}),r._status===-1&&(r._status=0,r._result=t)}if(r._status===1)return r._result.default;throw r._result}var bs={current:null},hd={transition:null},RA={ReactCurrentDispatcher:bs,ReactCurrentBatchConfig:hd,ReactCurrentOwner:gg};function Xw(){throw Error("act(...) is not supported in production builds of React.")}ur.Children={map:Wh,forEach:function(r,t,s){Wh(r,function(){t.apply(this,arguments)},s)},count:function(r){var t=0;return Wh(r,function(){t++}),t},toArray:function(r){return Wh(r,function(t){return t})||[]},only:function(r){if(!yg(r))throw Error("React.Children.only expected to receive a single React element child.");return r}};ur.Component=Cc;ur.Fragment=bA;ur.Profiler=_A;ur.PureComponent=pg;ur.StrictMode=wA;ur.Suspense=AA;ur.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=RA;ur.act=Xw;ur.cloneElement=function(r,t,s){if(r==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+r+".");var i=Hw({},r.props),n=r.key,e=r.ref,p=r._owner;if(t!=null){if(t.ref!==void 0&&(e=t.ref,p=gg.current),t.key!==void 0&&(n=""+t.key),r.type&&r.type.defaultProps)var x=r.type.defaultProps;for(w in t)Kw.call(t,w)&&!Yw.hasOwnProperty(w)&&(i[w]=t[w]===void 0&&x!==void 0?x[w]:t[w])}var w=arguments.length-2;if(w===1)i.children=s;else if(1<w){x=Array(w);for(var E=0;E<w;E++)x[E]=arguments[E+2];i.children=x}return{$$typeof:Af,type:r.type,key:n,ref:e,props:i,_owner:p}};ur.createContext=function(r){return r={$$typeof:EA,_currentValue:r,_currentValue2:r,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},r.Provider={$$typeof:TA,_context:r},r.Consumer=r};ur.createElement=Qw;ur.createFactory=function(r){var t=Qw.bind(null,r);return t.type=r,t};ur.createRef=function(){return{current:null}};ur.forwardRef=function(r){return{$$typeof:SA,render:r}};ur.isValidElement=yg;ur.lazy=function(r){return{$$typeof:kA,_payload:{_status:-1,_result:r},_init:DA}};ur.memo=function(r,t){return{$$typeof:CA,type:r,compare:t===void 0?null:t}};ur.startTransition=function(r){var t=hd.transition;hd.transition={};try{r()}finally{hd.transition=t}};ur.unstable_act=Xw;ur.useCallback=function(r,t){return bs.current.useCallback(r,t)};ur.useContext=function(r){return bs.current.useContext(r)};ur.useDebugValue=function(){};ur.useDeferredValue=function(r){return bs.current.useDeferredValue(r)};ur.useEffect=function(r,t){return bs.current.useEffect(r,t)};ur.useId=function(){return bs.current.useId()};ur.useImperativeHandle=function(r,t,s){return bs.current.useImperativeHandle(r,t,s)};ur.useInsertionEffect=function(r,t){return bs.current.useInsertionEffect(r,t)};ur.useLayoutEffect=function(r,t){return bs.current.useLayoutEffect(r,t)};ur.useMemo=function(r,t){return bs.current.useMemo(r,t)};ur.useReducer=function(r,t,s){return bs.current.useReducer(r,t,s)};ur.useRef=function(r){return bs.current.useRef(r)};ur.useState=function(r){return bs.current.useState(r)};ur.useSyncExternalStore=function(r,t,s){return bs.current.useSyncExternalStore(r,t,s)};ur.useTransition=function(){return bs.current.useTransition()};ur.version="18.3.1";Ww.exports=ur;var we=Ww.exports;const PA=yA(we);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OA=we,jA=Symbol.for("react.element"),MA=Symbol.for("react.fragment"),LA=Object.prototype.hasOwnProperty,VA=OA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,UA={key:!0,ref:!0,__self:!0,__source:!0};function Jw(r,t,s){var i,n={},e=null,p=null;s!==void 0&&(e=""+s),t.key!==void 0&&(e=""+t.key),t.ref!==void 0&&(p=t.ref);for(i in t)LA.call(t,i)&&!UA.hasOwnProperty(i)&&(n[i]=t[i]);if(r&&r.defaultProps)for(i in t=r.defaultProps,t)n[i]===void 0&&(n[i]=t[i]);return{$$typeof:jA,type:r,key:e,ref:p,props:n,_owner:VA.current}}f0.Fragment=MA;f0.jsx=Jw;f0.jsxs=Jw;$w.exports=f0;var m=$w.exports,H1={},Zw={exports:{}},Bs={},e3={exports:{}},t3={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(r){function t($e,Ve){var ye=$e.length;$e.push(Ve);e:for(;0<ye;){var oe=ye-1>>>1,Fe=$e[oe];if(0<n(Fe,Ve))$e[oe]=Ve,$e[ye]=Fe,ye=oe;else break e}}function s($e){return $e.length===0?null:$e[0]}function i($e){if($e.length===0)return null;var Ve=$e[0],ye=$e.pop();if(ye!==Ve){$e[0]=ye;e:for(var oe=0,Fe=$e.length,Oe=Fe>>>1;oe<Oe;){var Re=2*(oe+1)-1,de=$e[Re],Ce=Re+1,ce=$e[Ce];if(0>n(de,ye))Ce<Fe&&0>n(ce,de)?($e[oe]=ce,$e[Ce]=ye,oe=Ce):($e[oe]=de,$e[Re]=ye,oe=Re);else if(Ce<Fe&&0>n(ce,ye))$e[oe]=ce,$e[Ce]=ye,oe=Ce;else break e}}return Ve}function n($e,Ve){var ye=$e.sortIndex-Ve.sortIndex;return ye!==0?ye:$e.id-Ve.id}if(typeof performance=="object"&&typeof performance.now=="function"){var e=performance;r.unstable_now=function(){return e.now()}}else{var p=Date,x=p.now();r.unstable_now=function(){return p.now()-x}}var w=[],E=[],N=1,P=null,R=3,q=!1,Z=!1,ne=!1,fe=typeof setTimeout=="function"?setTimeout:null,G=typeof clearTimeout=="function"?clearTimeout:null,U=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function H($e){for(var Ve=s(E);Ve!==null;){if(Ve.callback===null)i(E);else if(Ve.startTime<=$e)i(E),Ve.sortIndex=Ve.expirationTime,t(w,Ve);else break;Ve=s(E)}}function ee($e){if(ne=!1,H($e),!Z)if(s(w)!==null)Z=!0,fr(te);else{var Ve=s(E);Ve!==null&&at(ee,Ve.startTime-$e)}}function te($e,Ve){Z=!1,ne&&(ne=!1,G(O),O=-1),q=!0;var ye=R;try{for(H(Ve),P=s(w);P!==null&&(!(P.expirationTime>Ve)||$e&&!J());){var oe=P.callback;if(typeof oe=="function"){P.callback=null,R=P.priorityLevel;var Fe=oe(P.expirationTime<=Ve);Ve=r.unstable_now(),typeof Fe=="function"?P.callback=Fe:P===s(w)&&i(w),H(Ve)}else i(w);P=s(w)}if(P!==null)var Oe=!0;else{var Re=s(E);Re!==null&&at(ee,Re.startTime-Ve),Oe=!1}return Oe}finally{P=null,R=ye,q=!1}}var ue=!1,L=null,O=-1,V=5,W=-1;function J(){return!(r.unstable_now()-W<V)}function X(){if(L!==null){var $e=r.unstable_now();W=$e;var Ve=!0;try{Ve=L(!0,$e)}finally{Ve?K():(ue=!1,L=null)}}else ue=!1}var K;if(typeof U=="function")K=function(){U(X)};else if(typeof MessageChannel<"u"){var me=new MessageChannel,He=me.port2;me.port1.onmessage=X,K=function(){He.postMessage(null)}}else K=function(){fe(X,0)};function fr($e){L=$e,ue||(ue=!0,K())}function at($e,Ve){O=fe(function(){$e(r.unstable_now())},Ve)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function($e){$e.callback=null},r.unstable_continueExecution=function(){Z||q||(Z=!0,fr(te))},r.unstable_forceFrameRate=function($e){0>$e||125<$e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<$e?Math.floor(1e3/$e):5},r.unstable_getCurrentPriorityLevel=function(){return R},r.unstable_getFirstCallbackNode=function(){return s(w)},r.unstable_next=function($e){switch(R){case 1:case 2:case 3:var Ve=3;break;default:Ve=R}var ye=R;R=Ve;try{return $e()}finally{R=ye}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function($e,Ve){switch($e){case 1:case 2:case 3:case 4:case 5:break;default:$e=3}var ye=R;R=$e;try{return Ve()}finally{R=ye}},r.unstable_scheduleCallback=function($e,Ve,ye){var oe=r.unstable_now();switch(typeof ye=="object"&&ye!==null?(ye=ye.delay,ye=typeof ye=="number"&&0<ye?oe+ye:oe):ye=oe,$e){case 1:var Fe=-1;break;case 2:Fe=250;break;case 5:Fe=1073741823;break;case 4:Fe=1e4;break;default:Fe=5e3}return Fe=ye+Fe,$e={id:N++,callback:Ve,priorityLevel:$e,startTime:ye,expirationTime:Fe,sortIndex:-1},ye>oe?($e.sortIndex=ye,t(E,$e),s(w)===null&&$e===s(E)&&(ne?(G(O),O=-1):ne=!0,at(ee,ye-oe))):($e.sortIndex=Fe,t(w,$e),Z||q||(Z=!0,fr(te))),$e},r.unstable_shouldYield=J,r.unstable_wrapCallback=function($e){var Ve=R;return function(){var ye=R;R=Ve;try{return $e.apply(this,arguments)}finally{R=ye}}}})(t3);e3.exports=t3;var BA=e3.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $A=we,Us=BA;function qe(r){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+r,s=1;s<arguments.length;s++)t+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+r+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r3=new Set,Yu={};function hl(r,t){hc(r,t),hc(r+"Capture",t)}function hc(r,t){for(Yu[r]=t,r=0;r<t.length;r++)r3.add(t[r])}var yi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),G1=Object.prototype.hasOwnProperty,WA=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,_b={},Tb={};function zA(r){return G1.call(Tb,r)?!0:G1.call(_b,r)?!1:WA.test(r)?Tb[r]=!0:(_b[r]=!0,!1)}function HA(r,t,s,i){if(s!==null&&s.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return i?!1:s!==null?!s.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function GA(r,t,s,i){if(t===null||typeof t>"u"||HA(r,t,s,i))return!0;if(i)return!1;if(s!==null)switch(s.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function ws(r,t,s,i,n,e,p){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=n,this.mustUseProperty=s,this.propertyName=r,this.type=t,this.sanitizeURL=e,this.removeEmptyString=p}var qn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){qn[r]=new ws(r,0,!1,r,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var t=r[0];qn[t]=new ws(t,1,!1,r[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(r){qn[r]=new ws(r,2,!1,r.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){qn[r]=new ws(r,2,!1,r,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){qn[r]=new ws(r,3,!1,r.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(r){qn[r]=new ws(r,3,!0,r,null,!1,!1)});["capture","download"].forEach(function(r){qn[r]=new ws(r,4,!1,r,null,!1,!1)});["cols","rows","size","span"].forEach(function(r){qn[r]=new ws(r,6,!1,r,null,!1,!1)});["rowSpan","start"].forEach(function(r){qn[r]=new ws(r,5,!1,r.toLowerCase(),null,!1,!1)});var vg=/[\-:]([a-z])/g;function xg(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var t=r.replace(vg,xg);qn[t]=new ws(t,1,!1,r,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var t=r.replace(vg,xg);qn[t]=new ws(t,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(r){var t=r.replace(vg,xg);qn[t]=new ws(t,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(r){qn[r]=new ws(r,1,!1,r.toLowerCase(),null,!1,!1)});qn.xlinkHref=new ws("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(r){qn[r]=new ws(r,1,!1,r.toLowerCase(),null,!0,!0)});function bg(r,t,s,i){var n=qn.hasOwnProperty(t)?qn[t]:null;(n!==null?n.type!==0:i||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(GA(t,s,n,i)&&(s=null),i||n===null?zA(t)&&(s===null?r.removeAttribute(t):r.setAttribute(t,""+s)):n.mustUseProperty?r[n.propertyName]=s===null?n.type===3?!1:"":s:(t=n.attributeName,i=n.attributeNamespace,s===null?r.removeAttribute(t):(n=n.type,s=n===3||n===4&&s===!0?"":""+s,i?r.setAttributeNS(i,t,s):r.setAttribute(t,s))))}var Si=$A.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,zh=Symbol.for("react.element"),Gl=Symbol.for("react.portal"),ql=Symbol.for("react.fragment"),wg=Symbol.for("react.strict_mode"),q1=Symbol.for("react.profiler"),n3=Symbol.for("react.provider"),s3=Symbol.for("react.context"),_g=Symbol.for("react.forward_ref"),K1=Symbol.for("react.suspense"),Y1=Symbol.for("react.suspense_list"),Tg=Symbol.for("react.memo"),Hi=Symbol.for("react.lazy"),a3=Symbol.for("react.offscreen"),Eb=Symbol.iterator;function vu(r){return r===null||typeof r!="object"?null:(r=Eb&&r[Eb]||r["@@iterator"],typeof r=="function"?r:null)}var on=Object.assign,Zp;function ku(r){if(Zp===void 0)try{throw Error()}catch(s){var t=s.stack.trim().match(/\n( *(at )?)/);Zp=t&&t[1]||""}return`
`+Zp+r}var e1=!1;function t1(r,t){if(!r||e1)return"";e1=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(E){var i=E}Reflect.construct(r,[],t)}else{try{t.call()}catch(E){i=E}r.call(t.prototype)}else{try{throw Error()}catch(E){i=E}r()}}catch(E){if(E&&i&&typeof E.stack=="string"){for(var n=E.stack.split(`
`),e=i.stack.split(`
`),p=n.length-1,x=e.length-1;1<=p&&0<=x&&n[p]!==e[x];)x--;for(;1<=p&&0<=x;p--,x--)if(n[p]!==e[x]){if(p!==1||x!==1)do if(p--,x--,0>x||n[p]!==e[x]){var w=`
`+n[p].replace(" at new "," at ");return r.displayName&&w.includes("<anonymous>")&&(w=w.replace("<anonymous>",r.displayName)),w}while(1<=p&&0<=x);break}}}finally{e1=!1,Error.prepareStackTrace=s}return(r=r?r.displayName||r.name:"")?ku(r):""}function qA(r){switch(r.tag){case 5:return ku(r.type);case 16:return ku("Lazy");case 13:return ku("Suspense");case 19:return ku("SuspenseList");case 0:case 2:case 15:return r=t1(r.type,!1),r;case 11:return r=t1(r.type.render,!1),r;case 1:return r=t1(r.type,!0),r;default:return""}}function Q1(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case ql:return"Fragment";case Gl:return"Portal";case q1:return"Profiler";case wg:return"StrictMode";case K1:return"Suspense";case Y1:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case s3:return(r.displayName||"Context")+".Consumer";case n3:return(r._context.displayName||"Context")+".Provider";case _g:var t=r.render;return r=r.displayName,r||(r=t.displayName||t.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case Tg:return t=r.displayName||null,t!==null?t:Q1(r.type)||"Memo";case Hi:t=r._payload,r=r._init;try{return Q1(r(t))}catch{}}return null}function KA(r){var t=r.type;switch(r.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=t.render,r=r.displayName||r.name||"",t.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Q1(t);case 8:return t===wg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function lo(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function i3(r){var t=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function YA(r){var t=i3(r)?"checked":"value",s=Object.getOwnPropertyDescriptor(r.constructor.prototype,t),i=""+r[t];if(!r.hasOwnProperty(t)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var n=s.get,e=s.set;return Object.defineProperty(r,t,{configurable:!0,get:function(){return n.call(this)},set:function(p){i=""+p,e.call(this,p)}}),Object.defineProperty(r,t,{enumerable:s.enumerable}),{getValue:function(){return i},setValue:function(p){i=""+p},stopTracking:function(){r._valueTracker=null,delete r[t]}}}}function Hh(r){r._valueTracker||(r._valueTracker=YA(r))}function o3(r){if(!r)return!1;var t=r._valueTracker;if(!t)return!0;var s=t.getValue(),i="";return r&&(i=i3(r)?r.checked?"true":"false":r.value),r=i,r!==s?(t.setValue(r),!0):!1}function Nd(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function X1(r,t){var s=t.checked;return on({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??r._wrapperState.initialChecked})}function Sb(r,t){var s=t.defaultValue==null?"":t.defaultValue,i=t.checked!=null?t.checked:t.defaultChecked;s=lo(t.value!=null?t.value:s),r._wrapperState={initialChecked:i,initialValue:s,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function l3(r,t){t=t.checked,t!=null&&bg(r,"checked",t,!1)}function J1(r,t){l3(r,t);var s=lo(t.value),i=t.type;if(s!=null)i==="number"?(s===0&&r.value===""||r.value!=s)&&(r.value=""+s):r.value!==""+s&&(r.value=""+s);else if(i==="submit"||i==="reset"){r.removeAttribute("value");return}t.hasOwnProperty("value")?Z1(r,t.type,s):t.hasOwnProperty("defaultValue")&&Z1(r,t.type,lo(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(r.defaultChecked=!!t.defaultChecked)}function Ab(r,t,s){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!(i!=="submit"&&i!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+r._wrapperState.initialValue,s||t===r.value||(r.value=t),r.defaultValue=t}s=r.name,s!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,s!==""&&(r.name=s)}function Z1(r,t,s){(t!=="number"||Nd(r.ownerDocument)!==r)&&(s==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+s&&(r.defaultValue=""+s))}var Fu=Array.isArray;function sc(r,t,s,i){if(r=r.options,t){t={};for(var n=0;n<s.length;n++)t["$"+s[n]]=!0;for(s=0;s<r.length;s++)n=t.hasOwnProperty("$"+r[s].value),r[s].selected!==n&&(r[s].selected=n),n&&i&&(r[s].defaultSelected=!0)}else{for(s=""+lo(s),t=null,n=0;n<r.length;n++){if(r[n].value===s){r[n].selected=!0,i&&(r[n].defaultSelected=!0);return}t!==null||r[n].disabled||(t=r[n])}t!==null&&(t.selected=!0)}}function em(r,t){if(t.dangerouslySetInnerHTML!=null)throw Error(qe(91));return on({},t,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function Cb(r,t){var s=t.value;if(s==null){if(s=t.children,t=t.defaultValue,s!=null){if(t!=null)throw Error(qe(92));if(Fu(s)){if(1<s.length)throw Error(qe(93));s=s[0]}t=s}t==null&&(t=""),s=t}r._wrapperState={initialValue:lo(s)}}function c3(r,t){var s=lo(t.value),i=lo(t.defaultValue);s!=null&&(s=""+s,s!==r.value&&(r.value=s),t.defaultValue==null&&r.defaultValue!==s&&(r.defaultValue=s)),i!=null&&(r.defaultValue=""+i)}function kb(r){var t=r.textContent;t===r._wrapperState.initialValue&&t!==""&&t!==null&&(r.value=t)}function u3(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function tm(r,t){return r==null||r==="http://www.w3.org/1999/xhtml"?u3(t):r==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var Gh,f3=function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,s,i,n){MSApp.execUnsafeLocalFunction(function(){return r(t,s,i,n)})}:r}(function(r,t){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=t;else{for(Gh=Gh||document.createElement("div"),Gh.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Gh.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;t.firstChild;)r.appendChild(t.firstChild)}});function Qu(r,t){if(t){var s=r.firstChild;if(s&&s===r.lastChild&&s.nodeType===3){s.nodeValue=t;return}}r.textContent=t}var ju={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},QA=["Webkit","ms","Moz","O"];Object.keys(ju).forEach(function(r){QA.forEach(function(t){t=t+r.charAt(0).toUpperCase()+r.substring(1),ju[t]=ju[r]})});function h3(r,t,s){return t==null||typeof t=="boolean"||t===""?"":s||typeof t!="number"||t===0||ju.hasOwnProperty(r)&&ju[r]?(""+t).trim():t+"px"}function d3(r,t){r=r.style;for(var s in t)if(t.hasOwnProperty(s)){var i=s.indexOf("--")===0,n=h3(s,t[s],i);s==="float"&&(s="cssFloat"),i?r.setProperty(s,n):r[s]=n}}var XA=on({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function rm(r,t){if(t){if(XA[r]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(qe(137,r));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(qe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(qe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(qe(62))}}function nm(r,t){if(r.indexOf("-")===-1)return typeof t.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sm=null;function Eg(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var am=null,ac=null,ic=null;function Fb(r){if(r=Ff(r)){if(typeof am!="function")throw Error(qe(280));var t=r.stateNode;t&&(t=g0(t),am(r.stateNode,r.type,t))}}function p3(r){ac?ic?ic.push(r):ic=[r]:ac=r}function m3(){if(ac){var r=ac,t=ic;if(ic=ac=null,Fb(r),t)for(r=0;r<t.length;r++)Fb(t[r])}}function g3(r,t){return r(t)}function y3(){}var r1=!1;function v3(r,t,s){if(r1)return r(t,s);r1=!0;try{return g3(r,t,s)}finally{r1=!1,(ac!==null||ic!==null)&&(y3(),m3())}}function Xu(r,t){var s=r.stateNode;if(s===null)return null;var i=g0(s);if(i===null)return null;s=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(r=r.type,i=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!i;break e;default:r=!1}if(r)return null;if(s&&typeof s!="function")throw Error(qe(231,t,typeof s));return s}var im=!1;if(yi)try{var xu={};Object.defineProperty(xu,"passive",{get:function(){im=!0}}),window.addEventListener("test",xu,xu),window.removeEventListener("test",xu,xu)}catch{im=!1}function JA(r,t,s,i,n,e,p,x,w){var E=Array.prototype.slice.call(arguments,3);try{t.apply(s,E)}catch(N){this.onError(N)}}var Mu=!1,Id=null,Dd=!1,om=null,ZA={onError:function(r){Mu=!0,Id=r}};function eC(r,t,s,i,n,e,p,x,w){Mu=!1,Id=null,JA.apply(ZA,arguments)}function tC(r,t,s,i,n,e,p,x,w){if(eC.apply(this,arguments),Mu){if(Mu){var E=Id;Mu=!1,Id=null}else throw Error(qe(198));Dd||(Dd=!0,om=E)}}function dl(r){var t=r,s=r;if(r.alternate)for(;t.return;)t=t.return;else{r=t;do t=r,t.flags&4098&&(s=t.return),r=t.return;while(r)}return t.tag===3?s:null}function x3(r){if(r.tag===13){var t=r.memoizedState;if(t===null&&(r=r.alternate,r!==null&&(t=r.memoizedState)),t!==null)return t.dehydrated}return null}function Nb(r){if(dl(r)!==r)throw Error(qe(188))}function rC(r){var t=r.alternate;if(!t){if(t=dl(r),t===null)throw Error(qe(188));return t!==r?null:r}for(var s=r,i=t;;){var n=s.return;if(n===null)break;var e=n.alternate;if(e===null){if(i=n.return,i!==null){s=i;continue}break}if(n.child===e.child){for(e=n.child;e;){if(e===s)return Nb(n),r;if(e===i)return Nb(n),t;e=e.sibling}throw Error(qe(188))}if(s.return!==i.return)s=n,i=e;else{for(var p=!1,x=n.child;x;){if(x===s){p=!0,s=n,i=e;break}if(x===i){p=!0,i=n,s=e;break}x=x.sibling}if(!p){for(x=e.child;x;){if(x===s){p=!0,s=e,i=n;break}if(x===i){p=!0,i=e,s=n;break}x=x.sibling}if(!p)throw Error(qe(189))}}if(s.alternate!==i)throw Error(qe(190))}if(s.tag!==3)throw Error(qe(188));return s.stateNode.current===s?r:t}function b3(r){return r=rC(r),r!==null?w3(r):null}function w3(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var t=w3(r);if(t!==null)return t;r=r.sibling}return null}var _3=Us.unstable_scheduleCallback,Ib=Us.unstable_cancelCallback,nC=Us.unstable_shouldYield,sC=Us.unstable_requestPaint,gn=Us.unstable_now,aC=Us.unstable_getCurrentPriorityLevel,Sg=Us.unstable_ImmediatePriority,T3=Us.unstable_UserBlockingPriority,Rd=Us.unstable_NormalPriority,iC=Us.unstable_LowPriority,E3=Us.unstable_IdlePriority,h0=null,Wa=null;function oC(r){if(Wa&&typeof Wa.onCommitFiberRoot=="function")try{Wa.onCommitFiberRoot(h0,r,void 0,(r.current.flags&128)===128)}catch{}}var wa=Math.clz32?Math.clz32:uC,lC=Math.log,cC=Math.LN2;function uC(r){return r>>>=0,r===0?32:31-(lC(r)/cC|0)|0}var qh=64,Kh=4194304;function Nu(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function Pd(r,t){var s=r.pendingLanes;if(s===0)return 0;var i=0,n=r.suspendedLanes,e=r.pingedLanes,p=s&268435455;if(p!==0){var x=p&~n;x!==0?i=Nu(x):(e&=p,e!==0&&(i=Nu(e)))}else p=s&~n,p!==0?i=Nu(p):e!==0&&(i=Nu(e));if(i===0)return 0;if(t!==0&&t!==i&&!(t&n)&&(n=i&-i,e=t&-t,n>=e||n===16&&(e&4194240)!==0))return t;if(i&4&&(i|=s&16),t=r.entangledLanes,t!==0)for(r=r.entanglements,t&=i;0<t;)s=31-wa(t),n=1<<s,i|=r[s],t&=~n;return i}function fC(r,t){switch(r){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function hC(r,t){for(var s=r.suspendedLanes,i=r.pingedLanes,n=r.expirationTimes,e=r.pendingLanes;0<e;){var p=31-wa(e),x=1<<p,w=n[p];w===-1?(!(x&s)||x&i)&&(n[p]=fC(x,t)):w<=t&&(r.expiredLanes|=x),e&=~x}}function lm(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function S3(){var r=qh;return qh<<=1,!(qh&4194240)&&(qh=64),r}function n1(r){for(var t=[],s=0;31>s;s++)t.push(r);return t}function Cf(r,t,s){r.pendingLanes|=t,t!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,t=31-wa(t),r[t]=s}function dC(r,t){var s=r.pendingLanes&~t;r.pendingLanes=t,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=t,r.mutableReadLanes&=t,r.entangledLanes&=t,t=r.entanglements;var i=r.eventTimes;for(r=r.expirationTimes;0<s;){var n=31-wa(s),e=1<<n;t[n]=0,i[n]=-1,r[n]=-1,s&=~e}}function Ag(r,t){var s=r.entangledLanes|=t;for(r=r.entanglements;s;){var i=31-wa(s),n=1<<i;n&t|r[i]&t&&(r[i]|=t),s&=~n}}var Mr=0;function A3(r){return r&=-r,1<r?4<r?r&268435455?16:536870912:4:1}var C3,Cg,k3,F3,N3,cm=!1,Yh=[],Ji=null,Zi=null,eo=null,Ju=new Map,Zu=new Map,qi=[],pC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Db(r,t){switch(r){case"focusin":case"focusout":Ji=null;break;case"dragenter":case"dragleave":Zi=null;break;case"mouseover":case"mouseout":eo=null;break;case"pointerover":case"pointerout":Ju.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Zu.delete(t.pointerId)}}function bu(r,t,s,i,n,e){return r===null||r.nativeEvent!==e?(r={blockedOn:t,domEventName:s,eventSystemFlags:i,nativeEvent:e,targetContainers:[n]},t!==null&&(t=Ff(t),t!==null&&Cg(t)),r):(r.eventSystemFlags|=i,t=r.targetContainers,n!==null&&t.indexOf(n)===-1&&t.push(n),r)}function mC(r,t,s,i,n){switch(t){case"focusin":return Ji=bu(Ji,r,t,s,i,n),!0;case"dragenter":return Zi=bu(Zi,r,t,s,i,n),!0;case"mouseover":return eo=bu(eo,r,t,s,i,n),!0;case"pointerover":var e=n.pointerId;return Ju.set(e,bu(Ju.get(e)||null,r,t,s,i,n)),!0;case"gotpointercapture":return e=n.pointerId,Zu.set(e,bu(Zu.get(e)||null,r,t,s,i,n)),!0}return!1}function I3(r){var t=Go(r.target);if(t!==null){var s=dl(t);if(s!==null){if(t=s.tag,t===13){if(t=x3(s),t!==null){r.blockedOn=t,N3(r.priority,function(){k3(s)});return}}else if(t===3&&s.stateNode.current.memoizedState.isDehydrated){r.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}r.blockedOn=null}function dd(r){if(r.blockedOn!==null)return!1;for(var t=r.targetContainers;0<t.length;){var s=um(r.domEventName,r.eventSystemFlags,t[0],r.nativeEvent);if(s===null){s=r.nativeEvent;var i=new s.constructor(s.type,s);sm=i,s.target.dispatchEvent(i),sm=null}else return t=Ff(s),t!==null&&Cg(t),r.blockedOn=s,!1;t.shift()}return!0}function Rb(r,t,s){dd(r)&&s.delete(t)}function gC(){cm=!1,Ji!==null&&dd(Ji)&&(Ji=null),Zi!==null&&dd(Zi)&&(Zi=null),eo!==null&&dd(eo)&&(eo=null),Ju.forEach(Rb),Zu.forEach(Rb)}function wu(r,t){r.blockedOn===t&&(r.blockedOn=null,cm||(cm=!0,Us.unstable_scheduleCallback(Us.unstable_NormalPriority,gC)))}function ef(r){function t(n){return wu(n,r)}if(0<Yh.length){wu(Yh[0],r);for(var s=1;s<Yh.length;s++){var i=Yh[s];i.blockedOn===r&&(i.blockedOn=null)}}for(Ji!==null&&wu(Ji,r),Zi!==null&&wu(Zi,r),eo!==null&&wu(eo,r),Ju.forEach(t),Zu.forEach(t),s=0;s<qi.length;s++)i=qi[s],i.blockedOn===r&&(i.blockedOn=null);for(;0<qi.length&&(s=qi[0],s.blockedOn===null);)I3(s),s.blockedOn===null&&qi.shift()}var oc=Si.ReactCurrentBatchConfig,Od=!0;function yC(r,t,s,i){var n=Mr,e=oc.transition;oc.transition=null;try{Mr=1,kg(r,t,s,i)}finally{Mr=n,oc.transition=e}}function vC(r,t,s,i){var n=Mr,e=oc.transition;oc.transition=null;try{Mr=4,kg(r,t,s,i)}finally{Mr=n,oc.transition=e}}function kg(r,t,s,i){if(Od){var n=um(r,t,s,i);if(n===null)d1(r,t,i,jd,s),Db(r,i);else if(mC(n,r,t,s,i))i.stopPropagation();else if(Db(r,i),t&4&&-1<pC.indexOf(r)){for(;n!==null;){var e=Ff(n);if(e!==null&&C3(e),e=um(r,t,s,i),e===null&&d1(r,t,i,jd,s),e===n)break;n=e}n!==null&&i.stopPropagation()}else d1(r,t,i,null,s)}}var jd=null;function um(r,t,s,i){if(jd=null,r=Eg(i),r=Go(r),r!==null)if(t=dl(r),t===null)r=null;else if(s=t.tag,s===13){if(r=x3(t),r!==null)return r;r=null}else if(s===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;r=null}else t!==r&&(r=null);return jd=r,null}function D3(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(aC()){case Sg:return 1;case T3:return 4;case Rd:case iC:return 16;case E3:return 536870912;default:return 16}default:return 16}}var Yi=null,Fg=null,pd=null;function R3(){if(pd)return pd;var r,t=Fg,s=t.length,i,n="value"in Yi?Yi.value:Yi.textContent,e=n.length;for(r=0;r<s&&t[r]===n[r];r++);var p=s-r;for(i=1;i<=p&&t[s-i]===n[e-i];i++);return pd=n.slice(r,1<i?1-i:void 0)}function md(r){var t=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&t===13&&(r=13)):r=t,r===10&&(r=13),32<=r||r===13?r:0}function Qh(){return!0}function Pb(){return!1}function $s(r){function t(s,i,n,e,p){this._reactName=s,this._targetInst=n,this.type=i,this.nativeEvent=e,this.target=p,this.currentTarget=null;for(var x in r)r.hasOwnProperty(x)&&(s=r[x],this[x]=s?s(e):e[x]);return this.isDefaultPrevented=(e.defaultPrevented!=null?e.defaultPrevented:e.returnValue===!1)?Qh:Pb,this.isPropagationStopped=Pb,this}return on(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=Qh)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=Qh)},persist:function(){},isPersistent:Qh}),t}var kc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ng=$s(kc),kf=on({},kc,{view:0,detail:0}),xC=$s(kf),s1,a1,_u,d0=on({},kf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ig,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==_u&&(_u&&r.type==="mousemove"?(s1=r.screenX-_u.screenX,a1=r.screenY-_u.screenY):a1=s1=0,_u=r),s1)},movementY:function(r){return"movementY"in r?r.movementY:a1}}),Ob=$s(d0),bC=on({},d0,{dataTransfer:0}),wC=$s(bC),_C=on({},kf,{relatedTarget:0}),i1=$s(_C),TC=on({},kc,{animationName:0,elapsedTime:0,pseudoElement:0}),EC=$s(TC),SC=on({},kc,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),AC=$s(SC),CC=on({},kc,{data:0}),jb=$s(CC),kC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},FC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},NC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function IC(r){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(r):(r=NC[r])?!!t[r]:!1}function Ig(){return IC}var DC=on({},kf,{key:function(r){if(r.key){var t=kC[r.key]||r.key;if(t!=="Unidentified")return t}return r.type==="keypress"?(r=md(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?FC[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ig,charCode:function(r){return r.type==="keypress"?md(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?md(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),RC=$s(DC),PC=on({},d0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Mb=$s(PC),OC=on({},kf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ig}),jC=$s(OC),MC=on({},kc,{propertyName:0,elapsedTime:0,pseudoElement:0}),LC=$s(MC),VC=on({},d0,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),UC=$s(VC),BC=[9,13,27,32],Dg=yi&&"CompositionEvent"in window,Lu=null;yi&&"documentMode"in document&&(Lu=document.documentMode);var $C=yi&&"TextEvent"in window&&!Lu,P3=yi&&(!Dg||Lu&&8<Lu&&11>=Lu),Lb=" ",Vb=!1;function O3(r,t){switch(r){case"keyup":return BC.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function j3(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Kl=!1;function WC(r,t){switch(r){case"compositionend":return j3(t);case"keypress":return t.which!==32?null:(Vb=!0,Lb);case"textInput":return r=t.data,r===Lb&&Vb?null:r;default:return null}}function zC(r,t){if(Kl)return r==="compositionend"||!Dg&&O3(r,t)?(r=R3(),pd=Fg=Yi=null,Kl=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return P3&&t.locale!=="ko"?null:t.data;default:return null}}var HC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ub(r){var t=r&&r.nodeName&&r.nodeName.toLowerCase();return t==="input"?!!HC[r.type]:t==="textarea"}function M3(r,t,s,i){p3(i),t=Md(t,"onChange"),0<t.length&&(s=new Ng("onChange","change",null,s,i),r.push({event:s,listeners:t}))}var Vu=null,tf=null;function GC(r){K3(r,0)}function p0(r){var t=Xl(r);if(o3(t))return r}function qC(r,t){if(r==="change")return t}var L3=!1;if(yi){var o1;if(yi){var l1="oninput"in document;if(!l1){var Bb=document.createElement("div");Bb.setAttribute("oninput","return;"),l1=typeof Bb.oninput=="function"}o1=l1}else o1=!1;L3=o1&&(!document.documentMode||9<document.documentMode)}function $b(){Vu&&(Vu.detachEvent("onpropertychange",V3),tf=Vu=null)}function V3(r){if(r.propertyName==="value"&&p0(tf)){var t=[];M3(t,tf,r,Eg(r)),v3(GC,t)}}function KC(r,t,s){r==="focusin"?($b(),Vu=t,tf=s,Vu.attachEvent("onpropertychange",V3)):r==="focusout"&&$b()}function YC(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return p0(tf)}function QC(r,t){if(r==="click")return p0(t)}function XC(r,t){if(r==="input"||r==="change")return p0(t)}function JC(r,t){return r===t&&(r!==0||1/r===1/t)||r!==r&&t!==t}var Ea=typeof Object.is=="function"?Object.is:JC;function rf(r,t){if(Ea(r,t))return!0;if(typeof r!="object"||r===null||typeof t!="object"||t===null)return!1;var s=Object.keys(r),i=Object.keys(t);if(s.length!==i.length)return!1;for(i=0;i<s.length;i++){var n=s[i];if(!G1.call(t,n)||!Ea(r[n],t[n]))return!1}return!0}function Wb(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function zb(r,t){var s=Wb(r);r=0;for(var i;s;){if(s.nodeType===3){if(i=r+s.textContent.length,r<=t&&i>=t)return{node:s,offset:t-r};r=i}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=Wb(s)}}function U3(r,t){return r&&t?r===t?!0:r&&r.nodeType===3?!1:t&&t.nodeType===3?U3(r,t.parentNode):"contains"in r?r.contains(t):r.compareDocumentPosition?!!(r.compareDocumentPosition(t)&16):!1:!1}function B3(){for(var r=window,t=Nd();t instanceof r.HTMLIFrameElement;){try{var s=typeof t.contentWindow.location.href=="string"}catch{s=!1}if(s)r=t.contentWindow;else break;t=Nd(r.document)}return t}function Rg(r){var t=r&&r.nodeName&&r.nodeName.toLowerCase();return t&&(t==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||t==="textarea"||r.contentEditable==="true")}function ZC(r){var t=B3(),s=r.focusedElem,i=r.selectionRange;if(t!==s&&s&&s.ownerDocument&&U3(s.ownerDocument.documentElement,s)){if(i!==null&&Rg(s)){if(t=i.start,r=i.end,r===void 0&&(r=t),"selectionStart"in s)s.selectionStart=t,s.selectionEnd=Math.min(r,s.value.length);else if(r=(t=s.ownerDocument||document)&&t.defaultView||window,r.getSelection){r=r.getSelection();var n=s.textContent.length,e=Math.min(i.start,n);i=i.end===void 0?e:Math.min(i.end,n),!r.extend&&e>i&&(n=i,i=e,e=n),n=zb(s,e);var p=zb(s,i);n&&p&&(r.rangeCount!==1||r.anchorNode!==n.node||r.anchorOffset!==n.offset||r.focusNode!==p.node||r.focusOffset!==p.offset)&&(t=t.createRange(),t.setStart(n.node,n.offset),r.removeAllRanges(),e>i?(r.addRange(t),r.extend(p.node,p.offset)):(t.setEnd(p.node,p.offset),r.addRange(t)))}}for(t=[],r=s;r=r.parentNode;)r.nodeType===1&&t.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<t.length;s++)r=t[s],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var ek=yi&&"documentMode"in document&&11>=document.documentMode,Yl=null,fm=null,Uu=null,hm=!1;function Hb(r,t,s){var i=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;hm||Yl==null||Yl!==Nd(i)||(i=Yl,"selectionStart"in i&&Rg(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Uu&&rf(Uu,i)||(Uu=i,i=Md(fm,"onSelect"),0<i.length&&(t=new Ng("onSelect","select",null,t,s),r.push({event:t,listeners:i}),t.target=Yl)))}function Xh(r,t){var s={};return s[r.toLowerCase()]=t.toLowerCase(),s["Webkit"+r]="webkit"+t,s["Moz"+r]="moz"+t,s}var Ql={animationend:Xh("Animation","AnimationEnd"),animationiteration:Xh("Animation","AnimationIteration"),animationstart:Xh("Animation","AnimationStart"),transitionend:Xh("Transition","TransitionEnd")},c1={},$3={};yi&&($3=document.createElement("div").style,"AnimationEvent"in window||(delete Ql.animationend.animation,delete Ql.animationiteration.animation,delete Ql.animationstart.animation),"TransitionEvent"in window||delete Ql.transitionend.transition);function m0(r){if(c1[r])return c1[r];if(!Ql[r])return r;var t=Ql[r],s;for(s in t)if(t.hasOwnProperty(s)&&s in $3)return c1[r]=t[s];return r}var W3=m0("animationend"),z3=m0("animationiteration"),H3=m0("animationstart"),G3=m0("transitionend"),q3=new Map,Gb="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function mo(r,t){q3.set(r,t),hl(t,[r])}for(var u1=0;u1<Gb.length;u1++){var f1=Gb[u1],tk=f1.toLowerCase(),rk=f1[0].toUpperCase()+f1.slice(1);mo(tk,"on"+rk)}mo(W3,"onAnimationEnd");mo(z3,"onAnimationIteration");mo(H3,"onAnimationStart");mo("dblclick","onDoubleClick");mo("focusin","onFocus");mo("focusout","onBlur");mo(G3,"onTransitionEnd");hc("onMouseEnter",["mouseout","mouseover"]);hc("onMouseLeave",["mouseout","mouseover"]);hc("onPointerEnter",["pointerout","pointerover"]);hc("onPointerLeave",["pointerout","pointerover"]);hl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));hl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));hl("onBeforeInput",["compositionend","keypress","textInput","paste"]);hl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));hl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));hl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Iu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),nk=new Set("cancel close invalid load scroll toggle".split(" ").concat(Iu));function qb(r,t,s){var i=r.type||"unknown-event";r.currentTarget=s,tC(i,t,void 0,r),r.currentTarget=null}function K3(r,t){t=(t&4)!==0;for(var s=0;s<r.length;s++){var i=r[s],n=i.event;i=i.listeners;e:{var e=void 0;if(t)for(var p=i.length-1;0<=p;p--){var x=i[p],w=x.instance,E=x.currentTarget;if(x=x.listener,w!==e&&n.isPropagationStopped())break e;qb(n,x,E),e=w}else for(p=0;p<i.length;p++){if(x=i[p],w=x.instance,E=x.currentTarget,x=x.listener,w!==e&&n.isPropagationStopped())break e;qb(n,x,E),e=w}}}if(Dd)throw r=om,Dd=!1,om=null,r}function Kr(r,t){var s=t[ym];s===void 0&&(s=t[ym]=new Set);var i=r+"__bubble";s.has(i)||(Y3(t,r,2,!1),s.add(i))}function h1(r,t,s){var i=0;t&&(i|=4),Y3(s,r,i,t)}var Jh="_reactListening"+Math.random().toString(36).slice(2);function nf(r){if(!r[Jh]){r[Jh]=!0,r3.forEach(function(s){s!=="selectionchange"&&(nk.has(s)||h1(s,!1,r),h1(s,!0,r))});var t=r.nodeType===9?r:r.ownerDocument;t===null||t[Jh]||(t[Jh]=!0,h1("selectionchange",!1,t))}}function Y3(r,t,s,i){switch(D3(t)){case 1:var n=yC;break;case 4:n=vC;break;default:n=kg}s=n.bind(null,t,s,r),n=void 0,!im||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(n=!0),i?n!==void 0?r.addEventListener(t,s,{capture:!0,passive:n}):r.addEventListener(t,s,!0):n!==void 0?r.addEventListener(t,s,{passive:n}):r.addEventListener(t,s,!1)}function d1(r,t,s,i,n){var e=i;if(!(t&1)&&!(t&2)&&i!==null)e:for(;;){if(i===null)return;var p=i.tag;if(p===3||p===4){var x=i.stateNode.containerInfo;if(x===n||x.nodeType===8&&x.parentNode===n)break;if(p===4)for(p=i.return;p!==null;){var w=p.tag;if((w===3||w===4)&&(w=p.stateNode.containerInfo,w===n||w.nodeType===8&&w.parentNode===n))return;p=p.return}for(;x!==null;){if(p=Go(x),p===null)return;if(w=p.tag,w===5||w===6){i=e=p;continue e}x=x.parentNode}}i=i.return}v3(function(){var E=e,N=Eg(s),P=[];e:{var R=q3.get(r);if(R!==void 0){var q=Ng,Z=r;switch(r){case"keypress":if(md(s)===0)break e;case"keydown":case"keyup":q=RC;break;case"focusin":Z="focus",q=i1;break;case"focusout":Z="blur",q=i1;break;case"beforeblur":case"afterblur":q=i1;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":q=Ob;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":q=wC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":q=jC;break;case W3:case z3:case H3:q=EC;break;case G3:q=LC;break;case"scroll":q=xC;break;case"wheel":q=UC;break;case"copy":case"cut":case"paste":q=AC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":q=Mb}var ne=(t&4)!==0,fe=!ne&&r==="scroll",G=ne?R!==null?R+"Capture":null:R;ne=[];for(var U=E,H;U!==null;){H=U;var ee=H.stateNode;if(H.tag===5&&ee!==null&&(H=ee,G!==null&&(ee=Xu(U,G),ee!=null&&ne.push(sf(U,ee,H)))),fe)break;U=U.return}0<ne.length&&(R=new q(R,Z,null,s,N),P.push({event:R,listeners:ne}))}}if(!(t&7)){e:{if(R=r==="mouseover"||r==="pointerover",q=r==="mouseout"||r==="pointerout",R&&s!==sm&&(Z=s.relatedTarget||s.fromElement)&&(Go(Z)||Z[vi]))break e;if((q||R)&&(R=N.window===N?N:(R=N.ownerDocument)?R.defaultView||R.parentWindow:window,q?(Z=s.relatedTarget||s.toElement,q=E,Z=Z?Go(Z):null,Z!==null&&(fe=dl(Z),Z!==fe||Z.tag!==5&&Z.tag!==6)&&(Z=null)):(q=null,Z=E),q!==Z)){if(ne=Ob,ee="onMouseLeave",G="onMouseEnter",U="mouse",(r==="pointerout"||r==="pointerover")&&(ne=Mb,ee="onPointerLeave",G="onPointerEnter",U="pointer"),fe=q==null?R:Xl(q),H=Z==null?R:Xl(Z),R=new ne(ee,U+"leave",q,s,N),R.target=fe,R.relatedTarget=H,ee=null,Go(N)===E&&(ne=new ne(G,U+"enter",Z,s,N),ne.target=H,ne.relatedTarget=fe,ee=ne),fe=ee,q&&Z)t:{for(ne=q,G=Z,U=0,H=ne;H;H=Bl(H))U++;for(H=0,ee=G;ee;ee=Bl(ee))H++;for(;0<U-H;)ne=Bl(ne),U--;for(;0<H-U;)G=Bl(G),H--;for(;U--;){if(ne===G||G!==null&&ne===G.alternate)break t;ne=Bl(ne),G=Bl(G)}ne=null}else ne=null;q!==null&&Kb(P,R,q,ne,!1),Z!==null&&fe!==null&&Kb(P,fe,Z,ne,!0)}}e:{if(R=E?Xl(E):window,q=R.nodeName&&R.nodeName.toLowerCase(),q==="select"||q==="input"&&R.type==="file")var te=qC;else if(Ub(R))if(L3)te=XC;else{te=YC;var ue=KC}else(q=R.nodeName)&&q.toLowerCase()==="input"&&(R.type==="checkbox"||R.type==="radio")&&(te=QC);if(te&&(te=te(r,E))){M3(P,te,s,N);break e}ue&&ue(r,R,E),r==="focusout"&&(ue=R._wrapperState)&&ue.controlled&&R.type==="number"&&Z1(R,"number",R.value)}switch(ue=E?Xl(E):window,r){case"focusin":(Ub(ue)||ue.contentEditable==="true")&&(Yl=ue,fm=E,Uu=null);break;case"focusout":Uu=fm=Yl=null;break;case"mousedown":hm=!0;break;case"contextmenu":case"mouseup":case"dragend":hm=!1,Hb(P,s,N);break;case"selectionchange":if(ek)break;case"keydown":case"keyup":Hb(P,s,N)}var L;if(Dg)e:{switch(r){case"compositionstart":var O="onCompositionStart";break e;case"compositionend":O="onCompositionEnd";break e;case"compositionupdate":O="onCompositionUpdate";break e}O=void 0}else Kl?O3(r,s)&&(O="onCompositionEnd"):r==="keydown"&&s.keyCode===229&&(O="onCompositionStart");O&&(P3&&s.locale!=="ko"&&(Kl||O!=="onCompositionStart"?O==="onCompositionEnd"&&Kl&&(L=R3()):(Yi=N,Fg="value"in Yi?Yi.value:Yi.textContent,Kl=!0)),ue=Md(E,O),0<ue.length&&(O=new jb(O,r,null,s,N),P.push({event:O,listeners:ue}),L?O.data=L:(L=j3(s),L!==null&&(O.data=L)))),(L=$C?WC(r,s):zC(r,s))&&(E=Md(E,"onBeforeInput"),0<E.length&&(N=new jb("onBeforeInput","beforeinput",null,s,N),P.push({event:N,listeners:E}),N.data=L))}K3(P,t)})}function sf(r,t,s){return{instance:r,listener:t,currentTarget:s}}function Md(r,t){for(var s=t+"Capture",i=[];r!==null;){var n=r,e=n.stateNode;n.tag===5&&e!==null&&(n=e,e=Xu(r,s),e!=null&&i.unshift(sf(r,e,n)),e=Xu(r,t),e!=null&&i.push(sf(r,e,n))),r=r.return}return i}function Bl(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function Kb(r,t,s,i,n){for(var e=t._reactName,p=[];s!==null&&s!==i;){var x=s,w=x.alternate,E=x.stateNode;if(w!==null&&w===i)break;x.tag===5&&E!==null&&(x=E,n?(w=Xu(s,e),w!=null&&p.unshift(sf(s,w,x))):n||(w=Xu(s,e),w!=null&&p.push(sf(s,w,x)))),s=s.return}p.length!==0&&r.push({event:t,listeners:p})}var sk=/\r\n?/g,ak=/\u0000|\uFFFD/g;function Yb(r){return(typeof r=="string"?r:""+r).replace(sk,`
`).replace(ak,"")}function Zh(r,t,s){if(t=Yb(t),Yb(r)!==t&&s)throw Error(qe(425))}function Ld(){}var dm=null,pm=null;function mm(r,t){return r==="textarea"||r==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var gm=typeof setTimeout=="function"?setTimeout:void 0,ik=typeof clearTimeout=="function"?clearTimeout:void 0,Qb=typeof Promise=="function"?Promise:void 0,ok=typeof queueMicrotask=="function"?queueMicrotask:typeof Qb<"u"?function(r){return Qb.resolve(null).then(r).catch(lk)}:gm;function lk(r){setTimeout(function(){throw r})}function p1(r,t){var s=t,i=0;do{var n=s.nextSibling;if(r.removeChild(s),n&&n.nodeType===8)if(s=n.data,s==="/$"){if(i===0){r.removeChild(n),ef(t);return}i--}else s!=="$"&&s!=="$?"&&s!=="$!"||i++;s=n}while(s);ef(t)}function to(r){for(;r!=null;r=r.nextSibling){var t=r.nodeType;if(t===1||t===3)break;if(t===8){if(t=r.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return r}function Xb(r){r=r.previousSibling;for(var t=0;r;){if(r.nodeType===8){var s=r.data;if(s==="$"||s==="$!"||s==="$?"){if(t===0)return r;t--}else s==="/$"&&t++}r=r.previousSibling}return null}var Fc=Math.random().toString(36).slice(2),$a="__reactFiber$"+Fc,af="__reactProps$"+Fc,vi="__reactContainer$"+Fc,ym="__reactEvents$"+Fc,ck="__reactListeners$"+Fc,uk="__reactHandles$"+Fc;function Go(r){var t=r[$a];if(t)return t;for(var s=r.parentNode;s;){if(t=s[vi]||s[$a]){if(s=t.alternate,t.child!==null||s!==null&&s.child!==null)for(r=Xb(r);r!==null;){if(s=r[$a])return s;r=Xb(r)}return t}r=s,s=r.parentNode}return null}function Ff(r){return r=r[$a]||r[vi],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function Xl(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(qe(33))}function g0(r){return r[af]||null}var vm=[],Jl=-1;function go(r){return{current:r}}function Qr(r){0>Jl||(r.current=vm[Jl],vm[Jl]=null,Jl--)}function Hr(r,t){Jl++,vm[Jl]=r.current,r.current=t}var co={},cs=go(co),Cs=go(!1),el=co;function dc(r,t){var s=r.type.contextTypes;if(!s)return co;var i=r.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var n={},e;for(e in s)n[e]=t[e];return i&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=t,r.__reactInternalMemoizedMaskedChildContext=n),n}function ks(r){return r=r.childContextTypes,r!=null}function Vd(){Qr(Cs),Qr(cs)}function Jb(r,t,s){if(cs.current!==co)throw Error(qe(168));Hr(cs,t),Hr(Cs,s)}function Q3(r,t,s){var i=r.stateNode;if(t=t.childContextTypes,typeof i.getChildContext!="function")return s;i=i.getChildContext();for(var n in i)if(!(n in t))throw Error(qe(108,KA(r)||"Unknown",n));return on({},s,i)}function Ud(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||co,el=cs.current,Hr(cs,r),Hr(Cs,Cs.current),!0}function Zb(r,t,s){var i=r.stateNode;if(!i)throw Error(qe(169));s?(r=Q3(r,t,el),i.__reactInternalMemoizedMergedChildContext=r,Qr(Cs),Qr(cs),Hr(cs,r)):Qr(Cs),Hr(Cs,s)}var ui=null,y0=!1,m1=!1;function X3(r){ui===null?ui=[r]:ui.push(r)}function fk(r){y0=!0,X3(r)}function yo(){if(!m1&&ui!==null){m1=!0;var r=0,t=Mr;try{var s=ui;for(Mr=1;r<s.length;r++){var i=s[r];do i=i(!0);while(i!==null)}ui=null,y0=!1}catch(n){throw ui!==null&&(ui=ui.slice(r+1)),_3(Sg,yo),n}finally{Mr=t,m1=!1}}return null}var Zl=[],ec=0,Bd=null,$d=0,ra=[],na=0,tl=null,fi=1,hi="";function Wo(r,t){Zl[ec++]=$d,Zl[ec++]=Bd,Bd=r,$d=t}function J3(r,t,s){ra[na++]=fi,ra[na++]=hi,ra[na++]=tl,tl=r;var i=fi;r=hi;var n=32-wa(i)-1;i&=~(1<<n),s+=1;var e=32-wa(t)+n;if(30<e){var p=n-n%5;e=(i&(1<<p)-1).toString(32),i>>=p,n-=p,fi=1<<32-wa(t)+n|s<<n|i,hi=e+r}else fi=1<<e|s<<n|i,hi=r}function Pg(r){r.return!==null&&(Wo(r,1),J3(r,1,0))}function Og(r){for(;r===Bd;)Bd=Zl[--ec],Zl[ec]=null,$d=Zl[--ec],Zl[ec]=null;for(;r===tl;)tl=ra[--na],ra[na]=null,hi=ra[--na],ra[na]=null,fi=ra[--na],ra[na]=null}var Vs=null,Ms=null,tn=!1,ba=null;function Z3(r,t){var s=aa(5,null,null,0);s.elementType="DELETED",s.stateNode=t,s.return=r,t=r.deletions,t===null?(r.deletions=[s],r.flags|=16):t.push(s)}function e4(r,t){switch(r.tag){case 5:var s=r.type;return t=t.nodeType!==1||s.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(r.stateNode=t,Vs=r,Ms=to(t.firstChild),!0):!1;case 6:return t=r.pendingProps===""||t.nodeType!==3?null:t,t!==null?(r.stateNode=t,Vs=r,Ms=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(s=tl!==null?{id:fi,overflow:hi}:null,r.memoizedState={dehydrated:t,treeContext:s,retryLane:1073741824},s=aa(18,null,null,0),s.stateNode=t,s.return=r,r.child=s,Vs=r,Ms=null,!0):!1;default:return!1}}function xm(r){return(r.mode&1)!==0&&(r.flags&128)===0}function bm(r){if(tn){var t=Ms;if(t){var s=t;if(!e4(r,t)){if(xm(r))throw Error(qe(418));t=to(s.nextSibling);var i=Vs;t&&e4(r,t)?Z3(i,s):(r.flags=r.flags&-4097|2,tn=!1,Vs=r)}}else{if(xm(r))throw Error(qe(418));r.flags=r.flags&-4097|2,tn=!1,Vs=r}}}function t4(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;Vs=r}function ed(r){if(r!==Vs)return!1;if(!tn)return t4(r),tn=!0,!1;var t;if((t=r.tag!==3)&&!(t=r.tag!==5)&&(t=r.type,t=t!=="head"&&t!=="body"&&!mm(r.type,r.memoizedProps)),t&&(t=Ms)){if(xm(r))throw e_(),Error(qe(418));for(;t;)Z3(r,t),t=to(t.nextSibling)}if(t4(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(qe(317));e:{for(r=r.nextSibling,t=0;r;){if(r.nodeType===8){var s=r.data;if(s==="/$"){if(t===0){Ms=to(r.nextSibling);break e}t--}else s!=="$"&&s!=="$!"&&s!=="$?"||t++}r=r.nextSibling}Ms=null}}else Ms=Vs?to(r.stateNode.nextSibling):null;return!0}function e_(){for(var r=Ms;r;)r=to(r.nextSibling)}function pc(){Ms=Vs=null,tn=!1}function jg(r){ba===null?ba=[r]:ba.push(r)}var hk=Si.ReactCurrentBatchConfig;function Tu(r,t,s){if(r=s.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(qe(309));var i=s.stateNode}if(!i)throw Error(qe(147,r));var n=i,e=""+r;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===e?t.ref:(t=function(p){var x=n.refs;p===null?delete x[e]:x[e]=p},t._stringRef=e,t)}if(typeof r!="string")throw Error(qe(284));if(!s._owner)throw Error(qe(290,r))}return r}function td(r,t){throw r=Object.prototype.toString.call(t),Error(qe(31,r==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":r))}function r4(r){var t=r._init;return t(r._payload)}function t_(r){function t(G,U){if(r){var H=G.deletions;H===null?(G.deletions=[U],G.flags|=16):H.push(U)}}function s(G,U){if(!r)return null;for(;U!==null;)t(G,U),U=U.sibling;return null}function i(G,U){for(G=new Map;U!==null;)U.key!==null?G.set(U.key,U):G.set(U.index,U),U=U.sibling;return G}function n(G,U){return G=ao(G,U),G.index=0,G.sibling=null,G}function e(G,U,H){return G.index=H,r?(H=G.alternate,H!==null?(H=H.index,H<U?(G.flags|=2,U):H):(G.flags|=2,U)):(G.flags|=1048576,U)}function p(G){return r&&G.alternate===null&&(G.flags|=2),G}function x(G,U,H,ee){return U===null||U.tag!==6?(U=_1(H,G.mode,ee),U.return=G,U):(U=n(U,H),U.return=G,U)}function w(G,U,H,ee){var te=H.type;return te===ql?N(G,U,H.props.children,ee,H.key):U!==null&&(U.elementType===te||typeof te=="object"&&te!==null&&te.$$typeof===Hi&&r4(te)===U.type)?(ee=n(U,H.props),ee.ref=Tu(G,U,H),ee.return=G,ee):(ee=_d(H.type,H.key,H.props,null,G.mode,ee),ee.ref=Tu(G,U,H),ee.return=G,ee)}function E(G,U,H,ee){return U===null||U.tag!==4||U.stateNode.containerInfo!==H.containerInfo||U.stateNode.implementation!==H.implementation?(U=T1(H,G.mode,ee),U.return=G,U):(U=n(U,H.children||[]),U.return=G,U)}function N(G,U,H,ee,te){return U===null||U.tag!==7?(U=Jo(H,G.mode,ee,te),U.return=G,U):(U=n(U,H),U.return=G,U)}function P(G,U,H){if(typeof U=="string"&&U!==""||typeof U=="number")return U=_1(""+U,G.mode,H),U.return=G,U;if(typeof U=="object"&&U!==null){switch(U.$$typeof){case zh:return H=_d(U.type,U.key,U.props,null,G.mode,H),H.ref=Tu(G,null,U),H.return=G,H;case Gl:return U=T1(U,G.mode,H),U.return=G,U;case Hi:var ee=U._init;return P(G,ee(U._payload),H)}if(Fu(U)||vu(U))return U=Jo(U,G.mode,H,null),U.return=G,U;td(G,U)}return null}function R(G,U,H,ee){var te=U!==null?U.key:null;if(typeof H=="string"&&H!==""||typeof H=="number")return te!==null?null:x(G,U,""+H,ee);if(typeof H=="object"&&H!==null){switch(H.$$typeof){case zh:return H.key===te?w(G,U,H,ee):null;case Gl:return H.key===te?E(G,U,H,ee):null;case Hi:return te=H._init,R(G,U,te(H._payload),ee)}if(Fu(H)||vu(H))return te!==null?null:N(G,U,H,ee,null);td(G,H)}return null}function q(G,U,H,ee,te){if(typeof ee=="string"&&ee!==""||typeof ee=="number")return G=G.get(H)||null,x(U,G,""+ee,te);if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case zh:return G=G.get(ee.key===null?H:ee.key)||null,w(U,G,ee,te);case Gl:return G=G.get(ee.key===null?H:ee.key)||null,E(U,G,ee,te);case Hi:var ue=ee._init;return q(G,U,H,ue(ee._payload),te)}if(Fu(ee)||vu(ee))return G=G.get(H)||null,N(U,G,ee,te,null);td(U,ee)}return null}function Z(G,U,H,ee){for(var te=null,ue=null,L=U,O=U=0,V=null;L!==null&&O<H.length;O++){L.index>O?(V=L,L=null):V=L.sibling;var W=R(G,L,H[O],ee);if(W===null){L===null&&(L=V);break}r&&L&&W.alternate===null&&t(G,L),U=e(W,U,O),ue===null?te=W:ue.sibling=W,ue=W,L=V}if(O===H.length)return s(G,L),tn&&Wo(G,O),te;if(L===null){for(;O<H.length;O++)L=P(G,H[O],ee),L!==null&&(U=e(L,U,O),ue===null?te=L:ue.sibling=L,ue=L);return tn&&Wo(G,O),te}for(L=i(G,L);O<H.length;O++)V=q(L,G,O,H[O],ee),V!==null&&(r&&V.alternate!==null&&L.delete(V.key===null?O:V.key),U=e(V,U,O),ue===null?te=V:ue.sibling=V,ue=V);return r&&L.forEach(function(J){return t(G,J)}),tn&&Wo(G,O),te}function ne(G,U,H,ee){var te=vu(H);if(typeof te!="function")throw Error(qe(150));if(H=te.call(H),H==null)throw Error(qe(151));for(var ue=te=null,L=U,O=U=0,V=null,W=H.next();L!==null&&!W.done;O++,W=H.next()){L.index>O?(V=L,L=null):V=L.sibling;var J=R(G,L,W.value,ee);if(J===null){L===null&&(L=V);break}r&&L&&J.alternate===null&&t(G,L),U=e(J,U,O),ue===null?te=J:ue.sibling=J,ue=J,L=V}if(W.done)return s(G,L),tn&&Wo(G,O),te;if(L===null){for(;!W.done;O++,W=H.next())W=P(G,W.value,ee),W!==null&&(U=e(W,U,O),ue===null?te=W:ue.sibling=W,ue=W);return tn&&Wo(G,O),te}for(L=i(G,L);!W.done;O++,W=H.next())W=q(L,G,O,W.value,ee),W!==null&&(r&&W.alternate!==null&&L.delete(W.key===null?O:W.key),U=e(W,U,O),ue===null?te=W:ue.sibling=W,ue=W);return r&&L.forEach(function(X){return t(G,X)}),tn&&Wo(G,O),te}function fe(G,U,H,ee){if(typeof H=="object"&&H!==null&&H.type===ql&&H.key===null&&(H=H.props.children),typeof H=="object"&&H!==null){switch(H.$$typeof){case zh:e:{for(var te=H.key,ue=U;ue!==null;){if(ue.key===te){if(te=H.type,te===ql){if(ue.tag===7){s(G,ue.sibling),U=n(ue,H.props.children),U.return=G,G=U;break e}}else if(ue.elementType===te||typeof te=="object"&&te!==null&&te.$$typeof===Hi&&r4(te)===ue.type){s(G,ue.sibling),U=n(ue,H.props),U.ref=Tu(G,ue,H),U.return=G,G=U;break e}s(G,ue);break}else t(G,ue);ue=ue.sibling}H.type===ql?(U=Jo(H.props.children,G.mode,ee,H.key),U.return=G,G=U):(ee=_d(H.type,H.key,H.props,null,G.mode,ee),ee.ref=Tu(G,U,H),ee.return=G,G=ee)}return p(G);case Gl:e:{for(ue=H.key;U!==null;){if(U.key===ue)if(U.tag===4&&U.stateNode.containerInfo===H.containerInfo&&U.stateNode.implementation===H.implementation){s(G,U.sibling),U=n(U,H.children||[]),U.return=G,G=U;break e}else{s(G,U);break}else t(G,U);U=U.sibling}U=T1(H,G.mode,ee),U.return=G,G=U}return p(G);case Hi:return ue=H._init,fe(G,U,ue(H._payload),ee)}if(Fu(H))return Z(G,U,H,ee);if(vu(H))return ne(G,U,H,ee);td(G,H)}return typeof H=="string"&&H!==""||typeof H=="number"?(H=""+H,U!==null&&U.tag===6?(s(G,U.sibling),U=n(U,H),U.return=G,G=U):(s(G,U),U=_1(H,G.mode,ee),U.return=G,G=U),p(G)):s(G,U)}return fe}var mc=t_(!0),r_=t_(!1),Wd=go(null),zd=null,tc=null,Mg=null;function Lg(){Mg=tc=zd=null}function Vg(r){var t=Wd.current;Qr(Wd),r._currentValue=t}function wm(r,t,s){for(;r!==null;){var i=r.alternate;if((r.childLanes&t)!==t?(r.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),r===s)break;r=r.return}}function lc(r,t){zd=r,Mg=tc=null,r=r.dependencies,r!==null&&r.firstContext!==null&&(r.lanes&t&&(As=!0),r.firstContext=null)}function oa(r){var t=r._currentValue;if(Mg!==r)if(r={context:r,memoizedValue:t,next:null},tc===null){if(zd===null)throw Error(qe(308));tc=r,zd.dependencies={lanes:0,firstContext:r}}else tc=tc.next=r;return t}var qo=null;function Ug(r){qo===null?qo=[r]:qo.push(r)}function n_(r,t,s,i){var n=t.interleaved;return n===null?(s.next=s,Ug(t)):(s.next=n.next,n.next=s),t.interleaved=s,xi(r,i)}function xi(r,t){r.lanes|=t;var s=r.alternate;for(s!==null&&(s.lanes|=t),s=r,r=r.return;r!==null;)r.childLanes|=t,s=r.alternate,s!==null&&(s.childLanes|=t),s=r,r=r.return;return s.tag===3?s.stateNode:null}var Gi=!1;function Bg(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function s_(r,t){r=r.updateQueue,t.updateQueue===r&&(t.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function pi(r,t){return{eventTime:r,lane:t,tag:0,payload:null,callback:null,next:null}}function ro(r,t,s){var i=r.updateQueue;if(i===null)return null;if(i=i.shared,wr&2){var n=i.pending;return n===null?t.next=t:(t.next=n.next,n.next=t),i.pending=t,xi(r,s)}return n=i.interleaved,n===null?(t.next=t,Ug(i)):(t.next=n.next,n.next=t),i.interleaved=t,xi(r,s)}function gd(r,t,s){if(t=t.updateQueue,t!==null&&(t=t.shared,(s&4194240)!==0)){var i=t.lanes;i&=r.pendingLanes,s|=i,t.lanes=s,Ag(r,s)}}function n4(r,t){var s=r.updateQueue,i=r.alternate;if(i!==null&&(i=i.updateQueue,s===i)){var n=null,e=null;if(s=s.firstBaseUpdate,s!==null){do{var p={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};e===null?n=e=p:e=e.next=p,s=s.next}while(s!==null);e===null?n=e=t:e=e.next=t}else n=e=t;s={baseState:i.baseState,firstBaseUpdate:n,lastBaseUpdate:e,shared:i.shared,effects:i.effects},r.updateQueue=s;return}r=s.lastBaseUpdate,r===null?s.firstBaseUpdate=t:r.next=t,s.lastBaseUpdate=t}function Hd(r,t,s,i){var n=r.updateQueue;Gi=!1;var e=n.firstBaseUpdate,p=n.lastBaseUpdate,x=n.shared.pending;if(x!==null){n.shared.pending=null;var w=x,E=w.next;w.next=null,p===null?e=E:p.next=E,p=w;var N=r.alternate;N!==null&&(N=N.updateQueue,x=N.lastBaseUpdate,x!==p&&(x===null?N.firstBaseUpdate=E:x.next=E,N.lastBaseUpdate=w))}if(e!==null){var P=n.baseState;p=0,N=E=w=null,x=e;do{var R=x.lane,q=x.eventTime;if((i&R)===R){N!==null&&(N=N.next={eventTime:q,lane:0,tag:x.tag,payload:x.payload,callback:x.callback,next:null});e:{var Z=r,ne=x;switch(R=t,q=s,ne.tag){case 1:if(Z=ne.payload,typeof Z=="function"){P=Z.call(q,P,R);break e}P=Z;break e;case 3:Z.flags=Z.flags&-65537|128;case 0:if(Z=ne.payload,R=typeof Z=="function"?Z.call(q,P,R):Z,R==null)break e;P=on({},P,R);break e;case 2:Gi=!0}}x.callback!==null&&x.lane!==0&&(r.flags|=64,R=n.effects,R===null?n.effects=[x]:R.push(x))}else q={eventTime:q,lane:R,tag:x.tag,payload:x.payload,callback:x.callback,next:null},N===null?(E=N=q,w=P):N=N.next=q,p|=R;if(x=x.next,x===null){if(x=n.shared.pending,x===null)break;R=x,x=R.next,R.next=null,n.lastBaseUpdate=R,n.shared.pending=null}}while(!0);if(N===null&&(w=P),n.baseState=w,n.firstBaseUpdate=E,n.lastBaseUpdate=N,t=n.shared.interleaved,t!==null){n=t;do p|=n.lane,n=n.next;while(n!==t)}else e===null&&(n.shared.lanes=0);nl|=p,r.lanes=p,r.memoizedState=P}}function s4(r,t,s){if(r=t.effects,t.effects=null,r!==null)for(t=0;t<r.length;t++){var i=r[t],n=i.callback;if(n!==null){if(i.callback=null,i=s,typeof n!="function")throw Error(qe(191,n));n.call(i)}}}var Nf={},za=go(Nf),of=go(Nf),lf=go(Nf);function Ko(r){if(r===Nf)throw Error(qe(174));return r}function $g(r,t){switch(Hr(lf,t),Hr(of,r),Hr(za,Nf),r=t.nodeType,r){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:tm(null,"");break;default:r=r===8?t.parentNode:t,t=r.namespaceURI||null,r=r.tagName,t=tm(t,r)}Qr(za),Hr(za,t)}function gc(){Qr(za),Qr(of),Qr(lf)}function a_(r){Ko(lf.current);var t=Ko(za.current),s=tm(t,r.type);t!==s&&(Hr(of,r),Hr(za,s))}function Wg(r){of.current===r&&(Qr(za),Qr(of))}var sn=go(0);function Gd(r){for(var t=r;t!==null;){if(t.tag===13){var s=t.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===r)break;for(;t.sibling===null;){if(t.return===null||t.return===r)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var g1=[];function zg(){for(var r=0;r<g1.length;r++)g1[r]._workInProgressVersionPrimary=null;g1.length=0}var yd=Si.ReactCurrentDispatcher,y1=Si.ReactCurrentBatchConfig,rl=0,an=null,Dn=null,Mn=null,qd=!1,Bu=!1,cf=0,dk=0;function rs(){throw Error(qe(321))}function Hg(r,t){if(t===null)return!1;for(var s=0;s<t.length&&s<r.length;s++)if(!Ea(r[s],t[s]))return!1;return!0}function Gg(r,t,s,i,n,e){if(rl=e,an=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,yd.current=r===null||r.memoizedState===null?yk:vk,r=s(i,n),Bu){e=0;do{if(Bu=!1,cf=0,25<=e)throw Error(qe(301));e+=1,Mn=Dn=null,t.updateQueue=null,yd.current=xk,r=s(i,n)}while(Bu)}if(yd.current=Kd,t=Dn!==null&&Dn.next!==null,rl=0,Mn=Dn=an=null,qd=!1,t)throw Error(qe(300));return r}function qg(){var r=cf!==0;return cf=0,r}function Ua(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mn===null?an.memoizedState=Mn=r:Mn=Mn.next=r,Mn}function la(){if(Dn===null){var r=an.alternate;r=r!==null?r.memoizedState:null}else r=Dn.next;var t=Mn===null?an.memoizedState:Mn.next;if(t!==null)Mn=t,Dn=r;else{if(r===null)throw Error(qe(310));Dn=r,r={memoizedState:Dn.memoizedState,baseState:Dn.baseState,baseQueue:Dn.baseQueue,queue:Dn.queue,next:null},Mn===null?an.memoizedState=Mn=r:Mn=Mn.next=r}return Mn}function uf(r,t){return typeof t=="function"?t(r):t}function v1(r){var t=la(),s=t.queue;if(s===null)throw Error(qe(311));s.lastRenderedReducer=r;var i=Dn,n=i.baseQueue,e=s.pending;if(e!==null){if(n!==null){var p=n.next;n.next=e.next,e.next=p}i.baseQueue=n=e,s.pending=null}if(n!==null){e=n.next,i=i.baseState;var x=p=null,w=null,E=e;do{var N=E.lane;if((rl&N)===N)w!==null&&(w=w.next={lane:0,action:E.action,hasEagerState:E.hasEagerState,eagerState:E.eagerState,next:null}),i=E.hasEagerState?E.eagerState:r(i,E.action);else{var P={lane:N,action:E.action,hasEagerState:E.hasEagerState,eagerState:E.eagerState,next:null};w===null?(x=w=P,p=i):w=w.next=P,an.lanes|=N,nl|=N}E=E.next}while(E!==null&&E!==e);w===null?p=i:w.next=x,Ea(i,t.memoizedState)||(As=!0),t.memoizedState=i,t.baseState=p,t.baseQueue=w,s.lastRenderedState=i}if(r=s.interleaved,r!==null){n=r;do e=n.lane,an.lanes|=e,nl|=e,n=n.next;while(n!==r)}else n===null&&(s.lanes=0);return[t.memoizedState,s.dispatch]}function x1(r){var t=la(),s=t.queue;if(s===null)throw Error(qe(311));s.lastRenderedReducer=r;var i=s.dispatch,n=s.pending,e=t.memoizedState;if(n!==null){s.pending=null;var p=n=n.next;do e=r(e,p.action),p=p.next;while(p!==n);Ea(e,t.memoizedState)||(As=!0),t.memoizedState=e,t.baseQueue===null&&(t.baseState=e),s.lastRenderedState=e}return[e,i]}function i_(){}function o_(r,t){var s=an,i=la(),n=t(),e=!Ea(i.memoizedState,n);if(e&&(i.memoizedState=n,As=!0),i=i.queue,Kg(u_.bind(null,s,i,r),[r]),i.getSnapshot!==t||e||Mn!==null&&Mn.memoizedState.tag&1){if(s.flags|=2048,ff(9,c_.bind(null,s,i,n,t),void 0,null),Ln===null)throw Error(qe(349));rl&30||l_(s,t,n)}return n}function l_(r,t,s){r.flags|=16384,r={getSnapshot:t,value:s},t=an.updateQueue,t===null?(t={lastEffect:null,stores:null},an.updateQueue=t,t.stores=[r]):(s=t.stores,s===null?t.stores=[r]:s.push(r))}function c_(r,t,s,i){t.value=s,t.getSnapshot=i,f_(t)&&h_(r)}function u_(r,t,s){return s(function(){f_(t)&&h_(r)})}function f_(r){var t=r.getSnapshot;r=r.value;try{var s=t();return!Ea(r,s)}catch{return!0}}function h_(r){var t=xi(r,1);t!==null&&_a(t,r,1,-1)}function a4(r){var t=Ua();return typeof r=="function"&&(r=r()),t.memoizedState=t.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:uf,lastRenderedState:r},t.queue=r,r=r.dispatch=gk.bind(null,an,r),[t.memoizedState,r]}function ff(r,t,s,i){return r={tag:r,create:t,destroy:s,deps:i,next:null},t=an.updateQueue,t===null?(t={lastEffect:null,stores:null},an.updateQueue=t,t.lastEffect=r.next=r):(s=t.lastEffect,s===null?t.lastEffect=r.next=r:(i=s.next,s.next=r,r.next=i,t.lastEffect=r)),r}function d_(){return la().memoizedState}function vd(r,t,s,i){var n=Ua();an.flags|=r,n.memoizedState=ff(1|t,s,void 0,i===void 0?null:i)}function v0(r,t,s,i){var n=la();i=i===void 0?null:i;var e=void 0;if(Dn!==null){var p=Dn.memoizedState;if(e=p.destroy,i!==null&&Hg(i,p.deps)){n.memoizedState=ff(t,s,e,i);return}}an.flags|=r,n.memoizedState=ff(1|t,s,e,i)}function i4(r,t){return vd(8390656,8,r,t)}function Kg(r,t){return v0(2048,8,r,t)}function p_(r,t){return v0(4,2,r,t)}function m_(r,t){return v0(4,4,r,t)}function g_(r,t){if(typeof t=="function")return r=r(),t(r),function(){t(null)};if(t!=null)return r=r(),t.current=r,function(){t.current=null}}function y_(r,t,s){return s=s!=null?s.concat([r]):null,v0(4,4,g_.bind(null,t,r),s)}function Yg(){}function v_(r,t){var s=la();t=t===void 0?null:t;var i=s.memoizedState;return i!==null&&t!==null&&Hg(t,i[1])?i[0]:(s.memoizedState=[r,t],r)}function x_(r,t){var s=la();t=t===void 0?null:t;var i=s.memoizedState;return i!==null&&t!==null&&Hg(t,i[1])?i[0]:(r=r(),s.memoizedState=[r,t],r)}function b_(r,t,s){return rl&21?(Ea(s,t)||(s=S3(),an.lanes|=s,nl|=s,r.baseState=!0),t):(r.baseState&&(r.baseState=!1,As=!0),r.memoizedState=s)}function pk(r,t){var s=Mr;Mr=s!==0&&4>s?s:4,r(!0);var i=y1.transition;y1.transition={};try{r(!1),t()}finally{Mr=s,y1.transition=i}}function w_(){return la().memoizedState}function mk(r,t,s){var i=so(r);if(s={lane:i,action:s,hasEagerState:!1,eagerState:null,next:null},__(r))T_(t,s);else if(s=n_(r,t,s,i),s!==null){var n=gs();_a(s,r,i,n),E_(s,t,i)}}function gk(r,t,s){var i=so(r),n={lane:i,action:s,hasEagerState:!1,eagerState:null,next:null};if(__(r))T_(t,n);else{var e=r.alternate;if(r.lanes===0&&(e===null||e.lanes===0)&&(e=t.lastRenderedReducer,e!==null))try{var p=t.lastRenderedState,x=e(p,s);if(n.hasEagerState=!0,n.eagerState=x,Ea(x,p)){var w=t.interleaved;w===null?(n.next=n,Ug(t)):(n.next=w.next,w.next=n),t.interleaved=n;return}}catch{}finally{}s=n_(r,t,n,i),s!==null&&(n=gs(),_a(s,r,i,n),E_(s,t,i))}}function __(r){var t=r.alternate;return r===an||t!==null&&t===an}function T_(r,t){Bu=qd=!0;var s=r.pending;s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t}function E_(r,t,s){if(s&4194240){var i=t.lanes;i&=r.pendingLanes,s|=i,t.lanes=s,Ag(r,s)}}var Kd={readContext:oa,useCallback:rs,useContext:rs,useEffect:rs,useImperativeHandle:rs,useInsertionEffect:rs,useLayoutEffect:rs,useMemo:rs,useReducer:rs,useRef:rs,useState:rs,useDebugValue:rs,useDeferredValue:rs,useTransition:rs,useMutableSource:rs,useSyncExternalStore:rs,useId:rs,unstable_isNewReconciler:!1},yk={readContext:oa,useCallback:function(r,t){return Ua().memoizedState=[r,t===void 0?null:t],r},useContext:oa,useEffect:i4,useImperativeHandle:function(r,t,s){return s=s!=null?s.concat([r]):null,vd(4194308,4,g_.bind(null,t,r),s)},useLayoutEffect:function(r,t){return vd(4194308,4,r,t)},useInsertionEffect:function(r,t){return vd(4,2,r,t)},useMemo:function(r,t){var s=Ua();return t=t===void 0?null:t,r=r(),s.memoizedState=[r,t],r},useReducer:function(r,t,s){var i=Ua();return t=s!==void 0?s(t):t,i.memoizedState=i.baseState=t,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:t},i.queue=r,r=r.dispatch=mk.bind(null,an,r),[i.memoizedState,r]},useRef:function(r){var t=Ua();return r={current:r},t.memoizedState=r},useState:a4,useDebugValue:Yg,useDeferredValue:function(r){return Ua().memoizedState=r},useTransition:function(){var r=a4(!1),t=r[0];return r=pk.bind(null,r[1]),Ua().memoizedState=r,[t,r]},useMutableSource:function(){},useSyncExternalStore:function(r,t,s){var i=an,n=Ua();if(tn){if(s===void 0)throw Error(qe(407));s=s()}else{if(s=t(),Ln===null)throw Error(qe(349));rl&30||l_(i,t,s)}n.memoizedState=s;var e={value:s,getSnapshot:t};return n.queue=e,i4(u_.bind(null,i,e,r),[r]),i.flags|=2048,ff(9,c_.bind(null,i,e,s,t),void 0,null),s},useId:function(){var r=Ua(),t=Ln.identifierPrefix;if(tn){var s=hi,i=fi;s=(i&~(1<<32-wa(i)-1)).toString(32)+s,t=":"+t+"R"+s,s=cf++,0<s&&(t+="H"+s.toString(32)),t+=":"}else s=dk++,t=":"+t+"r"+s.toString(32)+":";return r.memoizedState=t},unstable_isNewReconciler:!1},vk={readContext:oa,useCallback:v_,useContext:oa,useEffect:Kg,useImperativeHandle:y_,useInsertionEffect:p_,useLayoutEffect:m_,useMemo:x_,useReducer:v1,useRef:d_,useState:function(){return v1(uf)},useDebugValue:Yg,useDeferredValue:function(r){var t=la();return b_(t,Dn.memoizedState,r)},useTransition:function(){var r=v1(uf)[0],t=la().memoizedState;return[r,t]},useMutableSource:i_,useSyncExternalStore:o_,useId:w_,unstable_isNewReconciler:!1},xk={readContext:oa,useCallback:v_,useContext:oa,useEffect:Kg,useImperativeHandle:y_,useInsertionEffect:p_,useLayoutEffect:m_,useMemo:x_,useReducer:x1,useRef:d_,useState:function(){return x1(uf)},useDebugValue:Yg,useDeferredValue:function(r){var t=la();return Dn===null?t.memoizedState=r:b_(t,Dn.memoizedState,r)},useTransition:function(){var r=x1(uf)[0],t=la().memoizedState;return[r,t]},useMutableSource:i_,useSyncExternalStore:o_,useId:w_,unstable_isNewReconciler:!1};function va(r,t){if(r&&r.defaultProps){t=on({},t),r=r.defaultProps;for(var s in r)t[s]===void 0&&(t[s]=r[s]);return t}return t}function _m(r,t,s,i){t=r.memoizedState,s=s(i,t),s=s==null?t:on({},t,s),r.memoizedState=s,r.lanes===0&&(r.updateQueue.baseState=s)}var x0={isMounted:function(r){return(r=r._reactInternals)?dl(r)===r:!1},enqueueSetState:function(r,t,s){r=r._reactInternals;var i=gs(),n=so(r),e=pi(i,n);e.payload=t,s!=null&&(e.callback=s),t=ro(r,e,n),t!==null&&(_a(t,r,n,i),gd(t,r,n))},enqueueReplaceState:function(r,t,s){r=r._reactInternals;var i=gs(),n=so(r),e=pi(i,n);e.tag=1,e.payload=t,s!=null&&(e.callback=s),t=ro(r,e,n),t!==null&&(_a(t,r,n,i),gd(t,r,n))},enqueueForceUpdate:function(r,t){r=r._reactInternals;var s=gs(),i=so(r),n=pi(s,i);n.tag=2,t!=null&&(n.callback=t),t=ro(r,n,i),t!==null&&(_a(t,r,i,s),gd(t,r,i))}};function o4(r,t,s,i,n,e,p){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(i,e,p):t.prototype&&t.prototype.isPureReactComponent?!rf(s,i)||!rf(n,e):!0}function S_(r,t,s){var i=!1,n=co,e=t.contextType;return typeof e=="object"&&e!==null?e=oa(e):(n=ks(t)?el:cs.current,i=t.contextTypes,e=(i=i!=null)?dc(r,n):co),t=new t(s,e),r.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=x0,r.stateNode=t,t._reactInternals=r,i&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=n,r.__reactInternalMemoizedMaskedChildContext=e),t}function l4(r,t,s,i){r=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(s,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(s,i),t.state!==r&&x0.enqueueReplaceState(t,t.state,null)}function Tm(r,t,s,i){var n=r.stateNode;n.props=s,n.state=r.memoizedState,n.refs={},Bg(r);var e=t.contextType;typeof e=="object"&&e!==null?n.context=oa(e):(e=ks(t)?el:cs.current,n.context=dc(r,e)),n.state=r.memoizedState,e=t.getDerivedStateFromProps,typeof e=="function"&&(_m(r,t,e,s),n.state=r.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(t=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),t!==n.state&&x0.enqueueReplaceState(n,n.state,null),Hd(r,s,n,i),n.state=r.memoizedState),typeof n.componentDidMount=="function"&&(r.flags|=4194308)}function yc(r,t){try{var s="",i=t;do s+=qA(i),i=i.return;while(i);var n=s}catch(e){n=`
Error generating stack: `+e.message+`
`+e.stack}return{value:r,source:t,stack:n,digest:null}}function b1(r,t,s){return{value:r,source:null,stack:s??null,digest:t??null}}function Em(r,t){try{console.error(t.value)}catch(s){setTimeout(function(){throw s})}}var bk=typeof WeakMap=="function"?WeakMap:Map;function A_(r,t,s){s=pi(-1,s),s.tag=3,s.payload={element:null};var i=t.value;return s.callback=function(){Qd||(Qd=!0,Pm=i),Em(r,t)},s}function C_(r,t,s){s=pi(-1,s),s.tag=3;var i=r.type.getDerivedStateFromError;if(typeof i=="function"){var n=t.value;s.payload=function(){return i(n)},s.callback=function(){Em(r,t)}}var e=r.stateNode;return e!==null&&typeof e.componentDidCatch=="function"&&(s.callback=function(){Em(r,t),typeof i!="function"&&(no===null?no=new Set([this]):no.add(this));var p=t.stack;this.componentDidCatch(t.value,{componentStack:p!==null?p:""})}),s}function c4(r,t,s){var i=r.pingCache;if(i===null){i=r.pingCache=new bk;var n=new Set;i.set(t,n)}else n=i.get(t),n===void 0&&(n=new Set,i.set(t,n));n.has(s)||(n.add(s),r=Pk.bind(null,r,t,s),t.then(r,r))}function u4(r){do{var t;if((t=r.tag===13)&&(t=r.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return r;r=r.return}while(r!==null);return null}function f4(r,t,s,i,n){return r.mode&1?(r.flags|=65536,r.lanes=n,r):(r===t?r.flags|=65536:(r.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(t=pi(-1,1),t.tag=2,ro(s,t,1))),s.lanes|=1),r)}var wk=Si.ReactCurrentOwner,As=!1;function ms(r,t,s,i){t.child=r===null?r_(t,null,s,i):mc(t,r.child,s,i)}function h4(r,t,s,i,n){s=s.render;var e=t.ref;return lc(t,n),i=Gg(r,t,s,i,e,n),s=qg(),r!==null&&!As?(t.updateQueue=r.updateQueue,t.flags&=-2053,r.lanes&=~n,bi(r,t,n)):(tn&&s&&Pg(t),t.flags|=1,ms(r,t,i,n),t.child)}function d4(r,t,s,i,n){if(r===null){var e=s.type;return typeof e=="function"&&!n2(e)&&e.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(t.tag=15,t.type=e,k_(r,t,e,i,n)):(r=_d(s.type,null,i,t,t.mode,n),r.ref=t.ref,r.return=t,t.child=r)}if(e=r.child,!(r.lanes&n)){var p=e.memoizedProps;if(s=s.compare,s=s!==null?s:rf,s(p,i)&&r.ref===t.ref)return bi(r,t,n)}return t.flags|=1,r=ao(e,i),r.ref=t.ref,r.return=t,t.child=r}function k_(r,t,s,i,n){if(r!==null){var e=r.memoizedProps;if(rf(e,i)&&r.ref===t.ref)if(As=!1,t.pendingProps=i=e,(r.lanes&n)!==0)r.flags&131072&&(As=!0);else return t.lanes=r.lanes,bi(r,t,n)}return Sm(r,t,s,i,n)}function F_(r,t,s){var i=t.pendingProps,n=i.children,e=r!==null?r.memoizedState:null;if(i.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Hr(nc,js),js|=s;else{if(!(s&1073741824))return r=e!==null?e.baseLanes|s:s,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:r,cachePool:null,transitions:null},t.updateQueue=null,Hr(nc,js),js|=r,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=e!==null?e.baseLanes:s,Hr(nc,js),js|=i}else e!==null?(i=e.baseLanes|s,t.memoizedState=null):i=s,Hr(nc,js),js|=i;return ms(r,t,n,s),t.child}function N_(r,t){var s=t.ref;(r===null&&s!==null||r!==null&&r.ref!==s)&&(t.flags|=512,t.flags|=2097152)}function Sm(r,t,s,i,n){var e=ks(s)?el:cs.current;return e=dc(t,e),lc(t,n),s=Gg(r,t,s,i,e,n),i=qg(),r!==null&&!As?(t.updateQueue=r.updateQueue,t.flags&=-2053,r.lanes&=~n,bi(r,t,n)):(tn&&i&&Pg(t),t.flags|=1,ms(r,t,s,n),t.child)}function p4(r,t,s,i,n){if(ks(s)){var e=!0;Ud(t)}else e=!1;if(lc(t,n),t.stateNode===null)xd(r,t),S_(t,s,i),Tm(t,s,i,n),i=!0;else if(r===null){var p=t.stateNode,x=t.memoizedProps;p.props=x;var w=p.context,E=s.contextType;typeof E=="object"&&E!==null?E=oa(E):(E=ks(s)?el:cs.current,E=dc(t,E));var N=s.getDerivedStateFromProps,P=typeof N=="function"||typeof p.getSnapshotBeforeUpdate=="function";P||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(x!==i||w!==E)&&l4(t,p,i,E),Gi=!1;var R=t.memoizedState;p.state=R,Hd(t,i,p,n),w=t.memoizedState,x!==i||R!==w||Cs.current||Gi?(typeof N=="function"&&(_m(t,s,N,i),w=t.memoizedState),(x=Gi||o4(t,s,x,i,R,w,E))?(P||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(t.flags|=4194308)):(typeof p.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=w),p.props=i,p.state=w,p.context=E,i=x):(typeof p.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{p=t.stateNode,s_(r,t),x=t.memoizedProps,E=t.type===t.elementType?x:va(t.type,x),p.props=E,P=t.pendingProps,R=p.context,w=s.contextType,typeof w=="object"&&w!==null?w=oa(w):(w=ks(s)?el:cs.current,w=dc(t,w));var q=s.getDerivedStateFromProps;(N=typeof q=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(x!==P||R!==w)&&l4(t,p,i,w),Gi=!1,R=t.memoizedState,p.state=R,Hd(t,i,p,n);var Z=t.memoizedState;x!==P||R!==Z||Cs.current||Gi?(typeof q=="function"&&(_m(t,s,q,i),Z=t.memoizedState),(E=Gi||o4(t,s,E,i,R,Z,w)||!1)?(N||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(i,Z,w),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(i,Z,w)),typeof p.componentDidUpdate=="function"&&(t.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof p.componentDidUpdate!="function"||x===r.memoizedProps&&R===r.memoizedState||(t.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||x===r.memoizedProps&&R===r.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=Z),p.props=i,p.state=Z,p.context=w,i=E):(typeof p.componentDidUpdate!="function"||x===r.memoizedProps&&R===r.memoizedState||(t.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||x===r.memoizedProps&&R===r.memoizedState||(t.flags|=1024),i=!1)}return Am(r,t,s,i,e,n)}function Am(r,t,s,i,n,e){N_(r,t);var p=(t.flags&128)!==0;if(!i&&!p)return n&&Zb(t,s,!1),bi(r,t,e);i=t.stateNode,wk.current=t;var x=p&&typeof s.getDerivedStateFromError!="function"?null:i.render();return t.flags|=1,r!==null&&p?(t.child=mc(t,r.child,null,e),t.child=mc(t,null,x,e)):ms(r,t,x,e),t.memoizedState=i.state,n&&Zb(t,s,!0),t.child}function I_(r){var t=r.stateNode;t.pendingContext?Jb(r,t.pendingContext,t.pendingContext!==t.context):t.context&&Jb(r,t.context,!1),$g(r,t.containerInfo)}function m4(r,t,s,i,n){return pc(),jg(n),t.flags|=256,ms(r,t,s,i),t.child}var Cm={dehydrated:null,treeContext:null,retryLane:0};function km(r){return{baseLanes:r,cachePool:null,transitions:null}}function D_(r,t,s){var i=t.pendingProps,n=sn.current,e=!1,p=(t.flags&128)!==0,x;if((x=p)||(x=r!==null&&r.memoizedState===null?!1:(n&2)!==0),x?(e=!0,t.flags&=-129):(r===null||r.memoizedState!==null)&&(n|=1),Hr(sn,n&1),r===null)return bm(t),r=t.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?(t.mode&1?r.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(p=i.children,r=i.fallback,e?(i=t.mode,e=t.child,p={mode:"hidden",children:p},!(i&1)&&e!==null?(e.childLanes=0,e.pendingProps=p):e=_0(p,i,0,null),r=Jo(r,i,s,null),e.return=t,r.return=t,e.sibling=r,t.child=e,t.child.memoizedState=km(s),t.memoizedState=Cm,r):Qg(t,p));if(n=r.memoizedState,n!==null&&(x=n.dehydrated,x!==null))return _k(r,t,p,i,x,n,s);if(e){e=i.fallback,p=t.mode,n=r.child,x=n.sibling;var w={mode:"hidden",children:i.children};return!(p&1)&&t.child!==n?(i=t.child,i.childLanes=0,i.pendingProps=w,t.deletions=null):(i=ao(n,w),i.subtreeFlags=n.subtreeFlags&14680064),x!==null?e=ao(x,e):(e=Jo(e,p,s,null),e.flags|=2),e.return=t,i.return=t,i.sibling=e,t.child=i,i=e,e=t.child,p=r.child.memoizedState,p=p===null?km(s):{baseLanes:p.baseLanes|s,cachePool:null,transitions:p.transitions},e.memoizedState=p,e.childLanes=r.childLanes&~s,t.memoizedState=Cm,i}return e=r.child,r=e.sibling,i=ao(e,{mode:"visible",children:i.children}),!(t.mode&1)&&(i.lanes=s),i.return=t,i.sibling=null,r!==null&&(s=t.deletions,s===null?(t.deletions=[r],t.flags|=16):s.push(r)),t.child=i,t.memoizedState=null,i}function Qg(r,t){return t=_0({mode:"visible",children:t},r.mode,0,null),t.return=r,r.child=t}function rd(r,t,s,i){return i!==null&&jg(i),mc(t,r.child,null,s),r=Qg(t,t.pendingProps.children),r.flags|=2,t.memoizedState=null,r}function _k(r,t,s,i,n,e,p){if(s)return t.flags&256?(t.flags&=-257,i=b1(Error(qe(422))),rd(r,t,p,i)):t.memoizedState!==null?(t.child=r.child,t.flags|=128,null):(e=i.fallback,n=t.mode,i=_0({mode:"visible",children:i.children},n,0,null),e=Jo(e,n,p,null),e.flags|=2,i.return=t,e.return=t,i.sibling=e,t.child=i,t.mode&1&&mc(t,r.child,null,p),t.child.memoizedState=km(p),t.memoizedState=Cm,e);if(!(t.mode&1))return rd(r,t,p,null);if(n.data==="$!"){if(i=n.nextSibling&&n.nextSibling.dataset,i)var x=i.dgst;return i=x,e=Error(qe(419)),i=b1(e,i,void 0),rd(r,t,p,i)}if(x=(p&r.childLanes)!==0,As||x){if(i=Ln,i!==null){switch(p&-p){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(i.suspendedLanes|p)?0:n,n!==0&&n!==e.retryLane&&(e.retryLane=n,xi(r,n),_a(i,r,n,-1))}return r2(),i=b1(Error(qe(421))),rd(r,t,p,i)}return n.data==="$?"?(t.flags|=128,t.child=r.child,t=Ok.bind(null,r),n._reactRetry=t,null):(r=e.treeContext,Ms=to(n.nextSibling),Vs=t,tn=!0,ba=null,r!==null&&(ra[na++]=fi,ra[na++]=hi,ra[na++]=tl,fi=r.id,hi=r.overflow,tl=t),t=Qg(t,i.children),t.flags|=4096,t)}function g4(r,t,s){r.lanes|=t;var i=r.alternate;i!==null&&(i.lanes|=t),wm(r.return,t,s)}function w1(r,t,s,i,n){var e=r.memoizedState;e===null?r.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:s,tailMode:n}:(e.isBackwards=t,e.rendering=null,e.renderingStartTime=0,e.last=i,e.tail=s,e.tailMode=n)}function R_(r,t,s){var i=t.pendingProps,n=i.revealOrder,e=i.tail;if(ms(r,t,i.children,s),i=sn.current,i&2)i=i&1|2,t.flags|=128;else{if(r!==null&&r.flags&128)e:for(r=t.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&g4(r,s,t);else if(r.tag===19)g4(r,s,t);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break e;for(;r.sibling===null;){if(r.return===null||r.return===t)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}i&=1}if(Hr(sn,i),!(t.mode&1))t.memoizedState=null;else switch(n){case"forwards":for(s=t.child,n=null;s!==null;)r=s.alternate,r!==null&&Gd(r)===null&&(n=s),s=s.sibling;s=n,s===null?(n=t.child,t.child=null):(n=s.sibling,s.sibling=null),w1(t,!1,n,s,e);break;case"backwards":for(s=null,n=t.child,t.child=null;n!==null;){if(r=n.alternate,r!==null&&Gd(r)===null){t.child=n;break}r=n.sibling,n.sibling=s,s=n,n=r}w1(t,!0,s,null,e);break;case"together":w1(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function xd(r,t){!(t.mode&1)&&r!==null&&(r.alternate=null,t.alternate=null,t.flags|=2)}function bi(r,t,s){if(r!==null&&(t.dependencies=r.dependencies),nl|=t.lanes,!(s&t.childLanes))return null;if(r!==null&&t.child!==r.child)throw Error(qe(153));if(t.child!==null){for(r=t.child,s=ao(r,r.pendingProps),t.child=s,s.return=t;r.sibling!==null;)r=r.sibling,s=s.sibling=ao(r,r.pendingProps),s.return=t;s.sibling=null}return t.child}function Tk(r,t,s){switch(t.tag){case 3:I_(t),pc();break;case 5:a_(t);break;case 1:ks(t.type)&&Ud(t);break;case 4:$g(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,n=t.memoizedProps.value;Hr(Wd,i._currentValue),i._currentValue=n;break;case 13:if(i=t.memoizedState,i!==null)return i.dehydrated!==null?(Hr(sn,sn.current&1),t.flags|=128,null):s&t.child.childLanes?D_(r,t,s):(Hr(sn,sn.current&1),r=bi(r,t,s),r!==null?r.sibling:null);Hr(sn,sn.current&1);break;case 19:if(i=(s&t.childLanes)!==0,r.flags&128){if(i)return R_(r,t,s);t.flags|=128}if(n=t.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),Hr(sn,sn.current),i)break;return null;case 22:case 23:return t.lanes=0,F_(r,t,s)}return bi(r,t,s)}var P_,Fm,O_,j_;P_=function(r,t){for(var s=t.child;s!==null;){if(s.tag===5||s.tag===6)r.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};Fm=function(){};O_=function(r,t,s,i){var n=r.memoizedProps;if(n!==i){r=t.stateNode,Ko(za.current);var e=null;switch(s){case"input":n=X1(r,n),i=X1(r,i),e=[];break;case"select":n=on({},n,{value:void 0}),i=on({},i,{value:void 0}),e=[];break;case"textarea":n=em(r,n),i=em(r,i),e=[];break;default:typeof n.onClick!="function"&&typeof i.onClick=="function"&&(r.onclick=Ld)}rm(s,i);var p;s=null;for(E in n)if(!i.hasOwnProperty(E)&&n.hasOwnProperty(E)&&n[E]!=null)if(E==="style"){var x=n[E];for(p in x)x.hasOwnProperty(p)&&(s||(s={}),s[p]="")}else E!=="dangerouslySetInnerHTML"&&E!=="children"&&E!=="suppressContentEditableWarning"&&E!=="suppressHydrationWarning"&&E!=="autoFocus"&&(Yu.hasOwnProperty(E)?e||(e=[]):(e=e||[]).push(E,null));for(E in i){var w=i[E];if(x=n!=null?n[E]:void 0,i.hasOwnProperty(E)&&w!==x&&(w!=null||x!=null))if(E==="style")if(x){for(p in x)!x.hasOwnProperty(p)||w&&w.hasOwnProperty(p)||(s||(s={}),s[p]="");for(p in w)w.hasOwnProperty(p)&&x[p]!==w[p]&&(s||(s={}),s[p]=w[p])}else s||(e||(e=[]),e.push(E,s)),s=w;else E==="dangerouslySetInnerHTML"?(w=w?w.__html:void 0,x=x?x.__html:void 0,w!=null&&x!==w&&(e=e||[]).push(E,w)):E==="children"?typeof w!="string"&&typeof w!="number"||(e=e||[]).push(E,""+w):E!=="suppressContentEditableWarning"&&E!=="suppressHydrationWarning"&&(Yu.hasOwnProperty(E)?(w!=null&&E==="onScroll"&&Kr("scroll",r),e||x===w||(e=[])):(e=e||[]).push(E,w))}s&&(e=e||[]).push("style",s);var E=e;(t.updateQueue=E)&&(t.flags|=4)}};j_=function(r,t,s,i){s!==i&&(t.flags|=4)};function Eu(r,t){if(!tn)switch(r.tailMode){case"hidden":t=r.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?r.tail=null:s.sibling=null;break;case"collapsed":s=r.tail;for(var i=null;s!==null;)s.alternate!==null&&(i=s),s=s.sibling;i===null?t||r.tail===null?r.tail=null:r.tail.sibling=null:i.sibling=null}}function ns(r){var t=r.alternate!==null&&r.alternate.child===r.child,s=0,i=0;if(t)for(var n=r.child;n!==null;)s|=n.lanes|n.childLanes,i|=n.subtreeFlags&14680064,i|=n.flags&14680064,n.return=r,n=n.sibling;else for(n=r.child;n!==null;)s|=n.lanes|n.childLanes,i|=n.subtreeFlags,i|=n.flags,n.return=r,n=n.sibling;return r.subtreeFlags|=i,r.childLanes=s,t}function Ek(r,t,s){var i=t.pendingProps;switch(Og(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ns(t),null;case 1:return ks(t.type)&&Vd(),ns(t),null;case 3:return i=t.stateNode,gc(),Qr(Cs),Qr(cs),zg(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(r===null||r.child===null)&&(ed(t)?t.flags|=4:r===null||r.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ba!==null&&(Mm(ba),ba=null))),Fm(r,t),ns(t),null;case 5:Wg(t);var n=Ko(lf.current);if(s=t.type,r!==null&&t.stateNode!=null)O_(r,t,s,i,n),r.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(t.stateNode===null)throw Error(qe(166));return ns(t),null}if(r=Ko(za.current),ed(t)){i=t.stateNode,s=t.type;var e=t.memoizedProps;switch(i[$a]=t,i[af]=e,r=(t.mode&1)!==0,s){case"dialog":Kr("cancel",i),Kr("close",i);break;case"iframe":case"object":case"embed":Kr("load",i);break;case"video":case"audio":for(n=0;n<Iu.length;n++)Kr(Iu[n],i);break;case"source":Kr("error",i);break;case"img":case"image":case"link":Kr("error",i),Kr("load",i);break;case"details":Kr("toggle",i);break;case"input":Sb(i,e),Kr("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!e.multiple},Kr("invalid",i);break;case"textarea":Cb(i,e),Kr("invalid",i)}rm(s,e),n=null;for(var p in e)if(e.hasOwnProperty(p)){var x=e[p];p==="children"?typeof x=="string"?i.textContent!==x&&(e.suppressHydrationWarning!==!0&&Zh(i.textContent,x,r),n=["children",x]):typeof x=="number"&&i.textContent!==""+x&&(e.suppressHydrationWarning!==!0&&Zh(i.textContent,x,r),n=["children",""+x]):Yu.hasOwnProperty(p)&&x!=null&&p==="onScroll"&&Kr("scroll",i)}switch(s){case"input":Hh(i),Ab(i,e,!0);break;case"textarea":Hh(i),kb(i);break;case"select":case"option":break;default:typeof e.onClick=="function"&&(i.onclick=Ld)}i=n,t.updateQueue=i,i!==null&&(t.flags|=4)}else{p=n.nodeType===9?n:n.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=u3(s)),r==="http://www.w3.org/1999/xhtml"?s==="script"?(r=p.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof i.is=="string"?r=p.createElement(s,{is:i.is}):(r=p.createElement(s),s==="select"&&(p=r,i.multiple?p.multiple=!0:i.size&&(p.size=i.size))):r=p.createElementNS(r,s),r[$a]=t,r[af]=i,P_(r,t,!1,!1),t.stateNode=r;e:{switch(p=nm(s,i),s){case"dialog":Kr("cancel",r),Kr("close",r),n=i;break;case"iframe":case"object":case"embed":Kr("load",r),n=i;break;case"video":case"audio":for(n=0;n<Iu.length;n++)Kr(Iu[n],r);n=i;break;case"source":Kr("error",r),n=i;break;case"img":case"image":case"link":Kr("error",r),Kr("load",r),n=i;break;case"details":Kr("toggle",r),n=i;break;case"input":Sb(r,i),n=X1(r,i),Kr("invalid",r);break;case"option":n=i;break;case"select":r._wrapperState={wasMultiple:!!i.multiple},n=on({},i,{value:void 0}),Kr("invalid",r);break;case"textarea":Cb(r,i),n=em(r,i),Kr("invalid",r);break;default:n=i}rm(s,n),x=n;for(e in x)if(x.hasOwnProperty(e)){var w=x[e];e==="style"?d3(r,w):e==="dangerouslySetInnerHTML"?(w=w?w.__html:void 0,w!=null&&f3(r,w)):e==="children"?typeof w=="string"?(s!=="textarea"||w!=="")&&Qu(r,w):typeof w=="number"&&Qu(r,""+w):e!=="suppressContentEditableWarning"&&e!=="suppressHydrationWarning"&&e!=="autoFocus"&&(Yu.hasOwnProperty(e)?w!=null&&e==="onScroll"&&Kr("scroll",r):w!=null&&bg(r,e,w,p))}switch(s){case"input":Hh(r),Ab(r,i,!1);break;case"textarea":Hh(r),kb(r);break;case"option":i.value!=null&&r.setAttribute("value",""+lo(i.value));break;case"select":r.multiple=!!i.multiple,e=i.value,e!=null?sc(r,!!i.multiple,e,!1):i.defaultValue!=null&&sc(r,!!i.multiple,i.defaultValue,!0);break;default:typeof n.onClick=="function"&&(r.onclick=Ld)}switch(s){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ns(t),null;case 6:if(r&&t.stateNode!=null)j_(r,t,r.memoizedProps,i);else{if(typeof i!="string"&&t.stateNode===null)throw Error(qe(166));if(s=Ko(lf.current),Ko(za.current),ed(t)){if(i=t.stateNode,s=t.memoizedProps,i[$a]=t,(e=i.nodeValue!==s)&&(r=Vs,r!==null))switch(r.tag){case 3:Zh(i.nodeValue,s,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&Zh(i.nodeValue,s,(r.mode&1)!==0)}e&&(t.flags|=4)}else i=(s.nodeType===9?s:s.ownerDocument).createTextNode(i),i[$a]=t,t.stateNode=i}return ns(t),null;case 13:if(Qr(sn),i=t.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(tn&&Ms!==null&&t.mode&1&&!(t.flags&128))e_(),pc(),t.flags|=98560,e=!1;else if(e=ed(t),i!==null&&i.dehydrated!==null){if(r===null){if(!e)throw Error(qe(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(qe(317));e[$a]=t}else pc(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ns(t),e=!1}else ba!==null&&(Mm(ba),ba=null),e=!0;if(!e)return t.flags&65536?t:null}return t.flags&128?(t.lanes=s,t):(i=i!==null,i!==(r!==null&&r.memoizedState!==null)&&i&&(t.child.flags|=8192,t.mode&1&&(r===null||sn.current&1?Rn===0&&(Rn=3):r2())),t.updateQueue!==null&&(t.flags|=4),ns(t),null);case 4:return gc(),Fm(r,t),r===null&&nf(t.stateNode.containerInfo),ns(t),null;case 10:return Vg(t.type._context),ns(t),null;case 17:return ks(t.type)&&Vd(),ns(t),null;case 19:if(Qr(sn),e=t.memoizedState,e===null)return ns(t),null;if(i=(t.flags&128)!==0,p=e.rendering,p===null)if(i)Eu(e,!1);else{if(Rn!==0||r!==null&&r.flags&128)for(r=t.child;r!==null;){if(p=Gd(r),p!==null){for(t.flags|=128,Eu(e,!1),i=p.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=s,s=t.child;s!==null;)e=s,r=i,e.flags&=14680066,p=e.alternate,p===null?(e.childLanes=0,e.lanes=r,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=p.childLanes,e.lanes=p.lanes,e.child=p.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=p.memoizedProps,e.memoizedState=p.memoizedState,e.updateQueue=p.updateQueue,e.type=p.type,r=p.dependencies,e.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),s=s.sibling;return Hr(sn,sn.current&1|2),t.child}r=r.sibling}e.tail!==null&&gn()>vc&&(t.flags|=128,i=!0,Eu(e,!1),t.lanes=4194304)}else{if(!i)if(r=Gd(p),r!==null){if(t.flags|=128,i=!0,s=r.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),Eu(e,!0),e.tail===null&&e.tailMode==="hidden"&&!p.alternate&&!tn)return ns(t),null}else 2*gn()-e.renderingStartTime>vc&&s!==1073741824&&(t.flags|=128,i=!0,Eu(e,!1),t.lanes=4194304);e.isBackwards?(p.sibling=t.child,t.child=p):(s=e.last,s!==null?s.sibling=p:t.child=p,e.last=p)}return e.tail!==null?(t=e.tail,e.rendering=t,e.tail=t.sibling,e.renderingStartTime=gn(),t.sibling=null,s=sn.current,Hr(sn,i?s&1|2:s&1),t):(ns(t),null);case 22:case 23:return t2(),i=t.memoizedState!==null,r!==null&&r.memoizedState!==null!==i&&(t.flags|=8192),i&&t.mode&1?js&1073741824&&(ns(t),t.subtreeFlags&6&&(t.flags|=8192)):ns(t),null;case 24:return null;case 25:return null}throw Error(qe(156,t.tag))}function Sk(r,t){switch(Og(t),t.tag){case 1:return ks(t.type)&&Vd(),r=t.flags,r&65536?(t.flags=r&-65537|128,t):null;case 3:return gc(),Qr(Cs),Qr(cs),zg(),r=t.flags,r&65536&&!(r&128)?(t.flags=r&-65537|128,t):null;case 5:return Wg(t),null;case 13:if(Qr(sn),r=t.memoizedState,r!==null&&r.dehydrated!==null){if(t.alternate===null)throw Error(qe(340));pc()}return r=t.flags,r&65536?(t.flags=r&-65537|128,t):null;case 19:return Qr(sn),null;case 4:return gc(),null;case 10:return Vg(t.type._context),null;case 22:case 23:return t2(),null;case 24:return null;default:return null}}var nd=!1,is=!1,Ak=typeof WeakSet=="function"?WeakSet:Set,bt=null;function rc(r,t){var s=r.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(i){fn(r,t,i)}else s.current=null}function Nm(r,t,s){try{s()}catch(i){fn(r,t,i)}}var y4=!1;function Ck(r,t){if(dm=Od,r=B3(),Rg(r)){if("selectionStart"in r)var s={start:r.selectionStart,end:r.selectionEnd};else e:{s=(s=r.ownerDocument)&&s.defaultView||window;var i=s.getSelection&&s.getSelection();if(i&&i.rangeCount!==0){s=i.anchorNode;var n=i.anchorOffset,e=i.focusNode;i=i.focusOffset;try{s.nodeType,e.nodeType}catch{s=null;break e}var p=0,x=-1,w=-1,E=0,N=0,P=r,R=null;t:for(;;){for(var q;P!==s||n!==0&&P.nodeType!==3||(x=p+n),P!==e||i!==0&&P.nodeType!==3||(w=p+i),P.nodeType===3&&(p+=P.nodeValue.length),(q=P.firstChild)!==null;)R=P,P=q;for(;;){if(P===r)break t;if(R===s&&++E===n&&(x=p),R===e&&++N===i&&(w=p),(q=P.nextSibling)!==null)break;P=R,R=P.parentNode}P=q}s=x===-1||w===-1?null:{start:x,end:w}}else s=null}s=s||{start:0,end:0}}else s=null;for(pm={focusedElem:r,selectionRange:s},Od=!1,bt=t;bt!==null;)if(t=bt,r=t.child,(t.subtreeFlags&1028)!==0&&r!==null)r.return=t,bt=r;else for(;bt!==null;){t=bt;try{var Z=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(Z!==null){var ne=Z.memoizedProps,fe=Z.memoizedState,G=t.stateNode,U=G.getSnapshotBeforeUpdate(t.elementType===t.type?ne:va(t.type,ne),fe);G.__reactInternalSnapshotBeforeUpdate=U}break;case 3:var H=t.stateNode.containerInfo;H.nodeType===1?H.textContent="":H.nodeType===9&&H.documentElement&&H.removeChild(H.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(qe(163))}}catch(ee){fn(t,t.return,ee)}if(r=t.sibling,r!==null){r.return=t.return,bt=r;break}bt=t.return}return Z=y4,y4=!1,Z}function $u(r,t,s){var i=t.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var n=i=i.next;do{if((n.tag&r)===r){var e=n.destroy;n.destroy=void 0,e!==void 0&&Nm(t,s,e)}n=n.next}while(n!==i)}}function b0(r,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var s=t=t.next;do{if((s.tag&r)===r){var i=s.create;s.destroy=i()}s=s.next}while(s!==t)}}function Im(r){var t=r.ref;if(t!==null){var s=r.stateNode;switch(r.tag){case 5:r=s;break;default:r=s}typeof t=="function"?t(r):t.current=r}}function M_(r){var t=r.alternate;t!==null&&(r.alternate=null,M_(t)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(t=r.stateNode,t!==null&&(delete t[$a],delete t[af],delete t[ym],delete t[ck],delete t[uk])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function L_(r){return r.tag===5||r.tag===3||r.tag===4}function v4(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||L_(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Dm(r,t,s){var i=r.tag;if(i===5||i===6)r=r.stateNode,t?s.nodeType===8?s.parentNode.insertBefore(r,t):s.insertBefore(r,t):(s.nodeType===8?(t=s.parentNode,t.insertBefore(r,s)):(t=s,t.appendChild(r)),s=s._reactRootContainer,s!=null||t.onclick!==null||(t.onclick=Ld));else if(i!==4&&(r=r.child,r!==null))for(Dm(r,t,s),r=r.sibling;r!==null;)Dm(r,t,s),r=r.sibling}function Rm(r,t,s){var i=r.tag;if(i===5||i===6)r=r.stateNode,t?s.insertBefore(r,t):s.appendChild(r);else if(i!==4&&(r=r.child,r!==null))for(Rm(r,t,s),r=r.sibling;r!==null;)Rm(r,t,s),r=r.sibling}var $n=null,xa=!1;function zi(r,t,s){for(s=s.child;s!==null;)V_(r,t,s),s=s.sibling}function V_(r,t,s){if(Wa&&typeof Wa.onCommitFiberUnmount=="function")try{Wa.onCommitFiberUnmount(h0,s)}catch{}switch(s.tag){case 5:is||rc(s,t);case 6:var i=$n,n=xa;$n=null,zi(r,t,s),$n=i,xa=n,$n!==null&&(xa?(r=$n,s=s.stateNode,r.nodeType===8?r.parentNode.removeChild(s):r.removeChild(s)):$n.removeChild(s.stateNode));break;case 18:$n!==null&&(xa?(r=$n,s=s.stateNode,r.nodeType===8?p1(r.parentNode,s):r.nodeType===1&&p1(r,s),ef(r)):p1($n,s.stateNode));break;case 4:i=$n,n=xa,$n=s.stateNode.containerInfo,xa=!0,zi(r,t,s),$n=i,xa=n;break;case 0:case 11:case 14:case 15:if(!is&&(i=s.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){n=i=i.next;do{var e=n,p=e.destroy;e=e.tag,p!==void 0&&(e&2||e&4)&&Nm(s,t,p),n=n.next}while(n!==i)}zi(r,t,s);break;case 1:if(!is&&(rc(s,t),i=s.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=s.memoizedProps,i.state=s.memoizedState,i.componentWillUnmount()}catch(x){fn(s,t,x)}zi(r,t,s);break;case 21:zi(r,t,s);break;case 22:s.mode&1?(is=(i=is)||s.memoizedState!==null,zi(r,t,s),is=i):zi(r,t,s);break;default:zi(r,t,s)}}function x4(r){var t=r.updateQueue;if(t!==null){r.updateQueue=null;var s=r.stateNode;s===null&&(s=r.stateNode=new Ak),t.forEach(function(i){var n=jk.bind(null,r,i);s.has(i)||(s.add(i),i.then(n,n))})}}function ya(r,t){var s=t.deletions;if(s!==null)for(var i=0;i<s.length;i++){var n=s[i];try{var e=r,p=t,x=p;e:for(;x!==null;){switch(x.tag){case 5:$n=x.stateNode,xa=!1;break e;case 3:$n=x.stateNode.containerInfo,xa=!0;break e;case 4:$n=x.stateNode.containerInfo,xa=!0;break e}x=x.return}if($n===null)throw Error(qe(160));V_(e,p,n),$n=null,xa=!1;var w=n.alternate;w!==null&&(w.return=null),n.return=null}catch(E){fn(n,t,E)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)U_(t,r),t=t.sibling}function U_(r,t){var s=r.alternate,i=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(ya(t,r),Va(r),i&4){try{$u(3,r,r.return),b0(3,r)}catch(ne){fn(r,r.return,ne)}try{$u(5,r,r.return)}catch(ne){fn(r,r.return,ne)}}break;case 1:ya(t,r),Va(r),i&512&&s!==null&&rc(s,s.return);break;case 5:if(ya(t,r),Va(r),i&512&&s!==null&&rc(s,s.return),r.flags&32){var n=r.stateNode;try{Qu(n,"")}catch(ne){fn(r,r.return,ne)}}if(i&4&&(n=r.stateNode,n!=null)){var e=r.memoizedProps,p=s!==null?s.memoizedProps:e,x=r.type,w=r.updateQueue;if(r.updateQueue=null,w!==null)try{x==="input"&&e.type==="radio"&&e.name!=null&&l3(n,e),nm(x,p);var E=nm(x,e);for(p=0;p<w.length;p+=2){var N=w[p],P=w[p+1];N==="style"?d3(n,P):N==="dangerouslySetInnerHTML"?f3(n,P):N==="children"?Qu(n,P):bg(n,N,P,E)}switch(x){case"input":J1(n,e);break;case"textarea":c3(n,e);break;case"select":var R=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!e.multiple;var q=e.value;q!=null?sc(n,!!e.multiple,q,!1):R!==!!e.multiple&&(e.defaultValue!=null?sc(n,!!e.multiple,e.defaultValue,!0):sc(n,!!e.multiple,e.multiple?[]:"",!1))}n[af]=e}catch(ne){fn(r,r.return,ne)}}break;case 6:if(ya(t,r),Va(r),i&4){if(r.stateNode===null)throw Error(qe(162));n=r.stateNode,e=r.memoizedProps;try{n.nodeValue=e}catch(ne){fn(r,r.return,ne)}}break;case 3:if(ya(t,r),Va(r),i&4&&s!==null&&s.memoizedState.isDehydrated)try{ef(t.containerInfo)}catch(ne){fn(r,r.return,ne)}break;case 4:ya(t,r),Va(r);break;case 13:ya(t,r),Va(r),n=r.child,n.flags&8192&&(e=n.memoizedState!==null,n.stateNode.isHidden=e,!e||n.alternate!==null&&n.alternate.memoizedState!==null||(Zg=gn())),i&4&&x4(r);break;case 22:if(N=s!==null&&s.memoizedState!==null,r.mode&1?(is=(E=is)||N,ya(t,r),is=E):ya(t,r),Va(r),i&8192){if(E=r.memoizedState!==null,(r.stateNode.isHidden=E)&&!N&&r.mode&1)for(bt=r,N=r.child;N!==null;){for(P=bt=N;bt!==null;){switch(R=bt,q=R.child,R.tag){case 0:case 11:case 14:case 15:$u(4,R,R.return);break;case 1:rc(R,R.return);var Z=R.stateNode;if(typeof Z.componentWillUnmount=="function"){i=R,s=R.return;try{t=i,Z.props=t.memoizedProps,Z.state=t.memoizedState,Z.componentWillUnmount()}catch(ne){fn(i,s,ne)}}break;case 5:rc(R,R.return);break;case 22:if(R.memoizedState!==null){w4(P);continue}}q!==null?(q.return=R,bt=q):w4(P)}N=N.sibling}e:for(N=null,P=r;;){if(P.tag===5){if(N===null){N=P;try{n=P.stateNode,E?(e=n.style,typeof e.setProperty=="function"?e.setProperty("display","none","important"):e.display="none"):(x=P.stateNode,w=P.memoizedProps.style,p=w!=null&&w.hasOwnProperty("display")?w.display:null,x.style.display=h3("display",p))}catch(ne){fn(r,r.return,ne)}}}else if(P.tag===6){if(N===null)try{P.stateNode.nodeValue=E?"":P.memoizedProps}catch(ne){fn(r,r.return,ne)}}else if((P.tag!==22&&P.tag!==23||P.memoizedState===null||P===r)&&P.child!==null){P.child.return=P,P=P.child;continue}if(P===r)break e;for(;P.sibling===null;){if(P.return===null||P.return===r)break e;N===P&&(N=null),P=P.return}N===P&&(N=null),P.sibling.return=P.return,P=P.sibling}}break;case 19:ya(t,r),Va(r),i&4&&x4(r);break;case 21:break;default:ya(t,r),Va(r)}}function Va(r){var t=r.flags;if(t&2){try{e:{for(var s=r.return;s!==null;){if(L_(s)){var i=s;break e}s=s.return}throw Error(qe(160))}switch(i.tag){case 5:var n=i.stateNode;i.flags&32&&(Qu(n,""),i.flags&=-33);var e=v4(r);Rm(r,e,n);break;case 3:case 4:var p=i.stateNode.containerInfo,x=v4(r);Dm(r,x,p);break;default:throw Error(qe(161))}}catch(w){fn(r,r.return,w)}r.flags&=-3}t&4096&&(r.flags&=-4097)}function kk(r,t,s){bt=r,B_(r)}function B_(r,t,s){for(var i=(r.mode&1)!==0;bt!==null;){var n=bt,e=n.child;if(n.tag===22&&i){var p=n.memoizedState!==null||nd;if(!p){var x=n.alternate,w=x!==null&&x.memoizedState!==null||is;x=nd;var E=is;if(nd=p,(is=w)&&!E)for(bt=n;bt!==null;)p=bt,w=p.child,p.tag===22&&p.memoizedState!==null?_4(n):w!==null?(w.return=p,bt=w):_4(n);for(;e!==null;)bt=e,B_(e),e=e.sibling;bt=n,nd=x,is=E}b4(r)}else n.subtreeFlags&8772&&e!==null?(e.return=n,bt=e):b4(r)}}function b4(r){for(;bt!==null;){var t=bt;if(t.flags&8772){var s=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:is||b0(5,t);break;case 1:var i=t.stateNode;if(t.flags&4&&!is)if(s===null)i.componentDidMount();else{var n=t.elementType===t.type?s.memoizedProps:va(t.type,s.memoizedProps);i.componentDidUpdate(n,s.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var e=t.updateQueue;e!==null&&s4(t,e,i);break;case 3:var p=t.updateQueue;if(p!==null){if(s=null,t.child!==null)switch(t.child.tag){case 5:s=t.child.stateNode;break;case 1:s=t.child.stateNode}s4(t,p,s)}break;case 5:var x=t.stateNode;if(s===null&&t.flags&4){s=x;var w=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":w.autoFocus&&s.focus();break;case"img":w.src&&(s.src=w.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var E=t.alternate;if(E!==null){var N=E.memoizedState;if(N!==null){var P=N.dehydrated;P!==null&&ef(P)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(qe(163))}is||t.flags&512&&Im(t)}catch(R){fn(t,t.return,R)}}if(t===r){bt=null;break}if(s=t.sibling,s!==null){s.return=t.return,bt=s;break}bt=t.return}}function w4(r){for(;bt!==null;){var t=bt;if(t===r){bt=null;break}var s=t.sibling;if(s!==null){s.return=t.return,bt=s;break}bt=t.return}}function _4(r){for(;bt!==null;){var t=bt;try{switch(t.tag){case 0:case 11:case 15:var s=t.return;try{b0(4,t)}catch(w){fn(t,s,w)}break;case 1:var i=t.stateNode;if(typeof i.componentDidMount=="function"){var n=t.return;try{i.componentDidMount()}catch(w){fn(t,n,w)}}var e=t.return;try{Im(t)}catch(w){fn(t,e,w)}break;case 5:var p=t.return;try{Im(t)}catch(w){fn(t,p,w)}}}catch(w){fn(t,t.return,w)}if(t===r){bt=null;break}var x=t.sibling;if(x!==null){x.return=t.return,bt=x;break}bt=t.return}}var Fk=Math.ceil,Yd=Si.ReactCurrentDispatcher,Xg=Si.ReactCurrentOwner,ia=Si.ReactCurrentBatchConfig,wr=0,Ln=null,En=null,Hn=0,js=0,nc=go(0),Rn=0,hf=null,nl=0,w0=0,Jg=0,Wu=null,Es=null,Zg=0,vc=1/0,li=null,Qd=!1,Pm=null,no=null,sd=!1,Qi=null,Xd=0,zu=0,Om=null,bd=-1,wd=0;function gs(){return wr&6?gn():bd!==-1?bd:bd=gn()}function so(r){return r.mode&1?wr&2&&Hn!==0?Hn&-Hn:hk.transition!==null?(wd===0&&(wd=S3()),wd):(r=Mr,r!==0||(r=window.event,r=r===void 0?16:D3(r.type)),r):1}function _a(r,t,s,i){if(50<zu)throw zu=0,Om=null,Error(qe(185));Cf(r,s,i),(!(wr&2)||r!==Ln)&&(r===Ln&&(!(wr&2)&&(w0|=s),Rn===4&&Ki(r,Hn)),Fs(r,i),s===1&&wr===0&&!(t.mode&1)&&(vc=gn()+500,y0&&yo()))}function Fs(r,t){var s=r.callbackNode;hC(r,t);var i=Pd(r,r===Ln?Hn:0);if(i===0)s!==null&&Ib(s),r.callbackNode=null,r.callbackPriority=0;else if(t=i&-i,r.callbackPriority!==t){if(s!=null&&Ib(s),t===1)r.tag===0?fk(T4.bind(null,r)):X3(T4.bind(null,r)),ok(function(){!(wr&6)&&yo()}),s=null;else{switch(A3(i)){case 1:s=Sg;break;case 4:s=T3;break;case 16:s=Rd;break;case 536870912:s=E3;break;default:s=Rd}s=Y_(s,$_.bind(null,r))}r.callbackPriority=t,r.callbackNode=s}}function $_(r,t){if(bd=-1,wd=0,wr&6)throw Error(qe(327));var s=r.callbackNode;if(cc()&&r.callbackNode!==s)return null;var i=Pd(r,r===Ln?Hn:0);if(i===0)return null;if(i&30||i&r.expiredLanes||t)t=Jd(r,i);else{t=i;var n=wr;wr|=2;var e=z_();(Ln!==r||Hn!==t)&&(li=null,vc=gn()+500,Xo(r,t));do try{Dk();break}catch(x){W_(r,x)}while(!0);Lg(),Yd.current=e,wr=n,En!==null?t=0:(Ln=null,Hn=0,t=Rn)}if(t!==0){if(t===2&&(n=lm(r),n!==0&&(i=n,t=jm(r,n))),t===1)throw s=hf,Xo(r,0),Ki(r,i),Fs(r,gn()),s;if(t===6)Ki(r,i);else{if(n=r.current.alternate,!(i&30)&&!Nk(n)&&(t=Jd(r,i),t===2&&(e=lm(r),e!==0&&(i=e,t=jm(r,e))),t===1))throw s=hf,Xo(r,0),Ki(r,i),Fs(r,gn()),s;switch(r.finishedWork=n,r.finishedLanes=i,t){case 0:case 1:throw Error(qe(345));case 2:zo(r,Es,li);break;case 3:if(Ki(r,i),(i&130023424)===i&&(t=Zg+500-gn(),10<t)){if(Pd(r,0)!==0)break;if(n=r.suspendedLanes,(n&i)!==i){gs(),r.pingedLanes|=r.suspendedLanes&n;break}r.timeoutHandle=gm(zo.bind(null,r,Es,li),t);break}zo(r,Es,li);break;case 4:if(Ki(r,i),(i&4194240)===i)break;for(t=r.eventTimes,n=-1;0<i;){var p=31-wa(i);e=1<<p,p=t[p],p>n&&(n=p),i&=~e}if(i=n,i=gn()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Fk(i/1960))-i,10<i){r.timeoutHandle=gm(zo.bind(null,r,Es,li),i);break}zo(r,Es,li);break;case 5:zo(r,Es,li);break;default:throw Error(qe(329))}}}return Fs(r,gn()),r.callbackNode===s?$_.bind(null,r):null}function jm(r,t){var s=Wu;return r.current.memoizedState.isDehydrated&&(Xo(r,t).flags|=256),r=Jd(r,t),r!==2&&(t=Es,Es=s,t!==null&&Mm(t)),r}function Mm(r){Es===null?Es=r:Es.push.apply(Es,r)}function Nk(r){for(var t=r;;){if(t.flags&16384){var s=t.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var i=0;i<s.length;i++){var n=s[i],e=n.getSnapshot;n=n.value;try{if(!Ea(e(),n))return!1}catch{return!1}}}if(s=t.child,t.subtreeFlags&16384&&s!==null)s.return=t,t=s;else{if(t===r)break;for(;t.sibling===null;){if(t.return===null||t.return===r)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ki(r,t){for(t&=~Jg,t&=~w0,r.suspendedLanes|=t,r.pingedLanes&=~t,r=r.expirationTimes;0<t;){var s=31-wa(t),i=1<<s;r[s]=-1,t&=~i}}function T4(r){if(wr&6)throw Error(qe(327));cc();var t=Pd(r,0);if(!(t&1))return Fs(r,gn()),null;var s=Jd(r,t);if(r.tag!==0&&s===2){var i=lm(r);i!==0&&(t=i,s=jm(r,i))}if(s===1)throw s=hf,Xo(r,0),Ki(r,t),Fs(r,gn()),s;if(s===6)throw Error(qe(345));return r.finishedWork=r.current.alternate,r.finishedLanes=t,zo(r,Es,li),Fs(r,gn()),null}function e2(r,t){var s=wr;wr|=1;try{return r(t)}finally{wr=s,wr===0&&(vc=gn()+500,y0&&yo())}}function sl(r){Qi!==null&&Qi.tag===0&&!(wr&6)&&cc();var t=wr;wr|=1;var s=ia.transition,i=Mr;try{if(ia.transition=null,Mr=1,r)return r()}finally{Mr=i,ia.transition=s,wr=t,!(wr&6)&&yo()}}function t2(){js=nc.current,Qr(nc)}function Xo(r,t){r.finishedWork=null,r.finishedLanes=0;var s=r.timeoutHandle;if(s!==-1&&(r.timeoutHandle=-1,ik(s)),En!==null)for(s=En.return;s!==null;){var i=s;switch(Og(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Vd();break;case 3:gc(),Qr(Cs),Qr(cs),zg();break;case 5:Wg(i);break;case 4:gc();break;case 13:Qr(sn);break;case 19:Qr(sn);break;case 10:Vg(i.type._context);break;case 22:case 23:t2()}s=s.return}if(Ln=r,En=r=ao(r.current,null),Hn=js=t,Rn=0,hf=null,Jg=w0=nl=0,Es=Wu=null,qo!==null){for(t=0;t<qo.length;t++)if(s=qo[t],i=s.interleaved,i!==null){s.interleaved=null;var n=i.next,e=s.pending;if(e!==null){var p=e.next;e.next=n,i.next=p}s.pending=i}qo=null}return r}function W_(r,t){do{var s=En;try{if(Lg(),yd.current=Kd,qd){for(var i=an.memoizedState;i!==null;){var n=i.queue;n!==null&&(n.pending=null),i=i.next}qd=!1}if(rl=0,Mn=Dn=an=null,Bu=!1,cf=0,Xg.current=null,s===null||s.return===null){Rn=1,hf=t,En=null;break}e:{var e=r,p=s.return,x=s,w=t;if(t=Hn,x.flags|=32768,w!==null&&typeof w=="object"&&typeof w.then=="function"){var E=w,N=x,P=N.tag;if(!(N.mode&1)&&(P===0||P===11||P===15)){var R=N.alternate;R?(N.updateQueue=R.updateQueue,N.memoizedState=R.memoizedState,N.lanes=R.lanes):(N.updateQueue=null,N.memoizedState=null)}var q=u4(p);if(q!==null){q.flags&=-257,f4(q,p,x,e,t),q.mode&1&&c4(e,E,t),t=q,w=E;var Z=t.updateQueue;if(Z===null){var ne=new Set;ne.add(w),t.updateQueue=ne}else Z.add(w);break e}else{if(!(t&1)){c4(e,E,t),r2();break e}w=Error(qe(426))}}else if(tn&&x.mode&1){var fe=u4(p);if(fe!==null){!(fe.flags&65536)&&(fe.flags|=256),f4(fe,p,x,e,t),jg(yc(w,x));break e}}e=w=yc(w,x),Rn!==4&&(Rn=2),Wu===null?Wu=[e]:Wu.push(e),e=p;do{switch(e.tag){case 3:e.flags|=65536,t&=-t,e.lanes|=t;var G=A_(e,w,t);n4(e,G);break e;case 1:x=w;var U=e.type,H=e.stateNode;if(!(e.flags&128)&&(typeof U.getDerivedStateFromError=="function"||H!==null&&typeof H.componentDidCatch=="function"&&(no===null||!no.has(H)))){e.flags|=65536,t&=-t,e.lanes|=t;var ee=C_(e,x,t);n4(e,ee);break e}}e=e.return}while(e!==null)}G_(s)}catch(te){t=te,En===s&&s!==null&&(En=s=s.return);continue}break}while(!0)}function z_(){var r=Yd.current;return Yd.current=Kd,r===null?Kd:r}function r2(){(Rn===0||Rn===3||Rn===2)&&(Rn=4),Ln===null||!(nl&268435455)&&!(w0&268435455)||Ki(Ln,Hn)}function Jd(r,t){var s=wr;wr|=2;var i=z_();(Ln!==r||Hn!==t)&&(li=null,Xo(r,t));do try{Ik();break}catch(n){W_(r,n)}while(!0);if(Lg(),wr=s,Yd.current=i,En!==null)throw Error(qe(261));return Ln=null,Hn=0,Rn}function Ik(){for(;En!==null;)H_(En)}function Dk(){for(;En!==null&&!nC();)H_(En)}function H_(r){var t=K_(r.alternate,r,js);r.memoizedProps=r.pendingProps,t===null?G_(r):En=t,Xg.current=null}function G_(r){var t=r;do{var s=t.alternate;if(r=t.return,t.flags&32768){if(s=Sk(s,t),s!==null){s.flags&=32767,En=s;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{Rn=6,En=null;return}}else if(s=Ek(s,t,js),s!==null){En=s;return}if(t=t.sibling,t!==null){En=t;return}En=t=r}while(t!==null);Rn===0&&(Rn=5)}function zo(r,t,s){var i=Mr,n=ia.transition;try{ia.transition=null,Mr=1,Rk(r,t,s,i)}finally{ia.transition=n,Mr=i}return null}function Rk(r,t,s,i){do cc();while(Qi!==null);if(wr&6)throw Error(qe(327));s=r.finishedWork;var n=r.finishedLanes;if(s===null)return null;if(r.finishedWork=null,r.finishedLanes=0,s===r.current)throw Error(qe(177));r.callbackNode=null,r.callbackPriority=0;var e=s.lanes|s.childLanes;if(dC(r,e),r===Ln&&(En=Ln=null,Hn=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||sd||(sd=!0,Y_(Rd,function(){return cc(),null})),e=(s.flags&15990)!==0,s.subtreeFlags&15990||e){e=ia.transition,ia.transition=null;var p=Mr;Mr=1;var x=wr;wr|=4,Xg.current=null,Ck(r,s),U_(s,r),ZC(pm),Od=!!dm,pm=dm=null,r.current=s,kk(s),sC(),wr=x,Mr=p,ia.transition=e}else r.current=s;if(sd&&(sd=!1,Qi=r,Xd=n),e=r.pendingLanes,e===0&&(no=null),oC(s.stateNode),Fs(r,gn()),t!==null)for(i=r.onRecoverableError,s=0;s<t.length;s++)n=t[s],i(n.value,{componentStack:n.stack,digest:n.digest});if(Qd)throw Qd=!1,r=Pm,Pm=null,r;return Xd&1&&r.tag!==0&&cc(),e=r.pendingLanes,e&1?r===Om?zu++:(zu=0,Om=r):zu=0,yo(),null}function cc(){if(Qi!==null){var r=A3(Xd),t=ia.transition,s=Mr;try{if(ia.transition=null,Mr=16>r?16:r,Qi===null)var i=!1;else{if(r=Qi,Qi=null,Xd=0,wr&6)throw Error(qe(331));var n=wr;for(wr|=4,bt=r.current;bt!==null;){var e=bt,p=e.child;if(bt.flags&16){var x=e.deletions;if(x!==null){for(var w=0;w<x.length;w++){var E=x[w];for(bt=E;bt!==null;){var N=bt;switch(N.tag){case 0:case 11:case 15:$u(8,N,e)}var P=N.child;if(P!==null)P.return=N,bt=P;else for(;bt!==null;){N=bt;var R=N.sibling,q=N.return;if(M_(N),N===E){bt=null;break}if(R!==null){R.return=q,bt=R;break}bt=q}}}var Z=e.alternate;if(Z!==null){var ne=Z.child;if(ne!==null){Z.child=null;do{var fe=ne.sibling;ne.sibling=null,ne=fe}while(ne!==null)}}bt=e}}if(e.subtreeFlags&2064&&p!==null)p.return=e,bt=p;else e:for(;bt!==null;){if(e=bt,e.flags&2048)switch(e.tag){case 0:case 11:case 15:$u(9,e,e.return)}var G=e.sibling;if(G!==null){G.return=e.return,bt=G;break e}bt=e.return}}var U=r.current;for(bt=U;bt!==null;){p=bt;var H=p.child;if(p.subtreeFlags&2064&&H!==null)H.return=p,bt=H;else e:for(p=U;bt!==null;){if(x=bt,x.flags&2048)try{switch(x.tag){case 0:case 11:case 15:b0(9,x)}}catch(te){fn(x,x.return,te)}if(x===p){bt=null;break e}var ee=x.sibling;if(ee!==null){ee.return=x.return,bt=ee;break e}bt=x.return}}if(wr=n,yo(),Wa&&typeof Wa.onPostCommitFiberRoot=="function")try{Wa.onPostCommitFiberRoot(h0,r)}catch{}i=!0}return i}finally{Mr=s,ia.transition=t}}return!1}function E4(r,t,s){t=yc(s,t),t=A_(r,t,1),r=ro(r,t,1),t=gs(),r!==null&&(Cf(r,1,t),Fs(r,t))}function fn(r,t,s){if(r.tag===3)E4(r,r,s);else for(;t!==null;){if(t.tag===3){E4(t,r,s);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(no===null||!no.has(i))){r=yc(s,r),r=C_(t,r,1),t=ro(t,r,1),r=gs(),t!==null&&(Cf(t,1,r),Fs(t,r));break}}t=t.return}}function Pk(r,t,s){var i=r.pingCache;i!==null&&i.delete(t),t=gs(),r.pingedLanes|=r.suspendedLanes&s,Ln===r&&(Hn&s)===s&&(Rn===4||Rn===3&&(Hn&130023424)===Hn&&500>gn()-Zg?Xo(r,0):Jg|=s),Fs(r,t)}function q_(r,t){t===0&&(r.mode&1?(t=Kh,Kh<<=1,!(Kh&130023424)&&(Kh=4194304)):t=1);var s=gs();r=xi(r,t),r!==null&&(Cf(r,t,s),Fs(r,s))}function Ok(r){var t=r.memoizedState,s=0;t!==null&&(s=t.retryLane),q_(r,s)}function jk(r,t){var s=0;switch(r.tag){case 13:var i=r.stateNode,n=r.memoizedState;n!==null&&(s=n.retryLane);break;case 19:i=r.stateNode;break;default:throw Error(qe(314))}i!==null&&i.delete(t),q_(r,s)}var K_;K_=function(r,t,s){if(r!==null)if(r.memoizedProps!==t.pendingProps||Cs.current)As=!0;else{if(!(r.lanes&s)&&!(t.flags&128))return As=!1,Tk(r,t,s);As=!!(r.flags&131072)}else As=!1,tn&&t.flags&1048576&&J3(t,$d,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;xd(r,t),r=t.pendingProps;var n=dc(t,cs.current);lc(t,s),n=Gg(null,t,i,r,n,s);var e=qg();return t.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ks(i)?(e=!0,Ud(t)):e=!1,t.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,Bg(t),n.updater=x0,t.stateNode=n,n._reactInternals=t,Tm(t,i,r,s),t=Am(null,t,i,!0,e,s)):(t.tag=0,tn&&e&&Pg(t),ms(null,t,n,s),t=t.child),t;case 16:i=t.elementType;e:{switch(xd(r,t),r=t.pendingProps,n=i._init,i=n(i._payload),t.type=i,n=t.tag=Lk(i),r=va(i,r),n){case 0:t=Sm(null,t,i,r,s);break e;case 1:t=p4(null,t,i,r,s);break e;case 11:t=h4(null,t,i,r,s);break e;case 14:t=d4(null,t,i,va(i.type,r),s);break e}throw Error(qe(306,i,""))}return t;case 0:return i=t.type,n=t.pendingProps,n=t.elementType===i?n:va(i,n),Sm(r,t,i,n,s);case 1:return i=t.type,n=t.pendingProps,n=t.elementType===i?n:va(i,n),p4(r,t,i,n,s);case 3:e:{if(I_(t),r===null)throw Error(qe(387));i=t.pendingProps,e=t.memoizedState,n=e.element,s_(r,t),Hd(t,i,null,s);var p=t.memoizedState;if(i=p.element,e.isDehydrated)if(e={element:i,isDehydrated:!1,cache:p.cache,pendingSuspenseBoundaries:p.pendingSuspenseBoundaries,transitions:p.transitions},t.updateQueue.baseState=e,t.memoizedState=e,t.flags&256){n=yc(Error(qe(423)),t),t=m4(r,t,i,s,n);break e}else if(i!==n){n=yc(Error(qe(424)),t),t=m4(r,t,i,s,n);break e}else for(Ms=to(t.stateNode.containerInfo.firstChild),Vs=t,tn=!0,ba=null,s=r_(t,null,i,s),t.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(pc(),i===n){t=bi(r,t,s);break e}ms(r,t,i,s)}t=t.child}return t;case 5:return a_(t),r===null&&bm(t),i=t.type,n=t.pendingProps,e=r!==null?r.memoizedProps:null,p=n.children,mm(i,n)?p=null:e!==null&&mm(i,e)&&(t.flags|=32),N_(r,t),ms(r,t,p,s),t.child;case 6:return r===null&&bm(t),null;case 13:return D_(r,t,s);case 4:return $g(t,t.stateNode.containerInfo),i=t.pendingProps,r===null?t.child=mc(t,null,i,s):ms(r,t,i,s),t.child;case 11:return i=t.type,n=t.pendingProps,n=t.elementType===i?n:va(i,n),h4(r,t,i,n,s);case 7:return ms(r,t,t.pendingProps,s),t.child;case 8:return ms(r,t,t.pendingProps.children,s),t.child;case 12:return ms(r,t,t.pendingProps.children,s),t.child;case 10:e:{if(i=t.type._context,n=t.pendingProps,e=t.memoizedProps,p=n.value,Hr(Wd,i._currentValue),i._currentValue=p,e!==null)if(Ea(e.value,p)){if(e.children===n.children&&!Cs.current){t=bi(r,t,s);break e}}else for(e=t.child,e!==null&&(e.return=t);e!==null;){var x=e.dependencies;if(x!==null){p=e.child;for(var w=x.firstContext;w!==null;){if(w.context===i){if(e.tag===1){w=pi(-1,s&-s),w.tag=2;var E=e.updateQueue;if(E!==null){E=E.shared;var N=E.pending;N===null?w.next=w:(w.next=N.next,N.next=w),E.pending=w}}e.lanes|=s,w=e.alternate,w!==null&&(w.lanes|=s),wm(e.return,s,t),x.lanes|=s;break}w=w.next}}else if(e.tag===10)p=e.type===t.type?null:e.child;else if(e.tag===18){if(p=e.return,p===null)throw Error(qe(341));p.lanes|=s,x=p.alternate,x!==null&&(x.lanes|=s),wm(p,s,t),p=e.sibling}else p=e.child;if(p!==null)p.return=e;else for(p=e;p!==null;){if(p===t){p=null;break}if(e=p.sibling,e!==null){e.return=p.return,p=e;break}p=p.return}e=p}ms(r,t,n.children,s),t=t.child}return t;case 9:return n=t.type,i=t.pendingProps.children,lc(t,s),n=oa(n),i=i(n),t.flags|=1,ms(r,t,i,s),t.child;case 14:return i=t.type,n=va(i,t.pendingProps),n=va(i.type,n),d4(r,t,i,n,s);case 15:return k_(r,t,t.type,t.pendingProps,s);case 17:return i=t.type,n=t.pendingProps,n=t.elementType===i?n:va(i,n),xd(r,t),t.tag=1,ks(i)?(r=!0,Ud(t)):r=!1,lc(t,s),S_(t,i,n),Tm(t,i,n,s),Am(null,t,i,!0,r,s);case 19:return R_(r,t,s);case 22:return F_(r,t,s)}throw Error(qe(156,t.tag))};function Y_(r,t){return _3(r,t)}function Mk(r,t,s,i){this.tag=r,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function aa(r,t,s,i){return new Mk(r,t,s,i)}function n2(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Lk(r){if(typeof r=="function")return n2(r)?1:0;if(r!=null){if(r=r.$$typeof,r===_g)return 11;if(r===Tg)return 14}return 2}function ao(r,t){var s=r.alternate;return s===null?(s=aa(r.tag,t,r.key,r.mode),s.elementType=r.elementType,s.type=r.type,s.stateNode=r.stateNode,s.alternate=r,r.alternate=s):(s.pendingProps=t,s.type=r.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=r.flags&14680064,s.childLanes=r.childLanes,s.lanes=r.lanes,s.child=r.child,s.memoizedProps=r.memoizedProps,s.memoizedState=r.memoizedState,s.updateQueue=r.updateQueue,t=r.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},s.sibling=r.sibling,s.index=r.index,s.ref=r.ref,s}function _d(r,t,s,i,n,e){var p=2;if(i=r,typeof r=="function")n2(r)&&(p=1);else if(typeof r=="string")p=5;else e:switch(r){case ql:return Jo(s.children,n,e,t);case wg:p=8,n|=8;break;case q1:return r=aa(12,s,t,n|2),r.elementType=q1,r.lanes=e,r;case K1:return r=aa(13,s,t,n),r.elementType=K1,r.lanes=e,r;case Y1:return r=aa(19,s,t,n),r.elementType=Y1,r.lanes=e,r;case a3:return _0(s,n,e,t);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case n3:p=10;break e;case s3:p=9;break e;case _g:p=11;break e;case Tg:p=14;break e;case Hi:p=16,i=null;break e}throw Error(qe(130,r==null?r:typeof r,""))}return t=aa(p,s,t,n),t.elementType=r,t.type=i,t.lanes=e,t}function Jo(r,t,s,i){return r=aa(7,r,i,t),r.lanes=s,r}function _0(r,t,s,i){return r=aa(22,r,i,t),r.elementType=a3,r.lanes=s,r.stateNode={isHidden:!1},r}function _1(r,t,s){return r=aa(6,r,null,t),r.lanes=s,r}function T1(r,t,s){return t=aa(4,r.children!==null?r.children:[],r.key,t),t.lanes=s,t.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},t}function Vk(r,t,s,i,n){this.tag=t,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=n1(0),this.expirationTimes=n1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=n1(0),this.identifierPrefix=i,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function s2(r,t,s,i,n,e,p,x,w){return r=new Vk(r,t,s,x,w),t===1?(t=1,e===!0&&(t|=8)):t=0,e=aa(3,null,null,t),r.current=e,e.stateNode=r,e.memoizedState={element:i,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},Bg(e),r}function Uk(r,t,s){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Gl,key:i==null?null:""+i,children:r,containerInfo:t,implementation:s}}function Q_(r){if(!r)return co;r=r._reactInternals;e:{if(dl(r)!==r||r.tag!==1)throw Error(qe(170));var t=r;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ks(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(qe(171))}if(r.tag===1){var s=r.type;if(ks(s))return Q3(r,s,t)}return t}function X_(r,t,s,i,n,e,p,x,w){return r=s2(s,i,!0,r,n,e,p,x,w),r.context=Q_(null),s=r.current,i=gs(),n=so(s),e=pi(i,n),e.callback=t??null,ro(s,e,n),r.current.lanes=n,Cf(r,n,i),Fs(r,i),r}function T0(r,t,s,i){var n=t.current,e=gs(),p=so(n);return s=Q_(s),t.context===null?t.context=s:t.pendingContext=s,t=pi(e,p),t.payload={element:r},i=i===void 0?null:i,i!==null&&(t.callback=i),r=ro(n,t,p),r!==null&&(_a(r,n,p,e),gd(r,n,p)),p}function Zd(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function S4(r,t){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var s=r.retryLane;r.retryLane=s!==0&&s<t?s:t}}function a2(r,t){S4(r,t),(r=r.alternate)&&S4(r,t)}function Bk(){return null}var J_=typeof reportError=="function"?reportError:function(r){console.error(r)};function i2(r){this._internalRoot=r}E0.prototype.render=i2.prototype.render=function(r){var t=this._internalRoot;if(t===null)throw Error(qe(409));T0(r,t,null,null)};E0.prototype.unmount=i2.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var t=r.containerInfo;sl(function(){T0(null,r,null,null)}),t[vi]=null}};function E0(r){this._internalRoot=r}E0.prototype.unstable_scheduleHydration=function(r){if(r){var t=F3();r={blockedOn:null,target:r,priority:t};for(var s=0;s<qi.length&&t!==0&&t<qi[s].priority;s++);qi.splice(s,0,r),s===0&&I3(r)}};function o2(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function S0(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function A4(){}function $k(r,t,s,i,n){if(n){if(typeof i=="function"){var e=i;i=function(){var E=Zd(p);e.call(E)}}var p=X_(t,i,r,0,null,!1,!1,"",A4);return r._reactRootContainer=p,r[vi]=p.current,nf(r.nodeType===8?r.parentNode:r),sl(),p}for(;n=r.lastChild;)r.removeChild(n);if(typeof i=="function"){var x=i;i=function(){var E=Zd(w);x.call(E)}}var w=s2(r,0,!1,null,null,!1,!1,"",A4);return r._reactRootContainer=w,r[vi]=w.current,nf(r.nodeType===8?r.parentNode:r),sl(function(){T0(t,w,s,i)}),w}function A0(r,t,s,i,n){var e=s._reactRootContainer;if(e){var p=e;if(typeof n=="function"){var x=n;n=function(){var w=Zd(p);x.call(w)}}T0(t,p,r,n)}else p=$k(s,t,r,n,i);return Zd(p)}C3=function(r){switch(r.tag){case 3:var t=r.stateNode;if(t.current.memoizedState.isDehydrated){var s=Nu(t.pendingLanes);s!==0&&(Ag(t,s|1),Fs(t,gn()),!(wr&6)&&(vc=gn()+500,yo()))}break;case 13:sl(function(){var i=xi(r,1);if(i!==null){var n=gs();_a(i,r,1,n)}}),a2(r,1)}};Cg=function(r){if(r.tag===13){var t=xi(r,134217728);if(t!==null){var s=gs();_a(t,r,134217728,s)}a2(r,134217728)}};k3=function(r){if(r.tag===13){var t=so(r),s=xi(r,t);if(s!==null){var i=gs();_a(s,r,t,i)}a2(r,t)}};F3=function(){return Mr};N3=function(r,t){var s=Mr;try{return Mr=r,t()}finally{Mr=s}};am=function(r,t,s){switch(t){case"input":if(J1(r,s),t=s.name,s.type==="radio"&&t!=null){for(s=r;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<s.length;t++){var i=s[t];if(i!==r&&i.form===r.form){var n=g0(i);if(!n)throw Error(qe(90));o3(i),J1(i,n)}}}break;case"textarea":c3(r,s);break;case"select":t=s.value,t!=null&&sc(r,!!s.multiple,t,!1)}};g3=e2;y3=sl;var Wk={usingClientEntryPoint:!1,Events:[Ff,Xl,g0,p3,m3,e2]},Su={findFiberByHostInstance:Go,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},zk={bundleType:Su.bundleType,version:Su.version,rendererPackageName:Su.rendererPackageName,rendererConfig:Su.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Si.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=b3(r),r===null?null:r.stateNode},findFiberByHostInstance:Su.findFiberByHostInstance||Bk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ad=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ad.isDisabled&&ad.supportsFiber)try{h0=ad.inject(zk),Wa=ad}catch{}}Bs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Wk;Bs.createPortal=function(r,t){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!o2(t))throw Error(qe(200));return Uk(r,t,null,s)};Bs.createRoot=function(r,t){if(!o2(r))throw Error(qe(299));var s=!1,i="",n=J_;return t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(n=t.onRecoverableError)),t=s2(r,1,!1,null,null,s,!1,i,n),r[vi]=t.current,nf(r.nodeType===8?r.parentNode:r),new i2(t)};Bs.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var t=r._reactInternals;if(t===void 0)throw typeof r.render=="function"?Error(qe(188)):(r=Object.keys(r).join(","),Error(qe(268,r)));return r=b3(t),r=r===null?null:r.stateNode,r};Bs.flushSync=function(r){return sl(r)};Bs.hydrate=function(r,t,s){if(!S0(t))throw Error(qe(200));return A0(null,r,t,!0,s)};Bs.hydrateRoot=function(r,t,s){if(!o2(r))throw Error(qe(405));var i=s!=null&&s.hydratedSources||null,n=!1,e="",p=J_;if(s!=null&&(s.unstable_strictMode===!0&&(n=!0),s.identifierPrefix!==void 0&&(e=s.identifierPrefix),s.onRecoverableError!==void 0&&(p=s.onRecoverableError)),t=X_(t,null,r,1,s??null,n,!1,e,p),r[vi]=t.current,nf(r),i)for(r=0;r<i.length;r++)s=i[r],n=s._getVersion,n=n(s._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[s,n]:t.mutableSourceEagerHydrationData.push(s,n);return new E0(t)};Bs.render=function(r,t,s){if(!S0(t))throw Error(qe(200));return A0(null,r,t,!1,s)};Bs.unmountComponentAtNode=function(r){if(!S0(r))throw Error(qe(40));return r._reactRootContainer?(sl(function(){A0(null,null,r,!1,function(){r._reactRootContainer=null,r[vi]=null})}),!0):!1};Bs.unstable_batchedUpdates=e2;Bs.unstable_renderSubtreeIntoContainer=function(r,t,s,i){if(!S0(s))throw Error(qe(200));if(r==null||r._reactInternals===void 0)throw Error(qe(38));return A0(r,t,s,!1,i)};Bs.version="18.3.1-next-f1338f8080-20240426";function Z_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Z_)}catch(r){console.error(r)}}Z_(),Zw.exports=Bs;var Hk=Zw.exports,C4=Hk;H1.createRoot=C4.createRoot,H1.hydrateRoot=C4.hydrateRoot;function Gk({onSelect:r,onSettings:t,onCadets:s,onTrainingSchedule:i,onAttendance:n,onPT:e}){const[p,x]=we.useState("companies");return m.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center px-4 py-8 safe-area-inset",children:m.jsxs("div",{className:"w-full max-w-md",children:[m.jsx("h1",{className:"text-3xl font-bold text-center mb-2 text-gray-900",children:"Bulldog CO Manager"}),m.jsxs("div",{className:"flex border-b border-gray-200 mb-6 overflow-x-auto",children:[m.jsx("button",{onClick:()=>x("companies"),className:`flex-1 min-w-[80px] py-3 text-sm font-medium touch-manipulation ${p==="companies"?"text-blue-600 border-b-2 border-blue-600":"text-gray-600"}`,children:"Companies"}),m.jsx("button",{onClick:()=>{x("cadets"),s()},className:`flex-1 min-w-[80px] py-3 text-sm font-medium touch-manipulation ${p==="cadets"?"text-blue-600 border-b-2 border-blue-600":"text-gray-600"}`,children:"Cadets"}),m.jsx("button",{onClick:()=>{x("training-schedule"),i()},className:`flex-1 min-w-[80px] py-3 text-sm font-medium touch-manipulation ${p==="training-schedule"?"text-blue-600 border-b-2 border-blue-600":"text-gray-600"}`,children:"Staff"}),m.jsx("button",{onClick:()=>{x("settings"),t()},className:`flex-1 min-w-[80px] py-3 text-sm font-medium touch-manipulation ${p==="settings"?"text-blue-600 border-b-2 border-blue-600":"text-gray-600"}`,children:"Settings"})]}),p==="companies"&&m.jsxs("div",{className:"space-y-3",children:[m.jsx("button",{onClick:n,className:"w-full bg-white rounded-lg shadow-sm border border-gray-200 px-6 py-4 text-left hover:bg-gray-50 active:bg-gray-100 transition-colors touch-manipulation",style:{minHeight:"44px"},children:m.jsx("span",{className:"text-lg font-semibold text-gray-900",children:"Attendance"})}),m.jsx("button",{onClick:e,className:"w-full bg-white rounded-lg shadow-sm border border-gray-200 px-6 py-4 text-left hover:bg-gray-50 active:bg-gray-100 transition-colors touch-manipulation",style:{minHeight:"44px"},children:m.jsx("span",{className:"text-lg font-semibold text-gray-900",children:"PT"})})]})]})})}var k4={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eT=function(r){const t=[];let s=0;for(let i=0;i<r.length;i++){let n=r.charCodeAt(i);n<128?t[s++]=n:n<2048?(t[s++]=n>>6|192,t[s++]=n&63|128):(n&64512)===55296&&i+1<r.length&&(r.charCodeAt(i+1)&64512)===56320?(n=65536+((n&1023)<<10)+(r.charCodeAt(++i)&1023),t[s++]=n>>18|240,t[s++]=n>>12&63|128,t[s++]=n>>6&63|128,t[s++]=n&63|128):(t[s++]=n>>12|224,t[s++]=n>>6&63|128,t[s++]=n&63|128)}return t},qk=function(r){const t=[];let s=0,i=0;for(;s<r.length;){const n=r[s++];if(n<128)t[i++]=String.fromCharCode(n);else if(n>191&&n<224){const e=r[s++];t[i++]=String.fromCharCode((n&31)<<6|e&63)}else if(n>239&&n<365){const e=r[s++],p=r[s++],x=r[s++],w=((n&7)<<18|(e&63)<<12|(p&63)<<6|x&63)-65536;t[i++]=String.fromCharCode(55296+(w>>10)),t[i++]=String.fromCharCode(56320+(w&1023))}else{const e=r[s++],p=r[s++];t[i++]=String.fromCharCode((n&15)<<12|(e&63)<<6|p&63)}}return t.join("")},tT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,t){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const s=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let n=0;n<r.length;n+=3){const e=r[n],p=n+1<r.length,x=p?r[n+1]:0,w=n+2<r.length,E=w?r[n+2]:0,N=e>>2,P=(e&3)<<4|x>>4;let R=(x&15)<<2|E>>6,q=E&63;w||(q=64,p||(R=64)),i.push(s[N],s[P],s[R],s[q])}return i.join("")},encodeString(r,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(r):this.encodeByteArray(eT(r),t)},decodeString(r,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(r):qk(this.decodeStringToByteArray(r,t))},decodeStringToByteArray(r,t){this.init_();const s=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let n=0;n<r.length;){const e=s[r.charAt(n++)],x=n<r.length?s[r.charAt(n)]:0;++n;const E=n<r.length?s[r.charAt(n)]:64;++n;const P=n<r.length?s[r.charAt(n)]:64;if(++n,e==null||x==null||E==null||P==null)throw new Kk;const R=e<<2|x>>4;if(i.push(R),E!==64){const q=x<<4&240|E>>2;if(i.push(q),P!==64){const Z=E<<6&192|P;i.push(Z)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class Kk extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Yk=function(r){const t=eT(r);return tT.encodeByteArray(t,!0)},e0=function(r){return Yk(r).replace(/\./g,"")},Qk=function(r){try{return tT.decodeString(r,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xk(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jk=()=>Xk().__FIREBASE_DEFAULTS__,Zk=()=>{if(typeof process>"u"||typeof k4>"u")return;const r=k4.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},eF=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=r&&Qk(r[1]);return t&&JSON.parse(t)},l2=()=>{try{return Jk()||Zk()||eF()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},tF=r=>{var t,s;return(s=(t=l2())===null||t===void 0?void 0:t.emulatorHosts)===null||s===void 0?void 0:s[r]},rF=r=>{const t=tF(r);if(!t)return;const s=t.lastIndexOf(":");if(s<=0||s+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(s+1),10);return t[0]==="["?[t.substring(1,s-1),i]:[t.substring(0,s),i]},rT=()=>{var r;return(r=l2())===null||r===void 0?void 0:r.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nF{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,s)=>{this.resolve=t,this.reject=s})}wrapCallback(t){return(s,i)=>{s?this.reject(s):this.resolve(i),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(s):t(s,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sF(r,t){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const s={alg:"none",type:"JWT"},i=t||"demo-project",n=r.iat||0,e=r.sub||r.user_id;if(!e)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const p=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:n,exp:n+3600,auth_time:n,sub:e,user_id:e,firebase:{sign_in_provider:"custom",identities:{}}},r);return[e0(JSON.stringify(s)),e0(JSON.stringify(p)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aF(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function iF(){var r;const t=(r=l2())===null||r===void 0?void 0:r.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function oF(){return!iF()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function nT(){try{return typeof indexedDB=="object"}catch{return!1}}function sT(){return new Promise((r,t)=>{try{let s=!0;const i="validate-browser-context-for-indexeddb-analytics-module",n=self.indexedDB.open(i);n.onsuccess=()=>{n.result.close(),s||self.indexedDB.deleteDatabase(i),r(!0)},n.onupgradeneeded=()=>{s=!1},n.onerror=()=>{var e;t(((e=n.error)===null||e===void 0?void 0:e.message)||"")}}catch(s){t(s)}})}function lF(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cF="FirebaseError";class pl extends Error{constructor(t,s,i){super(s),this.code=t,this.customData=i,this.name=cF,Object.setPrototypeOf(this,pl.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,C0.prototype.create)}}class C0{constructor(t,s,i){this.service=t,this.serviceName=s,this.errors=i}create(t,...s){const i=s[0]||{},n=`${this.service}/${t}`,e=this.errors[t],p=e?uF(e,i):"Error",x=`${this.serviceName}: ${p} (${n}).`;return new pl(n,x,i)}}function uF(r,t){return r.replace(fF,(s,i)=>{const n=t[i];return n!=null?String(n):`<${i}?>`})}const fF=/\{\$([^}]+)}/g;function Lm(r,t){if(r===t)return!0;const s=Object.keys(r),i=Object.keys(t);for(const n of s){if(!i.includes(n))return!1;const e=r[n],p=t[n];if(F4(e)&&F4(p)){if(!Lm(e,p))return!1}else if(e!==p)return!1}for(const n of i)if(!s.includes(n))return!1;return!0}function F4(r){return r!==null&&typeof r=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ns(r){return r&&r._delegate?r._delegate:r}class wi{constructor(t,s,i){this.name=t,this.instanceFactory=s,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ho="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hF{constructor(t,s){this.name=t,this.container=s,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const s=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(s)){const i=new nF;if(this.instancesDeferred.set(s,i),this.isInitialized(s)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:s});n&&i.resolve(n)}catch{}}return this.instancesDeferred.get(s).promise}getImmediate(t){var s;const i=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),n=(s=t==null?void 0:t.optional)!==null&&s!==void 0?s:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(e){if(n)return null;throw e}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(pF(t))try{this.getOrInitializeService({instanceIdentifier:Ho})}catch{}for(const[s,i]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(s);try{const e=this.getOrInitializeService({instanceIdentifier:n});i.resolve(e)}catch{}}}}clearInstance(t=Ho){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(s=>"INTERNAL"in s).map(s=>s.INTERNAL.delete()),...t.filter(s=>"_delete"in s).map(s=>s._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Ho){return this.instances.has(t)}getOptions(t=Ho){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:s={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const n=this.getOrInitializeService({instanceIdentifier:i,options:s});for(const[e,p]of this.instancesDeferred.entries()){const x=this.normalizeInstanceIdentifier(e);i===x&&p.resolve(n)}return n}onInit(t,s){var i;const n=this.normalizeInstanceIdentifier(s),e=(i=this.onInitCallbacks.get(n))!==null&&i!==void 0?i:new Set;e.add(t),this.onInitCallbacks.set(n,e);const p=this.instances.get(n);return p&&t(p,n),()=>{e.delete(t)}}invokeOnInitCallbacks(t,s){const i=this.onInitCallbacks.get(s);if(i)for(const n of i)try{n(t,s)}catch{}}getOrInitializeService({instanceIdentifier:t,options:s={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:dF(t),options:s}),this.instances.set(t,i),this.instancesOptions.set(t,s),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}return i||null}normalizeInstanceIdentifier(t=Ho){return this.component?this.component.multipleInstances?t:Ho:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function dF(r){return r===Ho?void 0:r}function pF(r){return r.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mF{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const s=this.getProvider(t.name);if(s.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);s.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const s=new hF(t,this);return this.providers.set(t,s),s}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var br;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(br||(br={}));const gF={debug:br.DEBUG,verbose:br.VERBOSE,info:br.INFO,warn:br.WARN,error:br.ERROR,silent:br.SILENT},yF=br.INFO,vF={[br.DEBUG]:"log",[br.VERBOSE]:"log",[br.INFO]:"info",[br.WARN]:"warn",[br.ERROR]:"error"},xF=(r,t,...s)=>{if(t<r.logLevel)return;const i=new Date().toISOString(),n=vF[t];if(n)console[n](`[${i}]  ${r.name}:`,...s);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class aT{constructor(t){this.name=t,this._logLevel=yF,this._logHandler=xF,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in br))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?gF[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,br.DEBUG,...t),this._logHandler(this,br.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,br.VERBOSE,...t),this._logHandler(this,br.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,br.INFO,...t),this._logHandler(this,br.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,br.WARN,...t),this._logHandler(this,br.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,br.ERROR,...t),this._logHandler(this,br.ERROR,...t)}}const bF=(r,t)=>t.some(s=>r instanceof s);let N4,I4;function wF(){return N4||(N4=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function _F(){return I4||(I4=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const iT=new WeakMap,Vm=new WeakMap,oT=new WeakMap,E1=new WeakMap,c2=new WeakMap;function TF(r){const t=new Promise((s,i)=>{const n=()=>{r.removeEventListener("success",e),r.removeEventListener("error",p)},e=()=>{s(mi(r.result)),n()},p=()=>{i(r.error),n()};r.addEventListener("success",e),r.addEventListener("error",p)});return t.then(s=>{s instanceof IDBCursor&&iT.set(s,r)}).catch(()=>{}),c2.set(t,r),t}function EF(r){if(Vm.has(r))return;const t=new Promise((s,i)=>{const n=()=>{r.removeEventListener("complete",e),r.removeEventListener("error",p),r.removeEventListener("abort",p)},e=()=>{s(),n()},p=()=>{i(r.error||new DOMException("AbortError","AbortError")),n()};r.addEventListener("complete",e),r.addEventListener("error",p),r.addEventListener("abort",p)});Vm.set(r,t)}let Um={get(r,t,s){if(r instanceof IDBTransaction){if(t==="done")return Vm.get(r);if(t==="objectStoreNames")return r.objectStoreNames||oT.get(r);if(t==="store")return s.objectStoreNames[1]?void 0:s.objectStore(s.objectStoreNames[0])}return mi(r[t])},set(r,t,s){return r[t]=s,!0},has(r,t){return r instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in r}};function SF(r){Um=r(Um)}function AF(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...s){const i=r.call(S1(this),t,...s);return oT.set(i,t.sort?t.sort():[t]),mi(i)}:_F().includes(r)?function(...t){return r.apply(S1(this),t),mi(iT.get(this))}:function(...t){return mi(r.apply(S1(this),t))}}function CF(r){return typeof r=="function"?AF(r):(r instanceof IDBTransaction&&EF(r),bF(r,wF())?new Proxy(r,Um):r)}function mi(r){if(r instanceof IDBRequest)return TF(r);if(E1.has(r))return E1.get(r);const t=CF(r);return t!==r&&(E1.set(r,t),c2.set(t,r)),t}const S1=r=>c2.get(r);function k0(r,t,{blocked:s,upgrade:i,blocking:n,terminated:e}={}){const p=indexedDB.open(r,t),x=mi(p);return i&&p.addEventListener("upgradeneeded",w=>{i(mi(p.result),w.oldVersion,w.newVersion,mi(p.transaction),w)}),s&&p.addEventListener("blocked",w=>s(w.oldVersion,w.newVersion,w)),x.then(w=>{e&&w.addEventListener("close",()=>e()),n&&w.addEventListener("versionchange",E=>n(E.oldVersion,E.newVersion,E))}).catch(()=>{}),x}function A1(r,{blocked:t}={}){const s=indexedDB.deleteDatabase(r);return t&&s.addEventListener("blocked",i=>t(i.oldVersion,i)),mi(s).then(()=>{})}const kF=["get","getKey","getAll","getAllKeys","count"],FF=["put","add","delete","clear"],C1=new Map;function D4(r,t){if(!(r instanceof IDBDatabase&&!(t in r)&&typeof t=="string"))return;if(C1.get(t))return C1.get(t);const s=t.replace(/FromIndex$/,""),i=t!==s,n=FF.includes(s);if(!(s in(i?IDBIndex:IDBObjectStore).prototype)||!(n||kF.includes(s)))return;const e=async function(p,...x){const w=this.transaction(p,n?"readwrite":"readonly");let E=w.store;return i&&(E=E.index(x.shift())),(await Promise.all([E[s](...x),n&&w.done]))[0]};return C1.set(t,e),e}SF(r=>({...r,get:(t,s,i)=>D4(t,s)||r.get(t,s,i),has:(t,s)=>!!D4(t,s)||r.has(t,s)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NF{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(s=>{if(IF(s)){const i=s.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(s=>s).join(" ")}}function IF(r){const t=r.getComponent();return(t==null?void 0:t.type)==="VERSION"}const Bm="@firebase/app",R4="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _i=new aT("@firebase/app"),DF="@firebase/app-compat",RF="@firebase/analytics-compat",PF="@firebase/analytics",OF="@firebase/app-check-compat",jF="@firebase/app-check",MF="@firebase/auth",LF="@firebase/auth-compat",VF="@firebase/database",UF="@firebase/data-connect",BF="@firebase/database-compat",$F="@firebase/functions",WF="@firebase/functions-compat",zF="@firebase/installations",HF="@firebase/installations-compat",GF="@firebase/messaging",qF="@firebase/messaging-compat",KF="@firebase/performance",YF="@firebase/performance-compat",QF="@firebase/remote-config",XF="@firebase/remote-config-compat",JF="@firebase/storage",ZF="@firebase/storage-compat",eN="@firebase/firestore",tN="@firebase/vertexai-preview",rN="@firebase/firestore-compat",nN="firebase",sN="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $m="[DEFAULT]",aN={[Bm]:"fire-core",[DF]:"fire-core-compat",[PF]:"fire-analytics",[RF]:"fire-analytics-compat",[jF]:"fire-app-check",[OF]:"fire-app-check-compat",[MF]:"fire-auth",[LF]:"fire-auth-compat",[VF]:"fire-rtdb",[UF]:"fire-data-connect",[BF]:"fire-rtdb-compat",[$F]:"fire-fn",[WF]:"fire-fn-compat",[zF]:"fire-iid",[HF]:"fire-iid-compat",[GF]:"fire-fcm",[qF]:"fire-fcm-compat",[KF]:"fire-perf",[YF]:"fire-perf-compat",[QF]:"fire-rc",[XF]:"fire-rc-compat",[JF]:"fire-gcs",[ZF]:"fire-gcs-compat",[eN]:"fire-fst",[rN]:"fire-fst-compat",[tN]:"fire-vertex","fire-js":"fire-js",[nN]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const df=new Map,iN=new Map,Wm=new Map;function P4(r,t){try{r.container.addComponent(t)}catch(s){_i.debug(`Component ${t.name} failed to register with FirebaseApp ${r.name}`,s)}}function uo(r){const t=r.name;if(Wm.has(t))return _i.debug(`There were multiple attempts to register component ${t}.`),!1;Wm.set(t,r);for(const s of df.values())P4(s,r);for(const s of iN.values())P4(s,r);return!0}function F0(r,t){const s=r.container.getProvider("heartbeat").getImmediate({optional:!0});return s&&s.triggerHeartbeat(),r.container.getProvider(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},io=new C0("app","Firebase",oN);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lN{constructor(t,s,i){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},s),this._name=s.name,this._automaticDataCollectionEnabled=s.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new wi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw io.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cN=sN;function lT(r,t={}){let s=r;typeof t!="object"&&(t={name:t});const i=Object.assign({name:$m,automaticDataCollectionEnabled:!1},t),n=i.name;if(typeof n!="string"||!n)throw io.create("bad-app-name",{appName:String(n)});if(s||(s=rT()),!s)throw io.create("no-options");const e=df.get(n);if(e){if(Lm(s,e.options)&&Lm(i,e.config))return e;throw io.create("duplicate-app",{appName:n})}const p=new mF(n);for(const w of Wm.values())p.addComponent(w);const x=new lN(s,i,p);return df.set(n,x),x}function cT(r=$m){const t=df.get(r);if(!t&&r===$m&&rT())return lT();if(!t)throw io.create("no-app",{appName:r});return t}function O4(){return Array.from(df.values())}function Ha(r,t,s){var i;let n=(i=aN[r])!==null&&i!==void 0?i:r;s&&(n+=`-${s}`);const e=n.match(/\s|\//),p=t.match(/\s|\//);if(e||p){const x=[`Unable to register library "${n}" with version "${t}":`];e&&x.push(`library name "${n}" contains illegal characters (whitespace or "/")`),e&&p&&x.push("and"),p&&x.push(`version name "${t}" contains illegal characters (whitespace or "/")`),_i.warn(x.join(" "));return}uo(new wi(`${n}-version`,()=>({library:n,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uN="firebase-heartbeat-database",fN=1,pf="firebase-heartbeat-store";let k1=null;function uT(){return k1||(k1=k0(uN,fN,{upgrade:(r,t)=>{switch(t){case 0:try{r.createObjectStore(pf)}catch(s){console.warn(s)}}}}).catch(r=>{throw io.create("idb-open",{originalErrorMessage:r.message})})),k1}async function hN(r){try{const s=(await uT()).transaction(pf),i=await s.objectStore(pf).get(fT(r));return await s.done,i}catch(t){if(t instanceof pl)_i.warn(t.message);else{const s=io.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});_i.warn(s.message)}}}async function j4(r,t){try{const i=(await uT()).transaction(pf,"readwrite");await i.objectStore(pf).put(t,fT(r)),await i.done}catch(s){if(s instanceof pl)_i.warn(s.message);else{const i=io.create("idb-set",{originalErrorMessage:s==null?void 0:s.message});_i.warn(i.message)}}}function fT(r){return`${r.name}!${r.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dN=1024,pN=30*24*60*60*1e3;class mN{constructor(t){this.container=t,this._heartbeatsCache=null;const s=this.container.getProvider("app").getImmediate();this._storage=new yN(s),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var t,s;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),e=M4();return((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((s=this._heartbeatsCache)===null||s===void 0?void 0:s.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===e||this._heartbeatsCache.heartbeats.some(p=>p.date===e)?void 0:(this._heartbeatsCache.heartbeats.push({date:e,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(p=>{const x=new Date(p.date).valueOf();return Date.now()-x<=pN}),this._storage.overwrite(this._heartbeatsCache))}catch(i){_i.warn(i)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const s=M4(),{heartbeatsToSend:i,unsentEntries:n}=gN(this._heartbeatsCache.heartbeats),e=e0(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=s,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),e}catch(s){return _i.warn(s),""}}}function M4(){return new Date().toISOString().substring(0,10)}function gN(r,t=dN){const s=[];let i=r.slice();for(const n of r){const e=s.find(p=>p.agent===n.agent);if(e){if(e.dates.push(n.date),L4(s)>t){e.dates.pop();break}}else if(s.push({agent:n.agent,dates:[n.date]}),L4(s)>t){s.pop();break}i=i.slice(1)}return{heartbeatsToSend:s,unsentEntries:i}}class yN{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return nT()?sT().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const s=await hN(this.app);return s!=null&&s.heartbeats?s:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var s;if(await this._canUseIndexedDBPromise){const n=await this.read();return j4(this.app,{lastSentHeartbeatDate:(s=t.lastSentHeartbeatDate)!==null&&s!==void 0?s:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var s;if(await this._canUseIndexedDBPromise){const n=await this.read();return j4(this.app,{lastSentHeartbeatDate:(s=t.lastSentHeartbeatDate)!==null&&s!==void 0?s:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}else return}}function L4(r){return e0(JSON.stringify({version:2,heartbeats:r})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vN(r){uo(new wi("platform-logger",t=>new NF(t),"PRIVATE")),uo(new wi("heartbeat",t=>new mN(t),"PRIVATE")),Ha(Bm,R4,r),Ha(Bm,R4,"esm2017"),Ha("fire-js","")}vN("");var V4=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Zo,hT;(function(){var r;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(L,O){function V(){}V.prototype=O.prototype,L.D=O.prototype,L.prototype=new V,L.prototype.constructor=L,L.C=function(W,J,X){for(var K=Array(arguments.length-2),me=2;me<arguments.length;me++)K[me-2]=arguments[me];return O.prototype[J].apply(W,K)}}function s(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(i,s),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function n(L,O,V){V||(V=0);var W=Array(16);if(typeof O=="string")for(var J=0;16>J;++J)W[J]=O.charCodeAt(V++)|O.charCodeAt(V++)<<8|O.charCodeAt(V++)<<16|O.charCodeAt(V++)<<24;else for(J=0;16>J;++J)W[J]=O[V++]|O[V++]<<8|O[V++]<<16|O[V++]<<24;O=L.g[0],V=L.g[1],J=L.g[2];var X=L.g[3],K=O+(X^V&(J^X))+W[0]+3614090360&4294967295;O=V+(K<<7&4294967295|K>>>25),K=X+(J^O&(V^J))+W[1]+3905402710&4294967295,X=O+(K<<12&4294967295|K>>>20),K=J+(V^X&(O^V))+W[2]+606105819&4294967295,J=X+(K<<17&4294967295|K>>>15),K=V+(O^J&(X^O))+W[3]+3250441966&4294967295,V=J+(K<<22&4294967295|K>>>10),K=O+(X^V&(J^X))+W[4]+4118548399&4294967295,O=V+(K<<7&4294967295|K>>>25),K=X+(J^O&(V^J))+W[5]+1200080426&4294967295,X=O+(K<<12&4294967295|K>>>20),K=J+(V^X&(O^V))+W[6]+2821735955&4294967295,J=X+(K<<17&4294967295|K>>>15),K=V+(O^J&(X^O))+W[7]+4249261313&4294967295,V=J+(K<<22&4294967295|K>>>10),K=O+(X^V&(J^X))+W[8]+1770035416&4294967295,O=V+(K<<7&4294967295|K>>>25),K=X+(J^O&(V^J))+W[9]+2336552879&4294967295,X=O+(K<<12&4294967295|K>>>20),K=J+(V^X&(O^V))+W[10]+4294925233&4294967295,J=X+(K<<17&4294967295|K>>>15),K=V+(O^J&(X^O))+W[11]+2304563134&4294967295,V=J+(K<<22&4294967295|K>>>10),K=O+(X^V&(J^X))+W[12]+1804603682&4294967295,O=V+(K<<7&4294967295|K>>>25),K=X+(J^O&(V^J))+W[13]+4254626195&4294967295,X=O+(K<<12&4294967295|K>>>20),K=J+(V^X&(O^V))+W[14]+2792965006&4294967295,J=X+(K<<17&4294967295|K>>>15),K=V+(O^J&(X^O))+W[15]+1236535329&4294967295,V=J+(K<<22&4294967295|K>>>10),K=O+(J^X&(V^J))+W[1]+4129170786&4294967295,O=V+(K<<5&4294967295|K>>>27),K=X+(V^J&(O^V))+W[6]+3225465664&4294967295,X=O+(K<<9&4294967295|K>>>23),K=J+(O^V&(X^O))+W[11]+643717713&4294967295,J=X+(K<<14&4294967295|K>>>18),K=V+(X^O&(J^X))+W[0]+3921069994&4294967295,V=J+(K<<20&4294967295|K>>>12),K=O+(J^X&(V^J))+W[5]+3593408605&4294967295,O=V+(K<<5&4294967295|K>>>27),K=X+(V^J&(O^V))+W[10]+38016083&4294967295,X=O+(K<<9&4294967295|K>>>23),K=J+(O^V&(X^O))+W[15]+3634488961&4294967295,J=X+(K<<14&4294967295|K>>>18),K=V+(X^O&(J^X))+W[4]+3889429448&4294967295,V=J+(K<<20&4294967295|K>>>12),K=O+(J^X&(V^J))+W[9]+568446438&4294967295,O=V+(K<<5&4294967295|K>>>27),K=X+(V^J&(O^V))+W[14]+3275163606&4294967295,X=O+(K<<9&4294967295|K>>>23),K=J+(O^V&(X^O))+W[3]+4107603335&4294967295,J=X+(K<<14&4294967295|K>>>18),K=V+(X^O&(J^X))+W[8]+1163531501&4294967295,V=J+(K<<20&4294967295|K>>>12),K=O+(J^X&(V^J))+W[13]+2850285829&4294967295,O=V+(K<<5&4294967295|K>>>27),K=X+(V^J&(O^V))+W[2]+4243563512&4294967295,X=O+(K<<9&4294967295|K>>>23),K=J+(O^V&(X^O))+W[7]+1735328473&4294967295,J=X+(K<<14&4294967295|K>>>18),K=V+(X^O&(J^X))+W[12]+2368359562&4294967295,V=J+(K<<20&4294967295|K>>>12),K=O+(V^J^X)+W[5]+4294588738&4294967295,O=V+(K<<4&4294967295|K>>>28),K=X+(O^V^J)+W[8]+2272392833&4294967295,X=O+(K<<11&4294967295|K>>>21),K=J+(X^O^V)+W[11]+1839030562&4294967295,J=X+(K<<16&4294967295|K>>>16),K=V+(J^X^O)+W[14]+4259657740&4294967295,V=J+(K<<23&4294967295|K>>>9),K=O+(V^J^X)+W[1]+2763975236&4294967295,O=V+(K<<4&4294967295|K>>>28),K=X+(O^V^J)+W[4]+1272893353&4294967295,X=O+(K<<11&4294967295|K>>>21),K=J+(X^O^V)+W[7]+4139469664&4294967295,J=X+(K<<16&4294967295|K>>>16),K=V+(J^X^O)+W[10]+3200236656&4294967295,V=J+(K<<23&4294967295|K>>>9),K=O+(V^J^X)+W[13]+681279174&4294967295,O=V+(K<<4&4294967295|K>>>28),K=X+(O^V^J)+W[0]+3936430074&4294967295,X=O+(K<<11&4294967295|K>>>21),K=J+(X^O^V)+W[3]+3572445317&4294967295,J=X+(K<<16&4294967295|K>>>16),K=V+(J^X^O)+W[6]+76029189&4294967295,V=J+(K<<23&4294967295|K>>>9),K=O+(V^J^X)+W[9]+3654602809&4294967295,O=V+(K<<4&4294967295|K>>>28),K=X+(O^V^J)+W[12]+3873151461&4294967295,X=O+(K<<11&4294967295|K>>>21),K=J+(X^O^V)+W[15]+530742520&4294967295,J=X+(K<<16&4294967295|K>>>16),K=V+(J^X^O)+W[2]+3299628645&4294967295,V=J+(K<<23&4294967295|K>>>9),K=O+(J^(V|~X))+W[0]+4096336452&4294967295,O=V+(K<<6&4294967295|K>>>26),K=X+(V^(O|~J))+W[7]+1126891415&4294967295,X=O+(K<<10&4294967295|K>>>22),K=J+(O^(X|~V))+W[14]+2878612391&4294967295,J=X+(K<<15&4294967295|K>>>17),K=V+(X^(J|~O))+W[5]+4237533241&4294967295,V=J+(K<<21&4294967295|K>>>11),K=O+(J^(V|~X))+W[12]+1700485571&4294967295,O=V+(K<<6&4294967295|K>>>26),K=X+(V^(O|~J))+W[3]+2399980690&4294967295,X=O+(K<<10&4294967295|K>>>22),K=J+(O^(X|~V))+W[10]+4293915773&4294967295,J=X+(K<<15&4294967295|K>>>17),K=V+(X^(J|~O))+W[1]+2240044497&4294967295,V=J+(K<<21&4294967295|K>>>11),K=O+(J^(V|~X))+W[8]+1873313359&4294967295,O=V+(K<<6&4294967295|K>>>26),K=X+(V^(O|~J))+W[15]+4264355552&4294967295,X=O+(K<<10&4294967295|K>>>22),K=J+(O^(X|~V))+W[6]+2734768916&4294967295,J=X+(K<<15&4294967295|K>>>17),K=V+(X^(J|~O))+W[13]+1309151649&4294967295,V=J+(K<<21&4294967295|K>>>11),K=O+(J^(V|~X))+W[4]+4149444226&4294967295,O=V+(K<<6&4294967295|K>>>26),K=X+(V^(O|~J))+W[11]+3174756917&4294967295,X=O+(K<<10&4294967295|K>>>22),K=J+(O^(X|~V))+W[2]+718787259&4294967295,J=X+(K<<15&4294967295|K>>>17),K=V+(X^(J|~O))+W[9]+3951481745&4294967295,L.g[0]=L.g[0]+O&4294967295,L.g[1]=L.g[1]+(J+(K<<21&4294967295|K>>>11))&4294967295,L.g[2]=L.g[2]+J&4294967295,L.g[3]=L.g[3]+X&4294967295}i.prototype.u=function(L,O){O===void 0&&(O=L.length);for(var V=O-this.blockSize,W=this.B,J=this.h,X=0;X<O;){if(J==0)for(;X<=V;)n(this,L,X),X+=this.blockSize;if(typeof L=="string"){for(;X<O;)if(W[J++]=L.charCodeAt(X++),J==this.blockSize){n(this,W),J=0;break}}else for(;X<O;)if(W[J++]=L[X++],J==this.blockSize){n(this,W),J=0;break}}this.h=J,this.o+=O},i.prototype.v=function(){var L=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);L[0]=128;for(var O=1;O<L.length-8;++O)L[O]=0;var V=8*this.o;for(O=L.length-8;O<L.length;++O)L[O]=V&255,V/=256;for(this.u(L),L=Array(16),O=V=0;4>O;++O)for(var W=0;32>W;W+=8)L[V++]=this.g[O]>>>W&255;return L};function e(L,O){var V=x;return Object.prototype.hasOwnProperty.call(V,L)?V[L]:V[L]=O(L)}function p(L,O){this.h=O;for(var V=[],W=!0,J=L.length-1;0<=J;J--){var X=L[J]|0;W&&X==O||(V[J]=X,W=!1)}this.g=V}var x={};function w(L){return-128<=L&&128>L?e(L,function(O){return new p([O|0],0>O?-1:0)}):new p([L|0],0>L?-1:0)}function E(L){if(isNaN(L)||!isFinite(L))return P;if(0>L)return fe(E(-L));for(var O=[],V=1,W=0;L>=V;W++)O[W]=L/V|0,V*=4294967296;return new p(O,0)}function N(L,O){if(L.length==0)throw Error("number format error: empty string");if(O=O||10,2>O||36<O)throw Error("radix out of range: "+O);if(L.charAt(0)=="-")return fe(N(L.substring(1),O));if(0<=L.indexOf("-"))throw Error('number format error: interior "-" character');for(var V=E(Math.pow(O,8)),W=P,J=0;J<L.length;J+=8){var X=Math.min(8,L.length-J),K=parseInt(L.substring(J,J+X),O);8>X?(X=E(Math.pow(O,X)),W=W.j(X).add(E(K))):(W=W.j(V),W=W.add(E(K)))}return W}var P=w(0),R=w(1),q=w(16777216);r=p.prototype,r.m=function(){if(ne(this))return-fe(this).m();for(var L=0,O=1,V=0;V<this.g.length;V++){var W=this.i(V);L+=(0<=W?W:4294967296+W)*O,O*=4294967296}return L},r.toString=function(L){if(L=L||10,2>L||36<L)throw Error("radix out of range: "+L);if(Z(this))return"0";if(ne(this))return"-"+fe(this).toString(L);for(var O=E(Math.pow(L,6)),V=this,W="";;){var J=ee(V,O).g;V=G(V,J.j(O));var X=((0<V.g.length?V.g[0]:V.h)>>>0).toString(L);if(V=J,Z(V))return X+W;for(;6>X.length;)X="0"+X;W=X+W}},r.i=function(L){return 0>L?0:L<this.g.length?this.g[L]:this.h};function Z(L){if(L.h!=0)return!1;for(var O=0;O<L.g.length;O++)if(L.g[O]!=0)return!1;return!0}function ne(L){return L.h==-1}r.l=function(L){return L=G(this,L),ne(L)?-1:Z(L)?0:1};function fe(L){for(var O=L.g.length,V=[],W=0;W<O;W++)V[W]=~L.g[W];return new p(V,~L.h).add(R)}r.abs=function(){return ne(this)?fe(this):this},r.add=function(L){for(var O=Math.max(this.g.length,L.g.length),V=[],W=0,J=0;J<=O;J++){var X=W+(this.i(J)&65535)+(L.i(J)&65535),K=(X>>>16)+(this.i(J)>>>16)+(L.i(J)>>>16);W=K>>>16,X&=65535,K&=65535,V[J]=K<<16|X}return new p(V,V[V.length-1]&-2147483648?-1:0)};function G(L,O){return L.add(fe(O))}r.j=function(L){if(Z(this)||Z(L))return P;if(ne(this))return ne(L)?fe(this).j(fe(L)):fe(fe(this).j(L));if(ne(L))return fe(this.j(fe(L)));if(0>this.l(q)&&0>L.l(q))return E(this.m()*L.m());for(var O=this.g.length+L.g.length,V=[],W=0;W<2*O;W++)V[W]=0;for(W=0;W<this.g.length;W++)for(var J=0;J<L.g.length;J++){var X=this.i(W)>>>16,K=this.i(W)&65535,me=L.i(J)>>>16,He=L.i(J)&65535;V[2*W+2*J]+=K*He,U(V,2*W+2*J),V[2*W+2*J+1]+=X*He,U(V,2*W+2*J+1),V[2*W+2*J+1]+=K*me,U(V,2*W+2*J+1),V[2*W+2*J+2]+=X*me,U(V,2*W+2*J+2)}for(W=0;W<O;W++)V[W]=V[2*W+1]<<16|V[2*W];for(W=O;W<2*O;W++)V[W]=0;return new p(V,0)};function U(L,O){for(;(L[O]&65535)!=L[O];)L[O+1]+=L[O]>>>16,L[O]&=65535,O++}function H(L,O){this.g=L,this.h=O}function ee(L,O){if(Z(O))throw Error("division by zero");if(Z(L))return new H(P,P);if(ne(L))return O=ee(fe(L),O),new H(fe(O.g),fe(O.h));if(ne(O))return O=ee(L,fe(O)),new H(fe(O.g),O.h);if(30<L.g.length){if(ne(L)||ne(O))throw Error("slowDivide_ only works with positive integers.");for(var V=R,W=O;0>=W.l(L);)V=te(V),W=te(W);var J=ue(V,1),X=ue(W,1);for(W=ue(W,2),V=ue(V,2);!Z(W);){var K=X.add(W);0>=K.l(L)&&(J=J.add(V),X=K),W=ue(W,1),V=ue(V,1)}return O=G(L,J.j(O)),new H(J,O)}for(J=P;0<=L.l(O);){for(V=Math.max(1,Math.floor(L.m()/O.m())),W=Math.ceil(Math.log(V)/Math.LN2),W=48>=W?1:Math.pow(2,W-48),X=E(V),K=X.j(O);ne(K)||0<K.l(L);)V-=W,X=E(V),K=X.j(O);Z(X)&&(X=R),J=J.add(X),L=G(L,K)}return new H(J,L)}r.A=function(L){return ee(this,L).h},r.and=function(L){for(var O=Math.max(this.g.length,L.g.length),V=[],W=0;W<O;W++)V[W]=this.i(W)&L.i(W);return new p(V,this.h&L.h)},r.or=function(L){for(var O=Math.max(this.g.length,L.g.length),V=[],W=0;W<O;W++)V[W]=this.i(W)|L.i(W);return new p(V,this.h|L.h)},r.xor=function(L){for(var O=Math.max(this.g.length,L.g.length),V=[],W=0;W<O;W++)V[W]=this.i(W)^L.i(W);return new p(V,this.h^L.h)};function te(L){for(var O=L.g.length+1,V=[],W=0;W<O;W++)V[W]=L.i(W)<<1|L.i(W-1)>>>31;return new p(V,L.h)}function ue(L,O){var V=O>>5;O%=32;for(var W=L.g.length-V,J=[],X=0;X<W;X++)J[X]=0<O?L.i(X+V)>>>O|L.i(X+V+1)<<32-O:L.i(X+V);return new p(J,L.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,hT=i,p.prototype.add=p.prototype.add,p.prototype.multiply=p.prototype.j,p.prototype.modulo=p.prototype.A,p.prototype.compare=p.prototype.l,p.prototype.toNumber=p.prototype.m,p.prototype.toString=p.prototype.toString,p.prototype.getBits=p.prototype.i,p.fromNumber=E,p.fromString=N,Zo=p}).apply(typeof V4<"u"?V4:typeof self<"u"?self:typeof window<"u"?window:{});var id=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var dT,Du,pT,Td,zm,mT,gT,yT;(function(){var r,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(g,A,C){return g==Array.prototype||g==Object.prototype||(g[A]=C.value),g};function s(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof id=="object"&&id];for(var A=0;A<g.length;++A){var C=g[A];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var i=s(this);function n(g,A){if(A)e:{var C=i;g=g.split(".");for(var Y=0;Y<g.length-1;Y++){var pe=g[Y];if(!(pe in C))break e;C=C[pe]}g=g[g.length-1],Y=C[g],A=A(Y),A!=Y&&A!=null&&t(C,g,{configurable:!0,writable:!0,value:A})}}function e(g,A){g instanceof String&&(g+="");var C=0,Y=!1,pe={next:function(){if(!Y&&C<g.length){var Ee=C++;return{value:A(Ee,g[Ee]),done:!1}}return Y=!0,{done:!0,value:void 0}}};return pe[Symbol.iterator]=function(){return pe},pe}n("Array.prototype.values",function(g){return g||function(){return e(this,function(A,C){return C})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var p=p||{},x=this||self;function w(g){var A=typeof g;return A=A!="object"?A:g?Array.isArray(g)?"array":A:"null",A=="array"||A=="object"&&typeof g.length=="number"}function E(g){var A=typeof g;return A=="object"&&g!=null||A=="function"}function N(g,A,C){return g.call.apply(g.bind,arguments)}function P(g,A,C){if(!g)throw Error();if(2<arguments.length){var Y=Array.prototype.slice.call(arguments,2);return function(){var pe=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(pe,Y),g.apply(A,pe)}}return function(){return g.apply(A,arguments)}}function R(g,A,C){return R=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?N:P,R.apply(null,arguments)}function q(g,A){var C=Array.prototype.slice.call(arguments,1);return function(){var Y=C.slice();return Y.push.apply(Y,arguments),g.apply(this,Y)}}function Z(g,A){function C(){}C.prototype=A.prototype,g.aa=A.prototype,g.prototype=new C,g.prototype.constructor=g,g.Qb=function(Y,pe,Ee){for(var tt=Array(arguments.length-2),Fr=2;Fr<arguments.length;Fr++)tt[Fr-2]=arguments[Fr];return A.prototype[pe].apply(Y,tt)}}function ne(g){const A=g.length;if(0<A){const C=Array(A);for(let Y=0;Y<A;Y++)C[Y]=g[Y];return C}return[]}function fe(g,A){for(let C=1;C<arguments.length;C++){const Y=arguments[C];if(w(Y)){const pe=g.length||0,Ee=Y.length||0;g.length=pe+Ee;for(let tt=0;tt<Ee;tt++)g[pe+tt]=Y[tt]}else g.push(Y)}}class G{constructor(A,C){this.i=A,this.j=C,this.h=0,this.g=null}get(){let A;return 0<this.h?(this.h--,A=this.g,this.g=A.next,A.next=null):A=this.i(),A}}function U(g){return/^[\s\xa0]*$/.test(g)}function H(){var g=x.navigator;return g&&(g=g.userAgent)?g:""}function ee(g){return ee[" "](g),g}ee[" "]=function(){};var te=H().indexOf("Gecko")!=-1&&!(H().toLowerCase().indexOf("webkit")!=-1&&H().indexOf("Edge")==-1)&&!(H().indexOf("Trident")!=-1||H().indexOf("MSIE")!=-1)&&H().indexOf("Edge")==-1;function ue(g,A,C){for(const Y in g)A.call(C,g[Y],Y,g)}function L(g,A){for(const C in g)A.call(void 0,g[C],C,g)}function O(g){const A={};for(const C in g)A[C]=g[C];return A}const V="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function W(g,A){let C,Y;for(let pe=1;pe<arguments.length;pe++){Y=arguments[pe];for(C in Y)g[C]=Y[C];for(let Ee=0;Ee<V.length;Ee++)C=V[Ee],Object.prototype.hasOwnProperty.call(Y,C)&&(g[C]=Y[C])}}function J(g){var A=1;g=g.split(":");const C=[];for(;0<A&&g.length;)C.push(g.shift()),A--;return g.length&&C.push(g.join(":")),C}function X(g){x.setTimeout(()=>{throw g},0)}function K(){var g=Ve;let A=null;return g.g&&(A=g.g,g.g=g.g.next,g.g||(g.h=null),A.next=null),A}class me{constructor(){this.h=this.g=null}add(A,C){const Y=He.get();Y.set(A,C),this.h?this.h.next=Y:this.g=Y,this.h=Y}}var He=new G(()=>new fr,g=>g.reset());class fr{constructor(){this.next=this.g=this.h=null}set(A,C){this.h=A,this.g=C,this.next=null}reset(){this.next=this.g=this.h=null}}let at,$e=!1,Ve=new me,ye=()=>{const g=x.Promise.resolve(void 0);at=()=>{g.then(oe)}};var oe=()=>{for(var g;g=K();){try{g.h.call(g.g)}catch(C){X(C)}var A=He;A.j(g),100>A.h&&(A.h++,g.next=A.g,A.g=g)}$e=!1};function Fe(){this.s=this.s,this.C=this.C}Fe.prototype.s=!1,Fe.prototype.ma=function(){this.s||(this.s=!0,this.N())},Fe.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Oe(g,A){this.type=g,this.g=this.target=A,this.defaultPrevented=!1}Oe.prototype.h=function(){this.defaultPrevented=!0};var Re=function(){if(!x.addEventListener||!Object.defineProperty)return!1;var g=!1,A=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const C=()=>{};x.addEventListener("test",C,A),x.removeEventListener("test",C,A)}catch{}return g}();function de(g,A){if(Oe.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g){var C=this.type=g.type,Y=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;if(this.target=g.target||g.srcElement,this.g=A,A=g.relatedTarget){if(te){e:{try{ee(A.nodeName);var pe=!0;break e}catch{}pe=!1}pe||(A=null)}}else C=="mouseover"?A=g.fromElement:C=="mouseout"&&(A=g.toElement);this.relatedTarget=A,Y?(this.clientX=Y.clientX!==void 0?Y.clientX:Y.pageX,this.clientY=Y.clientY!==void 0?Y.clientY:Y.pageY,this.screenX=Y.screenX||0,this.screenY=Y.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=typeof g.pointerType=="string"?g.pointerType:Ce[g.pointerType]||"",this.state=g.state,this.i=g,g.defaultPrevented&&de.aa.h.call(this)}}Z(de,Oe);var Ce={2:"touch",3:"pen",4:"mouse"};de.prototype.h=function(){de.aa.h.call(this);var g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var ce="closure_listenable_"+(1e6*Math.random()|0),Et=0;function Xe(g,A,C,Y,pe){this.listener=g,this.proxy=null,this.src=A,this.type=C,this.capture=!!Y,this.ha=pe,this.key=++Et,this.da=this.fa=!1}function zt(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function or(g){this.src=g,this.g={},this.h=0}or.prototype.add=function(g,A,C,Y,pe){var Ee=g.toString();g=this.g[Ee],g||(g=this.g[Ee]=[],this.h++);var tt=Ct(g,A,Y,pe);return-1<tt?(A=g[tt],C||(A.fa=!1)):(A=new Xe(A,this.src,Ee,!!Y,pe),A.fa=C,g.push(A)),A};function vt(g,A){var C=A.type;if(C in g.g){var Y=g.g[C],pe=Array.prototype.indexOf.call(Y,A,void 0),Ee;(Ee=0<=pe)&&Array.prototype.splice.call(Y,pe,1),Ee&&(zt(A),g.g[C].length==0&&(delete g.g[C],g.h--))}}function Ct(g,A,C,Y){for(var pe=0;pe<g.length;++pe){var Ee=g[pe];if(!Ee.da&&Ee.listener==A&&Ee.capture==!!C&&Ee.ha==Y)return pe}return-1}var pt="closure_lm_"+(1e6*Math.random()|0),Rr={};function er(g,A,C,Y,pe){if(Array.isArray(A)){for(var Ee=0;Ee<A.length;Ee++)er(g,A[Ee],C,Y,pe);return null}return C=Xr(C),g&&g[ce]?g.K(A,C,E(Y)?!!Y.capture:!1,pe):Pr(g,A,C,!1,Y,pe)}function Pr(g,A,C,Y,pe,Ee){if(!A)throw Error("Invalid event type");var tt=E(pe)?!!pe.capture:!!pe,Fr=lr(g);if(Fr||(g[pt]=Fr=new or(g)),C=Fr.add(A,C,Y,tt,Ee),C.proxy)return C;if(Y=Ke(),C.proxy=Y,Y.src=g,Y.listener=C,g.addEventListener)Re||(pe=tt),pe===void 0&&(pe=!1),g.addEventListener(A.toString(),Y,pe);else if(g.attachEvent)g.attachEvent(Vt(A.toString()),Y);else if(g.addListener&&g.removeListener)g.addListener(Y);else throw Error("addEventListener and attachEvent are unavailable.");return C}function Ke(){function g(C){return A.call(g.src,g.listener,C)}const A=Qt;return g}function jt(g,A,C,Y,pe){if(Array.isArray(A))for(var Ee=0;Ee<A.length;Ee++)jt(g,A[Ee],C,Y,pe);else Y=E(Y)?!!Y.capture:!!Y,C=Xr(C),g&&g[ce]?(g=g.i,A=String(A).toString(),A in g.g&&(Ee=g.g[A],C=Ct(Ee,C,Y,pe),-1<C&&(zt(Ee[C]),Array.prototype.splice.call(Ee,C,1),Ee.length==0&&(delete g.g[A],g.h--)))):g&&(g=lr(g))&&(A=g.g[A.toString()],g=-1,A&&(g=Ct(A,C,Y,pe)),(C=-1<g?A[g]:null)&&mt(C))}function mt(g){if(typeof g!="number"&&g&&!g.da){var A=g.src;if(A&&A[ce])vt(A.i,g);else{var C=g.type,Y=g.proxy;A.removeEventListener?A.removeEventListener(C,Y,g.capture):A.detachEvent?A.detachEvent(Vt(C),Y):A.addListener&&A.removeListener&&A.removeListener(Y),(C=lr(A))?(vt(C,g),C.h==0&&(C.src=null,A[pt]=null)):zt(g)}}}function Vt(g){return g in Rr?Rr[g]:Rr[g]="on"+g}function Qt(g,A){if(g.da)g=!0;else{A=new de(A,this);var C=g.listener,Y=g.ha||g.src;g.fa&&mt(g),g=C.call(Y,A)}return g}function lr(g){return g=g[pt],g instanceof or?g:null}var hn="__closure_events_fn_"+(1e9*Math.random()>>>0);function Xr(g){return typeof g=="function"?g:(g[hn]||(g[hn]=function(A){return g.handleEvent(A)}),g[hn])}function _r(){Fe.call(this),this.i=new or(this),this.M=this,this.F=null}Z(_r,Fe),_r.prototype[ce]=!0,_r.prototype.removeEventListener=function(g,A,C,Y){jt(this,g,A,C,Y)};function Or(g,A){var C,Y=g.F;if(Y)for(C=[];Y;Y=Y.F)C.push(Y);if(g=g.M,Y=A.type||A,typeof A=="string")A=new Oe(A,g);else if(A instanceof Oe)A.target=A.target||g;else{var pe=A;A=new Oe(Y,g),W(A,pe)}if(pe=!0,C)for(var Ee=C.length-1;0<=Ee;Ee--){var tt=A.g=C[Ee];pe=Vn(tt,Y,!0,A)&&pe}if(tt=A.g=g,pe=Vn(tt,Y,!0,A)&&pe,pe=Vn(tt,Y,!1,A)&&pe,C)for(Ee=0;Ee<C.length;Ee++)tt=A.g=C[Ee],pe=Vn(tt,Y,!1,A)&&pe}_r.prototype.N=function(){if(_r.aa.N.call(this),this.i){var g=this.i,A;for(A in g.g){for(var C=g.g[A],Y=0;Y<C.length;Y++)zt(C[Y]);delete g.g[A],g.h--}}this.F=null},_r.prototype.K=function(g,A,C,Y){return this.i.add(String(g),A,!1,C,Y)},_r.prototype.L=function(g,A,C,Y){return this.i.add(String(g),A,!0,C,Y)};function Vn(g,A,C,Y){if(A=g.i.g[String(A)],!A)return!0;A=A.concat();for(var pe=!0,Ee=0;Ee<A.length;++Ee){var tt=A[Ee];if(tt&&!tt.da&&tt.capture==C){var Fr=tt.listener,tr=tt.ha||tt.src;tt.fa&&vt(g.i,tt),pe=Fr.call(tr,Y)!==!1&&pe}}return pe&&!Y.defaultPrevented}function Ai(g,A,C){if(typeof g=="function")C&&(g=R(g,C));else if(g&&typeof g.handleEvent=="function")g=R(g.handleEvent,g);else throw Error("Invalid listener argument");return 2147483647<Number(A)?-1:x.setTimeout(g,A||0)}function Is(g){g.g=Ai(()=>{g.g=null,g.i&&(g.i=!1,Is(g))},g.l);const A=g.h;g.h=null,g.m.apply(null,A)}class vl extends Fe{constructor(A,C){super(),this.m=A,this.l=C,this.h=null,this.i=!1,this.g=null}j(A){this.h=arguments,this.g?this.i=!0:Is(this)}N(){super.N(),this.g&&(x.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function fa(g){Fe.call(this),this.h=g,this.g={}}Z(fa,Fe);var Ci=[];function Ne(g){ue(g.g,function(A,C){this.g.hasOwnProperty(C)&&mt(A)},g),g.g={}}fa.prototype.N=function(){fa.aa.N.call(this),Ne(this)},fa.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Rt=x.JSON.stringify,Vr=x.JSON.parse,Ds=class{stringify(g){return x.JSON.stringify(g,void 0)}parse(g){return x.JSON.parse(g,void 0)}};function Rs(){}Rs.prototype.h=null;function Qa(g){return g.h||(g.h=g.i())}function Wf(){}var ki={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ws(){Oe.call(this,"d")}Z(Ws,Oe);function Oc(){Oe.call(this,"c")}Z(Oc,Oe);var wt={},zf=null;function Aa(){return zf=zf||new _r}wt.La="serverreachability";function Gr(g){Oe.call(this,wt.La,g)}Z(Gr,Oe);function Fi(g){const A=Aa();Or(A,new Gr(A))}wt.STAT_EVENT="statevent";function wo(g,A){Oe.call(this,wt.STAT_EVENT,g),this.stat=A}Z(wo,Oe);function yn(g){const A=Aa();Or(A,new wo(A,g))}wt.Ma="timingevent";function _o(g,A){Oe.call(this,wt.Ma,g),this.size=A}Z(_o,Oe);function qr(g,A){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return x.setTimeout(function(){g()},A)}function Ca(){this.g=!0}Ca.prototype.xa=function(){this.g=!1};function Q0(g,A,C,Y,pe,Ee){g.info(function(){if(g.g)if(Ee)for(var tt="",Fr=Ee.split("&"),tr=0;tr<Fr.length;tr++){var hr=Fr[tr].split("=");if(1<hr.length){var Yt=hr[0];hr=hr[1];var rr=Yt.split("_");tt=2<=rr.length&&rr[1]=="type"?tt+(Yt+"="+hr+"&"):tt+(Yt+"=redacted&")}}else tt=null;else tt=Ee;return"XMLHTTP REQ ("+Y+") [attempt "+pe+"]: "+A+`
`+C+`
`+tt})}function Hf(g,A,C,Y,pe,Ee,tt){g.info(function(){return"XMLHTTP RESP ("+Y+") [ attempt "+pe+"]: "+A+`
`+C+`
`+Ee+" "+tt})}function ha(g,A,C,Y){g.info(function(){return"XMLHTTP TEXT ("+A+"): "+Gf(g,C)+(Y?" "+Y:"")})}function xl(g,A){g.info(function(){return"TIMEOUT: "+A})}Ca.prototype.info=function(){};function Gf(g,A){if(!g.g)return A;if(!A)return null;try{var C=JSON.parse(A);if(C){for(g=0;g<C.length;g++)if(Array.isArray(C[g])){var Y=C[g];if(!(2>Y.length)){var pe=Y[1];if(Array.isArray(pe)&&!(1>pe.length)){var Ee=pe[0];if(Ee!="noop"&&Ee!="stop"&&Ee!="close")for(var tt=1;tt<pe.length;tt++)pe[tt]=""}}}}return Rt(C)}catch{return A}}var bl={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ur={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},da;function Tr(){}Z(Tr,Rs),Tr.prototype.g=function(){return new XMLHttpRequest},Tr.prototype.i=function(){return{}},da=new Tr;function Cr(g,A,C,Y){this.j=g,this.i=A,this.l=C,this.R=Y||1,this.U=new fa(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new _s}function _s(){this.i=null,this.g="",this.h=!1}var qf={},ka={};function wl(g,A,C){g.L=1,g.v=To(qt(A)),g.m=C,g.P=!0,Kf(g,null)}function Kf(g,A){g.F=Date.now(),Un(g),g.A=qt(g.v);var C=g.A,Y=g.R;Array.isArray(Y)||(Y=[String(Y)]),Os(C.i,"t",Y),g.C=0,C=g.j.J,g.h=new _s,g.g=ch(g.j,C?A:null,!g.m),0<g.O&&(g.M=new vl(R(g.Y,g,g.g),g.O)),A=g.U,C=g.g,Y=g.ca;var pe="readystatechange";Array.isArray(pe)||(pe&&(Ci[0]=pe.toString()),pe=Ci);for(var Ee=0;Ee<pe.length;Ee++){var tt=er(C,pe[Ee],Y||A.handleEvent,!1,A.h||A);if(!tt)break;A.g[tt.key]=tt}A=g.H?O(g.H):{},g.m?(g.u||(g.u="POST"),A["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.A,g.u,g.m,A)):(g.u="GET",g.g.ea(g.A,g.u,null,A)),Fi(),Q0(g.i,g.u,g.A,g.l,g.R,g.m)}Cr.prototype.ca=function(g){g=g.target;const A=this.M;A&&Gs(g)==3?A.j():this.Y(g)},Cr.prototype.Y=function(g){try{if(g==this.g)e:{const rr=Gs(this.g);var A=this.g.Ba();const Pt=this.g.Z();if(!(3>rr)&&(rr!=3||this.g&&(this.h.h||this.g.oa()||qc(this.g)))){this.J||rr!=4||A==7||(A==8||0>=Pt?Fi(3):Fi(2)),Jr(this);var C=this.g.Z();this.X=C;t:if(jc(this)){var Y=qc(this.g);g="";var pe=Y.length,Ee=Gs(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Fa(this),kn(this);var tt="";break t}this.h.i=new x.TextDecoder}for(A=0;A<pe;A++)this.h.h=!0,g+=this.h.i.decode(Y[A],{stream:!(Ee&&A==pe-1)});Y.length=0,this.h.g+=g,this.C=0,tt=this.h.g}else tt=this.g.oa();if(this.o=C==200,Hf(this.i,this.u,this.A,this.l,this.R,rr,C),this.o){if(this.T&&!this.K){t:{if(this.g){var Fr,tr=this.g;if((Fr=tr.g?tr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!U(Fr)){var hr=Fr;break t}}hr=null}if(C=hr)ha(this.i,this.l,C,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Wt(this,C);else{this.o=!1,this.s=3,yn(12),Fa(this),kn(this);break e}}if(this.P){C=!0;let Wr;for(;!this.J&&this.C<tt.length;)if(Wr=Yf(this,tt),Wr==ka){rr==4&&(this.s=4,yn(14),C=!1),ha(this.i,this.l,null,"[Incomplete Response]");break}else if(Wr==qf){this.s=4,yn(15),ha(this.i,this.l,tt,"[Invalid Chunk]"),C=!1;break}else ha(this.i,this.l,Wr,null),Wt(this,Wr);if(jc(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),rr!=4||tt.length!=0||this.h.h||(this.s=1,yn(16),C=!1),this.o=this.o&&C,!C)ha(this.i,this.l,tt,"[Invalid Chunked Response]"),Fa(this),kn(this);else if(0<tt.length&&!this.W){this.W=!0;var Yt=this.j;Yt.g==this&&Yt.ba&&!Yt.M&&(Yt.j.info("Great, no buffering proxy detected. Bytes received: "+tt.length),Da(Yt),Yt.M=!0,yn(11))}}else ha(this.i,this.l,tt,null),Wt(this,tt);rr==4&&Fa(this),this.o&&!this.J&&(rr==4?dn(this.j,this):(this.o=!1,Un(this)))}else oh(this.g),C==400&&0<tt.indexOf("Unknown SID")?(this.s=3,yn(12)):(this.s=0,yn(13)),Fa(this),kn(this)}}}catch{}finally{}};function jc(g){return g.g?g.u=="GET"&&g.L!=2&&g.j.Ca:!1}function Yf(g,A){var C=g.C,Y=A.indexOf(`
`,C);return Y==-1?ka:(C=Number(A.substring(C,Y)),isNaN(C)?qf:(Y+=1,Y+C>A.length?ka:(A=A.slice(Y,Y+C),g.C=Y+C,A)))}Cr.prototype.cancel=function(){this.J=!0,Fa(this)};function Un(g){g.S=Date.now()+g.I,_l(g,g.I)}function _l(g,A){if(g.B!=null)throw Error("WatchDog timer not null");g.B=qr(R(g.ba,g),A)}function Jr(g){g.B&&(x.clearTimeout(g.B),g.B=null)}Cr.prototype.ba=function(){this.B=null;const g=Date.now();0<=g-this.S?(xl(this.i,this.A),this.L!=2&&(Fi(),yn(17)),Fa(this),this.s=2,kn(this)):_l(this,this.S-g)};function kn(g){g.j.G==0||g.J||dn(g.j,g)}function Fa(g){Jr(g);var A=g.M;A&&typeof A.ma=="function"&&A.ma(),g.M=null,Ne(g.U),g.g&&(A=g.g,g.g=null,A.abort(),A.ma())}function Wt(g,A){try{var C=g.j;if(C.G!=0&&(C.g==g||Vc(C.h,g))){if(!g.K&&Vc(C.h,g)&&C.G==3){try{var Y=C.Da.g.parse(A)}catch{Y=null}if(Array.isArray(Y)&&Y.length==3){var pe=Y;if(pe[0]==0){e:if(!C.u){if(C.g)if(C.g.F+3e3<g.F)Al(C),Ao(C);else break e;ko(C),yn(18)}}else C.za=pe[1],0<C.za-C.T&&37500>pe[2]&&C.F&&C.v==0&&!C.C&&(C.C=qr(R(C.Za,C),6e3));if(1>=Zr(C.h)&&C.ca){try{C.ca()}catch{}C.ca=void 0}}else ni(C,11)}else if((g.K||C.g==g)&&Al(C),!U(A))for(pe=C.Da.g.parse(A),A=0;A<pe.length;A++){let hr=pe[A];if(C.T=hr[0],hr=hr[1],C.G==2)if(hr[0]=="c"){C.K=hr[1],C.ia=hr[2];const Yt=hr[3];Yt!=null&&(C.la=Yt,C.j.info("VER="+C.la));const rr=hr[4];rr!=null&&(C.Aa=rr,C.j.info("SVER="+C.Aa));const Pt=hr[5];Pt!=null&&typeof Pt=="number"&&0<Pt&&(Y=1.5*Pt,C.L=Y,C.j.info("backChannelRequestTimeoutMs_="+Y)),Y=C;const Wr=g.g;if(Wr){const Bt=Wr.g?Wr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Bt){var Ee=Y.h;Ee.g||Bt.indexOf("spdy")==-1&&Bt.indexOf("quic")==-1&&Bt.indexOf("h2")==-1||(Ee.j=Ee.l,Ee.g=new Set,Ee.h&&(vn(Ee,Ee.h),Ee.h=null))}if(Y.D){const nr=Wr.g?Wr.g.getResponseHeader("X-HTTP-Session-Id"):null;nr&&(Y.ya=nr,Br(Y.I,Y.D,nr))}}C.G=3,C.l&&C.l.ua(),C.ba&&(C.R=Date.now()-g.F,C.j.info("Handshake RTT: "+C.R+"ms")),Y=C;var tt=g;if(Y.qa=lh(Y,Y.J?Y.ia:null,Y.W),tt.K){Qf(Y.h,tt);var Fr=tt,tr=Y.L;tr&&(Fr.I=tr),Fr.B&&(Jr(Fr),Un(Fr)),Y.g=tt}else Co(Y);0<C.i.length&&ji(C)}else hr[0]!="stop"&&hr[0]!="close"||ni(C,7);else C.G==3&&(hr[0]=="stop"||hr[0]=="close"?hr[0]=="stop"?ni(C,7):Oi(C):hr[0]!="noop"&&C.l&&C.l.ta(hr),C.v=0)}}Fi(4)}catch{}}var Mc=class{constructor(g,A){this.g=g,this.map=A}};function Lc(g){this.l=g||10,x.PerformanceNavigationTiming?(g=x.performance.getEntriesByType("navigation"),g=0<g.length&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(x.chrome&&x.chrome.loadTimes&&x.chrome.loadTimes()&&x.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ni(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function Zr(g){return g.h?1:g.g?g.g.size:0}function Vc(g,A){return g.h?g.h==A:g.g?g.g.has(A):!1}function vn(g,A){g.g?g.g.add(A):g.h=A}function Qf(g,A){g.h&&g.h==A?g.h=null:g.g&&g.g.has(A)&&g.g.delete(A)}Lc.prototype.cancel=function(){if(this.i=Xf(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function Xf(g){if(g.h!=null)return g.i.concat(g.h.D);if(g.g!=null&&g.g.size!==0){let A=g.i;for(const C of g.g.values())A=A.concat(C.D);return A}return ne(g.i)}function Lt(g){if(g.V&&typeof g.V=="function")return g.V();if(typeof Map<"u"&&g instanceof Map||typeof Set<"u"&&g instanceof Set)return Array.from(g.values());if(typeof g=="string")return g.split("");if(w(g)){for(var A=[],C=g.length,Y=0;Y<C;Y++)A.push(g[Y]);return A}A=[],C=0;for(Y in g)A[C++]=g[Y];return A}function zs(g){if(g.na&&typeof g.na=="function")return g.na();if(!g.V||typeof g.V!="function"){if(typeof Map<"u"&&g instanceof Map)return Array.from(g.keys());if(!(typeof Set<"u"&&g instanceof Set)){if(w(g)||typeof g=="string"){var A=[];g=g.length;for(var C=0;C<g;C++)A.push(C);return A}A=[],C=0;for(const Y in g)A[C++]=Y;return A}}}function Uc(g,A){if(g.forEach&&typeof g.forEach=="function")g.forEach(A,void 0);else if(w(g)||typeof g=="string")Array.prototype.forEach.call(g,A,void 0);else for(var C=zs(g),Y=Lt(g),pe=Y.length,Ee=0;Ee<pe;Ee++)A.call(void 0,Y[Ee],C&&C[Ee],g)}var Bc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Jf(g,A){if(g){g=g.split("&");for(var C=0;C<g.length;C++){var Y=g[C].indexOf("="),pe=null;if(0<=Y){var Ee=g[C].substring(0,Y);pe=g[C].substring(Y+1)}else Ee=g[C];A(Ee,pe?decodeURIComponent(pe.replace(/\+/g," ")):"")}}}function pa(g){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,g instanceof pa){this.h=g.h,Ii(this,g.j),this.o=g.o,this.g=g.g,Tl(this,g.s),this.l=g.l;var A=g.i,C=new Ja;C.i=A.i,A.g&&(C.g=new Map(A.g),C.h=A.h),Er(this,C),this.m=g.m}else g&&(A=String(g).match(Bc))?(this.h=!1,Ii(this,A[1]||"",!0),this.o=Xa(A[2]||""),this.g=Xa(A[3]||"",!0),Tl(this,A[4]),this.l=Xa(A[5]||"",!0),Er(this,A[6]||"",!0),this.m=Xa(A[7]||"")):(this.h=!1,this.i=new Ja(null,this.h))}pa.prototype.toString=function(){var g=[],A=this.j;A&&g.push(Di(A,eh,!0),":");var C=this.g;return(C||A=="file")&&(g.push("//"),(A=this.o)&&g.push(Di(A,eh,!0),"@"),g.push(encodeURIComponent(String(C)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C=this.s,C!=null&&g.push(":",String(C))),(C=this.l)&&(this.g&&C.charAt(0)!="/"&&g.push("/"),g.push(Di(C,C.charAt(0)=="/"?$c:$r,!0))),(C=this.i.toString())&&g.push("?",C),(C=this.m)&&g.push("#",Di(C,rh)),g.join("")};function qt(g){return new pa(g)}function Ii(g,A,C){g.j=C?Xa(A,!0):A,g.j&&(g.j=g.j.replace(/:$/,""))}function Tl(g,A){if(A){if(A=Number(A),isNaN(A)||0>A)throw Error("Bad port number "+A);g.s=A}else g.s=null}function Er(g,A,C){A instanceof Ja?(g.i=A,nh(g.i,g.h)):(C||(A=Di(A,th)),g.i=new Ja(A,g.h))}function Br(g,A,C){g.i.set(A,C)}function To(g){return Br(g,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),g}function Xa(g,A){return g?A?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function Di(g,A,C){return typeof g=="string"?(g=encodeURI(g).replace(A,Zf),C&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function Zf(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var eh=/[#\/\?@]/g,$r=/[#\?:]/g,$c=/[#\?]/g,th=/[#\?@]/g,rh=/#/g;function Ja(g,A){this.h=this.g=null,this.i=g||null,this.j=!!A}function Ps(g){g.g||(g.g=new Map,g.h=0,g.i&&Jf(g.i,function(A,C){g.add(decodeURIComponent(A.replace(/\+/g," ")),C)}))}r=Ja.prototype,r.add=function(g,A){Ps(this),this.i=null,g=Hs(this,g);var C=this.g.get(g);return C||this.g.set(g,C=[]),C.push(A),this.h+=1,this};function Eo(g,A){Ps(g),A=Hs(g,A),g.g.has(A)&&(g.i=null,g.h-=g.g.get(A).length,g.g.delete(A))}function kr(g,A){return Ps(g),A=Hs(g,A),g.g.has(A)}r.forEach=function(g,A){Ps(this),this.g.forEach(function(C,Y){C.forEach(function(pe){g.call(A,pe,Y,this)},this)},this)},r.na=function(){Ps(this);const g=Array.from(this.g.values()),A=Array.from(this.g.keys()),C=[];for(let Y=0;Y<A.length;Y++){const pe=g[Y];for(let Ee=0;Ee<pe.length;Ee++)C.push(A[Y])}return C},r.V=function(g){Ps(this);let A=[];if(typeof g=="string")kr(this,g)&&(A=A.concat(this.g.get(Hs(this,g))));else{g=Array.from(this.g.values());for(let C=0;C<g.length;C++)A=A.concat(g[C])}return A},r.set=function(g,A){return Ps(this),this.i=null,g=Hs(this,g),kr(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[A]),this.h+=1,this},r.get=function(g,A){return g?(g=this.V(g),0<g.length?String(g[0]):A):A};function Os(g,A,C){Eo(g,A),0<C.length&&(g.i=null,g.g.set(Hs(g,A),ne(C)),g.h+=C.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],A=Array.from(this.g.keys());for(var C=0;C<A.length;C++){var Y=A[C];const Ee=encodeURIComponent(String(Y)),tt=this.V(Y);for(Y=0;Y<tt.length;Y++){var pe=Ee;tt[Y]!==""&&(pe+="="+encodeURIComponent(String(tt[Y]))),g.push(pe)}}return this.i=g.join("&")};function Hs(g,A){return A=String(A),g.j&&(A=A.toLowerCase()),A}function nh(g,A){A&&!g.j&&(Ps(g),g.i=null,g.g.forEach(function(C,Y){var pe=Y.toLowerCase();Y!=pe&&(Eo(this,Y),Os(this,pe,C))},g)),g.j=A}function X0(g,A){const C=new Ca;if(x.Image){const Y=new Image;Y.onload=q(Na,C,"TestLoadImage: loaded",!0,A,Y),Y.onerror=q(Na,C,"TestLoadImage: error",!1,A,Y),Y.onabort=q(Na,C,"TestLoadImage: abort",!1,A,Y),Y.ontimeout=q(Na,C,"TestLoadImage: timeout",!1,A,Y),x.setTimeout(function(){Y.ontimeout&&Y.ontimeout()},1e4),Y.src=g}else A(!1)}function J0(g,A){const C=new Ca,Y=new AbortController,pe=setTimeout(()=>{Y.abort(),Na(C,"TestPingServer: timeout",!1,A)},1e4);fetch(g,{signal:Y.signal}).then(Ee=>{clearTimeout(pe),Ee.ok?Na(C,"TestPingServer: ok",!0,A):Na(C,"TestPingServer: server error",!1,A)}).catch(()=>{clearTimeout(pe),Na(C,"TestPingServer: error",!1,A)})}function Na(g,A,C,Y,pe){try{pe&&(pe.onload=null,pe.onerror=null,pe.onabort=null,pe.ontimeout=null),Y(C)}catch{}}function sh(){this.g=new Ds}function ah(g,A,C){const Y=C||"";try{Uc(g,function(pe,Ee){let tt=pe;E(pe)&&(tt=Rt(pe)),A.push(Y+Ee+"="+encodeURIComponent(tt))})}catch(pe){throw A.push(Y+"type="+encodeURIComponent("_badmap")),pe}}function cn(g){this.l=g.Ub||null,this.j=g.eb||!1}Z(cn,Rs),cn.prototype.g=function(){return new Ia(this.l,this.j)},cn.prototype.i=function(g){return function(){return g}}({});function Ia(g,A){_r.call(this),this.D=g,this.o=A,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}Z(Ia,_r),r=Ia.prototype,r.open=function(g,A){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=g,this.A=A,this.readyState=1,ei(this)},r.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const A={headers:this.u,method:this.B,credentials:this.m,cache:void 0};g&&(A.body=g),(this.D||x).fetch(new Request(this.A,A)).then(this.Sa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Za(this)),this.readyState=0},r.Sa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,ei(this)),this.g&&(this.readyState=3,ei(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof x.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ze(this)}else g.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ze(g){g.j.read().then(g.Pa.bind(g)).catch(g.ga.bind(g))}r.Pa=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var A=g.value?g.value:new Uint8Array(0);(A=this.v.decode(A,{stream:!g.done}))&&(this.response=this.responseText+=A)}g.done?Za(this):ei(this),this.readyState==3&&Ze(this)}},r.Ra=function(g){this.g&&(this.response=this.responseText=g,Za(this))},r.Qa=function(g){this.g&&(this.response=g,Za(this))},r.ga=function(){this.g&&Za(this)};function Za(g){g.readyState=4,g.l=null,g.j=null,g.v=null,ei(g)}r.setRequestHeader=function(g,A){this.u.append(g,A)},r.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],A=this.h.entries();for(var C=A.next();!C.done;)C=C.value,g.push(C[0]+": "+C[1]),C=A.next();return g.join(`\r
`)};function ei(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(Ia.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function Ri(g){let A="";return ue(g,function(C,Y){A+=Y,A+=":",A+=C,A+=`\r
`}),A}function rn(g,A,C){e:{for(Y in C){var Y=!1;break e}Y=!0}Y||(C=Ri(C),typeof g=="string"?C!=null&&encodeURIComponent(String(C)):Br(g,A,C))}function Dr(g){_r.call(this),this.headers=new Map,this.o=g||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}Z(Dr,_r);var fs=/^https?$/i,ih=["POST","PUT"];r=Dr.prototype,r.Ha=function(g){this.J=g},r.ea=function(g,A,C,Y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);A=A?A.toUpperCase():"GET",this.D=g,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():da.g(),this.v=this.o?Qa(this.o):Qa(da),this.g.onreadystatechange=R(this.Ea,this);try{this.B=!0,this.g.open(A,String(g),!0),this.B=!1}catch(Ee){Wc(this,Ee);return}if(g=C||"",C=new Map(this.headers),Y)if(Object.getPrototypeOf(Y)===Object.prototype)for(var pe in Y)C.set(pe,Y[pe]);else if(typeof Y.keys=="function"&&typeof Y.get=="function")for(const Ee of Y.keys())C.set(Ee,Y.get(Ee));else throw Error("Unknown input type for opt_headers: "+String(Y));Y=Array.from(C.keys()).find(Ee=>Ee.toLowerCase()=="content-type"),pe=x.FormData&&g instanceof x.FormData,!(0<=Array.prototype.indexOf.call(ih,A,void 0))||Y||pe||C.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ee,tt]of C)this.g.setRequestHeader(Ee,tt);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Gc(this),this.u=!0,this.g.send(g),this.u=!1}catch(Ee){Wc(this,Ee)}};function Wc(g,A){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=A,g.m=5,zc(g),So(g)}function zc(g){g.A||(g.A=!0,Or(g,"complete"),Or(g,"error"))}r.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=g||7,Or(this,"complete"),Or(this,"abort"),So(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),So(this,!0)),Dr.aa.N.call(this)},r.Ea=function(){this.s||(this.B||this.u||this.j?Hc(this):this.bb())},r.bb=function(){Hc(this)};function Hc(g){if(g.h&&typeof p<"u"&&(!g.v[1]||Gs(g)!=4||g.Z()!=2)){if(g.u&&Gs(g)==4)Ai(g.Ea,0,g);else if(Or(g,"readystatechange"),Gs(g)==4){g.h=!1;try{const tt=g.Z();e:switch(tt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var A=!0;break e;default:A=!1}var C;if(!(C=A)){var Y;if(Y=tt===0){var pe=String(g.D).match(Bc)[1]||null;!pe&&x.self&&x.self.location&&(pe=x.self.location.protocol.slice(0,-1)),Y=!fs.test(pe?pe.toLowerCase():"")}C=Y}if(C)Or(g,"complete"),Or(g,"success");else{g.m=6;try{var Ee=2<Gs(g)?g.g.statusText:""}catch{Ee=""}g.l=Ee+" ["+g.Z()+"]",zc(g)}}finally{So(g)}}}}function So(g,A){if(g.g){Gc(g);const C=g.g,Y=g.v[0]?()=>{}:null;g.g=null,g.v=null,A||Or(g,"ready");try{C.onreadystatechange=Y}catch{}}}function Gc(g){g.I&&(x.clearTimeout(g.I),g.I=null)}r.isActive=function(){return!!this.g};function Gs(g){return g.g?g.g.readyState:0}r.Z=function(){try{return 2<Gs(this)?this.g.status:-1}catch{return-1}},r.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.Oa=function(g){if(this.g){var A=this.g.responseText;return g&&A.indexOf(g)==0&&(A=A.substring(g.length)),Vr(A)}};function qc(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.H){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function oh(g){const A={};g=(g.g&&2<=Gs(g)&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let Y=0;Y<g.length;Y++){if(U(g[Y]))continue;var C=J(g[Y]);const pe=C[0];if(C=C[1],typeof C!="string")continue;C=C.trim();const Ee=A[pe]||[];A[pe]=Ee,Ee.push(C)}L(A,function(Y){return Y.join(", ")})}r.Ba=function(){return this.m},r.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Pi(g,A,C){return C&&C.internalChannelParams&&C.internalChannelParams[g]||A}function Kc(g){this.Aa=0,this.i=[],this.j=new Ca,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Pi("failFast",!1,g),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Pi("baseRetryDelayMs",5e3,g),this.cb=Pi("retryDelaySeedMs",1e4,g),this.Wa=Pi("forwardChannelMaxRetries",2,g),this.wa=Pi("forwardChannelRequestTimeoutMs",2e4,g),this.pa=g&&g.xmlHttpFactory||void 0,this.Xa=g&&g.Tb||void 0,this.Ca=g&&g.useFetchStreams||!1,this.L=void 0,this.J=g&&g.supportsCrossDomainXhr||!1,this.K="",this.h=new Lc(g&&g.concurrentRequestLimit),this.Da=new sh,this.P=g&&g.fastHandshake||!1,this.O=g&&g.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=g&&g.Rb||!1,g&&g.xa&&this.j.xa(),g&&g.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&g&&g.detectBufferingProxy||!1,this.ja=void 0,g&&g.longPollingTimeout&&0<g.longPollingTimeout&&(this.ja=g.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}r=Kc.prototype,r.la=8,r.G=1,r.connect=function(g,A,C,Y){yn(0),this.W=g,this.H=A||{},C&&Y!==void 0&&(this.H.OSID=C,this.H.OAID=Y),this.F=this.X,this.I=lh(this,null,this.W),ji(this)};function Oi(g){if(ti(g),g.G==3){var A=g.U++,C=qt(g.I);if(Br(C,"SID",g.K),Br(C,"RID",A),Br(C,"TYPE","terminate"),ri(g,C),A=new Cr(g,g.j,A),A.L=2,A.v=To(qt(C)),C=!1,x.navigator&&x.navigator.sendBeacon)try{C=x.navigator.sendBeacon(A.v.toString(),"")}catch{}!C&&x.Image&&(new Image().src=A.v,C=!0),C||(A.g=ch(A.j,null),A.g.ea(A.v)),A.F=Date.now(),Un(A)}Mi(g)}function Ao(g){g.g&&(Da(g),g.g.cancel(),g.g=null)}function ti(g){Ao(g),g.u&&(x.clearTimeout(g.u),g.u=null),Al(g),g.h.cancel(),g.s&&(typeof g.s=="number"&&x.clearTimeout(g.s),g.s=null)}function ji(g){if(!Ni(g.h)&&!g.s){g.s=!0;var A=g.Ga;at||ye(),$e||(at(),$e=!0),Ve.add(A,g),g.B=0}}function Yc(g,A){return Zr(g.h)>=g.h.j-(g.s?1:0)?!1:g.s?(g.i=A.D.concat(g.i),!0):g.G==1||g.G==2||g.B>=(g.Va?0:g.Wa)?!1:(g.s=qr(R(g.Ga,g,A),Ra(g,g.B)),g.B++,!0)}r.Ga=function(g){if(this.s)if(this.s=null,this.G==1){if(!g){this.U=Math.floor(1e5*Math.random()),g=this.U++;const pe=new Cr(this,this.j,g);let Ee=this.o;if(this.S&&(Ee?(Ee=O(Ee),W(Ee,this.S)):Ee=this.S),this.m!==null||this.O||(pe.H=Ee,Ee=null),this.P)e:{for(var A=0,C=0;C<this.i.length;C++){t:{var Y=this.i[C];if("__data__"in Y.map&&(Y=Y.map.__data__,typeof Y=="string")){Y=Y.length;break t}Y=void 0}if(Y===void 0)break;if(A+=Y,4096<A){A=C;break e}if(A===4096||C===this.i.length-1){A=C+1;break e}}A=1e3}else A=1e3;A=Sl(this,pe,A),C=qt(this.I),Br(C,"RID",g),Br(C,"CVER",22),this.D&&Br(C,"X-HTTP-Session-Id",this.D),ri(this,C),Ee&&(this.O?A="headers="+encodeURIComponent(String(Ri(Ee)))+"&"+A:this.m&&rn(C,this.m,Ee)),vn(this.h,pe),this.Ua&&Br(C,"TYPE","init"),this.P?(Br(C,"$req",A),Br(C,"SID","null"),pe.T=!0,wl(pe,C,null)):wl(pe,C,A),this.G=2}}else this.G==3&&(g?El(this,g):this.i.length==0||Ni(this.h)||El(this))};function El(g,A){var C;A?C=A.l:C=g.U++;const Y=qt(g.I);Br(Y,"SID",g.K),Br(Y,"RID",C),Br(Y,"AID",g.T),ri(g,Y),g.m&&g.o&&rn(Y,g.m,g.o),C=new Cr(g,g.j,C,g.B+1),g.m===null&&(C.H=g.o),A&&(g.i=A.D.concat(g.i)),A=Sl(g,C,1e3),C.I=Math.round(.5*g.wa)+Math.round(.5*g.wa*Math.random()),vn(g.h,C),wl(C,Y,A)}function ri(g,A){g.H&&ue(g.H,function(C,Y){Br(A,Y,C)}),g.l&&Uc({},function(C,Y){Br(A,Y,C)})}function Sl(g,A,C){C=Math.min(g.i.length,C);var Y=g.l?R(g.l.Na,g.l,g):null;e:{var pe=g.i;let Ee=-1;for(;;){const tt=["count="+C];Ee==-1?0<C?(Ee=pe[0].g,tt.push("ofs="+Ee)):Ee=0:tt.push("ofs="+Ee);let Fr=!0;for(let tr=0;tr<C;tr++){let hr=pe[tr].g;const Yt=pe[tr].map;if(hr-=Ee,0>hr)Ee=Math.max(0,pe[tr].g-100),Fr=!1;else try{ah(Yt,tt,"req"+hr+"_")}catch{Y&&Y(Yt)}}if(Fr){Y=tt.join("&");break e}}}return g=g.i.splice(0,C),A.D=g,Y}function Co(g){if(!g.g&&!g.u){g.Y=1;var A=g.Fa;at||ye(),$e||(at(),$e=!0),Ve.add(A,g),g.v=0}}function ko(g){return g.g||g.u||3<=g.v?!1:(g.Y++,g.u=qr(R(g.Fa,g),Ra(g,g.v)),g.v++,!0)}r.Fa=function(){if(this.u=null,qs(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var g=2*this.R;this.j.info("BP detection timer enabled: "+g),this.A=qr(R(this.ab,this),g)}},r.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,yn(10),Ao(this),qs(this))};function Da(g){g.A!=null&&(x.clearTimeout(g.A),g.A=null)}function qs(g){g.g=new Cr(g,g.j,"rpc",g.Y),g.m===null&&(g.g.H=g.o),g.g.O=0;var A=qt(g.qa);Br(A,"RID","rpc"),Br(A,"SID",g.K),Br(A,"AID",g.T),Br(A,"CI",g.F?"0":"1"),!g.F&&g.ja&&Br(A,"TO",g.ja),Br(A,"TYPE","xmlhttp"),ri(g,A),g.m&&g.o&&rn(A,g.m,g.o),g.L&&(g.g.I=g.L);var C=g.g;g=g.ia,C.L=1,C.v=To(qt(A)),C.m=null,C.P=!0,Kf(C,g)}r.Za=function(){this.C!=null&&(this.C=null,Ao(this),ko(this),yn(19))};function Al(g){g.C!=null&&(x.clearTimeout(g.C),g.C=null)}function dn(g,A){var C=null;if(g.g==A){Al(g),Da(g),g.g=null;var Y=2}else if(Vc(g.h,A))C=A.D,Qf(g.h,A),Y=1;else return;if(g.G!=0){if(A.o)if(Y==1){C=A.m?A.m.length:0,A=Date.now()-A.F;var pe=g.B;Y=Aa(),Or(Y,new _o(Y,C)),ji(g)}else Co(g);else if(pe=A.s,pe==3||pe==0&&0<A.X||!(Y==1&&Yc(g,A)||Y==2&&ko(g)))switch(C&&0<C.length&&(A=g.h,A.i=A.i.concat(C)),pe){case 1:ni(g,5);break;case 4:ni(g,10);break;case 3:ni(g,6);break;default:ni(g,2)}}}function Ra(g,A){let C=g.Ta+Math.floor(Math.random()*g.cb);return g.isActive()||(C*=2),C*A}function ni(g,A){if(g.j.info("Error code "+A),A==2){var C=R(g.fb,g),Y=g.Xa;const pe=!Y;Y=new pa(Y||"//www.google.com/images/cleardot.gif"),x.location&&x.location.protocol=="http"||Ii(Y,"https"),To(Y),pe?X0(Y.toString(),C):J0(Y.toString(),C)}else yn(2);g.G=0,g.l&&g.l.sa(A),Mi(g),ti(g)}r.fb=function(g){g?(this.j.info("Successfully pinged google.com"),yn(2)):(this.j.info("Failed to ping google.com"),yn(1))};function Mi(g){if(g.G=0,g.ka=[],g.l){const A=Xf(g.h);(A.length!=0||g.i.length!=0)&&(fe(g.ka,A),fe(g.ka,g.i),g.h.i.length=0,ne(g.i),g.i.length=0),g.l.ra()}}function lh(g,A,C){var Y=C instanceof pa?qt(C):new pa(C);if(Y.g!="")A&&(Y.g=A+"."+Y.g),Tl(Y,Y.s);else{var pe=x.location;Y=pe.protocol,A=A?A+"."+pe.hostname:pe.hostname,pe=+pe.port;var Ee=new pa(null);Y&&Ii(Ee,Y),A&&(Ee.g=A),pe&&Tl(Ee,pe),C&&(Ee.l=C),Y=Ee}return C=g.D,A=g.ya,C&&A&&Br(Y,C,A),Br(Y,"VER",g.la),ri(g,Y),Y}function ch(g,A,C){if(A&&!g.J)throw Error("Can't create secondary domain capable XhrIo object.");return A=g.Ca&&!g.pa?new Dr(new cn({eb:C})):new Dr(g.pa),A.Ha(g.J),A}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function uh(){}r=uh.prototype,r.ua=function(){},r.ta=function(){},r.sa=function(){},r.ra=function(){},r.isActive=function(){return!0},r.Na=function(){};function Cl(){}Cl.prototype.g=function(g,A){return new Yn(g,A)};function Yn(g,A){_r.call(this),this.g=new Kc(A),this.l=g,this.h=A&&A.messageUrlParams||null,g=A&&A.messageHeaders||null,A&&A.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=A&&A.initMessageHeaders||null,A&&A.messageContentType&&(g?g["X-WebChannel-Content-Type"]=A.messageContentType:g={"X-WebChannel-Content-Type":A.messageContentType}),A&&A.va&&(g?g["X-WebChannel-Client-Profile"]=A.va:g={"X-WebChannel-Client-Profile":A.va}),this.g.S=g,(g=A&&A.Sb)&&!U(g)&&(this.g.m=g),this.v=A&&A.supportsCrossDomainXhr||!1,this.u=A&&A.sendRawJson||!1,(A=A&&A.httpSessionIdParam)&&!U(A)&&(this.g.D=A,g=this.h,g!==null&&A in g&&(g=this.h,A in g&&delete g[A])),this.j=new Ae(this)}Z(Yn,_r),Yn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Yn.prototype.close=function(){Oi(this.g)},Yn.prototype.o=function(g){var A=this.g;if(typeof g=="string"){var C={};C.__data__=g,g=C}else this.u&&(C={},C.__data__=Rt(g),g=C);A.i.push(new Mc(A.Ya++,g)),A.G==3&&ji(A)},Yn.prototype.N=function(){this.g.l=null,delete this.j,Oi(this.g),delete this.g,Yn.aa.N.call(this)};function xn(g){Ws.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var A=g.__sm__;if(A){e:{for(const C in A){g=C;break e}g=void 0}(this.i=g)&&(g=this.i,A=A!==null&&g in A?A[g]:void 0),this.data=A}else this.data=g}Z(xn,Ws);function Fn(){Oc.call(this),this.status=1}Z(Fn,Oc);function Ae(g){this.g=g}Z(Ae,uh),Ae.prototype.ua=function(){Or(this.g,"a")},Ae.prototype.ta=function(g){Or(this.g,new xn(g))},Ae.prototype.sa=function(g){Or(this.g,new Fn)},Ae.prototype.ra=function(){Or(this.g,"b")},Cl.prototype.createWebChannel=Cl.prototype.g,Yn.prototype.send=Yn.prototype.o,Yn.prototype.open=Yn.prototype.m,Yn.prototype.close=Yn.prototype.close,yT=function(){return new Cl},gT=function(){return Aa()},mT=wt,zm={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},bl.NO_ERROR=0,bl.TIMEOUT=8,bl.HTTP_ERROR=6,Td=bl,Ur.COMPLETE="complete",pT=Ur,Wf.EventType=ki,ki.OPEN="a",ki.CLOSE="b",ki.ERROR="c",ki.MESSAGE="d",_r.prototype.listen=_r.prototype.K,Du=Wf,Dr.prototype.listenOnce=Dr.prototype.L,Dr.prototype.getLastError=Dr.prototype.Ka,Dr.prototype.getLastErrorCode=Dr.prototype.Ba,Dr.prototype.getStatus=Dr.prototype.Z,Dr.prototype.getResponseJson=Dr.prototype.Oa,Dr.prototype.getResponseText=Dr.prototype.oa,Dr.prototype.send=Dr.prototype.ea,Dr.prototype.setWithCredentials=Dr.prototype.Ha,dT=Dr}).apply(typeof id<"u"?id:typeof self<"u"?self:typeof window<"u"?window:{});const U4="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}as.UNAUTHENTICATED=new as(null),as.GOOGLE_CREDENTIALS=new as("google-credentials-uid"),as.FIRST_PARTY=new as("first-party-uid"),as.MOCK_USER=new as("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nc="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const al=new aT("@firebase/firestore");function Au(){return al.logLevel}function Ft(r,...t){if(al.logLevel<=br.DEBUG){const s=t.map(u2);al.debug(`Firestore (${Nc}): ${r}`,...s)}}function Ti(r,...t){if(al.logLevel<=br.ERROR){const s=t.map(u2);al.error(`Firestore (${Nc}): ${r}`,...s)}}function xc(r,...t){if(al.logLevel<=br.WARN){const s=t.map(u2);al.warn(`Firestore (${Nc}): ${r}`,...s)}}function u2(r){if(typeof r=="string")return r;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(s){return JSON.stringify(s)}(r)}catch{return r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $t(r="Unexpected state"){const t=`FIRESTORE (${Nc}) INTERNAL ASSERTION FAILED: `+r;throw Ti(t),new Error(t)}function Lr(r,t){r||$t()}function Gt(r,t){return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class dt extends pl{constructor(t,s){super(t,s),this.code=t,this.message=s,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(){this.promise=new Promise((t,s)=>{this.resolve=t,this.reject=s})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vT{constructor(t,s){this.user=s,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class xN{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,s){t.enqueueRetryable(()=>s(as.UNAUTHENTICATED))}shutdown(){}}class bN{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,s){this.changeListener=s,t.enqueueRetryable(()=>s(this.token.user))}shutdown(){this.changeListener=null}}class wN{constructor(t){this.t=t,this.currentUser=as.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,s){Lr(this.o===void 0);let i=this.i;const n=w=>this.i!==i?(i=this.i,s(w)):Promise.resolve();let e=new gi;this.o=()=>{this.i++,this.currentUser=this.u(),e.resolve(),e=new gi,t.enqueueRetryable(()=>n(this.currentUser))};const p=()=>{const w=e;t.enqueueRetryable(async()=>{await w.promise,await n(this.currentUser)})},x=w=>{Ft("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=w,this.o&&(this.auth.addAuthTokenListener(this.o),p())};this.t.onInit(w=>x(w)),setTimeout(()=>{if(!this.auth){const w=this.t.getImmediate({optional:!0});w?x(w):(Ft("FirebaseAuthCredentialsProvider","Auth not yet detected"),e.resolve(),e=new gi)}},0),p()}getToken(){const t=this.i,s=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(s).then(i=>this.i!==t?(Ft("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Lr(typeof i.accessToken=="string"),new vT(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return Lr(t===null||typeof t=="string"),new as(t)}}class _N{constructor(t,s,i){this.l=t,this.h=s,this.P=i,this.type="FirstParty",this.user=as.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class TN{constructor(t,s,i){this.l=t,this.h=s,this.P=i}getToken(){return Promise.resolve(new _N(this.l,this.h,this.P))}start(t,s){t.enqueueRetryable(()=>s(as.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class EN{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class SN{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,s){Lr(this.o===void 0);const i=e=>{e.error!=null&&Ft("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const p=e.token!==this.R;return this.R=e.token,Ft("FirebaseAppCheckTokenProvider",`Received ${p?"new":"existing"} token.`),p?s(e.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable(()=>i(e))};const n=e=>{Ft("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(e=>n(e)),setTimeout(()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?n(e):Ft("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(s=>s?(Lr(typeof s.token=="string"),this.R=s.token,new EN(s.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AN(r){const t=typeof self<"u"&&(self.crypto||self.msCrypto),s=new Uint8Array(r);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(s);else for(let i=0;i<r;i++)s[i]=Math.floor(256*Math.random());return s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xT{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",s=Math.floor(256/t.length)*t.length;let i="";for(;i.length<20;){const n=AN(40);for(let e=0;e<n.length;++e)i.length<20&&n[e]<s&&(i+=t.charAt(n[e]%t.length))}return i}}function Ar(r,t){return r<t?-1:r>t?1:0}function bc(r,t,s){return r.length===t.length&&r.every((i,n)=>s(i,t[n]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An{constructor(t,s){if(this.seconds=t,this.nanoseconds=s,s<0)throw new dt(Pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+s);if(s>=1e9)throw new dt(Pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+s);if(t<-62135596800)throw new dt(Pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new dt(Pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return An.fromMillis(Date.now())}static fromDate(t){return An.fromMillis(t.getTime())}static fromMillis(t){const s=Math.floor(t/1e3),i=Math.floor(1e6*(t-1e3*s));return new An(s,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?Ar(this.nanoseconds,t.nanoseconds):Ar(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(t){this.timestamp=t}static fromTimestamp(t){return new Ht(t)}static min(){return new Ht(new An(0,0))}static max(){return new Ht(new An(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mf{constructor(t,s,i){s===void 0?s=0:s>t.length&&$t(),i===void 0?i=t.length-s:i>t.length-s&&$t(),this.segments=t,this.offset=s,this.len=i}get length(){return this.len}isEqual(t){return mf.comparator(this,t)===0}child(t){const s=this.segments.slice(this.offset,this.limit());return t instanceof mf?t.forEach(i=>{s.push(i)}):s.push(t),this.construct(s)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let s=0;s<this.length;s++)if(this.get(s)!==t.get(s))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let s=0;s<this.length;s++)if(this.get(s)!==t.get(s))return!1;return!0}forEach(t){for(let s=this.offset,i=this.limit();s<i;s++)t(this.segments[s])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,s){const i=Math.min(t.length,s.length);for(let n=0;n<i;n++){const e=t.get(n),p=s.get(n);if(e<p)return-1;if(e>p)return 1}return t.length<s.length?-1:t.length>s.length?1:0}}class Yr extends mf{construct(t,s,i){return new Yr(t,s,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const s=[];for(const i of t){if(i.indexOf("//")>=0)throw new dt(Pe.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);s.push(...i.split("/").filter(n=>n.length>0))}return new Yr(s)}static emptyPath(){return new Yr([])}}const CN=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class zn extends mf{construct(t,s,i){return new zn(t,s,i)}static isValidIdentifier(t){return CN.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),zn.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new zn(["__name__"])}static fromServerFormat(t){const s=[];let i="",n=0;const e=()=>{if(i.length===0)throw new dt(Pe.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);s.push(i),i=""};let p=!1;for(;n<t.length;){const x=t[n];if(x==="\\"){if(n+1===t.length)throw new dt(Pe.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const w=t[n+1];if(w!=="\\"&&w!=="."&&w!=="`")throw new dt(Pe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);i+=w,n+=2}else x==="`"?(p=!p,n++):x!=="."||p?(i+=x,n++):(e(),n++)}if(e(),p)throw new dt(Pe.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new zn(s)}static emptyPath(){return new zn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot{constructor(t){this.path=t}static fromPath(t){return new Ot(Yr.fromString(t))}static fromName(t){return new Ot(Yr.fromString(t).popFirst(5))}static empty(){return new Ot(Yr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&Yr.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,s){return Yr.comparator(t.path,s.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Ot(new Yr(t.slice()))}}function kN(r,t){const s=r.toTimestamp().seconds,i=r.toTimestamp().nanoseconds+1,n=Ht.fromTimestamp(i===1e9?new An(s+1,0):new An(s,i));return new fo(n,Ot.empty(),t)}function FN(r){return new fo(r.readTime,r.key,-1)}class fo{constructor(t,s,i){this.readTime=t,this.documentKey=s,this.largestBatchId=i}static min(){return new fo(Ht.min(),Ot.empty(),-1)}static max(){return new fo(Ht.max(),Ot.empty(),-1)}}function NN(r,t){let s=r.readTime.compareTo(t.readTime);return s!==0?s:(s=Ot.comparator(r.documentKey,t.documentKey),s!==0?s:Ar(r.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class DN{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function If(r){if(r.code!==Pe.FAILED_PRECONDITION||r.message!==IN)throw r;Ft("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Be{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(s=>{this.isDone=!0,this.result=s,this.nextCallback&&this.nextCallback(s)},s=>{this.isDone=!0,this.error=s,this.catchCallback&&this.catchCallback(s)})}catch(t){return this.next(void 0,t)}next(t,s){return this.callbackAttached&&$t(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(s,this.error):this.wrapSuccess(t,this.result):new Be((i,n)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(i,n)},this.catchCallback=e=>{this.wrapFailure(s,e).next(i,n)}})}toPromise(){return new Promise((t,s)=>{this.next(t,s)})}wrapUserFunction(t){try{const s=t();return s instanceof Be?s:Be.resolve(s)}catch(s){return Be.reject(s)}}wrapSuccess(t,s){return t?this.wrapUserFunction(()=>t(s)):Be.resolve(s)}wrapFailure(t,s){return t?this.wrapUserFunction(()=>t(s)):Be.reject(s)}static resolve(t){return new Be((s,i)=>{s(t)})}static reject(t){return new Be((s,i)=>{i(t)})}static waitFor(t){return new Be((s,i)=>{let n=0,e=0,p=!1;t.forEach(x=>{++n,x.next(()=>{++e,p&&e===n&&s()},w=>i(w))}),p=!0,e===n&&s()})}static or(t){let s=Be.resolve(!1);for(const i of t)s=s.next(n=>n?Be.resolve(n):i());return s}static forEach(t,s){const i=[];return t.forEach((n,e)=>{i.push(s.call(this,n,e))}),this.waitFor(i)}static mapArray(t,s){return new Be((i,n)=>{const e=t.length,p=new Array(e);let x=0;for(let w=0;w<e;w++){const E=w;s(t[E]).next(N=>{p[E]=N,++x,x===e&&i(p)},N=>n(N))}})}static doWhile(t,s){return new Be((i,n)=>{const e=()=>{t()===!0?s().next(()=>{e()},n):i()};e()})}}function RN(r){const t=r.match(/Android ([\d.]+)/i),s=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(s)}function Df(r){return r.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f2{constructor(t,s){this.previousValue=t,s&&(s.sequenceNumberHandler=i=>this.ie(i),this.se=i=>s.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.se&&this.se(t),t}}f2.oe=-1;function N0(r){return r==null}function t0(r){return r===0&&1/r==-1/0}function PN(r){return typeof r=="number"&&Number.isInteger(r)&&!t0(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B4(r){let t=0;for(const s in r)Object.prototype.hasOwnProperty.call(r,s)&&t++;return t}function ml(r,t){for(const s in r)Object.prototype.hasOwnProperty.call(r,s)&&t(s,r[s])}function bT(r){for(const t in r)if(Object.prototype.hasOwnProperty.call(r,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(t,s){this.comparator=t,this.root=s||Wn.EMPTY}insert(t,s){return new ln(this.comparator,this.root.insert(t,s,this.comparator).copy(null,null,Wn.BLACK,null,null))}remove(t){return new ln(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Wn.BLACK,null,null))}get(t){let s=this.root;for(;!s.isEmpty();){const i=this.comparator(t,s.key);if(i===0)return s.value;i<0?s=s.left:i>0&&(s=s.right)}return null}indexOf(t){let s=0,i=this.root;for(;!i.isEmpty();){const n=this.comparator(t,i.key);if(n===0)return s+i.left.size;n<0?i=i.left:(s+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((s,i)=>(t(s,i),!1))}toString(){const t=[];return this.inorderTraversal((s,i)=>(t.push(`${s}:${i}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new od(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new od(this.root,t,this.comparator,!1)}getReverseIterator(){return new od(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new od(this.root,t,this.comparator,!0)}}class od{constructor(t,s,i,n){this.isReverse=n,this.nodeStack=[];let e=1;for(;!t.isEmpty();)if(e=s?i(t.key,s):1,s&&n&&(e*=-1),e<0)t=this.isReverse?t.left:t.right;else{if(e===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const s={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return s}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Wn{constructor(t,s,i,n,e){this.key=t,this.value=s,this.color=i??Wn.RED,this.left=n??Wn.EMPTY,this.right=e??Wn.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,s,i,n,e){return new Wn(t??this.key,s??this.value,i??this.color,n??this.left,e??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,s,i){let n=this;const e=i(t,n.key);return n=e<0?n.copy(null,null,null,n.left.insert(t,s,i),null):e===0?n.copy(null,s,null,null,null):n.copy(null,null,null,null,n.right.insert(t,s,i)),n.fixUp()}removeMin(){if(this.left.isEmpty())return Wn.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,s){let i,n=this;if(s(t,n.key)<0)n.left.isEmpty()||n.left.isRed()||n.left.left.isRed()||(n=n.moveRedLeft()),n=n.copy(null,null,null,n.left.remove(t,s),null);else{if(n.left.isRed()&&(n=n.rotateRight()),n.right.isEmpty()||n.right.isRed()||n.right.left.isRed()||(n=n.moveRedRight()),s(t,n.key)===0){if(n.right.isEmpty())return Wn.EMPTY;i=n.right.min(),n=n.copy(i.key,i.value,null,null,n.right.removeMin())}n=n.copy(null,null,null,null,n.right.remove(t,s))}return n.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Wn.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Wn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),s=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,s)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw $t();const t=this.left.check();if(t!==this.right.check())throw $t();return t+(this.isRed()?0:1)}}Wn.EMPTY=null,Wn.RED=!0,Wn.BLACK=!1;Wn.EMPTY=new class{constructor(){this.size=0}get key(){throw $t()}get value(){throw $t()}get color(){throw $t()}get left(){throw $t()}get right(){throw $t()}copy(t,s,i,n,e){return this}insert(t,s,i){return new Wn(t,s)}remove(t,s){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(t){this.comparator=t,this.data=new ln(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((s,i)=>(t(s),!1))}forEachInRange(t,s){const i=this.data.getIteratorFrom(t[0]);for(;i.hasNext();){const n=i.getNext();if(this.comparator(n.key,t[1])>=0)return;s(n.key)}}forEachWhile(t,s){let i;for(i=s!==void 0?this.data.getIteratorFrom(s):this.data.getIterator();i.hasNext();)if(!t(i.getNext().key))return}firstAfterOrEqual(t){const s=this.data.getIteratorFrom(t);return s.hasNext()?s.getNext().key:null}getIterator(){return new $4(this.data.getIterator())}getIteratorFrom(t){return new $4(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let s=this;return s.size<t.size&&(s=t,t=this),t.forEach(i=>{s=s.add(i)}),s}isEqual(t){if(!(t instanceof Gn)||this.size!==t.size)return!1;const s=this.data.getIterator(),i=t.data.getIterator();for(;s.hasNext();){const n=s.getNext().key,e=i.getNext().key;if(this.comparator(n,e)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(s=>{t.push(s)}),t}toString(){const t=[];return this.forEach(s=>t.push(s)),"SortedSet("+t.toString()+")"}copy(t){const s=new Gn(this.comparator);return s.data=t,s}}class $4{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ls{constructor(t){this.fields=t,t.sort(zn.comparator)}static empty(){return new Ls([])}unionWith(t){let s=new Gn(zn.comparator);for(const i of this.fields)s=s.add(i);for(const i of t)s=s.add(i);return new Ls(s.toArray())}covers(t){for(const s of this.fields)if(s.isPrefixOf(t))return!0;return!1}isEqual(t){return bc(this.fields,t.fields,(s,i)=>s.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(t){this.binaryString=t}static fromBase64String(t){const s=function(n){try{return atob(n)}catch(e){throw typeof DOMException<"u"&&e instanceof DOMException?new wT("Invalid base64 string: "+e):e}}(t);return new Kn(s)}static fromUint8Array(t){const s=function(n){let e="";for(let p=0;p<n.length;++p)e+=String.fromCharCode(n[p]);return e}(t);return new Kn(s)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(s){return btoa(s)}(this.binaryString)}toUint8Array(){return function(s){const i=new Uint8Array(s.length);for(let n=0;n<s.length;n++)i[n]=s.charCodeAt(n);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Ar(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Kn.EMPTY_BYTE_STRING=new Kn("");const ON=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ho(r){if(Lr(!!r),typeof r=="string"){let t=0;const s=ON.exec(r);if(Lr(!!s),s[1]){let n=s[1];n=(n+"000000000").substr(0,9),t=Number(n)}const i=new Date(r);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:mn(r.seconds),nanos:mn(r.nanos)}}function mn(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function il(r){return typeof r=="string"?Kn.fromBase64String(r):Kn.fromUint8Array(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h2(r){var t,s;return((s=(((t=r==null?void 0:r.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||s===void 0?void 0:s.stringValue)==="server_timestamp"}function d2(r){const t=r.mapValue.fields.__previous_value__;return h2(t)?d2(t):t}function gf(r){const t=ho(r.mapValue.fields.__local_write_time__.timestampValue);return new An(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jN{constructor(t,s,i,n,e,p,x,w,E){this.databaseId=t,this.appId=s,this.persistenceKey=i,this.host=n,this.ssl=e,this.forceLongPolling=p,this.autoDetectLongPolling=x,this.longPollingOptions=w,this.useFetchStreams=E}}class yf{constructor(t,s){this.projectId=t,this.database=s||"(default)"}static empty(){return new yf("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(t){return t instanceof yf&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ld={mapValue:{}};function ol(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?h2(r)?4:LN(r)?9007199254740991:MN(r)?10:11:$t()}function Ka(r,t){if(r===t)return!0;const s=ol(r);if(s!==ol(t))return!1;switch(s){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===t.booleanValue;case 4:return gf(r).isEqual(gf(t));case 3:return function(n,e){if(typeof n.timestampValue=="string"&&typeof e.timestampValue=="string"&&n.timestampValue.length===e.timestampValue.length)return n.timestampValue===e.timestampValue;const p=ho(n.timestampValue),x=ho(e.timestampValue);return p.seconds===x.seconds&&p.nanos===x.nanos}(r,t);case 5:return r.stringValue===t.stringValue;case 6:return function(n,e){return il(n.bytesValue).isEqual(il(e.bytesValue))}(r,t);case 7:return r.referenceValue===t.referenceValue;case 8:return function(n,e){return mn(n.geoPointValue.latitude)===mn(e.geoPointValue.latitude)&&mn(n.geoPointValue.longitude)===mn(e.geoPointValue.longitude)}(r,t);case 2:return function(n,e){if("integerValue"in n&&"integerValue"in e)return mn(n.integerValue)===mn(e.integerValue);if("doubleValue"in n&&"doubleValue"in e){const p=mn(n.doubleValue),x=mn(e.doubleValue);return p===x?t0(p)===t0(x):isNaN(p)&&isNaN(x)}return!1}(r,t);case 9:return bc(r.arrayValue.values||[],t.arrayValue.values||[],Ka);case 10:case 11:return function(n,e){const p=n.mapValue.fields||{},x=e.mapValue.fields||{};if(B4(p)!==B4(x))return!1;for(const w in p)if(p.hasOwnProperty(w)&&(x[w]===void 0||!Ka(p[w],x[w])))return!1;return!0}(r,t);default:return $t()}}function vf(r,t){return(r.values||[]).find(s=>Ka(s,t))!==void 0}function wc(r,t){if(r===t)return 0;const s=ol(r),i=ol(t);if(s!==i)return Ar(s,i);switch(s){case 0:case 9007199254740991:return 0;case 1:return Ar(r.booleanValue,t.booleanValue);case 2:return function(e,p){const x=mn(e.integerValue||e.doubleValue),w=mn(p.integerValue||p.doubleValue);return x<w?-1:x>w?1:x===w?0:isNaN(x)?isNaN(w)?0:-1:1}(r,t);case 3:return W4(r.timestampValue,t.timestampValue);case 4:return W4(gf(r),gf(t));case 5:return Ar(r.stringValue,t.stringValue);case 6:return function(e,p){const x=il(e),w=il(p);return x.compareTo(w)}(r.bytesValue,t.bytesValue);case 7:return function(e,p){const x=e.split("/"),w=p.split("/");for(let E=0;E<x.length&&E<w.length;E++){const N=Ar(x[E],w[E]);if(N!==0)return N}return Ar(x.length,w.length)}(r.referenceValue,t.referenceValue);case 8:return function(e,p){const x=Ar(mn(e.latitude),mn(p.latitude));return x!==0?x:Ar(mn(e.longitude),mn(p.longitude))}(r.geoPointValue,t.geoPointValue);case 9:return z4(r.arrayValue,t.arrayValue);case 10:return function(e,p){var x,w,E,N;const P=e.fields||{},R=p.fields||{},q=(x=P.value)===null||x===void 0?void 0:x.arrayValue,Z=(w=R.value)===null||w===void 0?void 0:w.arrayValue,ne=Ar(((E=q==null?void 0:q.values)===null||E===void 0?void 0:E.length)||0,((N=Z==null?void 0:Z.values)===null||N===void 0?void 0:N.length)||0);return ne!==0?ne:z4(q,Z)}(r.mapValue,t.mapValue);case 11:return function(e,p){if(e===ld.mapValue&&p===ld.mapValue)return 0;if(e===ld.mapValue)return 1;if(p===ld.mapValue)return-1;const x=e.fields||{},w=Object.keys(x),E=p.fields||{},N=Object.keys(E);w.sort(),N.sort();for(let P=0;P<w.length&&P<N.length;++P){const R=Ar(w[P],N[P]);if(R!==0)return R;const q=wc(x[w[P]],E[N[P]]);if(q!==0)return q}return Ar(w.length,N.length)}(r.mapValue,t.mapValue);default:throw $t()}}function W4(r,t){if(typeof r=="string"&&typeof t=="string"&&r.length===t.length)return Ar(r,t);const s=ho(r),i=ho(t),n=Ar(s.seconds,i.seconds);return n!==0?n:Ar(s.nanos,i.nanos)}function z4(r,t){const s=r.values||[],i=t.values||[];for(let n=0;n<s.length&&n<i.length;++n){const e=wc(s[n],i[n]);if(e)return e}return Ar(s.length,i.length)}function _c(r){return Hm(r)}function Hm(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(s){const i=ho(s);return`time(${i.seconds},${i.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?function(s){return il(s).toBase64()}(r.bytesValue):"referenceValue"in r?function(s){return Ot.fromName(s).toString()}(r.referenceValue):"geoPointValue"in r?function(s){return`geo(${s.latitude},${s.longitude})`}(r.geoPointValue):"arrayValue"in r?function(s){let i="[",n=!0;for(const e of s.values||[])n?n=!1:i+=",",i+=Hm(e);return i+"]"}(r.arrayValue):"mapValue"in r?function(s){const i=Object.keys(s.fields||{}).sort();let n="{",e=!0;for(const p of i)e?e=!1:n+=",",n+=`${p}:${Hm(s.fields[p])}`;return n+"}"}(r.mapValue):$t()}function H4(r,t){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${t.path.canonicalString()}`}}function Gm(r){return!!r&&"integerValue"in r}function p2(r){return!!r&&"arrayValue"in r}function G4(r){return!!r&&"nullValue"in r}function q4(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function Ed(r){return!!r&&"mapValue"in r}function MN(r){var t,s;return((s=(((t=r==null?void 0:r.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||s===void 0?void 0:s.stringValue)==="__vector__"}function Hu(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){const t={mapValue:{fields:{}}};return ml(r.mapValue.fields,(s,i)=>t.mapValue.fields[s]=Hu(i)),t}if(r.arrayValue){const t={arrayValue:{values:[]}};for(let s=0;s<(r.arrayValue.values||[]).length;++s)t.arrayValue.values[s]=Hu(r.arrayValue.values[s]);return t}return Object.assign({},r)}function LN(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(t){this.value=t}static empty(){return new Ss({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let s=this.value;for(let i=0;i<t.length-1;++i)if(s=(s.mapValue.fields||{})[t.get(i)],!Ed(s))return null;return s=(s.mapValue.fields||{})[t.lastSegment()],s||null}}set(t,s){this.getFieldsMap(t.popLast())[t.lastSegment()]=Hu(s)}setAll(t){let s=zn.emptyPath(),i={},n=[];t.forEach((p,x)=>{if(!s.isImmediateParentOf(x)){const w=this.getFieldsMap(s);this.applyChanges(w,i,n),i={},n=[],s=x.popLast()}p?i[x.lastSegment()]=Hu(p):n.push(x.lastSegment())});const e=this.getFieldsMap(s);this.applyChanges(e,i,n)}delete(t){const s=this.field(t.popLast());Ed(s)&&s.mapValue.fields&&delete s.mapValue.fields[t.lastSegment()]}isEqual(t){return Ka(this.value,t.value)}getFieldsMap(t){let s=this.value;s.mapValue.fields||(s.mapValue={fields:{}});for(let i=0;i<t.length;++i){let n=s.mapValue.fields[t.get(i)];Ed(n)&&n.mapValue.fields||(n={mapValue:{fields:{}}},s.mapValue.fields[t.get(i)]=n),s=n}return s.mapValue.fields}applyChanges(t,s,i){ml(s,(n,e)=>t[n]=e);for(const n of i)delete t[n]}clone(){return new Ss(Hu(this.value))}}function _T(r){const t=[];return ml(r.fields,(s,i)=>{const n=new zn([s]);if(Ed(i)){const e=_T(i.mapValue).fields;if(e.length===0)t.push(n);else for(const p of e)t.push(n.child(p))}else t.push(n)}),new Ls(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os{constructor(t,s,i,n,e,p,x){this.key=t,this.documentType=s,this.version=i,this.readTime=n,this.createTime=e,this.data=p,this.documentState=x}static newInvalidDocument(t){return new os(t,0,Ht.min(),Ht.min(),Ht.min(),Ss.empty(),0)}static newFoundDocument(t,s,i,n){return new os(t,1,s,Ht.min(),i,n,0)}static newNoDocument(t,s){return new os(t,2,s,Ht.min(),Ht.min(),Ss.empty(),0)}static newUnknownDocument(t,s){return new os(t,3,s,Ht.min(),Ht.min(),Ss.empty(),2)}convertToFoundDocument(t,s){return!this.createTime.isEqual(Ht.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=s,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Ss.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Ss.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ht.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof os&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new os(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r0{constructor(t,s){this.position=t,this.inclusive=s}}function K4(r,t,s){let i=0;for(let n=0;n<r.position.length;n++){const e=t[n],p=r.position[n];if(e.field.isKeyField()?i=Ot.comparator(Ot.fromName(p.referenceValue),s.key):i=wc(p,s.data.field(e.field)),e.dir==="desc"&&(i*=-1),i!==0)break}return i}function Y4(r,t){if(r===null)return t===null;if(t===null||r.inclusive!==t.inclusive||r.position.length!==t.position.length)return!1;for(let s=0;s<r.position.length;s++)if(!Ka(r.position[s],t.position[s]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xf{constructor(t,s="asc"){this.field=t,this.dir=s}}function VN(r,t){return r.dir===t.dir&&r.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TT{}class Sn extends TT{constructor(t,s,i){super(),this.field=t,this.op=s,this.value=i}static create(t,s,i){return t.isKeyField()?s==="in"||s==="not-in"?this.createKeyFieldInFilter(t,s,i):new BN(t,s,i):s==="array-contains"?new zN(t,i):s==="in"?new HN(t,i):s==="not-in"?new GN(t,i):s==="array-contains-any"?new qN(t,i):new Sn(t,s,i)}static createKeyFieldInFilter(t,s,i){return s==="in"?new $N(t,i):new WN(t,i)}matches(t){const s=t.data.field(this.field);return this.op==="!="?s!==null&&this.matchesComparison(wc(s,this.value)):s!==null&&ol(this.value)===ol(s)&&this.matchesComparison(wc(s,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return $t()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Sa extends TT{constructor(t,s){super(),this.filters=t,this.op=s,this.ae=null}static create(t,s){return new Sa(t,s)}matches(t){return ET(this)?this.filters.find(s=>!s.matches(t))===void 0:this.filters.find(s=>s.matches(t))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((t,s)=>t.concat(s.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function ET(r){return r.op==="and"}function ST(r){return UN(r)&&ET(r)}function UN(r){for(const t of r.filters)if(t instanceof Sa)return!1;return!0}function qm(r){if(r instanceof Sn)return r.field.canonicalString()+r.op.toString()+_c(r.value);if(ST(r))return r.filters.map(t=>qm(t)).join(",");{const t=r.filters.map(s=>qm(s)).join(",");return`${r.op}(${t})`}}function AT(r,t){return r instanceof Sn?function(i,n){return n instanceof Sn&&i.op===n.op&&i.field.isEqual(n.field)&&Ka(i.value,n.value)}(r,t):r instanceof Sa?function(i,n){return n instanceof Sa&&i.op===n.op&&i.filters.length===n.filters.length?i.filters.reduce((e,p,x)=>e&&AT(p,n.filters[x]),!0):!1}(r,t):void $t()}function CT(r){return r instanceof Sn?function(s){return`${s.field.canonicalString()} ${s.op} ${_c(s.value)}`}(r):r instanceof Sa?function(s){return s.op.toString()+" {"+s.getFilters().map(CT).join(" ,")+"}"}(r):"Filter"}class BN extends Sn{constructor(t,s,i){super(t,s,i),this.key=Ot.fromName(i.referenceValue)}matches(t){const s=Ot.comparator(t.key,this.key);return this.matchesComparison(s)}}class $N extends Sn{constructor(t,s){super(t,"in",s),this.keys=kT("in",s)}matches(t){return this.keys.some(s=>s.isEqual(t.key))}}class WN extends Sn{constructor(t,s){super(t,"not-in",s),this.keys=kT("not-in",s)}matches(t){return!this.keys.some(s=>s.isEqual(t.key))}}function kT(r,t){var s;return(((s=t.arrayValue)===null||s===void 0?void 0:s.values)||[]).map(i=>Ot.fromName(i.referenceValue))}class zN extends Sn{constructor(t,s){super(t,"array-contains",s)}matches(t){const s=t.data.field(this.field);return p2(s)&&vf(s.arrayValue,this.value)}}class HN extends Sn{constructor(t,s){super(t,"in",s)}matches(t){const s=t.data.field(this.field);return s!==null&&vf(this.value.arrayValue,s)}}class GN extends Sn{constructor(t,s){super(t,"not-in",s)}matches(t){if(vf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const s=t.data.field(this.field);return s!==null&&!vf(this.value.arrayValue,s)}}class qN extends Sn{constructor(t,s){super(t,"array-contains-any",s)}matches(t){const s=t.data.field(this.field);return!(!p2(s)||!s.arrayValue.values)&&s.arrayValue.values.some(i=>vf(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KN{constructor(t,s=null,i=[],n=[],e=null,p=null,x=null){this.path=t,this.collectionGroup=s,this.orderBy=i,this.filters=n,this.limit=e,this.startAt=p,this.endAt=x,this.ue=null}}function Q4(r,t=null,s=[],i=[],n=null,e=null,p=null){return new KN(r,t,s,i,n,e,p)}function m2(r){const t=Gt(r);if(t.ue===null){let s=t.path.canonicalString();t.collectionGroup!==null&&(s+="|cg:"+t.collectionGroup),s+="|f:",s+=t.filters.map(i=>qm(i)).join(","),s+="|ob:",s+=t.orderBy.map(i=>function(e){return e.field.canonicalString()+e.dir}(i)).join(","),N0(t.limit)||(s+="|l:",s+=t.limit),t.startAt&&(s+="|lb:",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map(i=>_c(i)).join(",")),t.endAt&&(s+="|ub:",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map(i=>_c(i)).join(",")),t.ue=s}return t.ue}function g2(r,t){if(r.limit!==t.limit||r.orderBy.length!==t.orderBy.length)return!1;for(let s=0;s<r.orderBy.length;s++)if(!VN(r.orderBy[s],t.orderBy[s]))return!1;if(r.filters.length!==t.filters.length)return!1;for(let s=0;s<r.filters.length;s++)if(!AT(r.filters[s],t.filters[s]))return!1;return r.collectionGroup===t.collectionGroup&&!!r.path.isEqual(t.path)&&!!Y4(r.startAt,t.startAt)&&Y4(r.endAt,t.endAt)}function Km(r){return Ot.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ic{constructor(t,s=null,i=[],n=[],e=null,p="F",x=null,w=null){this.path=t,this.collectionGroup=s,this.explicitOrderBy=i,this.filters=n,this.limit=e,this.limitType=p,this.startAt=x,this.endAt=w,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function YN(r,t,s,i,n,e,p,x){return new Ic(r,t,s,i,n,e,p,x)}function y2(r){return new Ic(r)}function X4(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function FT(r){return r.collectionGroup!==null}function Gu(r){const t=Gt(r);if(t.ce===null){t.ce=[];const s=new Set;for(const e of t.explicitOrderBy)t.ce.push(e),s.add(e.field.canonicalString());const i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(p){let x=new Gn(zn.comparator);return p.filters.forEach(w=>{w.getFlattenedFilters().forEach(E=>{E.isInequality()&&(x=x.add(E.field))})}),x})(t).forEach(e=>{s.has(e.canonicalString())||e.isKeyField()||t.ce.push(new xf(e,i))}),s.has(zn.keyField().canonicalString())||t.ce.push(new xf(zn.keyField(),i))}return t.ce}function Ga(r){const t=Gt(r);return t.le||(t.le=QN(t,Gu(r))),t.le}function QN(r,t){if(r.limitType==="F")return Q4(r.path,r.collectionGroup,t,r.filters,r.limit,r.startAt,r.endAt);{t=t.map(n=>{const e=n.dir==="desc"?"asc":"desc";return new xf(n.field,e)});const s=r.endAt?new r0(r.endAt.position,r.endAt.inclusive):null,i=r.startAt?new r0(r.startAt.position,r.startAt.inclusive):null;return Q4(r.path,r.collectionGroup,t,r.filters,r.limit,s,i)}}function Ym(r,t){const s=r.filters.concat([t]);return new Ic(r.path,r.collectionGroup,r.explicitOrderBy.slice(),s,r.limit,r.limitType,r.startAt,r.endAt)}function Qm(r,t,s){return new Ic(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),t,s,r.startAt,r.endAt)}function I0(r,t){return g2(Ga(r),Ga(t))&&r.limitType===t.limitType}function NT(r){return`${m2(Ga(r))}|lt:${r.limitType}`}function Wl(r){return`Query(target=${function(s){let i=s.path.canonicalString();return s.collectionGroup!==null&&(i+=" collectionGroup="+s.collectionGroup),s.filters.length>0&&(i+=`, filters: [${s.filters.map(n=>CT(n)).join(", ")}]`),N0(s.limit)||(i+=", limit: "+s.limit),s.orderBy.length>0&&(i+=`, orderBy: [${s.orderBy.map(n=>function(p){return`${p.field.canonicalString()} (${p.dir})`}(n)).join(", ")}]`),s.startAt&&(i+=", startAt: ",i+=s.startAt.inclusive?"b:":"a:",i+=s.startAt.position.map(n=>_c(n)).join(",")),s.endAt&&(i+=", endAt: ",i+=s.endAt.inclusive?"a:":"b:",i+=s.endAt.position.map(n=>_c(n)).join(",")),`Target(${i})`}(Ga(r))}; limitType=${r.limitType})`}function D0(r,t){return t.isFoundDocument()&&function(i,n){const e=n.key.path;return i.collectionGroup!==null?n.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(e):Ot.isDocumentKey(i.path)?i.path.isEqual(e):i.path.isImmediateParentOf(e)}(r,t)&&function(i,n){for(const e of Gu(i))if(!e.field.isKeyField()&&n.data.field(e.field)===null)return!1;return!0}(r,t)&&function(i,n){for(const e of i.filters)if(!e.matches(n))return!1;return!0}(r,t)&&function(i,n){return!(i.startAt&&!function(p,x,w){const E=K4(p,x,w);return p.inclusive?E<=0:E<0}(i.startAt,Gu(i),n)||i.endAt&&!function(p,x,w){const E=K4(p,x,w);return p.inclusive?E>=0:E>0}(i.endAt,Gu(i),n))}(r,t)}function XN(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function IT(r){return(t,s)=>{let i=!1;for(const n of Gu(r)){const e=JN(n,t,s);if(e!==0)return e;i=i||n.field.isKeyField()}return 0}}function JN(r,t,s){const i=r.field.isKeyField()?Ot.comparator(t.key,s.key):function(e,p,x){const w=p.data.field(e),E=x.data.field(e);return w!==null&&E!==null?wc(w,E):$t()}(r.field,t,s);switch(r.dir){case"asc":return i;case"desc":return-1*i;default:return $t()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dc{constructor(t,s){this.mapKeyFn=t,this.equalsFn=s,this.inner={},this.innerSize=0}get(t){const s=this.mapKeyFn(t),i=this.inner[s];if(i!==void 0){for(const[n,e]of i)if(this.equalsFn(n,t))return e}}has(t){return this.get(t)!==void 0}set(t,s){const i=this.mapKeyFn(t),n=this.inner[i];if(n===void 0)return this.inner[i]=[[t,s]],void this.innerSize++;for(let e=0;e<n.length;e++)if(this.equalsFn(n[e][0],t))return void(n[e]=[t,s]);n.push([t,s]),this.innerSize++}delete(t){const s=this.mapKeyFn(t),i=this.inner[s];if(i===void 0)return!1;for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],t))return i.length===1?delete this.inner[s]:i.splice(n,1),this.innerSize--,!0;return!1}forEach(t){ml(this.inner,(s,i)=>{for(const[n,e]of i)t(n,e)})}isEmpty(){return bT(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZN=new ln(Ot.comparator);function Ei(){return ZN}const DT=new ln(Ot.comparator);function Ru(...r){let t=DT;for(const s of r)t=t.insert(s.key,s);return t}function RT(r){let t=DT;return r.forEach((s,i)=>t=t.insert(s,i.overlayedDocument)),t}function Yo(){return qu()}function PT(){return qu()}function qu(){return new Dc(r=>r.toString(),(r,t)=>r.isEqual(t))}const e8=new ln(Ot.comparator),t8=new Gn(Ot.comparator);function mr(...r){let t=t8;for(const s of r)t=t.add(s);return t}const r8=new Gn(Ar);function n8(){return r8}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v2(r,t){if(r.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:t0(t)?"-0":t}}function OT(r){return{integerValue:""+r}}function s8(r,t){return PN(t)?OT(t):v2(r,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R0{constructor(){this._=void 0}}function a8(r,t,s){return r instanceof n0?function(n,e){const p={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:n.seconds,nanos:n.nanoseconds}}}};return e&&h2(e)&&(e=d2(e)),e&&(p.fields.__previous_value__=e),{mapValue:p}}(s,t):r instanceof bf?MT(r,t):r instanceof wf?LT(r,t):function(n,e){const p=jT(n,e),x=J4(p)+J4(n.Pe);return Gm(p)&&Gm(n.Pe)?OT(x):v2(n.serializer,x)}(r,t)}function i8(r,t,s){return r instanceof bf?MT(r,t):r instanceof wf?LT(r,t):s}function jT(r,t){return r instanceof s0?function(i){return Gm(i)||function(e){return!!e&&"doubleValue"in e}(i)}(t)?t:{integerValue:0}:null}class n0 extends R0{}class bf extends R0{constructor(t){super(),this.elements=t}}function MT(r,t){const s=VT(t);for(const i of r.elements)s.some(n=>Ka(n,i))||s.push(i);return{arrayValue:{values:s}}}class wf extends R0{constructor(t){super(),this.elements=t}}function LT(r,t){let s=VT(t);for(const i of r.elements)s=s.filter(n=>!Ka(n,i));return{arrayValue:{values:s}}}class s0 extends R0{constructor(t,s){super(),this.serializer=t,this.Pe=s}}function J4(r){return mn(r.integerValue||r.doubleValue)}function VT(r){return p2(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}function o8(r,t){return r.field.isEqual(t.field)&&function(i,n){return i instanceof bf&&n instanceof bf||i instanceof wf&&n instanceof wf?bc(i.elements,n.elements,Ka):i instanceof s0&&n instanceof s0?Ka(i.Pe,n.Pe):i instanceof n0&&n instanceof n0}(r.transform,t.transform)}class l8{constructor(t,s){this.version=t,this.transformResults=s}}class ys{constructor(t,s){this.updateTime=t,this.exists=s}static none(){return new ys}static exists(t){return new ys(void 0,t)}static updateTime(t){return new ys(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Sd(r,t){return r.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(r.updateTime):r.exists===void 0||r.exists===t.isFoundDocument()}class P0{}function UT(r,t){if(!r.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return r.isNoDocument()?new O0(r.key,ys.none()):new Rf(r.key,r.data,ys.none());{const s=r.data,i=Ss.empty();let n=new Gn(zn.comparator);for(let e of t.fields)if(!n.has(e)){let p=s.field(e);p===null&&e.length>1&&(e=e.popLast(),p=s.field(e)),p===null?i.delete(e):i.set(e,p),n=n.add(e)}return new vo(r.key,i,new Ls(n.toArray()),ys.none())}}function c8(r,t,s){r instanceof Rf?function(n,e,p){const x=n.value.clone(),w=ew(n.fieldTransforms,e,p.transformResults);x.setAll(w),e.convertToFoundDocument(p.version,x).setHasCommittedMutations()}(r,t,s):r instanceof vo?function(n,e,p){if(!Sd(n.precondition,e))return void e.convertToUnknownDocument(p.version);const x=ew(n.fieldTransforms,e,p.transformResults),w=e.data;w.setAll(BT(n)),w.setAll(x),e.convertToFoundDocument(p.version,w).setHasCommittedMutations()}(r,t,s):function(n,e,p){e.convertToNoDocument(p.version).setHasCommittedMutations()}(0,t,s)}function Ku(r,t,s,i){return r instanceof Rf?function(e,p,x,w){if(!Sd(e.precondition,p))return x;const E=e.value.clone(),N=tw(e.fieldTransforms,w,p);return E.setAll(N),p.convertToFoundDocument(p.version,E).setHasLocalMutations(),null}(r,t,s,i):r instanceof vo?function(e,p,x,w){if(!Sd(e.precondition,p))return x;const E=tw(e.fieldTransforms,w,p),N=p.data;return N.setAll(BT(e)),N.setAll(E),p.convertToFoundDocument(p.version,N).setHasLocalMutations(),x===null?null:x.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(P=>P.field))}(r,t,s,i):function(e,p,x){return Sd(e.precondition,p)?(p.convertToNoDocument(p.version).setHasLocalMutations(),null):x}(r,t,s)}function u8(r,t){let s=null;for(const i of r.fieldTransforms){const n=t.data.field(i.field),e=jT(i.transform,n||null);e!=null&&(s===null&&(s=Ss.empty()),s.set(i.field,e))}return s||null}function Z4(r,t){return r.type===t.type&&!!r.key.isEqual(t.key)&&!!r.precondition.isEqual(t.precondition)&&!!function(i,n){return i===void 0&&n===void 0||!(!i||!n)&&bc(i,n,(e,p)=>o8(e,p))}(r.fieldTransforms,t.fieldTransforms)&&(r.type===0?r.value.isEqual(t.value):r.type!==1||r.data.isEqual(t.data)&&r.fieldMask.isEqual(t.fieldMask))}class Rf extends P0{constructor(t,s,i,n=[]){super(),this.key=t,this.value=s,this.precondition=i,this.fieldTransforms=n,this.type=0}getFieldMask(){return null}}class vo extends P0{constructor(t,s,i,n,e=[]){super(),this.key=t,this.data=s,this.fieldMask=i,this.precondition=n,this.fieldTransforms=e,this.type=1}getFieldMask(){return this.fieldMask}}function BT(r){const t=new Map;return r.fieldMask.fields.forEach(s=>{if(!s.isEmpty()){const i=r.data.field(s);t.set(s,i)}}),t}function ew(r,t,s){const i=new Map;Lr(r.length===s.length);for(let n=0;n<s.length;n++){const e=r[n],p=e.transform,x=t.data.field(e.field);i.set(e.field,i8(p,x,s[n]))}return i}function tw(r,t,s){const i=new Map;for(const n of r){const e=n.transform,p=s.data.field(n.field);i.set(n.field,a8(e,p,t))}return i}class O0 extends P0{constructor(t,s){super(),this.key=t,this.precondition=s,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class f8 extends P0{constructor(t,s){super(),this.key=t,this.precondition=s,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h8{constructor(t,s,i,n){this.batchId=t,this.localWriteTime=s,this.baseMutations=i,this.mutations=n}applyToRemoteDocument(t,s){const i=s.mutationResults;for(let n=0;n<this.mutations.length;n++){const e=this.mutations[n];e.key.isEqual(t.key)&&c8(e,t,i[n])}}applyToLocalView(t,s){for(const i of this.baseMutations)i.key.isEqual(t.key)&&(s=Ku(i,t,s,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(t.key)&&(s=Ku(i,t,s,this.localWriteTime));return s}applyToLocalDocumentSet(t,s){const i=PT();return this.mutations.forEach(n=>{const e=t.get(n.key),p=e.overlayedDocument;let x=this.applyToLocalView(p,e.mutatedFields);x=s.has(n.key)?null:x;const w=UT(p,x);w!==null&&i.set(n.key,w),p.isValidDocument()||p.convertToNoDocument(Ht.min())}),i}keys(){return this.mutations.reduce((t,s)=>t.add(s.key),mr())}isEqual(t){return this.batchId===t.batchId&&bc(this.mutations,t.mutations,(s,i)=>Z4(s,i))&&bc(this.baseMutations,t.baseMutations,(s,i)=>Z4(s,i))}}class x2{constructor(t,s,i,n){this.batch=t,this.commitVersion=s,this.mutationResults=i,this.docVersions=n}static from(t,s,i){Lr(t.mutations.length===i.length);let n=function(){return e8}();const e=t.mutations;for(let p=0;p<e.length;p++)n=n.insert(e[p].key,i[p].version);return new x2(t,s,i,n)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d8{constructor(t,s){this.largestBatchId=t,this.mutation=s}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p8{constructor(t,s){this.count=t,this.unchangedNames=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Tn,yr;function m8(r){switch(r){default:return $t();case Pe.CANCELLED:case Pe.UNKNOWN:case Pe.DEADLINE_EXCEEDED:case Pe.RESOURCE_EXHAUSTED:case Pe.INTERNAL:case Pe.UNAVAILABLE:case Pe.UNAUTHENTICATED:return!1;case Pe.INVALID_ARGUMENT:case Pe.NOT_FOUND:case Pe.ALREADY_EXISTS:case Pe.PERMISSION_DENIED:case Pe.FAILED_PRECONDITION:case Pe.ABORTED:case Pe.OUT_OF_RANGE:case Pe.UNIMPLEMENTED:case Pe.DATA_LOSS:return!0}}function $T(r){if(r===void 0)return Ti("GRPC error has no .code"),Pe.UNKNOWN;switch(r){case Tn.OK:return Pe.OK;case Tn.CANCELLED:return Pe.CANCELLED;case Tn.UNKNOWN:return Pe.UNKNOWN;case Tn.DEADLINE_EXCEEDED:return Pe.DEADLINE_EXCEEDED;case Tn.RESOURCE_EXHAUSTED:return Pe.RESOURCE_EXHAUSTED;case Tn.INTERNAL:return Pe.INTERNAL;case Tn.UNAVAILABLE:return Pe.UNAVAILABLE;case Tn.UNAUTHENTICATED:return Pe.UNAUTHENTICATED;case Tn.INVALID_ARGUMENT:return Pe.INVALID_ARGUMENT;case Tn.NOT_FOUND:return Pe.NOT_FOUND;case Tn.ALREADY_EXISTS:return Pe.ALREADY_EXISTS;case Tn.PERMISSION_DENIED:return Pe.PERMISSION_DENIED;case Tn.FAILED_PRECONDITION:return Pe.FAILED_PRECONDITION;case Tn.ABORTED:return Pe.ABORTED;case Tn.OUT_OF_RANGE:return Pe.OUT_OF_RANGE;case Tn.UNIMPLEMENTED:return Pe.UNIMPLEMENTED;case Tn.DATA_LOSS:return Pe.DATA_LOSS;default:return $t()}}(yr=Tn||(Tn={}))[yr.OK=0]="OK",yr[yr.CANCELLED=1]="CANCELLED",yr[yr.UNKNOWN=2]="UNKNOWN",yr[yr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",yr[yr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",yr[yr.NOT_FOUND=5]="NOT_FOUND",yr[yr.ALREADY_EXISTS=6]="ALREADY_EXISTS",yr[yr.PERMISSION_DENIED=7]="PERMISSION_DENIED",yr[yr.UNAUTHENTICATED=16]="UNAUTHENTICATED",yr[yr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",yr[yr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",yr[yr.ABORTED=10]="ABORTED",yr[yr.OUT_OF_RANGE=11]="OUT_OF_RANGE",yr[yr.UNIMPLEMENTED=12]="UNIMPLEMENTED",yr[yr.INTERNAL=13]="INTERNAL",yr[yr.UNAVAILABLE=14]="UNAVAILABLE",yr[yr.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g8(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y8=new Zo([4294967295,4294967295],0);function rw(r){const t=g8().encode(r),s=new hT;return s.update(t),new Uint8Array(s.digest())}function nw(r){const t=new DataView(r.buffer),s=t.getUint32(0,!0),i=t.getUint32(4,!0),n=t.getUint32(8,!0),e=t.getUint32(12,!0);return[new Zo([s,i],0),new Zo([n,e],0)]}class b2{constructor(t,s,i){if(this.bitmap=t,this.padding=s,this.hashCount=i,s<0||s>=8)throw new Pu(`Invalid padding: ${s}`);if(i<0)throw new Pu(`Invalid hash count: ${i}`);if(t.length>0&&this.hashCount===0)throw new Pu(`Invalid hash count: ${i}`);if(t.length===0&&s!==0)throw new Pu(`Invalid padding when bitmap length is 0: ${s}`);this.Ie=8*t.length-s,this.Te=Zo.fromNumber(this.Ie)}Ee(t,s,i){let n=t.add(s.multiply(Zo.fromNumber(i)));return n.compare(y8)===1&&(n=new Zo([n.getBits(0),n.getBits(1)],0)),n.modulo(this.Te).toNumber()}de(t){return(this.bitmap[Math.floor(t/8)]&1<<t%8)!=0}mightContain(t){if(this.Ie===0)return!1;const s=rw(t),[i,n]=nw(s);for(let e=0;e<this.hashCount;e++){const p=this.Ee(i,n,e);if(!this.de(p))return!1}return!0}static create(t,s,i){const n=t%8==0?0:8-t%8,e=new Uint8Array(Math.ceil(t/8)),p=new b2(e,n,s);return i.forEach(x=>p.insert(x)),p}insert(t){if(this.Ie===0)return;const s=rw(t),[i,n]=nw(s);for(let e=0;e<this.hashCount;e++){const p=this.Ee(i,n,e);this.Ae(p)}}Ae(t){const s=Math.floor(t/8),i=t%8;this.bitmap[s]|=1<<i}}class Pu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j0{constructor(t,s,i,n,e){this.snapshotVersion=t,this.targetChanges=s,this.targetMismatches=i,this.documentUpdates=n,this.resolvedLimboDocuments=e}static createSynthesizedRemoteEventForCurrentChange(t,s,i){const n=new Map;return n.set(t,Pf.createSynthesizedTargetChangeForCurrentChange(t,s,i)),new j0(Ht.min(),n,new ln(Ar),Ei(),mr())}}class Pf{constructor(t,s,i,n,e){this.resumeToken=t,this.current=s,this.addedDocuments=i,this.modifiedDocuments=n,this.removedDocuments=e}static createSynthesizedTargetChangeForCurrentChange(t,s,i){return new Pf(i,s,mr(),mr(),mr())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ad{constructor(t,s,i,n){this.Re=t,this.removedTargetIds=s,this.key=i,this.Ve=n}}class WT{constructor(t,s){this.targetId=t,this.me=s}}class zT{constructor(t,s,i=Kn.EMPTY_BYTE_STRING,n=null){this.state=t,this.targetIds=s,this.resumeToken=i,this.cause=n}}class sw{constructor(){this.fe=0,this.ge=iw(),this.pe=Kn.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(t){t.approximateByteSize()>0&&(this.we=!0,this.pe=t)}ve(){let t=mr(),s=mr(),i=mr();return this.ge.forEach((n,e)=>{switch(e){case 0:t=t.add(n);break;case 2:s=s.add(n);break;case 1:i=i.add(n);break;default:$t()}}),new Pf(this.pe,this.ye,t,s,i)}Ce(){this.we=!1,this.ge=iw()}Fe(t,s){this.we=!0,this.ge=this.ge.insert(t,s)}Me(t){this.we=!0,this.ge=this.ge.remove(t)}xe(){this.fe+=1}Oe(){this.fe-=1,Lr(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class v8{constructor(t){this.Le=t,this.Be=new Map,this.ke=Ei(),this.qe=aw(),this.Qe=new ln(Ar)}Ke(t){for(const s of t.Re)t.Ve&&t.Ve.isFoundDocument()?this.$e(s,t.Ve):this.Ue(s,t.key,t.Ve);for(const s of t.removedTargetIds)this.Ue(s,t.key,t.Ve)}We(t){this.forEachTarget(t,s=>{const i=this.Ge(s);switch(t.state){case 0:this.ze(s)&&i.De(t.resumeToken);break;case 1:i.Oe(),i.Se||i.Ce(),i.De(t.resumeToken);break;case 2:i.Oe(),i.Se||this.removeTarget(s);break;case 3:this.ze(s)&&(i.Ne(),i.De(t.resumeToken));break;case 4:this.ze(s)&&(this.je(s),i.De(t.resumeToken));break;default:$t()}})}forEachTarget(t,s){t.targetIds.length>0?t.targetIds.forEach(s):this.Be.forEach((i,n)=>{this.ze(n)&&s(n)})}He(t){const s=t.targetId,i=t.me.count,n=this.Je(s);if(n){const e=n.target;if(Km(e))if(i===0){const p=new Ot(e.path);this.Ue(s,p,os.newNoDocument(p,Ht.min()))}else Lr(i===1);else{const p=this.Ye(s);if(p!==i){const x=this.Ze(t),w=x?this.Xe(x,t,p):1;if(w!==0){this.je(s);const E=w===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(s,E)}}}}}Ze(t){const s=t.me.unchangedNames;if(!s||!s.bits)return null;const{bits:{bitmap:i="",padding:n=0},hashCount:e=0}=s;let p,x;try{p=il(i).toUint8Array()}catch(w){if(w instanceof wT)return xc("Decoding the base64 bloom filter in existence filter failed ("+w.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw w}try{x=new b2(p,n,e)}catch(w){return xc(w instanceof Pu?"BloomFilter error: ":"Applying bloom filter failed: ",w),null}return x.Ie===0?null:x}Xe(t,s,i){return s.me.count===i-this.nt(t,s.targetId)?0:2}nt(t,s){const i=this.Le.getRemoteKeysForTarget(s);let n=0;return i.forEach(e=>{const p=this.Le.tt(),x=`projects/${p.projectId}/databases/${p.database}/documents/${e.path.canonicalString()}`;t.mightContain(x)||(this.Ue(s,e,null),n++)}),n}rt(t){const s=new Map;this.Be.forEach((e,p)=>{const x=this.Je(p);if(x){if(e.current&&Km(x.target)){const w=new Ot(x.target.path);this.ke.get(w)!==null||this.it(p,w)||this.Ue(p,w,os.newNoDocument(w,t))}e.be&&(s.set(p,e.ve()),e.Ce())}});let i=mr();this.qe.forEach((e,p)=>{let x=!0;p.forEachWhile(w=>{const E=this.Je(w);return!E||E.purpose==="TargetPurposeLimboResolution"||(x=!1,!1)}),x&&(i=i.add(e))}),this.ke.forEach((e,p)=>p.setReadTime(t));const n=new j0(t,s,this.Qe,this.ke,i);return this.ke=Ei(),this.qe=aw(),this.Qe=new ln(Ar),n}$e(t,s){if(!this.ze(t))return;const i=this.it(t,s.key)?2:0;this.Ge(t).Fe(s.key,i),this.ke=this.ke.insert(s.key,s),this.qe=this.qe.insert(s.key,this.st(s.key).add(t))}Ue(t,s,i){if(!this.ze(t))return;const n=this.Ge(t);this.it(t,s)?n.Fe(s,1):n.Me(s),this.qe=this.qe.insert(s,this.st(s).delete(t)),i&&(this.ke=this.ke.insert(s,i))}removeTarget(t){this.Be.delete(t)}Ye(t){const s=this.Ge(t).ve();return this.Le.getRemoteKeysForTarget(t).size+s.addedDocuments.size-s.removedDocuments.size}xe(t){this.Ge(t).xe()}Ge(t){let s=this.Be.get(t);return s||(s=new sw,this.Be.set(t,s)),s}st(t){let s=this.qe.get(t);return s||(s=new Gn(Ar),this.qe=this.qe.insert(t,s)),s}ze(t){const s=this.Je(t)!==null;return s||Ft("WatchChangeAggregator","Detected inactive target",t),s}Je(t){const s=this.Be.get(t);return s&&s.Se?null:this.Le.ot(t)}je(t){this.Be.set(t,new sw),this.Le.getRemoteKeysForTarget(t).forEach(s=>{this.Ue(t,s,null)})}it(t,s){return this.Le.getRemoteKeysForTarget(t).has(s)}}function aw(){return new ln(Ot.comparator)}function iw(){return new ln(Ot.comparator)}const x8={asc:"ASCENDING",desc:"DESCENDING"},b8={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},w8={and:"AND",or:"OR"};class _8{constructor(t,s){this.databaseId=t,this.useProto3Json=s}}function Xm(r,t){return r.useProto3Json||N0(t)?t:{value:t}}function a0(r,t){return r.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function HT(r,t){return r.useProto3Json?t.toBase64():t.toUint8Array()}function T8(r,t){return a0(r,t.toTimestamp())}function qa(r){return Lr(!!r),Ht.fromTimestamp(function(s){const i=ho(s);return new An(i.seconds,i.nanos)}(r))}function w2(r,t){return Jm(r,t).canonicalString()}function Jm(r,t){const s=function(n){return new Yr(["projects",n.projectId,"databases",n.database])}(r).child("documents");return t===void 0?s:s.child(t)}function GT(r){const t=Yr.fromString(r);return Lr(XT(t)),t}function Zm(r,t){return w2(r.databaseId,t.path)}function F1(r,t){const s=GT(t);if(s.get(1)!==r.databaseId.projectId)throw new dt(Pe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+s.get(1)+" vs "+r.databaseId.projectId);if(s.get(3)!==r.databaseId.database)throw new dt(Pe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+s.get(3)+" vs "+r.databaseId.database);return new Ot(KT(s))}function qT(r,t){return w2(r.databaseId,t)}function E8(r){const t=GT(r);return t.length===4?Yr.emptyPath():KT(t)}function eg(r){return new Yr(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function KT(r){return Lr(r.length>4&&r.get(4)==="documents"),r.popFirst(5)}function ow(r,t,s){return{name:Zm(r,t),fields:s.value.mapValue.fields}}function S8(r,t){let s;if("targetChange"in t){t.targetChange;const i=function(E){return E==="NO_CHANGE"?0:E==="ADD"?1:E==="REMOVE"?2:E==="CURRENT"?3:E==="RESET"?4:$t()}(t.targetChange.targetChangeType||"NO_CHANGE"),n=t.targetChange.targetIds||[],e=function(E,N){return E.useProto3Json?(Lr(N===void 0||typeof N=="string"),Kn.fromBase64String(N||"")):(Lr(N===void 0||N instanceof Buffer||N instanceof Uint8Array),Kn.fromUint8Array(N||new Uint8Array))}(r,t.targetChange.resumeToken),p=t.targetChange.cause,x=p&&function(E){const N=E.code===void 0?Pe.UNKNOWN:$T(E.code);return new dt(N,E.message||"")}(p);s=new zT(i,n,e,x||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const n=F1(r,i.document.name),e=qa(i.document.updateTime),p=i.document.createTime?qa(i.document.createTime):Ht.min(),x=new Ss({mapValue:{fields:i.document.fields}}),w=os.newFoundDocument(n,e,p,x),E=i.targetIds||[],N=i.removedTargetIds||[];s=new Ad(E,N,w.key,w)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const n=F1(r,i.document),e=i.readTime?qa(i.readTime):Ht.min(),p=os.newNoDocument(n,e),x=i.removedTargetIds||[];s=new Ad([],x,p.key,p)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const n=F1(r,i.document),e=i.removedTargetIds||[];s=new Ad([],e,n,null)}else{if(!("filter"in t))return $t();{t.filter;const i=t.filter;i.targetId;const{count:n=0,unchangedNames:e}=i,p=new p8(n,e),x=i.targetId;s=new WT(x,p)}}return s}function A8(r,t){let s;if(t instanceof Rf)s={update:ow(r,t.key,t.value)};else if(t instanceof O0)s={delete:Zm(r,t.key)};else if(t instanceof vo)s={update:ow(r,t.key,t.data),updateMask:O8(t.fieldMask)};else{if(!(t instanceof f8))return $t();s={verify:Zm(r,t.key)}}return t.fieldTransforms.length>0&&(s.updateTransforms=t.fieldTransforms.map(i=>function(e,p){const x=p.transform;if(x instanceof n0)return{fieldPath:p.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(x instanceof bf)return{fieldPath:p.field.canonicalString(),appendMissingElements:{values:x.elements}};if(x instanceof wf)return{fieldPath:p.field.canonicalString(),removeAllFromArray:{values:x.elements}};if(x instanceof s0)return{fieldPath:p.field.canonicalString(),increment:x.Pe};throw $t()}(0,i))),t.precondition.isNone||(s.currentDocument=function(n,e){return e.updateTime!==void 0?{updateTime:T8(n,e.updateTime)}:e.exists!==void 0?{exists:e.exists}:$t()}(r,t.precondition)),s}function C8(r,t){return r&&r.length>0?(Lr(t!==void 0),r.map(s=>function(n,e){let p=n.updateTime?qa(n.updateTime):qa(e);return p.isEqual(Ht.min())&&(p=qa(e)),new l8(p,n.transformResults||[])}(s,t))):[]}function k8(r,t){return{documents:[qT(r,t.path)]}}function F8(r,t){const s={structuredQuery:{}},i=t.path;let n;t.collectionGroup!==null?(n=i,s.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n=i.popLast(),s.structuredQuery.from=[{collectionId:i.lastSegment()}]),s.parent=qT(r,n);const e=function(E){if(E.length!==0)return QT(Sa.create(E,"and"))}(t.filters);e&&(s.structuredQuery.where=e);const p=function(E){if(E.length!==0)return E.map(N=>function(R){return{field:zl(R.field),direction:D8(R.dir)}}(N))}(t.orderBy);p&&(s.structuredQuery.orderBy=p);const x=Xm(r,t.limit);return x!==null&&(s.structuredQuery.limit=x),t.startAt&&(s.structuredQuery.startAt=function(E){return{before:E.inclusive,values:E.position}}(t.startAt)),t.endAt&&(s.structuredQuery.endAt=function(E){return{before:!E.inclusive,values:E.position}}(t.endAt)),{_t:s,parent:n}}function N8(r){let t=E8(r.parent);const s=r.structuredQuery,i=s.from?s.from.length:0;let n=null;if(i>0){Lr(i===1);const N=s.from[0];N.allDescendants?n=N.collectionId:t=t.child(N.collectionId)}let e=[];s.where&&(e=function(P){const R=YT(P);return R instanceof Sa&&ST(R)?R.getFilters():[R]}(s.where));let p=[];s.orderBy&&(p=function(P){return P.map(R=>function(Z){return new xf(Hl(Z.field),function(fe){switch(fe){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(Z.direction))}(R))}(s.orderBy));let x=null;s.limit&&(x=function(P){let R;return R=typeof P=="object"?P.value:P,N0(R)?null:R}(s.limit));let w=null;s.startAt&&(w=function(P){const R=!!P.before,q=P.values||[];return new r0(q,R)}(s.startAt));let E=null;return s.endAt&&(E=function(P){const R=!P.before,q=P.values||[];return new r0(q,R)}(s.endAt)),YN(t,n,p,e,x,"F",w,E)}function I8(r,t){const s=function(n){switch(n){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return $t()}}(t.purpose);return s==null?null:{"goog-listen-tags":s}}function YT(r){return r.unaryFilter!==void 0?function(s){switch(s.unaryFilter.op){case"IS_NAN":const i=Hl(s.unaryFilter.field);return Sn.create(i,"==",{doubleValue:NaN});case"IS_NULL":const n=Hl(s.unaryFilter.field);return Sn.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const e=Hl(s.unaryFilter.field);return Sn.create(e,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const p=Hl(s.unaryFilter.field);return Sn.create(p,"!=",{nullValue:"NULL_VALUE"});default:return $t()}}(r):r.fieldFilter!==void 0?function(s){return Sn.create(Hl(s.fieldFilter.field),function(n){switch(n){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return $t()}}(s.fieldFilter.op),s.fieldFilter.value)}(r):r.compositeFilter!==void 0?function(s){return Sa.create(s.compositeFilter.filters.map(i=>YT(i)),function(n){switch(n){case"AND":return"and";case"OR":return"or";default:return $t()}}(s.compositeFilter.op))}(r):$t()}function D8(r){return x8[r]}function R8(r){return b8[r]}function P8(r){return w8[r]}function zl(r){return{fieldPath:r.canonicalString()}}function Hl(r){return zn.fromServerFormat(r.fieldPath)}function QT(r){return r instanceof Sn?function(s){if(s.op==="=="){if(q4(s.value))return{unaryFilter:{field:zl(s.field),op:"IS_NAN"}};if(G4(s.value))return{unaryFilter:{field:zl(s.field),op:"IS_NULL"}}}else if(s.op==="!="){if(q4(s.value))return{unaryFilter:{field:zl(s.field),op:"IS_NOT_NAN"}};if(G4(s.value))return{unaryFilter:{field:zl(s.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:zl(s.field),op:R8(s.op),value:s.value}}}(r):r instanceof Sa?function(s){const i=s.getFilters().map(n=>QT(n));return i.length===1?i[0]:{compositeFilter:{op:P8(s.op),filters:i}}}(r):$t()}function O8(r){const t=[];return r.fields.forEach(s=>t.push(s.canonicalString())),{fieldPaths:t}}function XT(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi{constructor(t,s,i,n,e=Ht.min(),p=Ht.min(),x=Kn.EMPTY_BYTE_STRING,w=null){this.target=t,this.targetId=s,this.purpose=i,this.sequenceNumber=n,this.snapshotVersion=e,this.lastLimboFreeSnapshotVersion=p,this.resumeToken=x,this.expectedCount=w}withSequenceNumber(t){return new Xi(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,s){return new Xi(this.target,this.targetId,this.purpose,this.sequenceNumber,s,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new Xi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new Xi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j8{constructor(t){this.ct=t}}function M8(r){const t=N8({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?Qm(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L8{constructor(){this.un=new V8}addToCollectionParentIndex(t,s){return this.un.add(s),Be.resolve()}getCollectionParents(t,s){return Be.resolve(this.un.getEntries(s))}addFieldIndex(t,s){return Be.resolve()}deleteFieldIndex(t,s){return Be.resolve()}deleteAllFieldIndexes(t){return Be.resolve()}createTargetIndexes(t,s){return Be.resolve()}getDocumentsMatchingTarget(t,s){return Be.resolve(null)}getIndexType(t,s){return Be.resolve(0)}getFieldIndexes(t,s){return Be.resolve([])}getNextCollectionGroupToUpdate(t){return Be.resolve(null)}getMinOffset(t,s){return Be.resolve(fo.min())}getMinOffsetFromCollectionGroup(t,s){return Be.resolve(fo.min())}updateCollectionGroup(t,s,i){return Be.resolve()}updateIndexEntries(t,s){return Be.resolve()}}class V8{constructor(){this.index={}}add(t){const s=t.lastSegment(),i=t.popLast(),n=this.index[s]||new Gn(Yr.comparator),e=!n.has(i);return this.index[s]=n.add(i),e}has(t){const s=t.lastSegment(),i=t.popLast(),n=this.index[s];return n&&n.has(i)}getEntries(t){return(this.index[t]||new Gn(Yr.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tc{constructor(t){this.Ln=t}next(){return this.Ln+=2,this.Ln}static Bn(){return new Tc(0)}static kn(){return new Tc(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U8{constructor(){this.changes=new Dc(t=>t.toString(),(t,s)=>t.isEqual(s)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,s){this.assertNotApplied(),this.changes.set(t,os.newInvalidDocument(t).setReadTime(s))}getEntry(t,s){this.assertNotApplied();const i=this.changes.get(s);return i!==void 0?Be.resolve(i):this.getFromCache(t,s)}getEntries(t,s){return this.getAllFromCache(t,s)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B8{constructor(t,s){this.overlayedDocument=t,this.mutatedFields=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $8{constructor(t,s,i,n){this.remoteDocumentCache=t,this.mutationQueue=s,this.documentOverlayCache=i,this.indexManager=n}getDocument(t,s){let i=null;return this.documentOverlayCache.getOverlay(t,s).next(n=>(i=n,this.remoteDocumentCache.getEntry(t,s))).next(n=>(i!==null&&Ku(i.mutation,n,Ls.empty(),An.now()),n))}getDocuments(t,s){return this.remoteDocumentCache.getEntries(t,s).next(i=>this.getLocalViewOfDocuments(t,i,mr()).next(()=>i))}getLocalViewOfDocuments(t,s,i=mr()){const n=Yo();return this.populateOverlays(t,n,s).next(()=>this.computeViews(t,s,n,i).next(e=>{let p=Ru();return e.forEach((x,w)=>{p=p.insert(x,w.overlayedDocument)}),p}))}getOverlayedDocuments(t,s){const i=Yo();return this.populateOverlays(t,i,s).next(()=>this.computeViews(t,s,i,mr()))}populateOverlays(t,s,i){const n=[];return i.forEach(e=>{s.has(e)||n.push(e)}),this.documentOverlayCache.getOverlays(t,n).next(e=>{e.forEach((p,x)=>{s.set(p,x)})})}computeViews(t,s,i,n){let e=Ei();const p=qu(),x=function(){return qu()}();return s.forEach((w,E)=>{const N=i.get(E.key);n.has(E.key)&&(N===void 0||N.mutation instanceof vo)?e=e.insert(E.key,E):N!==void 0?(p.set(E.key,N.mutation.getFieldMask()),Ku(N.mutation,E,N.mutation.getFieldMask(),An.now())):p.set(E.key,Ls.empty())}),this.recalculateAndSaveOverlays(t,e).next(w=>(w.forEach((E,N)=>p.set(E,N)),s.forEach((E,N)=>{var P;return x.set(E,new B8(N,(P=p.get(E))!==null&&P!==void 0?P:null))}),x))}recalculateAndSaveOverlays(t,s){const i=qu();let n=new ln((p,x)=>p-x),e=mr();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,s).next(p=>{for(const x of p)x.keys().forEach(w=>{const E=s.get(w);if(E===null)return;let N=i.get(w)||Ls.empty();N=x.applyToLocalView(E,N),i.set(w,N);const P=(n.get(x.batchId)||mr()).add(w);n=n.insert(x.batchId,P)})}).next(()=>{const p=[],x=n.getReverseIterator();for(;x.hasNext();){const w=x.getNext(),E=w.key,N=w.value,P=PT();N.forEach(R=>{if(!e.has(R)){const q=UT(s.get(R),i.get(R));q!==null&&P.set(R,q),e=e.add(R)}}),p.push(this.documentOverlayCache.saveOverlays(t,E,P))}return Be.waitFor(p)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(t,s){return this.remoteDocumentCache.getEntries(t,s).next(i=>this.recalculateAndSaveOverlays(t,i))}getDocumentsMatchingQuery(t,s,i,n){return function(p){return Ot.isDocumentKey(p.path)&&p.collectionGroup===null&&p.filters.length===0}(s)?this.getDocumentsMatchingDocumentQuery(t,s.path):FT(s)?this.getDocumentsMatchingCollectionGroupQuery(t,s,i,n):this.getDocumentsMatchingCollectionQuery(t,s,i,n)}getNextDocuments(t,s,i,n){return this.remoteDocumentCache.getAllFromCollectionGroup(t,s,i,n).next(e=>{const p=n-e.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,s,i.largestBatchId,n-e.size):Be.resolve(Yo());let x=-1,w=e;return p.next(E=>Be.forEach(E,(N,P)=>(x<P.largestBatchId&&(x=P.largestBatchId),e.get(N)?Be.resolve():this.remoteDocumentCache.getEntry(t,N).next(R=>{w=w.insert(N,R)}))).next(()=>this.populateOverlays(t,E,e)).next(()=>this.computeViews(t,w,E,mr())).next(N=>({batchId:x,changes:RT(N)})))})}getDocumentsMatchingDocumentQuery(t,s){return this.getDocument(t,new Ot(s)).next(i=>{let n=Ru();return i.isFoundDocument()&&(n=n.insert(i.key,i)),n})}getDocumentsMatchingCollectionGroupQuery(t,s,i,n){const e=s.collectionGroup;let p=Ru();return this.indexManager.getCollectionParents(t,e).next(x=>Be.forEach(x,w=>{const E=function(P,R){return new Ic(R,null,P.explicitOrderBy.slice(),P.filters.slice(),P.limit,P.limitType,P.startAt,P.endAt)}(s,w.child(e));return this.getDocumentsMatchingCollectionQuery(t,E,i,n).next(N=>{N.forEach((P,R)=>{p=p.insert(P,R)})})}).next(()=>p))}getDocumentsMatchingCollectionQuery(t,s,i,n){let e;return this.documentOverlayCache.getOverlaysForCollection(t,s.path,i.largestBatchId).next(p=>(e=p,this.remoteDocumentCache.getDocumentsMatchingQuery(t,s,i,e,n))).next(p=>{e.forEach((w,E)=>{const N=E.getKey();p.get(N)===null&&(p=p.insert(N,os.newInvalidDocument(N)))});let x=Ru();return p.forEach((w,E)=>{const N=e.get(w);N!==void 0&&Ku(N.mutation,E,Ls.empty(),An.now()),D0(s,E)&&(x=x.insert(w,E))}),x})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W8{constructor(t){this.serializer=t,this.hr=new Map,this.Pr=new Map}getBundleMetadata(t,s){return Be.resolve(this.hr.get(s))}saveBundleMetadata(t,s){return this.hr.set(s.id,function(n){return{id:n.id,version:n.version,createTime:qa(n.createTime)}}(s)),Be.resolve()}getNamedQuery(t,s){return Be.resolve(this.Pr.get(s))}saveNamedQuery(t,s){return this.Pr.set(s.name,function(n){return{name:n.name,query:M8(n.bundledQuery),readTime:qa(n.readTime)}}(s)),Be.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z8{constructor(){this.overlays=new ln(Ot.comparator),this.Ir=new Map}getOverlay(t,s){return Be.resolve(this.overlays.get(s))}getOverlays(t,s){const i=Yo();return Be.forEach(s,n=>this.getOverlay(t,n).next(e=>{e!==null&&i.set(n,e)})).next(()=>i)}saveOverlays(t,s,i){return i.forEach((n,e)=>{this.ht(t,s,e)}),Be.resolve()}removeOverlaysForBatchId(t,s,i){const n=this.Ir.get(i);return n!==void 0&&(n.forEach(e=>this.overlays=this.overlays.remove(e)),this.Ir.delete(i)),Be.resolve()}getOverlaysForCollection(t,s,i){const n=Yo(),e=s.length+1,p=new Ot(s.child("")),x=this.overlays.getIteratorFrom(p);for(;x.hasNext();){const w=x.getNext().value,E=w.getKey();if(!s.isPrefixOf(E.path))break;E.path.length===e&&w.largestBatchId>i&&n.set(w.getKey(),w)}return Be.resolve(n)}getOverlaysForCollectionGroup(t,s,i,n){let e=new ln((E,N)=>E-N);const p=this.overlays.getIterator();for(;p.hasNext();){const E=p.getNext().value;if(E.getKey().getCollectionGroup()===s&&E.largestBatchId>i){let N=e.get(E.largestBatchId);N===null&&(N=Yo(),e=e.insert(E.largestBatchId,N)),N.set(E.getKey(),E)}}const x=Yo(),w=e.getIterator();for(;w.hasNext()&&(w.getNext().value.forEach((E,N)=>x.set(E,N)),!(x.size()>=n)););return Be.resolve(x)}ht(t,s,i){const n=this.overlays.get(i.key);if(n!==null){const p=this.Ir.get(n.largestBatchId).delete(i.key);this.Ir.set(n.largestBatchId,p)}this.overlays=this.overlays.insert(i.key,new d8(s,i));let e=this.Ir.get(s);e===void 0&&(e=mr(),this.Ir.set(s,e)),this.Ir.set(s,e.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H8{constructor(){this.sessionToken=Kn.EMPTY_BYTE_STRING}getSessionToken(t){return Be.resolve(this.sessionToken)}setSessionToken(t,s){return this.sessionToken=s,Be.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _2{constructor(){this.Tr=new Gn(jn.Er),this.dr=new Gn(jn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(t,s){const i=new jn(t,s);this.Tr=this.Tr.add(i),this.dr=this.dr.add(i)}Rr(t,s){t.forEach(i=>this.addReference(i,s))}removeReference(t,s){this.Vr(new jn(t,s))}mr(t,s){t.forEach(i=>this.removeReference(i,s))}gr(t){const s=new Ot(new Yr([])),i=new jn(s,t),n=new jn(s,t+1),e=[];return this.dr.forEachInRange([i,n],p=>{this.Vr(p),e.push(p.key)}),e}pr(){this.Tr.forEach(t=>this.Vr(t))}Vr(t){this.Tr=this.Tr.delete(t),this.dr=this.dr.delete(t)}yr(t){const s=new Ot(new Yr([])),i=new jn(s,t),n=new jn(s,t+1);let e=mr();return this.dr.forEachInRange([i,n],p=>{e=e.add(p.key)}),e}containsKey(t){const s=new jn(t,0),i=this.Tr.firstAfterOrEqual(s);return i!==null&&t.isEqual(i.key)}}class jn{constructor(t,s){this.key=t,this.wr=s}static Er(t,s){return Ot.comparator(t.key,s.key)||Ar(t.wr,s.wr)}static Ar(t,s){return Ar(t.wr,s.wr)||Ot.comparator(t.key,s.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G8{constructor(t,s){this.indexManager=t,this.referenceDelegate=s,this.mutationQueue=[],this.Sr=1,this.br=new Gn(jn.Er)}checkEmpty(t){return Be.resolve(this.mutationQueue.length===0)}addMutationBatch(t,s,i,n){const e=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const p=new h8(e,s,i,n);this.mutationQueue.push(p);for(const x of n)this.br=this.br.add(new jn(x.key,e)),this.indexManager.addToCollectionParentIndex(t,x.key.path.popLast());return Be.resolve(p)}lookupMutationBatch(t,s){return Be.resolve(this.Dr(s))}getNextMutationBatchAfterBatchId(t,s){const i=s+1,n=this.vr(i),e=n<0?0:n;return Be.resolve(this.mutationQueue.length>e?this.mutationQueue[e]:null)}getHighestUnacknowledgedBatchId(){return Be.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(t){return Be.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,s){const i=new jn(s,0),n=new jn(s,Number.POSITIVE_INFINITY),e=[];return this.br.forEachInRange([i,n],p=>{const x=this.Dr(p.wr);e.push(x)}),Be.resolve(e)}getAllMutationBatchesAffectingDocumentKeys(t,s){let i=new Gn(Ar);return s.forEach(n=>{const e=new jn(n,0),p=new jn(n,Number.POSITIVE_INFINITY);this.br.forEachInRange([e,p],x=>{i=i.add(x.wr)})}),Be.resolve(this.Cr(i))}getAllMutationBatchesAffectingQuery(t,s){const i=s.path,n=i.length+1;let e=i;Ot.isDocumentKey(e)||(e=e.child(""));const p=new jn(new Ot(e),0);let x=new Gn(Ar);return this.br.forEachWhile(w=>{const E=w.key.path;return!!i.isPrefixOf(E)&&(E.length===n&&(x=x.add(w.wr)),!0)},p),Be.resolve(this.Cr(x))}Cr(t){const s=[];return t.forEach(i=>{const n=this.Dr(i);n!==null&&s.push(n)}),s}removeMutationBatch(t,s){Lr(this.Fr(s.batchId,"removed")===0),this.mutationQueue.shift();let i=this.br;return Be.forEach(s.mutations,n=>{const e=new jn(n.key,s.batchId);return i=i.delete(e),this.referenceDelegate.markPotentiallyOrphaned(t,n.key)}).next(()=>{this.br=i})}On(t){}containsKey(t,s){const i=new jn(s,0),n=this.br.firstAfterOrEqual(i);return Be.resolve(s.isEqual(n&&n.key))}performConsistencyCheck(t){return this.mutationQueue.length,Be.resolve()}Fr(t,s){return this.vr(t)}vr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Dr(t){const s=this.vr(t);return s<0||s>=this.mutationQueue.length?null:this.mutationQueue[s]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q8{constructor(t){this.Mr=t,this.docs=function(){return new ln(Ot.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,s){const i=s.key,n=this.docs.get(i),e=n?n.size:0,p=this.Mr(s);return this.docs=this.docs.insert(i,{document:s.mutableCopy(),size:p}),this.size+=p-e,this.indexManager.addToCollectionParentIndex(t,i.path.popLast())}removeEntry(t){const s=this.docs.get(t);s&&(this.docs=this.docs.remove(t),this.size-=s.size)}getEntry(t,s){const i=this.docs.get(s);return Be.resolve(i?i.document.mutableCopy():os.newInvalidDocument(s))}getEntries(t,s){let i=Ei();return s.forEach(n=>{const e=this.docs.get(n);i=i.insert(n,e?e.document.mutableCopy():os.newInvalidDocument(n))}),Be.resolve(i)}getDocumentsMatchingQuery(t,s,i,n){let e=Ei();const p=s.path,x=new Ot(p.child("")),w=this.docs.getIteratorFrom(x);for(;w.hasNext();){const{key:E,value:{document:N}}=w.getNext();if(!p.isPrefixOf(E.path))break;E.path.length>p.length+1||NN(FN(N),i)<=0||(n.has(N.key)||D0(s,N))&&(e=e.insert(N.key,N.mutableCopy()))}return Be.resolve(e)}getAllFromCollectionGroup(t,s,i,n){$t()}Or(t,s){return Be.forEach(this.docs,i=>s(i))}newChangeBuffer(t){return new K8(this)}getSize(t){return Be.resolve(this.size)}}class K8 extends U8{constructor(t){super(),this.cr=t}applyChanges(t){const s=[];return this.changes.forEach((i,n)=>{n.isValidDocument()?s.push(this.cr.addEntry(t,n)):this.cr.removeEntry(i)}),Be.waitFor(s)}getFromCache(t,s){return this.cr.getEntry(t,s)}getAllFromCache(t,s){return this.cr.getEntries(t,s)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y8{constructor(t){this.persistence=t,this.Nr=new Dc(s=>m2(s),g2),this.lastRemoteSnapshotVersion=Ht.min(),this.highestTargetId=0,this.Lr=0,this.Br=new _2,this.targetCount=0,this.kr=Tc.Bn()}forEachTarget(t,s){return this.Nr.forEach((i,n)=>s(n)),Be.resolve()}getLastRemoteSnapshotVersion(t){return Be.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return Be.resolve(this.Lr)}allocateTargetId(t){return this.highestTargetId=this.kr.next(),Be.resolve(this.highestTargetId)}setTargetsMetadata(t,s,i){return i&&(this.lastRemoteSnapshotVersion=i),s>this.Lr&&(this.Lr=s),Be.resolve()}Kn(t){this.Nr.set(t.target,t);const s=t.targetId;s>this.highestTargetId&&(this.kr=new Tc(s),this.highestTargetId=s),t.sequenceNumber>this.Lr&&(this.Lr=t.sequenceNumber)}addTargetData(t,s){return this.Kn(s),this.targetCount+=1,Be.resolve()}updateTargetData(t,s){return this.Kn(s),Be.resolve()}removeTargetData(t,s){return this.Nr.delete(s.target),this.Br.gr(s.targetId),this.targetCount-=1,Be.resolve()}removeTargets(t,s,i){let n=0;const e=[];return this.Nr.forEach((p,x)=>{x.sequenceNumber<=s&&i.get(x.targetId)===null&&(this.Nr.delete(p),e.push(this.removeMatchingKeysForTargetId(t,x.targetId)),n++)}),Be.waitFor(e).next(()=>n)}getTargetCount(t){return Be.resolve(this.targetCount)}getTargetData(t,s){const i=this.Nr.get(s)||null;return Be.resolve(i)}addMatchingKeys(t,s,i){return this.Br.Rr(s,i),Be.resolve()}removeMatchingKeys(t,s,i){this.Br.mr(s,i);const n=this.persistence.referenceDelegate,e=[];return n&&s.forEach(p=>{e.push(n.markPotentiallyOrphaned(t,p))}),Be.waitFor(e)}removeMatchingKeysForTargetId(t,s){return this.Br.gr(s),Be.resolve()}getMatchingKeysForTargetId(t,s){const i=this.Br.yr(s);return Be.resolve(i)}containsKey(t,s){return Be.resolve(this.Br.containsKey(s))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q8{constructor(t,s){this.qr={},this.overlays={},this.Qr=new f2(0),this.Kr=!1,this.Kr=!0,this.$r=new H8,this.referenceDelegate=t(this),this.Ur=new Y8(this),this.indexManager=new L8,this.remoteDocumentCache=function(n){return new q8(n)}(i=>this.referenceDelegate.Wr(i)),this.serializer=new j8(s),this.Gr=new W8(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let s=this.overlays[t.toKey()];return s||(s=new z8,this.overlays[t.toKey()]=s),s}getMutationQueue(t,s){let i=this.qr[t.toKey()];return i||(i=new G8(s,this.referenceDelegate),this.qr[t.toKey()]=i),i}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(t,s,i){Ft("MemoryPersistence","Starting transaction:",t);const n=new X8(this.Qr.next());return this.referenceDelegate.zr(),i(n).next(e=>this.referenceDelegate.jr(n).next(()=>e)).toPromise().then(e=>(n.raiseOnCommittedEvent(),e))}Hr(t,s){return Be.or(Object.values(this.qr).map(i=>()=>i.containsKey(t,s)))}}class X8 extends DN{constructor(t){super(),this.currentSequenceNumber=t}}class T2{constructor(t){this.persistence=t,this.Jr=new _2,this.Yr=null}static Zr(t){return new T2(t)}get Xr(){if(this.Yr)return this.Yr;throw $t()}addReference(t,s,i){return this.Jr.addReference(i,s),this.Xr.delete(i.toString()),Be.resolve()}removeReference(t,s,i){return this.Jr.removeReference(i,s),this.Xr.add(i.toString()),Be.resolve()}markPotentiallyOrphaned(t,s){return this.Xr.add(s.toString()),Be.resolve()}removeTarget(t,s){this.Jr.gr(s.targetId).forEach(n=>this.Xr.add(n.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(t,s.targetId).next(n=>{n.forEach(e=>this.Xr.add(e.toString()))}).next(()=>i.removeTargetData(t,s))}zr(){this.Yr=new Set}jr(t){const s=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Be.forEach(this.Xr,i=>{const n=Ot.fromPath(i);return this.ei(t,n).next(e=>{e||s.removeEntry(n,Ht.min())})}).next(()=>(this.Yr=null,s.apply(t)))}updateLimboDocument(t,s){return this.ei(t,s).next(i=>{i?this.Xr.delete(s.toString()):this.Xr.add(s.toString())})}Wr(t){return 0}ei(t,s){return Be.or([()=>Be.resolve(this.Jr.containsKey(s)),()=>this.persistence.getTargetCache().containsKey(t,s),()=>this.persistence.Hr(t,s)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E2{constructor(t,s,i,n){this.targetId=t,this.fromCache=s,this.$i=i,this.Ui=n}static Wi(t,s){let i=mr(),n=mr();for(const e of s.docChanges)switch(e.type){case 0:i=i.add(e.doc.key);break;case 1:n=n.add(e.doc.key)}return new E2(t,s.fromCache,i,n)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J8{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z8{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return oF()?8:RN(aF())>0?6:4}()}initialize(t,s){this.Ji=t,this.indexManager=s,this.Gi=!0}getDocumentsMatchingQuery(t,s,i,n){const e={result:null};return this.Yi(t,s).next(p=>{e.result=p}).next(()=>{if(!e.result)return this.Zi(t,s,n,i).next(p=>{e.result=p})}).next(()=>{if(e.result)return;const p=new J8;return this.Xi(t,s,p).next(x=>{if(e.result=x,this.zi)return this.es(t,s,p,x.size)})}).next(()=>e.result)}es(t,s,i,n){return i.documentReadCount<this.ji?(Au()<=br.DEBUG&&Ft("QueryEngine","SDK will not create cache indexes for query:",Wl(s),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Be.resolve()):(Au()<=br.DEBUG&&Ft("QueryEngine","Query:",Wl(s),"scans",i.documentReadCount,"local documents and returns",n,"documents as results."),i.documentReadCount>this.Hi*n?(Au()<=br.DEBUG&&Ft("QueryEngine","The SDK decides to create cache indexes for query:",Wl(s),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Ga(s))):Be.resolve())}Yi(t,s){if(X4(s))return Be.resolve(null);let i=Ga(s);return this.indexManager.getIndexType(t,i).next(n=>n===0?null:(s.limit!==null&&n===1&&(s=Qm(s,null,"F"),i=Ga(s)),this.indexManager.getDocumentsMatchingTarget(t,i).next(e=>{const p=mr(...e);return this.Ji.getDocuments(t,p).next(x=>this.indexManager.getMinOffset(t,i).next(w=>{const E=this.ts(s,x);return this.ns(s,E,p,w.readTime)?this.Yi(t,Qm(s,null,"F")):this.rs(t,E,s,w)}))})))}Zi(t,s,i,n){return X4(s)||n.isEqual(Ht.min())?Be.resolve(null):this.Ji.getDocuments(t,i).next(e=>{const p=this.ts(s,e);return this.ns(s,p,i,n)?Be.resolve(null):(Au()<=br.DEBUG&&Ft("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Wl(s)),this.rs(t,p,s,kN(n,-1)).next(x=>x))})}ts(t,s){let i=new Gn(IT(t));return s.forEach((n,e)=>{D0(t,e)&&(i=i.add(e))}),i}ns(t,s,i,n){if(t.limit===null)return!1;if(i.size!==s.size)return!0;const e=t.limitType==="F"?s.last():s.first();return!!e&&(e.hasPendingWrites||e.version.compareTo(n)>0)}Xi(t,s,i){return Au()<=br.DEBUG&&Ft("QueryEngine","Using full collection scan to execute query:",Wl(s)),this.Ji.getDocumentsMatchingQuery(t,s,fo.min(),i)}rs(t,s,i,n){return this.Ji.getDocumentsMatchingQuery(t,i,n).next(e=>(s.forEach(p=>{e=e.insert(p.key,p)}),e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eI{constructor(t,s,i,n){this.persistence=t,this.ss=s,this.serializer=n,this.os=new ln(Ar),this._s=new Dc(e=>m2(e),g2),this.us=new Map,this.cs=t.getRemoteDocumentCache(),this.Ur=t.getTargetCache(),this.Gr=t.getBundleCache(),this.ls(i)}ls(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new $8(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",s=>t.collect(s,this.os))}}function tI(r,t,s,i){return new eI(r,t,s,i)}async function JT(r,t){const s=Gt(r);return await s.persistence.runTransaction("Handle user change","readonly",i=>{let n;return s.mutationQueue.getAllMutationBatches(i).next(e=>(n=e,s.ls(t),s.mutationQueue.getAllMutationBatches(i))).next(e=>{const p=[],x=[];let w=mr();for(const E of n){p.push(E.batchId);for(const N of E.mutations)w=w.add(N.key)}for(const E of e){x.push(E.batchId);for(const N of E.mutations)w=w.add(N.key)}return s.localDocuments.getDocuments(i,w).next(E=>({hs:E,removedBatchIds:p,addedBatchIds:x}))})})}function rI(r,t){const s=Gt(r);return s.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const n=t.batch.keys(),e=s.cs.newChangeBuffer({trackRemovals:!0});return function(x,w,E,N){const P=E.batch,R=P.keys();let q=Be.resolve();return R.forEach(Z=>{q=q.next(()=>N.getEntry(w,Z)).next(ne=>{const fe=E.docVersions.get(Z);Lr(fe!==null),ne.version.compareTo(fe)<0&&(P.applyToRemoteDocument(ne,E),ne.isValidDocument()&&(ne.setReadTime(E.commitVersion),N.addEntry(ne)))})}),q.next(()=>x.mutationQueue.removeMutationBatch(w,P))}(s,i,t,e).next(()=>e.apply(i)).next(()=>s.mutationQueue.performConsistencyCheck(i)).next(()=>s.documentOverlayCache.removeOverlaysForBatchId(i,n,t.batch.batchId)).next(()=>s.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(x){let w=mr();for(let E=0;E<x.mutationResults.length;++E)x.mutationResults[E].transformResults.length>0&&(w=w.add(x.batch.mutations[E].key));return w}(t))).next(()=>s.localDocuments.getDocuments(i,n))})}function ZT(r){const t=Gt(r);return t.persistence.runTransaction("Get last remote snapshot version","readonly",s=>t.Ur.getLastRemoteSnapshotVersion(s))}function nI(r,t){const s=Gt(r),i=t.snapshotVersion;let n=s.os;return s.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const p=s.cs.newChangeBuffer({trackRemovals:!0});n=s.os;const x=[];t.targetChanges.forEach((N,P)=>{const R=n.get(P);if(!R)return;x.push(s.Ur.removeMatchingKeys(e,N.removedDocuments,P).next(()=>s.Ur.addMatchingKeys(e,N.addedDocuments,P)));let q=R.withSequenceNumber(e.currentSequenceNumber);t.targetMismatches.get(P)!==null?q=q.withResumeToken(Kn.EMPTY_BYTE_STRING,Ht.min()).withLastLimboFreeSnapshotVersion(Ht.min()):N.resumeToken.approximateByteSize()>0&&(q=q.withResumeToken(N.resumeToken,i)),n=n.insert(P,q),function(ne,fe,G){return ne.resumeToken.approximateByteSize()===0||fe.snapshotVersion.toMicroseconds()-ne.snapshotVersion.toMicroseconds()>=3e8?!0:G.addedDocuments.size+G.modifiedDocuments.size+G.removedDocuments.size>0}(R,q,N)&&x.push(s.Ur.updateTargetData(e,q))});let w=Ei(),E=mr();if(t.documentUpdates.forEach(N=>{t.resolvedLimboDocuments.has(N)&&x.push(s.persistence.referenceDelegate.updateLimboDocument(e,N))}),x.push(sI(e,p,t.documentUpdates).next(N=>{w=N.Ps,E=N.Is})),!i.isEqual(Ht.min())){const N=s.Ur.getLastRemoteSnapshotVersion(e).next(P=>s.Ur.setTargetsMetadata(e,e.currentSequenceNumber,i));x.push(N)}return Be.waitFor(x).next(()=>p.apply(e)).next(()=>s.localDocuments.getLocalViewOfDocuments(e,w,E)).next(()=>w)}).then(e=>(s.os=n,e))}function sI(r,t,s){let i=mr(),n=mr();return s.forEach(e=>i=i.add(e)),t.getEntries(r,i).next(e=>{let p=Ei();return s.forEach((x,w)=>{const E=e.get(x);w.isFoundDocument()!==E.isFoundDocument()&&(n=n.add(x)),w.isNoDocument()&&w.version.isEqual(Ht.min())?(t.removeEntry(x,w.readTime),p=p.insert(x,w)):!E.isValidDocument()||w.version.compareTo(E.version)>0||w.version.compareTo(E.version)===0&&E.hasPendingWrites?(t.addEntry(w),p=p.insert(x,w)):Ft("LocalStore","Ignoring outdated watch update for ",x,". Current version:",E.version," Watch version:",w.version)}),{Ps:p,Is:n}})}function aI(r,t){const s=Gt(r);return s.persistence.runTransaction("Get next mutation batch","readonly",i=>(t===void 0&&(t=-1),s.mutationQueue.getNextMutationBatchAfterBatchId(i,t)))}function iI(r,t){const s=Gt(r);return s.persistence.runTransaction("Allocate target","readwrite",i=>{let n;return s.Ur.getTargetData(i,t).next(e=>e?(n=e,Be.resolve(n)):s.Ur.allocateTargetId(i).next(p=>(n=new Xi(t,p,"TargetPurposeListen",i.currentSequenceNumber),s.Ur.addTargetData(i,n).next(()=>n))))}).then(i=>{const n=s.os.get(i.targetId);return(n===null||i.snapshotVersion.compareTo(n.snapshotVersion)>0)&&(s.os=s.os.insert(i.targetId,i),s._s.set(t,i.targetId)),i})}async function tg(r,t,s){const i=Gt(r),n=i.os.get(t),e=s?"readwrite":"readwrite-primary";try{s||await i.persistence.runTransaction("Release target",e,p=>i.persistence.referenceDelegate.removeTarget(p,n))}catch(p){if(!Df(p))throw p;Ft("LocalStore",`Failed to update sequence numbers for target ${t}: ${p}`)}i.os=i.os.remove(t),i._s.delete(n.target)}function lw(r,t,s){const i=Gt(r);let n=Ht.min(),e=mr();return i.persistence.runTransaction("Execute query","readwrite",p=>function(w,E,N){const P=Gt(w),R=P._s.get(N);return R!==void 0?Be.resolve(P.os.get(R)):P.Ur.getTargetData(E,N)}(i,p,Ga(t)).next(x=>{if(x)return n=x.lastLimboFreeSnapshotVersion,i.Ur.getMatchingKeysForTargetId(p,x.targetId).next(w=>{e=w})}).next(()=>i.ss.getDocumentsMatchingQuery(p,t,s?n:Ht.min(),s?e:mr())).next(x=>(oI(i,XN(t),x),{documents:x,Ts:e})))}function oI(r,t,s){let i=r.us.get(t)||Ht.min();s.forEach((n,e)=>{e.readTime.compareTo(i)>0&&(i=e.readTime)}),r.us.set(t,i)}class cw{constructor(){this.activeTargetIds=n8()}fs(t){this.activeTargetIds=this.activeTargetIds.add(t)}gs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Vs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class lI{constructor(){this.so=new cw,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,s,i){}addLocalQueryTarget(t,s=!0){return s&&this.so.fs(t),this.oo[t]||"not-current"}updateQueryState(t,s,i){this.oo[t]=s}removeLocalQueryTarget(t){this.so.gs(t)}isLocalQueryTarget(t){return this.so.activeTargetIds.has(t)}clearQueryState(t){delete this.oo[t]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(t){return this.so.activeTargetIds.has(t)}start(){return this.so=new cw,Promise.resolve()}handleUserChange(t,s,i){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cI{_o(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uw{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(t){this.ho.push(t)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Ft("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.ho)t(0)}lo(){Ft("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.ho)t(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cd=null;function N1(){return cd===null?cd=function(){return 268435456+Math.round(2147483648*Math.random())}():cd++,"0x"+cd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uI={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fI{constructor(t){this.Io=t.Io,this.To=t.To}Eo(t){this.Ao=t}Ro(t){this.Vo=t}mo(t){this.fo=t}onMessage(t){this.po=t}close(){this.To()}send(t){this.Io(t)}yo(){this.Ao()}wo(){this.Vo()}So(t){this.fo(t)}bo(t){this.po(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ss="WebChannelConnection";class hI extends class{constructor(s){this.databaseInfo=s,this.databaseId=s.databaseId;const i=s.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),e=encodeURIComponent(this.databaseId.database);this.Do=i+"://"+s.host,this.vo=`projects/${n}/databases/${e}`,this.Co=this.databaseId.database==="(default)"?`project_id=${n}`:`project_id=${n}&database_id=${e}`}get Fo(){return!1}Mo(s,i,n,e,p){const x=N1(),w=this.xo(s,i.toUriEncodedString());Ft("RestConnection",`Sending RPC '${s}' ${x}:`,w,n);const E={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(E,e,p),this.No(s,w,E,n).then(N=>(Ft("RestConnection",`Received RPC '${s}' ${x}: `,N),N),N=>{throw xc("RestConnection",`RPC '${s}' ${x} failed with error: `,N,"url: ",w,"request:",n),N})}Lo(s,i,n,e,p,x){return this.Mo(s,i,n,e,p)}Oo(s,i,n){s["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Nc}(),s["Content-Type"]="text/plain",this.databaseInfo.appId&&(s["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((e,p)=>s[p]=e),n&&n.headers.forEach((e,p)=>s[p]=e)}xo(s,i){const n=uI[s];return`${this.Do}/v1/${i}:${n}`}terminate(){}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}No(t,s,i,n){const e=N1();return new Promise((p,x)=>{const w=new dT;w.setWithCredentials(!0),w.listenOnce(pT.COMPLETE,()=>{try{switch(w.getLastErrorCode()){case Td.NO_ERROR:const N=w.getResponseJson();Ft(ss,`XHR for RPC '${t}' ${e} received:`,JSON.stringify(N)),p(N);break;case Td.TIMEOUT:Ft(ss,`RPC '${t}' ${e} timed out`),x(new dt(Pe.DEADLINE_EXCEEDED,"Request time out"));break;case Td.HTTP_ERROR:const P=w.getStatus();if(Ft(ss,`RPC '${t}' ${e} failed with status:`,P,"response text:",w.getResponseText()),P>0){let R=w.getResponseJson();Array.isArray(R)&&(R=R[0]);const q=R==null?void 0:R.error;if(q&&q.status&&q.message){const Z=function(fe){const G=fe.toLowerCase().replace(/_/g,"-");return Object.values(Pe).indexOf(G)>=0?G:Pe.UNKNOWN}(q.status);x(new dt(Z,q.message))}else x(new dt(Pe.UNKNOWN,"Server responded with status "+w.getStatus()))}else x(new dt(Pe.UNAVAILABLE,"Connection failed."));break;default:$t()}}finally{Ft(ss,`RPC '${t}' ${e} completed.`)}});const E=JSON.stringify(n);Ft(ss,`RPC '${t}' ${e} sending request:`,n),w.send(s,"POST",E,i,15)})}Bo(t,s,i){const n=N1(),e=[this.Do,"/","google.firestore.v1.Firestore","/",t,"/channel"],p=yT(),x=gT(),w={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},E=this.longPollingOptions.timeoutSeconds;E!==void 0&&(w.longPollingTimeout=Math.round(1e3*E)),this.useFetchStreams&&(w.useFetchStreams=!0),this.Oo(w.initMessageHeaders,s,i),w.encodeInitMessageHeaders=!0;const N=e.join("");Ft(ss,`Creating RPC '${t}' stream ${n}: ${N}`,w);const P=p.createWebChannel(N,w);let R=!1,q=!1;const Z=new fI({Io:fe=>{q?Ft(ss,`Not sending because RPC '${t}' stream ${n} is closed:`,fe):(R||(Ft(ss,`Opening RPC '${t}' stream ${n} transport.`),P.open(),R=!0),Ft(ss,`RPC '${t}' stream ${n} sending:`,fe),P.send(fe))},To:()=>P.close()}),ne=(fe,G,U)=>{fe.listen(G,H=>{try{U(H)}catch(ee){setTimeout(()=>{throw ee},0)}})};return ne(P,Du.EventType.OPEN,()=>{q||(Ft(ss,`RPC '${t}' stream ${n} transport opened.`),Z.yo())}),ne(P,Du.EventType.CLOSE,()=>{q||(q=!0,Ft(ss,`RPC '${t}' stream ${n} transport closed`),Z.So())}),ne(P,Du.EventType.ERROR,fe=>{q||(q=!0,xc(ss,`RPC '${t}' stream ${n} transport errored:`,fe),Z.So(new dt(Pe.UNAVAILABLE,"The operation could not be completed")))}),ne(P,Du.EventType.MESSAGE,fe=>{var G;if(!q){const U=fe.data[0];Lr(!!U);const H=U,ee=H.error||((G=H[0])===null||G===void 0?void 0:G.error);if(ee){Ft(ss,`RPC '${t}' stream ${n} received error:`,ee);const te=ee.status;let ue=function(V){const W=Tn[V];if(W!==void 0)return $T(W)}(te),L=ee.message;ue===void 0&&(ue=Pe.INTERNAL,L="Unknown error status: "+te+" with message "+ee.message),q=!0,Z.So(new dt(ue,L)),P.close()}else Ft(ss,`RPC '${t}' stream ${n} received:`,U),Z.bo(U)}}),ne(x,mT.STAT_EVENT,fe=>{fe.stat===zm.PROXY?Ft(ss,`RPC '${t}' stream ${n} detected buffering proxy`):fe.stat===zm.NOPROXY&&Ft(ss,`RPC '${t}' stream ${n} detected no buffering proxy`)}),setTimeout(()=>{Z.wo()},0),Z}}function I1(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M0(r){return new _8(r,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eE{constructor(t,s,i=1e3,n=1.5,e=6e4){this.ui=t,this.timerId=s,this.ko=i,this.qo=n,this.Qo=e,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(t){this.cancel();const s=Math.floor(this.Ko+this.zo()),i=Math.max(0,Date.now()-this.Uo),n=Math.max(0,s-i);n>0&&Ft("ExponentialBackoff",`Backing off for ${n} ms (base delay: ${this.Ko} ms, delay with jitter: ${s} ms, last attempt: ${i} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,n,()=>(this.Uo=Date.now(),t())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tE{constructor(t,s,i,n,e,p,x,w){this.ui=t,this.Ho=i,this.Jo=n,this.connection=e,this.authCredentialsProvider=p,this.appCheckCredentialsProvider=x,this.listener=w,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new eE(t,s)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(t){this.u_(),this.stream.send(t)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(t,s){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,t!==4?this.t_.reset():s&&s.code===Pe.RESOURCE_EXHAUSTED?(Ti(s.toString()),Ti("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):s&&s.code===Pe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.mo(s)}l_(){}auth(){this.state=1;const t=this.h_(this.Yo),s=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,n])=>{this.Yo===s&&this.P_(i,n)},i=>{t(()=>{const n=new dt(Pe.UNKNOWN,"Fetching auth token failed: "+i.message);return this.I_(n)})})}P_(t,s){const i=this.h_(this.Yo);this.stream=this.T_(t,s),this.stream.Eo(()=>{i(()=>this.listener.Eo())}),this.stream.Ro(()=>{i(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(n=>{i(()=>this.I_(n))}),this.stream.onMessage(n=>{i(()=>++this.e_==1?this.E_(n):this.onNext(n))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(t){return Ft("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}h_(t){return s=>{this.ui.enqueueAndForget(()=>this.Yo===t?s():(Ft("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class dI extends tE{constructor(t,s,i,n,e,p){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",s,i,n,p),this.serializer=e}T_(t,s){return this.connection.Bo("Listen",t,s)}E_(t){return this.onNext(t)}onNext(t){this.t_.reset();const s=S8(this.serializer,t),i=function(e){if(!("targetChange"in e))return Ht.min();const p=e.targetChange;return p.targetIds&&p.targetIds.length?Ht.min():p.readTime?qa(p.readTime):Ht.min()}(t);return this.listener.d_(s,i)}A_(t){const s={};s.database=eg(this.serializer),s.addTarget=function(e,p){let x;const w=p.target;if(x=Km(w)?{documents:k8(e,w)}:{query:F8(e,w)._t},x.targetId=p.targetId,p.resumeToken.approximateByteSize()>0){x.resumeToken=HT(e,p.resumeToken);const E=Xm(e,p.expectedCount);E!==null&&(x.expectedCount=E)}else if(p.snapshotVersion.compareTo(Ht.min())>0){x.readTime=a0(e,p.snapshotVersion.toTimestamp());const E=Xm(e,p.expectedCount);E!==null&&(x.expectedCount=E)}return x}(this.serializer,t);const i=I8(this.serializer,t);i&&(s.labels=i),this.a_(s)}R_(t){const s={};s.database=eg(this.serializer),s.removeTarget=t,this.a_(s)}}class pI extends tE{constructor(t,s,i,n,e,p){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",s,i,n,p),this.serializer=e}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(t,s){return this.connection.Bo("Write",t,s)}E_(t){return Lr(!!t.streamToken),this.lastStreamToken=t.streamToken,Lr(!t.writeResults||t.writeResults.length===0),this.listener.f_()}onNext(t){Lr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.t_.reset();const s=C8(t.writeResults,t.commitTime),i=qa(t.commitTime);return this.listener.g_(i,s)}p_(){const t={};t.database=eg(this.serializer),this.a_(t)}m_(t){const s={streamToken:this.lastStreamToken,writes:t.map(i=>A8(this.serializer,i))};this.a_(s)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mI extends class{}{constructor(t,s,i,n){super(),this.authCredentials=t,this.appCheckCredentials=s,this.connection=i,this.serializer=n,this.y_=!1}w_(){if(this.y_)throw new dt(Pe.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(t,s,i,n){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([e,p])=>this.connection.Mo(t,Jm(s,i),n,e,p)).catch(e=>{throw e.name==="FirebaseError"?(e.code===Pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new dt(Pe.UNKNOWN,e.toString())})}Lo(t,s,i,n,e){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([p,x])=>this.connection.Lo(t,Jm(s,i),n,p,x,e)).catch(p=>{throw p.name==="FirebaseError"?(p.code===Pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),p):new dt(Pe.UNKNOWN,p.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class gI{constructor(t,s){this.asyncQueue=t,this.onlineStateHandler=s,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(t){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.C_("Offline")))}set(t){this.x_(),this.S_=0,t==="Online"&&(this.D_=!1),this.C_(t)}C_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}F_(t){const s=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Ti(s),this.D_=!1):Ft("OnlineStateTracker",s)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yI{constructor(t,s,i,n,e){this.localStore=t,this.datastore=s,this.asyncQueue=i,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=e,this.k_._o(p=>{i.enqueueAndForget(async()=>{gl(this)&&(Ft("RemoteStore","Restarting streams for network reachability change."),await async function(w){const E=Gt(w);E.L_.add(4),await Of(E),E.q_.set("Unknown"),E.L_.delete(4),await L0(E)}(this))})}),this.q_=new gI(i,n)}}async function L0(r){if(gl(r))for(const t of r.B_)await t(!0)}async function Of(r){for(const t of r.B_)await t(!1)}function rE(r,t){const s=Gt(r);s.N_.has(t.targetId)||(s.N_.set(t.targetId,t),k2(s)?C2(s):Rc(s).r_()&&A2(s,t))}function S2(r,t){const s=Gt(r),i=Rc(s);s.N_.delete(t),i.r_()&&nE(s,t),s.N_.size===0&&(i.r_()?i.o_():gl(s)&&s.q_.set("Unknown"))}function A2(r,t){if(r.Q_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Ht.min())>0){const s=r.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(s)}Rc(r).A_(t)}function nE(r,t){r.Q_.xe(t),Rc(r).R_(t)}function C2(r){r.Q_=new v8({getRemoteKeysForTarget:t=>r.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>r.N_.get(t)||null,tt:()=>r.datastore.serializer.databaseId}),Rc(r).start(),r.q_.v_()}function k2(r){return gl(r)&&!Rc(r).n_()&&r.N_.size>0}function gl(r){return Gt(r).L_.size===0}function sE(r){r.Q_=void 0}async function vI(r){r.q_.set("Online")}async function xI(r){r.N_.forEach((t,s)=>{A2(r,t)})}async function bI(r,t){sE(r),k2(r)?(r.q_.M_(t),C2(r)):r.q_.set("Unknown")}async function wI(r,t,s){if(r.q_.set("Online"),t instanceof zT&&t.state===2&&t.cause)try{await async function(n,e){const p=e.cause;for(const x of e.targetIds)n.N_.has(x)&&(await n.remoteSyncer.rejectListen(x,p),n.N_.delete(x),n.Q_.removeTarget(x))}(r,t)}catch(i){Ft("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),i),await i0(r,i)}else if(t instanceof Ad?r.Q_.Ke(t):t instanceof WT?r.Q_.He(t):r.Q_.We(t),!s.isEqual(Ht.min()))try{const i=await ZT(r.localStore);s.compareTo(i)>=0&&await function(e,p){const x=e.Q_.rt(p);return x.targetChanges.forEach((w,E)=>{if(w.resumeToken.approximateByteSize()>0){const N=e.N_.get(E);N&&e.N_.set(E,N.withResumeToken(w.resumeToken,p))}}),x.targetMismatches.forEach((w,E)=>{const N=e.N_.get(w);if(!N)return;e.N_.set(w,N.withResumeToken(Kn.EMPTY_BYTE_STRING,N.snapshotVersion)),nE(e,w);const P=new Xi(N.target,w,E,N.sequenceNumber);A2(e,P)}),e.remoteSyncer.applyRemoteEvent(x)}(r,s)}catch(i){Ft("RemoteStore","Failed to raise snapshot:",i),await i0(r,i)}}async function i0(r,t,s){if(!Df(t))throw t;r.L_.add(1),await Of(r),r.q_.set("Offline"),s||(s=()=>ZT(r.localStore)),r.asyncQueue.enqueueRetryable(async()=>{Ft("RemoteStore","Retrying IndexedDB access"),await s(),r.L_.delete(1),await L0(r)})}function aE(r,t){return t().catch(s=>i0(r,s,t))}async function V0(r){const t=Gt(r),s=po(t);let i=t.O_.length>0?t.O_[t.O_.length-1].batchId:-1;for(;_I(t);)try{const n=await aI(t.localStore,i);if(n===null){t.O_.length===0&&s.o_();break}i=n.batchId,TI(t,n)}catch(n){await i0(t,n)}iE(t)&&oE(t)}function _I(r){return gl(r)&&r.O_.length<10}function TI(r,t){r.O_.push(t);const s=po(r);s.r_()&&s.V_&&s.m_(t.mutations)}function iE(r){return gl(r)&&!po(r).n_()&&r.O_.length>0}function oE(r){po(r).start()}async function EI(r){po(r).p_()}async function SI(r){const t=po(r);for(const s of r.O_)t.m_(s.mutations)}async function AI(r,t,s){const i=r.O_.shift(),n=x2.from(i,t,s);await aE(r,()=>r.remoteSyncer.applySuccessfulWrite(n)),await V0(r)}async function CI(r,t){t&&po(r).V_&&await async function(i,n){if(function(p){return m8(p)&&p!==Pe.ABORTED}(n.code)){const e=i.O_.shift();po(i).s_(),await aE(i,()=>i.remoteSyncer.rejectFailedWrite(e.batchId,n)),await V0(i)}}(r,t),iE(r)&&oE(r)}async function fw(r,t){const s=Gt(r);s.asyncQueue.verifyOperationInProgress(),Ft("RemoteStore","RemoteStore received new credentials");const i=gl(s);s.L_.add(3),await Of(s),i&&s.q_.set("Unknown"),await s.remoteSyncer.handleCredentialChange(t),s.L_.delete(3),await L0(s)}async function kI(r,t){const s=Gt(r);t?(s.L_.delete(2),await L0(s)):t||(s.L_.add(2),await Of(s),s.q_.set("Unknown"))}function Rc(r){return r.K_||(r.K_=function(s,i,n){const e=Gt(s);return e.w_(),new dI(i,e.connection,e.authCredentials,e.appCheckCredentials,e.serializer,n)}(r.datastore,r.asyncQueue,{Eo:vI.bind(null,r),Ro:xI.bind(null,r),mo:bI.bind(null,r),d_:wI.bind(null,r)}),r.B_.push(async t=>{t?(r.K_.s_(),k2(r)?C2(r):r.q_.set("Unknown")):(await r.K_.stop(),sE(r))})),r.K_}function po(r){return r.U_||(r.U_=function(s,i,n){const e=Gt(s);return e.w_(),new pI(i,e.connection,e.authCredentials,e.appCheckCredentials,e.serializer,n)}(r.datastore,r.asyncQueue,{Eo:()=>Promise.resolve(),Ro:EI.bind(null,r),mo:CI.bind(null,r),f_:SI.bind(null,r),g_:AI.bind(null,r)}),r.B_.push(async t=>{t?(r.U_.s_(),await V0(r)):(await r.U_.stop(),r.O_.length>0&&(Ft("RemoteStore",`Stopping write stream with ${r.O_.length} pending writes`),r.O_=[]))})),r.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F2{constructor(t,s,i,n,e){this.asyncQueue=t,this.timerId=s,this.targetTimeMs=i,this.op=n,this.removalCallback=e,this.deferred=new gi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(p=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,s,i,n,e){const p=Date.now()+i,x=new F2(t,s,p,n,e);return x.start(i),x}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new dt(Pe.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function N2(r,t){if(Ti("AsyncQueue",`${t}: ${r}`),Df(r))return new dt(Pe.UNAVAILABLE,`${t}: ${r}`);throw r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uc{constructor(t){this.comparator=t?(s,i)=>t(s,i)||Ot.comparator(s.key,i.key):(s,i)=>Ot.comparator(s.key,i.key),this.keyedMap=Ru(),this.sortedSet=new ln(this.comparator)}static emptySet(t){return new uc(t.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const s=this.keyedMap.get(t);return s?this.sortedSet.indexOf(s):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((s,i)=>(t(s),!1))}add(t){const s=this.delete(t.key);return s.copy(s.keyedMap.insert(t.key,t),s.sortedSet.insert(t,null))}delete(t){const s=this.get(t);return s?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(s)):this}isEqual(t){if(!(t instanceof uc)||this.size!==t.size)return!1;const s=this.sortedSet.getIterator(),i=t.sortedSet.getIterator();for(;s.hasNext();){const n=s.getNext().key,e=i.getNext().key;if(!n.isEqual(e))return!1}return!0}toString(){const t=[];return this.forEach(s=>{t.push(s.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,s){const i=new uc;return i.comparator=this.comparator,i.keyedMap=t,i.sortedSet=s,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hw{constructor(){this.W_=new ln(Ot.comparator)}track(t){const s=t.doc.key,i=this.W_.get(s);i?t.type!==0&&i.type===3?this.W_=this.W_.insert(s,t):t.type===3&&i.type!==1?this.W_=this.W_.insert(s,{type:i.type,doc:t.doc}):t.type===2&&i.type===2?this.W_=this.W_.insert(s,{type:2,doc:t.doc}):t.type===2&&i.type===0?this.W_=this.W_.insert(s,{type:0,doc:t.doc}):t.type===1&&i.type===0?this.W_=this.W_.remove(s):t.type===1&&i.type===2?this.W_=this.W_.insert(s,{type:1,doc:i.doc}):t.type===0&&i.type===1?this.W_=this.W_.insert(s,{type:2,doc:t.doc}):$t():this.W_=this.W_.insert(s,t)}G_(){const t=[];return this.W_.inorderTraversal((s,i)=>{t.push(i)}),t}}class Ec{constructor(t,s,i,n,e,p,x,w,E){this.query=t,this.docs=s,this.oldDocs=i,this.docChanges=n,this.mutatedKeys=e,this.fromCache=p,this.syncStateChanged=x,this.excludesMetadataChanges=w,this.hasCachedResults=E}static fromInitialDocuments(t,s,i,n,e){const p=[];return s.forEach(x=>{p.push({type:0,doc:x})}),new Ec(t,s,uc.emptySet(s),p,i,n,!0,!1,e)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&I0(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const s=this.docChanges,i=t.docChanges;if(s.length!==i.length)return!1;for(let n=0;n<s.length;n++)if(s[n].type!==i[n].type||!s[n].doc.isEqual(i[n].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FI{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(t=>t.J_())}}class NI{constructor(){this.queries=dw(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(s,i){const n=Gt(s),e=n.queries;n.queries=dw(),e.forEach((p,x)=>{for(const w of x.j_)w.onError(i)})})(this,new dt(Pe.ABORTED,"Firestore shutting down"))}}function dw(){return new Dc(r=>NT(r),I0)}async function lE(r,t){const s=Gt(r);let i=3;const n=t.query;let e=s.queries.get(n);e?!e.H_()&&t.J_()&&(i=2):(e=new FI,i=t.J_()?0:1);try{switch(i){case 0:e.z_=await s.onListen(n,!0);break;case 1:e.z_=await s.onListen(n,!1);break;case 2:await s.onFirstRemoteStoreListen(n)}}catch(p){const x=N2(p,`Initialization of query '${Wl(t.query)}' failed`);return void t.onError(x)}s.queries.set(n,e),e.j_.push(t),t.Z_(s.onlineState),e.z_&&t.X_(e.z_)&&I2(s)}async function cE(r,t){const s=Gt(r),i=t.query;let n=3;const e=s.queries.get(i);if(e){const p=e.j_.indexOf(t);p>=0&&(e.j_.splice(p,1),e.j_.length===0?n=t.J_()?0:1:!e.H_()&&t.J_()&&(n=2))}switch(n){case 0:return s.queries.delete(i),s.onUnlisten(i,!0);case 1:return s.queries.delete(i),s.onUnlisten(i,!1);case 2:return s.onLastRemoteStoreUnlisten(i);default:return}}function II(r,t){const s=Gt(r);let i=!1;for(const n of t){const e=n.query,p=s.queries.get(e);if(p){for(const x of p.j_)x.X_(n)&&(i=!0);p.z_=n}}i&&I2(s)}function DI(r,t,s){const i=Gt(r),n=i.queries.get(t);if(n)for(const e of n.j_)e.onError(s);i.queries.delete(t)}function I2(r){r.Y_.forEach(t=>{t.next()})}var rg,pw;(pw=rg||(rg={})).ea="default",pw.Cache="cache";class uE{constructor(t,s,i){this.query=t,this.ta=s,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=i||{}}X_(t){if(!this.options.includeMetadataChanges){const i=[];for(const n of t.docChanges)n.type!==3&&i.push(n);t=new Ec(t.query,t.docs,t.oldDocs,i,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let s=!1;return this.na?this.ia(t)&&(this.ta.next(t),s=!0):this.sa(t,this.onlineState)&&(this.oa(t),s=!0),this.ra=t,s}onError(t){this.ta.error(t)}Z_(t){this.onlineState=t;let s=!1;return this.ra&&!this.na&&this.sa(this.ra,t)&&(this.oa(this.ra),s=!0),s}sa(t,s){if(!t.fromCache||!this.J_())return!0;const i=s!=="Offline";return(!this.options._a||!i)&&(!t.docs.isEmpty()||t.hasCachedResults||s==="Offline")}ia(t){if(t.docChanges.length>0)return!0;const s=this.ra&&this.ra.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!s)&&this.options.includeMetadataChanges===!0}oa(t){t=Ec.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.na=!0,this.ta.next(t)}J_(){return this.options.source!==rg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fE{constructor(t){this.key=t}}class hE{constructor(t){this.key=t}}class RI{constructor(t,s){this.query=t,this.Ta=s,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=mr(),this.mutatedKeys=mr(),this.Aa=IT(t),this.Ra=new uc(this.Aa)}get Va(){return this.Ta}ma(t,s){const i=s?s.fa:new hw,n=s?s.Ra:this.Ra;let e=s?s.mutatedKeys:this.mutatedKeys,p=n,x=!1;const w=this.query.limitType==="F"&&n.size===this.query.limit?n.last():null,E=this.query.limitType==="L"&&n.size===this.query.limit?n.first():null;if(t.inorderTraversal((N,P)=>{const R=n.get(N),q=D0(this.query,P)?P:null,Z=!!R&&this.mutatedKeys.has(R.key),ne=!!q&&(q.hasLocalMutations||this.mutatedKeys.has(q.key)&&q.hasCommittedMutations);let fe=!1;R&&q?R.data.isEqual(q.data)?Z!==ne&&(i.track({type:3,doc:q}),fe=!0):this.ga(R,q)||(i.track({type:2,doc:q}),fe=!0,(w&&this.Aa(q,w)>0||E&&this.Aa(q,E)<0)&&(x=!0)):!R&&q?(i.track({type:0,doc:q}),fe=!0):R&&!q&&(i.track({type:1,doc:R}),fe=!0,(w||E)&&(x=!0)),fe&&(q?(p=p.add(q),e=ne?e.add(N):e.delete(N)):(p=p.delete(N),e=e.delete(N)))}),this.query.limit!==null)for(;p.size>this.query.limit;){const N=this.query.limitType==="F"?p.last():p.first();p=p.delete(N.key),e=e.delete(N.key),i.track({type:1,doc:N})}return{Ra:p,fa:i,ns:x,mutatedKeys:e}}ga(t,s){return t.hasLocalMutations&&s.hasCommittedMutations&&!s.hasLocalMutations}applyChanges(t,s,i,n){const e=this.Ra;this.Ra=t.Ra,this.mutatedKeys=t.mutatedKeys;const p=t.fa.G_();p.sort((N,P)=>function(q,Z){const ne=fe=>{switch(fe){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return $t()}};return ne(q)-ne(Z)}(N.type,P.type)||this.Aa(N.doc,P.doc)),this.pa(i),n=n!=null&&n;const x=s&&!n?this.ya():[],w=this.da.size===0&&this.current&&!n?1:0,E=w!==this.Ea;return this.Ea=w,p.length!==0||E?{snapshot:new Ec(this.query,t.Ra,e,p,t.mutatedKeys,w===0,E,!1,!!i&&i.resumeToken.approximateByteSize()>0),wa:x}:{wa:x}}Z_(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new hw,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(t){return!this.Ta.has(t)&&!!this.Ra.has(t)&&!this.Ra.get(t).hasLocalMutations}pa(t){t&&(t.addedDocuments.forEach(s=>this.Ta=this.Ta.add(s)),t.modifiedDocuments.forEach(s=>{}),t.removedDocuments.forEach(s=>this.Ta=this.Ta.delete(s)),this.current=t.current)}ya(){if(!this.current)return[];const t=this.da;this.da=mr(),this.Ra.forEach(i=>{this.Sa(i.key)&&(this.da=this.da.add(i.key))});const s=[];return t.forEach(i=>{this.da.has(i)||s.push(new hE(i))}),this.da.forEach(i=>{t.has(i)||s.push(new fE(i))}),s}ba(t){this.Ta=t.Ts,this.da=mr();const s=this.ma(t.documents);return this.applyChanges(s,!0)}Da(){return Ec.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class PI{constructor(t,s,i){this.query=t,this.targetId=s,this.view=i}}class OI{constructor(t){this.key=t,this.va=!1}}class jI{constructor(t,s,i,n,e,p){this.localStore=t,this.remoteStore=s,this.eventManager=i,this.sharedClientState=n,this.currentUser=e,this.maxConcurrentLimboResolutions=p,this.Ca={},this.Fa=new Dc(x=>NT(x),I0),this.Ma=new Map,this.xa=new Set,this.Oa=new ln(Ot.comparator),this.Na=new Map,this.La=new _2,this.Ba={},this.ka=new Map,this.qa=Tc.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function MI(r,t,s=!0){const i=vE(r);let n;const e=i.Fa.get(t);return e?(i.sharedClientState.addLocalQueryTarget(e.targetId),n=e.view.Da()):n=await dE(i,t,s,!0),n}async function LI(r,t){const s=vE(r);await dE(s,t,!0,!1)}async function dE(r,t,s,i){const n=await iI(r.localStore,Ga(t)),e=n.targetId,p=r.sharedClientState.addLocalQueryTarget(e,s);let x;return i&&(x=await VI(r,t,e,p==="current",n.resumeToken)),r.isPrimaryClient&&s&&rE(r.remoteStore,n),x}async function VI(r,t,s,i,n){r.Ka=(P,R,q)=>async function(ne,fe,G,U){let H=fe.view.ma(G);H.ns&&(H=await lw(ne.localStore,fe.query,!1).then(({documents:L})=>fe.view.ma(L,H)));const ee=U&&U.targetChanges.get(fe.targetId),te=U&&U.targetMismatches.get(fe.targetId)!=null,ue=fe.view.applyChanges(H,ne.isPrimaryClient,ee,te);return gw(ne,fe.targetId,ue.wa),ue.snapshot}(r,P,R,q);const e=await lw(r.localStore,t,!0),p=new RI(t,e.Ts),x=p.ma(e.documents),w=Pf.createSynthesizedTargetChangeForCurrentChange(s,i&&r.onlineState!=="Offline",n),E=p.applyChanges(x,r.isPrimaryClient,w);gw(r,s,E.wa);const N=new PI(t,s,p);return r.Fa.set(t,N),r.Ma.has(s)?r.Ma.get(s).push(t):r.Ma.set(s,[t]),E.snapshot}async function UI(r,t,s){const i=Gt(r),n=i.Fa.get(t),e=i.Ma.get(n.targetId);if(e.length>1)return i.Ma.set(n.targetId,e.filter(p=>!I0(p,t))),void i.Fa.delete(t);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(n.targetId),i.sharedClientState.isActiveQueryTarget(n.targetId)||await tg(i.localStore,n.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(n.targetId),s&&S2(i.remoteStore,n.targetId),ng(i,n.targetId)}).catch(If)):(ng(i,n.targetId),await tg(i.localStore,n.targetId,!0))}async function BI(r,t){const s=Gt(r),i=s.Fa.get(t),n=s.Ma.get(i.targetId);s.isPrimaryClient&&n.length===1&&(s.sharedClientState.removeLocalQueryTarget(i.targetId),S2(s.remoteStore,i.targetId))}async function $I(r,t,s){const i=YI(r);try{const n=await function(p,x){const w=Gt(p),E=An.now(),N=x.reduce((q,Z)=>q.add(Z.key),mr());let P,R;return w.persistence.runTransaction("Locally write mutations","readwrite",q=>{let Z=Ei(),ne=mr();return w.cs.getEntries(q,N).next(fe=>{Z=fe,Z.forEach((G,U)=>{U.isValidDocument()||(ne=ne.add(G))})}).next(()=>w.localDocuments.getOverlayedDocuments(q,Z)).next(fe=>{P=fe;const G=[];for(const U of x){const H=u8(U,P.get(U.key).overlayedDocument);H!=null&&G.push(new vo(U.key,H,_T(H.value.mapValue),ys.exists(!0)))}return w.mutationQueue.addMutationBatch(q,E,G,x)}).next(fe=>{R=fe;const G=fe.applyToLocalDocumentSet(P,ne);return w.documentOverlayCache.saveOverlays(q,fe.batchId,G)})}).then(()=>({batchId:R.batchId,changes:RT(P)}))}(i.localStore,t);i.sharedClientState.addPendingMutation(n.batchId),function(p,x,w){let E=p.Ba[p.currentUser.toKey()];E||(E=new ln(Ar)),E=E.insert(x,w),p.Ba[p.currentUser.toKey()]=E}(i,n.batchId,s),await jf(i,n.changes),await V0(i.remoteStore)}catch(n){const e=N2(n,"Failed to persist write");s.reject(e)}}async function pE(r,t){const s=Gt(r);try{const i=await nI(s.localStore,t);t.targetChanges.forEach((n,e)=>{const p=s.Na.get(e);p&&(Lr(n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size<=1),n.addedDocuments.size>0?p.va=!0:n.modifiedDocuments.size>0?Lr(p.va):n.removedDocuments.size>0&&(Lr(p.va),p.va=!1))}),await jf(s,i,t)}catch(i){await If(i)}}function mw(r,t,s){const i=Gt(r);if(i.isPrimaryClient&&s===0||!i.isPrimaryClient&&s===1){const n=[];i.Fa.forEach((e,p)=>{const x=p.view.Z_(t);x.snapshot&&n.push(x.snapshot)}),function(p,x){const w=Gt(p);w.onlineState=x;let E=!1;w.queries.forEach((N,P)=>{for(const R of P.j_)R.Z_(x)&&(E=!0)}),E&&I2(w)}(i.eventManager,t),n.length&&i.Ca.d_(n),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function WI(r,t,s){const i=Gt(r);i.sharedClientState.updateQueryState(t,"rejected",s);const n=i.Na.get(t),e=n&&n.key;if(e){let p=new ln(Ot.comparator);p=p.insert(e,os.newNoDocument(e,Ht.min()));const x=mr().add(e),w=new j0(Ht.min(),new Map,new ln(Ar),p,x);await pE(i,w),i.Oa=i.Oa.remove(e),i.Na.delete(t),D2(i)}else await tg(i.localStore,t,!1).then(()=>ng(i,t,s)).catch(If)}async function zI(r,t){const s=Gt(r),i=t.batch.batchId;try{const n=await rI(s.localStore,t);gE(s,i,null),mE(s,i),s.sharedClientState.updateMutationState(i,"acknowledged"),await jf(s,n)}catch(n){await If(n)}}async function HI(r,t,s){const i=Gt(r);try{const n=await function(p,x){const w=Gt(p);return w.persistence.runTransaction("Reject batch","readwrite-primary",E=>{let N;return w.mutationQueue.lookupMutationBatch(E,x).next(P=>(Lr(P!==null),N=P.keys(),w.mutationQueue.removeMutationBatch(E,P))).next(()=>w.mutationQueue.performConsistencyCheck(E)).next(()=>w.documentOverlayCache.removeOverlaysForBatchId(E,N,x)).next(()=>w.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(E,N)).next(()=>w.localDocuments.getDocuments(E,N))})}(i.localStore,t);gE(i,t,s),mE(i,t),i.sharedClientState.updateMutationState(t,"rejected",s),await jf(i,n)}catch(n){await If(n)}}function mE(r,t){(r.ka.get(t)||[]).forEach(s=>{s.resolve()}),r.ka.delete(t)}function gE(r,t,s){const i=Gt(r);let n=i.Ba[i.currentUser.toKey()];if(n){const e=n.get(t);e&&(s?e.reject(s):e.resolve(),n=n.remove(t)),i.Ba[i.currentUser.toKey()]=n}}function ng(r,t,s=null){r.sharedClientState.removeLocalQueryTarget(t);for(const i of r.Ma.get(t))r.Fa.delete(i),s&&r.Ca.$a(i,s);r.Ma.delete(t),r.isPrimaryClient&&r.La.gr(t).forEach(i=>{r.La.containsKey(i)||yE(r,i)})}function yE(r,t){r.xa.delete(t.path.canonicalString());const s=r.Oa.get(t);s!==null&&(S2(r.remoteStore,s),r.Oa=r.Oa.remove(t),r.Na.delete(s),D2(r))}function gw(r,t,s){for(const i of s)i instanceof fE?(r.La.addReference(i.key,t),GI(r,i)):i instanceof hE?(Ft("SyncEngine","Document no longer in limbo: "+i.key),r.La.removeReference(i.key,t),r.La.containsKey(i.key)||yE(r,i.key)):$t()}function GI(r,t){const s=t.key,i=s.path.canonicalString();r.Oa.get(s)||r.xa.has(i)||(Ft("SyncEngine","New document in limbo: "+s),r.xa.add(i),D2(r))}function D2(r){for(;r.xa.size>0&&r.Oa.size<r.maxConcurrentLimboResolutions;){const t=r.xa.values().next().value;r.xa.delete(t);const s=new Ot(Yr.fromString(t)),i=r.qa.next();r.Na.set(i,new OI(s)),r.Oa=r.Oa.insert(s,i),rE(r.remoteStore,new Xi(Ga(y2(s.path)),i,"TargetPurposeLimboResolution",f2.oe))}}async function jf(r,t,s){const i=Gt(r),n=[],e=[],p=[];i.Fa.isEmpty()||(i.Fa.forEach((x,w)=>{p.push(i.Ka(w,t,s).then(E=>{var N;if((E||s)&&i.isPrimaryClient){const P=E?!E.fromCache:(N=s==null?void 0:s.targetChanges.get(w.targetId))===null||N===void 0?void 0:N.current;i.sharedClientState.updateQueryState(w.targetId,P?"current":"not-current")}if(E){n.push(E);const P=E2.Wi(w.targetId,E);e.push(P)}}))}),await Promise.all(p),i.Ca.d_(n),await async function(w,E){const N=Gt(w);try{await N.persistence.runTransaction("notifyLocalViewChanges","readwrite",P=>Be.forEach(E,R=>Be.forEach(R.$i,q=>N.persistence.referenceDelegate.addReference(P,R.targetId,q)).next(()=>Be.forEach(R.Ui,q=>N.persistence.referenceDelegate.removeReference(P,R.targetId,q)))))}catch(P){if(!Df(P))throw P;Ft("LocalStore","Failed to update sequence numbers: "+P)}for(const P of E){const R=P.targetId;if(!P.fromCache){const q=N.os.get(R),Z=q.snapshotVersion,ne=q.withLastLimboFreeSnapshotVersion(Z);N.os=N.os.insert(R,ne)}}}(i.localStore,e))}async function qI(r,t){const s=Gt(r);if(!s.currentUser.isEqual(t)){Ft("SyncEngine","User change. New user:",t.toKey());const i=await JT(s.localStore,t);s.currentUser=t,function(e,p){e.ka.forEach(x=>{x.forEach(w=>{w.reject(new dt(Pe.CANCELLED,p))})}),e.ka.clear()}(s,"'waitForPendingWrites' promise is rejected due to a user change."),s.sharedClientState.handleUserChange(t,i.removedBatchIds,i.addedBatchIds),await jf(s,i.hs)}}function KI(r,t){const s=Gt(r),i=s.Na.get(t);if(i&&i.va)return mr().add(i.key);{let n=mr();const e=s.Ma.get(t);if(!e)return n;for(const p of e){const x=s.Fa.get(p);n=n.unionWith(x.view.Va)}return n}}function vE(r){const t=Gt(r);return t.remoteStore.remoteSyncer.applyRemoteEvent=pE.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=KI.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=WI.bind(null,t),t.Ca.d_=II.bind(null,t.eventManager),t.Ca.$a=DI.bind(null,t.eventManager),t}function YI(r){const t=Gt(r);return t.remoteStore.remoteSyncer.applySuccessfulWrite=zI.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=HI.bind(null,t),t}class o0{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=M0(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),await this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)}ja(t,s){return null}Ha(t,s){return null}za(t){return tI(this.persistence,new Z8,t.initialUser,this.serializer)}Ga(t){return new Q8(T2.Zr,this.serializer)}Wa(t){return new lI}async terminate(){var t,s;(t=this.gcScheduler)===null||t===void 0||t.stop(),(s=this.indexBackfillerScheduler)===null||s===void 0||s.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}o0.provider={build:()=>new o0};class sg{async initialize(t,s){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(s),this.remoteStore=this.createRemoteStore(s),this.eventManager=this.createEventManager(s),this.syncEngine=this.createSyncEngine(s,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>mw(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=qI.bind(null,this.syncEngine),await kI(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new NI}()}createDatastore(t){const s=M0(t.databaseInfo.databaseId),i=function(e){return new hI(e)}(t.databaseInfo);return function(e,p,x,w){return new mI(e,p,x,w)}(t.authCredentials,t.appCheckCredentials,i,s)}createRemoteStore(t){return function(i,n,e,p,x){return new yI(i,n,e,p,x)}(this.localStore,this.datastore,t.asyncQueue,s=>mw(this.syncEngine,s,0),function(){return uw.D()?new uw:new cI}())}createSyncEngine(t,s){return function(n,e,p,x,w,E,N){const P=new jI(n,e,p,x,w,E);return N&&(P.Qa=!0),P}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,s)}async terminate(){var t,s;await async function(n){const e=Gt(n);Ft("RemoteStore","RemoteStore shutting down."),e.L_.add(5),await Of(e),e.k_.shutdown(),e.q_.set("Unknown")}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(s=this.eventManager)===null||s===void 0||s.terminate()}}sg.provider={build:()=>new sg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xE{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ya(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ya(this.observer.error,t):Ti("Uncaught Error in snapshot listener:",t.toString()))}Za(){this.muted=!0}Ya(t,s){setTimeout(()=>{this.muted||t(s)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QI{constructor(t,s,i,n,e){this.authCredentials=t,this.appCheckCredentials=s,this.asyncQueue=i,this.databaseInfo=n,this.user=as.UNAUTHENTICATED,this.clientId=xT.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=e,this.authCredentials.start(i,async p=>{Ft("FirestoreClient","Received user=",p.uid),await this.authCredentialListener(p),this.user=p}),this.appCheckCredentials.start(i,p=>(Ft("FirestoreClient","Received new app check token=",p),this.appCheckCredentialListener(p,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new gi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(s){const i=N2(s,"Failed to shutdown persistence");t.reject(i)}}),t.promise}}async function D1(r,t){r.asyncQueue.verifyOperationInProgress(),Ft("FirestoreClient","Initializing OfflineComponentProvider");const s=r.configuration;await t.initialize(s);let i=s.initialUser;r.setCredentialChangeListener(async n=>{i.isEqual(n)||(await JT(t.localStore,n),i=n)}),t.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=t}async function yw(r,t){r.asyncQueue.verifyOperationInProgress();const s=await XI(r);Ft("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(s,r.configuration),r.setCredentialChangeListener(i=>fw(t.remoteStore,i)),r.setAppCheckTokenChangeListener((i,n)=>fw(t.remoteStore,n)),r._onlineComponents=t}async function XI(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){Ft("FirestoreClient","Using user provided OfflineComponentProvider");try{await D1(r,r._uninitializedComponentsProvider._offline)}catch(t){const s=t;if(!function(n){return n.name==="FirebaseError"?n.code===Pe.FAILED_PRECONDITION||n.code===Pe.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}(s))throw s;xc("Error using user provided cache. Falling back to memory cache: "+s),await D1(r,new o0)}}else Ft("FirestoreClient","Using default OfflineComponentProvider"),await D1(r,new o0);return r._offlineComponents}async function bE(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(Ft("FirestoreClient","Using user provided OnlineComponentProvider"),await yw(r,r._uninitializedComponentsProvider._online)):(Ft("FirestoreClient","Using default OnlineComponentProvider"),await yw(r,new sg))),r._onlineComponents}function JI(r){return bE(r).then(t=>t.syncEngine)}async function wE(r){const t=await bE(r),s=t.eventManager;return s.onListen=MI.bind(null,t.syncEngine),s.onUnlisten=UI.bind(null,t.syncEngine),s.onFirstRemoteStoreListen=LI.bind(null,t.syncEngine),s.onLastRemoteStoreUnlisten=BI.bind(null,t.syncEngine),s}function ZI(r,t,s={}){const i=new gi;return r.asyncQueue.enqueueAndForget(async()=>function(e,p,x,w,E){const N=new xE({next:R=>{N.Za(),p.enqueueAndForget(()=>cE(e,P));const q=R.docs.has(x);!q&&R.fromCache?E.reject(new dt(Pe.UNAVAILABLE,"Failed to get document because the client is offline.")):q&&R.fromCache&&w&&w.source==="server"?E.reject(new dt(Pe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):E.resolve(R)},error:R=>E.reject(R)}),P=new uE(y2(x.path),N,{includeMetadataChanges:!0,_a:!0});return lE(e,P)}(await wE(r),r.asyncQueue,t,s,i)),i.promise}function eD(r,t,s={}){const i=new gi;return r.asyncQueue.enqueueAndForget(async()=>function(e,p,x,w,E){const N=new xE({next:R=>{N.Za(),p.enqueueAndForget(()=>cE(e,P)),R.fromCache&&w.source==="server"?E.reject(new dt(Pe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):E.resolve(R)},error:R=>E.reject(R)}),P=new uE(x,N,{includeMetadataChanges:!0,_a:!0});return lE(e,P)}(await wE(r),r.asyncQueue,t,s,i)),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _E(r){const t={};return r.timeoutSeconds!==void 0&&(t.timeoutSeconds=r.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vw=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TE(r,t,s){if(!s)throw new dt(Pe.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${t}.`)}function tD(r,t,s,i){if(t===!0&&i===!0)throw new dt(Pe.INVALID_ARGUMENT,`${r} and ${s} cannot be used together.`)}function xw(r){if(!Ot.isDocumentKey(r))throw new dt(Pe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function bw(r){if(Ot.isDocumentKey(r))throw new dt(Pe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function U0(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const t=function(i){return i.constructor?i.constructor.name:null}(r);return t?`a custom ${t} object`:"an object"}}return typeof r=="function"?"a function":$t()}function ca(r,t){if("_delegate"in r&&(r=r._delegate),!(r instanceof t)){if(t.name===r.constructor.name)throw new dt(Pe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const s=U0(r);throw new dt(Pe.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${s}`)}}return r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ww{constructor(t){var s,i;if(t.host===void 0){if(t.ssl!==void 0)throw new dt(Pe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=(s=t.ssl)===null||s===void 0||s;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<1048576)throw new dt(Pe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}tD("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=_E((i=t.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(e){if(e.timeoutSeconds!==void 0){if(isNaN(e.timeoutSeconds))throw new dt(Pe.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new dt(Pe.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new dt(Pe.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(i,n){return i.timeoutSeconds===n.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class B0{constructor(t,s,i,n){this._authCredentials=t,this._appCheckCredentials=s,this._databaseId=i,this._app=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ww({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new dt(Pe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new dt(Pe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ww(t),t.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new xN;switch(i.type){case"firstParty":return new TN(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new dt(Pe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(s){const i=vw.get(s);i&&(Ft("ComponentProvider","Removing Datastore"),vw.delete(s),i.terminate())}(this),Promise.resolve()}}function rD(r,t,s,i={}){var n;const e=(r=ca(r,B0))._getSettings(),p=`${t}:${s}`;if(e.host!=="firestore.googleapis.com"&&e.host!==p&&xc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),r._setSettings(Object.assign(Object.assign({},e),{host:p,ssl:!1})),i.mockUserToken){let x,w;if(typeof i.mockUserToken=="string")x=i.mockUserToken,w=as.MOCK_USER;else{x=sF(i.mockUserToken,(n=r._app)===null||n===void 0?void 0:n.options.projectId);const E=i.mockUserToken.sub||i.mockUserToken.user_id;if(!E)throw new dt(Pe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");w=new as(E)}r._authCredentials=new bN(new vT(x,w))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yl{constructor(t,s,i){this.converter=s,this._query=i,this.type="query",this.firestore=t}withConverter(t){return new yl(this.firestore,t,this._query)}}class vs{constructor(t,s,i){this.converter=s,this._key=i,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new oo(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new vs(this.firestore,t,this._key)}}class oo extends yl{constructor(t,s,i){super(t,s,y2(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new vs(this.firestore,null,new Ot(t))}withConverter(t){return new oo(this.firestore,t,this._path)}}function Cn(r,t,...s){if(r=Ns(r),TE("collection","path",t),r instanceof B0){const i=Yr.fromString(t,...s);return bw(i),new oo(r,null,i)}{if(!(r instanceof vs||r instanceof oo))throw new dt(Pe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=r._path.child(Yr.fromString(t,...s));return bw(i),new oo(r.firestore,null,i)}}function xs(r,t,...s){if(r=Ns(r),arguments.length===1&&(t=xT.newId()),TE("doc","path",t),r instanceof B0){const i=Yr.fromString(t,...s);return xw(i),new vs(r,null,new Ot(i))}{if(!(r instanceof vs||r instanceof oo))throw new dt(Pe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=r._path.child(Yr.fromString(t,...s));return xw(i),new vs(r.firestore,r instanceof oo?r.converter:null,new Ot(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _w{constructor(t=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new eE(this,"async_queue_retry"),this.Vu=()=>{const i=I1();i&&Ft("AsyncQueue","Visibility state changed to "+i.visibilityState),this.t_.jo()},this.mu=t;const s=I1();s&&typeof s.addEventListener=="function"&&s.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.fu(),this.gu(t)}enterRestrictedMode(t){if(!this.Iu){this.Iu=!0,this.Au=t||!1;const s=I1();s&&typeof s.removeEventListener=="function"&&s.removeEventListener("visibilitychange",this.Vu)}}enqueue(t){if(this.fu(),this.Iu)return new Promise(()=>{});const s=new gi;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(t().then(s.resolve,s.reject),s.promise)).then(()=>s.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Pu.push(t),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(t){if(!Df(t))throw t;Ft("AsyncQueue","Operation failed with retryable error: "+t)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(t){const s=this.mu.then(()=>(this.du=!0,t().catch(i=>{this.Eu=i,this.du=!1;const n=function(p){let x=p.message||"";return p.stack&&(x=p.stack.includes(p.message)?p.stack:p.message+`
`+p.stack),x}(i);throw Ti("INTERNAL UNHANDLED ERROR: ",n),i}).then(i=>(this.du=!1,i))));return this.mu=s,s}enqueueAfterDelay(t,s,i){this.fu(),this.Ru.indexOf(t)>-1&&(s=0);const n=F2.createAndSchedule(this,t,s,i,e=>this.yu(e));return this.Tu.push(n),n}fu(){this.Eu&&$t()}verifyOperationInProgress(){}async wu(){let t;do t=this.mu,await t;while(t!==this.mu)}Su(t){for(const s of this.Tu)if(s.timerId===t)return!0;return!1}bu(t){return this.wu().then(()=>{this.Tu.sort((s,i)=>s.targetTimeMs-i.targetTimeMs);for(const s of this.Tu)if(s.skipDelay(),t!=="all"&&s.timerId===t)break;return this.wu()})}Du(t){this.Ru.push(t)}yu(t){const s=this.Tu.indexOf(t);this.Tu.splice(s,1)}}class xo extends B0{constructor(t,s,i,n){super(t,s,i,n),this.type="firestore",this._queue=new _w,this._persistenceKey=(n==null?void 0:n.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new _w(t),this._firestoreClient=void 0,await t}}}function nD(r,t){const s=typeof r=="object"?r:cT(),i=typeof r=="string"?r:"(default)",n=F0(s,"firestore").getImmediate({identifier:i});if(!n._initialized){const e=rF("firestore");e&&rD(n,...e)}return n}function $0(r){if(r._terminated)throw new dt(Pe.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||sD(r),r._firestoreClient}function sD(r){var t,s,i;const n=r._freezeSettings(),e=function(x,w,E,N){return new jN(x,w,E,N.host,N.ssl,N.experimentalForceLongPolling,N.experimentalAutoDetectLongPolling,_E(N.experimentalLongPollingOptions),N.useFetchStreams)}(r._databaseId,((t=r._app)===null||t===void 0?void 0:t.options.appId)||"",r._persistenceKey,n);r._componentsProvider||!((s=n.localCache)===null||s===void 0)&&s._offlineComponentProvider&&(!((i=n.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(r._componentsProvider={_offline:n.localCache._offlineComponentProvider,_online:n.localCache._onlineComponentProvider}),r._firestoreClient=new QI(r._authCredentials,r._appCheckCredentials,r._queue,e,r._componentsProvider&&function(x){const w=x==null?void 0:x._online.build();return{_offline:x==null?void 0:x._offline.build(w),_online:w}}(r._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sc{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Sc(Kn.fromBase64String(t))}catch(s){throw new dt(Pe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+s)}}static fromUint8Array(t){return new Sc(Kn.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mf{constructor(...t){for(let s=0;s<t.length;++s)if(t[s].length===0)throw new dt(Pe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zn(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R2{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P2{constructor(t,s){if(!isFinite(t)||t<-90||t>90)throw new dt(Pe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(s)||s<-180||s>180)throw new dt(Pe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+s);this._lat=t,this._long=s}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return Ar(this._lat,t._lat)||Ar(this._long,t._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O2{constructor(t){this._values=(t||[]).map(s=>s)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(i,n){if(i.length!==n.length)return!1;for(let e=0;e<i.length;++e)if(i[e]!==n[e])return!1;return!0}(this._values,t._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aD=/^__.*__$/;class iD{constructor(t,s,i){this.data=t,this.fieldMask=s,this.fieldTransforms=i}toMutation(t,s){return this.fieldMask!==null?new vo(t,this.data,this.fieldMask,s,this.fieldTransforms):new Rf(t,this.data,s,this.fieldTransforms)}}class EE{constructor(t,s,i){this.data=t,this.fieldMask=s,this.fieldTransforms=i}toMutation(t,s){return new vo(t,this.data,this.fieldMask,s,this.fieldTransforms)}}function SE(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw $t()}}class j2{constructor(t,s,i,n,e,p){this.settings=t,this.databaseId=s,this.serializer=i,this.ignoreUndefinedProperties=n,e===void 0&&this.vu(),this.fieldTransforms=e||[],this.fieldMask=p||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(t){return new j2(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(t){var s;const i=(s=this.path)===null||s===void 0?void 0:s.child(t),n=this.Fu({path:i,xu:!1});return n.Ou(t),n}Nu(t){var s;const i=(s=this.path)===null||s===void 0?void 0:s.child(t),n=this.Fu({path:i,xu:!1});return n.vu(),n}Lu(t){return this.Fu({path:void 0,xu:!0})}Bu(t){return l0(t,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(t){return this.fieldMask.find(s=>t.isPrefixOf(s))!==void 0||this.fieldTransforms.find(s=>t.isPrefixOf(s.field))!==void 0}vu(){if(this.path)for(let t=0;t<this.path.length;t++)this.Ou(this.path.get(t))}Ou(t){if(t.length===0)throw this.Bu("Document fields must not be empty");if(SE(this.Cu)&&aD.test(t))throw this.Bu('Document fields cannot begin and end with "__"')}}class oD{constructor(t,s,i){this.databaseId=t,this.ignoreUndefinedProperties=s,this.serializer=i||M0(t)}Qu(t,s,i,n=!1){return new j2({Cu:t,methodName:s,qu:i,path:zn.emptyPath(),xu:!1,ku:n},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Lf(r){const t=r._freezeSettings(),s=M0(r._databaseId);return new oD(r._databaseId,!!t.ignoreUndefinedProperties,s)}function M2(r,t,s,i,n,e={}){const p=r.Qu(e.merge||e.mergeFields?2:0,t,s,n);L2("Data must be an object, but it was:",p,i);const x=kE(i,p);let w,E;if(e.merge)w=new Ls(p.fieldMask),E=p.fieldTransforms;else if(e.mergeFields){const N=[];for(const P of e.mergeFields){const R=ag(t,P,s);if(!p.contains(R))throw new dt(Pe.INVALID_ARGUMENT,`Field '${R}' is specified in your field mask but missing from your input data.`);NE(N,R)||N.push(R)}w=new Ls(N),E=p.fieldTransforms.filter(P=>w.covers(P.field))}else w=null,E=p.fieldTransforms;return new iD(new Ss(x),w,E)}class W0 extends R2{_toFieldTransform(t){if(t.Cu!==2)throw t.Cu===1?t.Bu(`${this._methodName}() can only appear at the top level of your update data`):t.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof W0}}function AE(r,t,s,i){const n=r.Qu(1,t,s);L2("Data must be an object, but it was:",n,i);const e=[],p=Ss.empty();ml(i,(w,E)=>{const N=V2(t,w,s);E=Ns(E);const P=n.Nu(N);if(E instanceof W0)e.push(N);else{const R=Vf(E,P);R!=null&&(e.push(N),p.set(N,R))}});const x=new Ls(e);return new EE(p,x,n.fieldTransforms)}function CE(r,t,s,i,n,e){const p=r.Qu(1,t,s),x=[ag(t,i,s)],w=[n];if(e.length%2!=0)throw new dt(Pe.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let R=0;R<e.length;R+=2)x.push(ag(t,e[R])),w.push(e[R+1]);const E=[],N=Ss.empty();for(let R=x.length-1;R>=0;--R)if(!NE(E,x[R])){const q=x[R];let Z=w[R];Z=Ns(Z);const ne=p.Nu(q);if(Z instanceof W0)E.push(q);else{const fe=Vf(Z,ne);fe!=null&&(E.push(q),N.set(q,fe))}}const P=new Ls(E);return new EE(N,P,p.fieldTransforms)}function lD(r,t,s,i=!1){return Vf(s,r.Qu(i?4:3,t))}function Vf(r,t){if(FE(r=Ns(r)))return L2("Unsupported field value:",t,r),kE(r,t);if(r instanceof R2)return function(i,n){if(!SE(n.Cu))throw n.Bu(`${i._methodName}() can only be used with update() and set()`);if(!n.path)throw n.Bu(`${i._methodName}() is not currently supported inside arrays`);const e=i._toFieldTransform(n);e&&n.fieldTransforms.push(e)}(r,t),null;if(r===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),r instanceof Array){if(t.settings.xu&&t.Cu!==4)throw t.Bu("Nested arrays are not supported");return function(i,n){const e=[];let p=0;for(const x of i){let w=Vf(x,n.Lu(p));w==null&&(w={nullValue:"NULL_VALUE"}),e.push(w),p++}return{arrayValue:{values:e}}}(r,t)}return function(i,n){if((i=Ns(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return s8(n.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const e=An.fromDate(i);return{timestampValue:a0(n.serializer,e)}}if(i instanceof An){const e=new An(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:a0(n.serializer,e)}}if(i instanceof P2)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Sc)return{bytesValue:HT(n.serializer,i._byteString)};if(i instanceof vs){const e=n.databaseId,p=i.firestore._databaseId;if(!p.isEqual(e))throw n.Bu(`Document reference is for database ${p.projectId}/${p.database} but should be for database ${e.projectId}/${e.database}`);return{referenceValue:w2(i.firestore._databaseId||n.databaseId,i._key.path)}}if(i instanceof O2)return function(p,x){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:p.toArray().map(w=>{if(typeof w!="number")throw x.Bu("VectorValues must only contain numeric values.");return v2(x.serializer,w)})}}}}}}(i,n);throw n.Bu(`Unsupported field value: ${U0(i)}`)}(r,t)}function kE(r,t){const s={};return bT(r)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):ml(r,(i,n)=>{const e=Vf(n,t.Mu(i));e!=null&&(s[i]=e)}),{mapValue:{fields:s}}}function FE(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof An||r instanceof P2||r instanceof Sc||r instanceof vs||r instanceof R2||r instanceof O2)}function L2(r,t,s){if(!FE(s)||!function(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}(s)){const i=U0(s);throw i==="an object"?t.Bu(r+" a custom object"):t.Bu(r+" "+i)}}function ag(r,t,s){if((t=Ns(t))instanceof Mf)return t._internalPath;if(typeof t=="string")return V2(r,t);throw l0("Field path arguments must be of type string or ",r,!1,void 0,s)}const cD=new RegExp("[~\\*/\\[\\]]");function V2(r,t,s){if(t.search(cD)>=0)throw l0(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,s);try{return new Mf(...t.split("."))._internalPath}catch{throw l0(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,s)}}function l0(r,t,s,i,n){const e=i&&!i.isEmpty(),p=n!==void 0;let x=`Function ${t}() called with invalid data`;s&&(x+=" (via `toFirestore()`)"),x+=". ";let w="";return(e||p)&&(w+=" (found",e&&(w+=` in field ${i}`),p&&(w+=` in document ${n}`),w+=")"),new dt(Pe.INVALID_ARGUMENT,x+r+w)}function NE(r,t){return r.some(s=>s.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IE{constructor(t,s,i,n,e){this._firestore=t,this._userDataWriter=s,this._key=i,this._document=n,this._converter=e}get id(){return this._key.path.lastSegment()}get ref(){return new vs(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new uD(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const s=this._document.data.field(z0("DocumentSnapshot.get",t));if(s!==null)return this._userDataWriter.convertValue(s)}}}class uD extends IE{data(){return super.data()}}function z0(r,t){return typeof t=="string"?V2(r,t):t instanceof Mf?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fD(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new dt(Pe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class U2{}class DE extends U2{}function ua(r,t,...s){let i=[];t instanceof U2&&i.push(t),i=i.concat(s),function(e){const p=e.filter(w=>w instanceof B2).length,x=e.filter(w=>w instanceof H0).length;if(p>1||p>0&&x>0)throw new dt(Pe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const n of i)r=n._apply(r);return r}class H0 extends DE{constructor(t,s,i){super(),this._field=t,this._op=s,this._value=i,this.type="where"}static _create(t,s,i){return new H0(t,s,i)}_apply(t){const s=this._parse(t);return RE(t._query,s),new yl(t.firestore,t.converter,Ym(t._query,s))}_parse(t){const s=Lf(t.firestore);return function(e,p,x,w,E,N,P){let R;if(E.isKeyField()){if(N==="array-contains"||N==="array-contains-any")throw new dt(Pe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${N}' queries on documentId().`);if(N==="in"||N==="not-in"){Ew(P,N);const q=[];for(const Z of P)q.push(Tw(w,e,Z));R={arrayValue:{values:q}}}else R=Tw(w,e,P)}else N!=="in"&&N!=="not-in"&&N!=="array-contains-any"||Ew(P,N),R=lD(x,p,P,N==="in"||N==="not-in");return Sn.create(E,N,R)}(t._query,"where",s,t.firestore._databaseId,this._field,this._op,this._value)}}function Ya(r,t,s){const i=t,n=z0("where",r);return H0._create(n,i,s)}class B2 extends U2{constructor(t,s){super(),this.type=t,this._queryConstraints=s}static _create(t,s){return new B2(t,s)}_parse(t){const s=this._queryConstraints.map(i=>i._parse(t)).filter(i=>i.getFilters().length>0);return s.length===1?s[0]:Sa.create(s,this._getOperator())}_apply(t){const s=this._parse(t);return s.getFilters().length===0?t:(function(n,e){let p=n;const x=e.getFlattenedFilters();for(const w of x)RE(p,w),p=Ym(p,w)}(t._query,s),new yl(t.firestore,t.converter,Ym(t._query,s)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class $2 extends DE{constructor(t,s){super(),this._field=t,this._direction=s,this.type="orderBy"}static _create(t,s){return new $2(t,s)}_apply(t){const s=function(n,e,p){if(n.startAt!==null)throw new dt(Pe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(n.endAt!==null)throw new dt(Pe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new xf(e,p)}(t._query,this._field,this._direction);return new yl(t.firestore,t.converter,function(n,e){const p=n.explicitOrderBy.concat([e]);return new Ic(n.path,n.collectionGroup,p,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}(t._query,s))}}function hD(r,t="asc"){const s=t,i=z0("orderBy",r);return $2._create(i,s)}function Tw(r,t,s){if(typeof(s=Ns(s))=="string"){if(s==="")throw new dt(Pe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!FT(t)&&s.indexOf("/")!==-1)throw new dt(Pe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${s}' contains a '/' character.`);const i=t.path.child(Yr.fromString(s));if(!Ot.isDocumentKey(i))throw new dt(Pe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return H4(r,new Ot(i))}if(s instanceof vs)return H4(r,s._key);throw new dt(Pe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${U0(s)}.`)}function Ew(r,t){if(!Array.isArray(r)||r.length===0)throw new dt(Pe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function RE(r,t){const s=function(n,e){for(const p of n)for(const x of p.getFlattenedFilters())if(e.indexOf(x.op)>=0)return x.op;return null}(r.filters,function(n){switch(n){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(s!==null)throw s===t.op?new dt(Pe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new dt(Pe.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${s.toString()}' filters.`)}class dD{convertValue(t,s="none"){switch(ol(t)){case 0:return null;case 1:return t.booleanValue;case 2:return mn(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,s);case 5:return t.stringValue;case 6:return this.convertBytes(il(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,s);case 11:return this.convertObject(t.mapValue,s);case 10:return this.convertVectorValue(t.mapValue);default:throw $t()}}convertObject(t,s){return this.convertObjectMap(t.fields,s)}convertObjectMap(t,s="none"){const i={};return ml(t,(n,e)=>{i[n]=this.convertValue(e,s)}),i}convertVectorValue(t){var s,i,n;const e=(n=(i=(s=t.fields)===null||s===void 0?void 0:s.value.arrayValue)===null||i===void 0?void 0:i.values)===null||n===void 0?void 0:n.map(p=>mn(p.doubleValue));return new O2(e)}convertGeoPoint(t){return new P2(mn(t.latitude),mn(t.longitude))}convertArray(t,s){return(t.values||[]).map(i=>this.convertValue(i,s))}convertServerTimestamp(t,s){switch(s){case"previous":const i=d2(t);return i==null?null:this.convertValue(i,s);case"estimate":return this.convertTimestamp(gf(t));default:return null}}convertTimestamp(t){const s=ho(t);return new An(s.seconds,s.nanos)}convertDocumentKey(t,s){const i=Yr.fromString(t);Lr(XT(i));const n=new yf(i.get(1),i.get(3)),e=new Ot(i.popFirst(5));return n.isEqual(s)||Ti(`Document ${e} contains a document reference within a different database (${n.projectId}/${n.database}) which is not supported. It will be treated as a reference in the current database (${s.projectId}/${s.database}) instead.`),e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W2(r,t,s){let i;return i=r?s&&(s.merge||s.mergeFields)?r.toFirestore(t,s):r.toFirestore(t):t,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou{constructor(t,s){this.hasPendingWrites=t,this.fromCache=s}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class PE extends IE{constructor(t,s,i,n,e,p){super(t,s,i,n,p),this._firestore=t,this._firestoreImpl=t,this.metadata=e}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const s=new Cd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(s,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,s={}){if(this._document){const i=this._document.data.field(z0("DocumentSnapshot.get",t));if(i!==null)return this._userDataWriter.convertValue(i,s.serverTimestamps)}}}class Cd extends PE{data(t={}){return super.data(t)}}class pD{constructor(t,s,i,n){this._firestore=t,this._userDataWriter=s,this._snapshot=n,this.metadata=new Ou(n.hasPendingWrites,n.fromCache),this.query=i}get docs(){const t=[];return this.forEach(s=>t.push(s)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,s){this._snapshot.docs.forEach(i=>{t.call(s,new Cd(this._firestore,this._userDataWriter,i.key,i,new Ou(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const s=!!t.includeMetadataChanges;if(s&&this._snapshot.excludesMetadataChanges)throw new dt(Pe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===s||(this._cachedChanges=function(n,e){if(n._snapshot.oldDocs.isEmpty()){let p=0;return n._snapshot.docChanges.map(x=>{const w=new Cd(n._firestore,n._userDataWriter,x.doc.key,x.doc,new Ou(n._snapshot.mutatedKeys.has(x.doc.key),n._snapshot.fromCache),n.query.converter);return x.doc,{type:"added",doc:w,oldIndex:-1,newIndex:p++}})}{let p=n._snapshot.oldDocs;return n._snapshot.docChanges.filter(x=>e||x.type!==3).map(x=>{const w=new Cd(n._firestore,n._userDataWriter,x.doc.key,x.doc,new Ou(n._snapshot.mutatedKeys.has(x.doc.key),n._snapshot.fromCache),n.query.converter);let E=-1,N=-1;return x.type!==0&&(E=p.indexOf(x.doc.key),p=p.delete(x.doc.key)),x.type!==1&&(p=p.add(x.doc),N=p.indexOf(x.doc.key)),{type:mD(x.type),doc:w,oldIndex:E,newIndex:N}})}}(this,s),this._cachedChangesIncludeMetadataChanges=s),this._cachedChanges}}function mD(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return $t()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z2(r){r=ca(r,vs);const t=ca(r.firestore,xo);return ZI($0(t),r._key).then(s=>gD(t,r,s))}class OE extends dD{constructor(t){super(),this.firestore=t}convertBytes(t){return new Sc(t)}convertReference(t){const s=this.convertDocumentKey(t,this.firestore._databaseId);return new vs(this.firestore,null,s)}}function us(r){r=ca(r,yl);const t=ca(r.firestore,xo),s=$0(t),i=new OE(t);return fD(r._query),eD(s,r._query).then(n=>new pD(t,i,r,n))}function ig(r,t,s){r=ca(r,vs);const i=ca(r.firestore,xo),n=W2(r.converter,t,s);return Bf(i,[M2(Lf(i),"setDoc",r._key,n,r.converter!==null,s).toMutation(r._key,ys.none())])}function jE(r,t,s,...i){r=ca(r,vs);const n=ca(r.firestore,xo),e=Lf(n);let p;return p=typeof(t=Ns(t))=="string"||t instanceof Mf?CE(e,"updateDoc",r._key,t,s,i):AE(e,"updateDoc",r._key,t),Bf(n,[p.toMutation(r._key,ys.exists(!0))])}function Uf(r){return Bf(ca(r.firestore,xo),[new O0(r._key,ys.none())])}function G0(r,t){const s=ca(r.firestore,xo),i=xs(r),n=W2(r.converter,t);return Bf(s,[M2(Lf(r.firestore),"addDoc",i._key,n,r.converter!==null,{}).toMutation(i._key,ys.exists(!1))]).then(()=>i)}function Bf(r,t){return function(i,n){const e=new gi;return i.asyncQueue.enqueueAndForget(async()=>$I(await JI(i),n,e)),e.promise}($0(r),t)}function gD(r,t,s){const i=s.docs.get(t._key),n=new OE(r);return new PE(r,n,t._key,i,new Ou(s.hasPendingWrites,s.fromCache),t.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yD{constructor(t,s){this._firestore=t,this._commitHandler=s,this._mutations=[],this._committed=!1,this._dataReader=Lf(t)}set(t,s,i){this._verifyNotCommitted();const n=R1(t,this._firestore),e=W2(n.converter,s,i),p=M2(this._dataReader,"WriteBatch.set",n._key,e,n.converter!==null,i);return this._mutations.push(p.toMutation(n._key,ys.none())),this}update(t,s,i,...n){this._verifyNotCommitted();const e=R1(t,this._firestore);let p;return p=typeof(s=Ns(s))=="string"||s instanceof Mf?CE(this._dataReader,"WriteBatch.update",e._key,s,i,n):AE(this._dataReader,"WriteBatch.update",e._key,s),this._mutations.push(p.toMutation(e._key,ys.exists(!0))),this}delete(t){this._verifyNotCommitted();const s=R1(t,this._firestore);return this._mutations=this._mutations.concat(new O0(s._key,ys.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new dt(Pe.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function R1(r,t){if((r=Ns(r)).firestore!==t)throw new dt(Pe.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function og(r){return $0(r=ca(r,xo)),new yD(r,t=>Bf(r,t))}(function(t,s=!0){(function(n){Nc=n})(cN),uo(new wi("firestore",(i,{instanceIdentifier:n,options:e})=>{const p=i.getProvider("app").getImmediate(),x=new xo(new wN(i.getProvider("auth-internal")),new SN(i.getProvider("app-check-internal")),function(E,N){if(!Object.prototype.hasOwnProperty.apply(E.options,["projectId"]))throw new dt(Pe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new yf(E.options.projectId,N)}(p,n),p);return e=Object.assign({useFetchStreams:s},e),x._setSettings(e),x},"PUBLIC").setMultipleInstances(!0)),Ha(U4,"4.7.3",t),Ha(U4,"4.7.3","esm2017")})();var vD="firebase",xD="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ha(vD,xD,"app");const ME="@firebase/installations",H2="0.6.9";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LE=1e4,VE=`w:${H2}`,UE="FIS_v2",bD="https://firebaseinstallations.googleapis.com/v1",wD=60*60*1e3,_D="installations",TD="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ED={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},ll=new C0(_D,TD,ED);function BE(r){return r instanceof pl&&r.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $E({projectId:r}){return`${bD}/projects/${r}/installations`}function WE(r){return{token:r.token,requestStatus:2,expiresIn:AD(r.expiresIn),creationTime:Date.now()}}async function zE(r,t){const i=(await t.json()).error;return ll.create("request-failed",{requestName:r,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function HE({apiKey:r}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":r})}function SD(r,{refreshToken:t}){const s=HE(r);return s.append("Authorization",CD(t)),s}async function GE(r){const t=await r();return t.status>=500&&t.status<600?r():t}function AD(r){return Number(r.replace("s","000"))}function CD(r){return`${UE} ${r}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kD({appConfig:r,heartbeatServiceProvider:t},{fid:s}){const i=$E(r),n=HE(r),e=t.getImmediate({optional:!0});if(e){const E=await e.getHeartbeatsHeader();E&&n.append("x-firebase-client",E)}const p={fid:s,authVersion:UE,appId:r.appId,sdkVersion:VE},x={method:"POST",headers:n,body:JSON.stringify(p)},w=await GE(()=>fetch(i,x));if(w.ok){const E=await w.json();return{fid:E.fid||s,registrationStatus:2,refreshToken:E.refreshToken,authToken:WE(E.authToken)}}else throw await zE("Create Installation",w)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qE(r){return new Promise(t=>{setTimeout(t,r)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FD(r){return btoa(String.fromCharCode(...r)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ND=/^[cdef][\w-]{21}$/,lg="";function ID(){try{const r=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(r),r[0]=112+r[0]%16;const s=DD(r);return ND.test(s)?s:lg}catch{return lg}}function DD(r){return FD(r).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q0(r){return`${r.appName}!${r.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KE=new Map;function YE(r,t){const s=q0(r);QE(s,t),RD(s,t)}function QE(r,t){const s=KE.get(r);if(s)for(const i of s)i(t)}function RD(r,t){const s=PD();s&&s.postMessage({key:r,fid:t}),OD()}let Qo=null;function PD(){return!Qo&&"BroadcastChannel"in self&&(Qo=new BroadcastChannel("[Firebase] FID Change"),Qo.onmessage=r=>{QE(r.data.key,r.data.fid)}),Qo}function OD(){KE.size===0&&Qo&&(Qo.close(),Qo=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jD="firebase-installations-database",MD=1,cl="firebase-installations-store";let P1=null;function G2(){return P1||(P1=k0(jD,MD,{upgrade:(r,t)=>{switch(t){case 0:r.createObjectStore(cl)}}})),P1}async function c0(r,t){const s=q0(r),n=(await G2()).transaction(cl,"readwrite"),e=n.objectStore(cl),p=await e.get(s);return await e.put(t,s),await n.done,(!p||p.fid!==t.fid)&&YE(r,t.fid),t}async function XE(r){const t=q0(r),i=(await G2()).transaction(cl,"readwrite");await i.objectStore(cl).delete(t),await i.done}async function K0(r,t){const s=q0(r),n=(await G2()).transaction(cl,"readwrite"),e=n.objectStore(cl),p=await e.get(s),x=t(p);return x===void 0?await e.delete(s):await e.put(x,s),await n.done,x&&(!p||p.fid!==x.fid)&&YE(r,x.fid),x}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function q2(r){let t;const s=await K0(r.appConfig,i=>{const n=LD(i),e=VD(r,n);return t=e.registrationPromise,e.installationEntry});return s.fid===lg?{installationEntry:await t}:{installationEntry:s,registrationPromise:t}}function LD(r){const t=r||{fid:ID(),registrationStatus:0};return JE(t)}function VD(r,t){if(t.registrationStatus===0){if(!navigator.onLine){const n=Promise.reject(ll.create("app-offline"));return{installationEntry:t,registrationPromise:n}}const s={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},i=UD(r,s);return{installationEntry:s,registrationPromise:i}}else return t.registrationStatus===1?{installationEntry:t,registrationPromise:BD(r)}:{installationEntry:t}}async function UD(r,t){try{const s=await kD(r,t);return c0(r.appConfig,s)}catch(s){throw BE(s)&&s.customData.serverCode===409?await XE(r.appConfig):await c0(r.appConfig,{fid:t.fid,registrationStatus:0}),s}}async function BD(r){let t=await Sw(r.appConfig);for(;t.registrationStatus===1;)await qE(100),t=await Sw(r.appConfig);if(t.registrationStatus===0){const{installationEntry:s,registrationPromise:i}=await q2(r);return i||s}return t}function Sw(r){return K0(r,t=>{if(!t)throw ll.create("installation-not-found");return JE(t)})}function JE(r){return $D(r)?{fid:r.fid,registrationStatus:0}:r}function $D(r){return r.registrationStatus===1&&r.registrationTime+LE<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WD({appConfig:r,heartbeatServiceProvider:t},s){const i=zD(r,s),n=SD(r,s),e=t.getImmediate({optional:!0});if(e){const E=await e.getHeartbeatsHeader();E&&n.append("x-firebase-client",E)}const p={installation:{sdkVersion:VE,appId:r.appId}},x={method:"POST",headers:n,body:JSON.stringify(p)},w=await GE(()=>fetch(i,x));if(w.ok){const E=await w.json();return WE(E)}else throw await zE("Generate Auth Token",w)}function zD(r,{fid:t}){return`${$E(r)}/${t}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K2(r,t=!1){let s;const i=await K0(r.appConfig,e=>{if(!ZE(e))throw ll.create("not-registered");const p=e.authToken;if(!t&&qD(p))return e;if(p.requestStatus===1)return s=HD(r,t),e;{if(!navigator.onLine)throw ll.create("app-offline");const x=YD(e);return s=GD(r,x),x}});return s?await s:i.authToken}async function HD(r,t){let s=await Aw(r.appConfig);for(;s.authToken.requestStatus===1;)await qE(100),s=await Aw(r.appConfig);const i=s.authToken;return i.requestStatus===0?K2(r,t):i}function Aw(r){return K0(r,t=>{if(!ZE(t))throw ll.create("not-registered");const s=t.authToken;return QD(s)?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t})}async function GD(r,t){try{const s=await WD(r,t),i=Object.assign(Object.assign({},t),{authToken:s});return await c0(r.appConfig,i),s}catch(s){if(BE(s)&&(s.customData.serverCode===401||s.customData.serverCode===404))await XE(r.appConfig);else{const i=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await c0(r.appConfig,i)}throw s}}function ZE(r){return r!==void 0&&r.registrationStatus===2}function qD(r){return r.requestStatus===2&&!KD(r)}function KD(r){const t=Date.now();return t<r.creationTime||r.creationTime+r.expiresIn<t+wD}function YD(r){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},r),{authToken:t})}function QD(r){return r.requestStatus===1&&r.requestTime+LE<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XD(r){const t=r,{installationEntry:s,registrationPromise:i}=await q2(t);return i?i.catch(console.error):K2(t).catch(console.error),s.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JD(r,t=!1){const s=r;return await ZD(s),(await K2(s,t)).token}async function ZD(r){const{registrationPromise:t}=await q2(r);t&&await t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e9(r){if(!r||!r.options)throw O1("App Configuration");if(!r.name)throw O1("App Name");const t=["projectId","apiKey","appId"];for(const s of t)if(!r.options[s])throw O1(s);return{appName:r.name,projectId:r.options.projectId,apiKey:r.options.apiKey,appId:r.options.appId}}function O1(r){return ll.create("missing-app-config-values",{valueName:r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e6="installations",t9="installations-internal",r9=r=>{const t=r.getProvider("app").getImmediate(),s=e9(t),i=F0(t,"heartbeat");return{app:t,appConfig:s,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},n9=r=>{const t=r.getProvider("app").getImmediate(),s=F0(t,e6).getImmediate();return{getId:()=>XD(s),getToken:n=>JD(s,n)}};function s9(){uo(new wi(e6,r9,"PUBLIC")),uo(new wi(t9,n9,"PRIVATE"))}s9();Ha(ME,H2);Ha(ME,H2,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a9="/firebase-messaging-sw.js",i9="/firebase-cloud-messaging-push-scope",t6="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",o9="https://fcmregistrations.googleapis.com/v1",r6="google.c.a.c_id",l9="google.c.a.c_l",c9="google.c.a.ts",u9="google.c.a.e";var Cw;(function(r){r[r.DATA_MESSAGE=1]="DATA_MESSAGE",r[r.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(Cw||(Cw={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var _f;(function(r){r.PUSH_RECEIVED="push-received",r.NOTIFICATION_CLICKED="notification-clicked"})(_f||(_f={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ci(r){const t=new Uint8Array(r);return btoa(String.fromCharCode(...t)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function f9(r){const t="=".repeat((4-r.length%4)%4),s=(r+t).replace(/\-/g,"+").replace(/_/g,"/"),i=atob(s),n=new Uint8Array(i.length);for(let e=0;e<i.length;++e)n[e]=i.charCodeAt(e);return n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j1="fcm_token_details_db",h9=5,kw="fcm_token_object_Store";async function d9(r){if("databases"in indexedDB&&!(await indexedDB.databases()).map(e=>e.name).includes(j1))return null;let t=null;return(await k0(j1,h9,{upgrade:async(i,n,e,p)=>{var x;if(n<2||!i.objectStoreNames.contains(kw))return;const w=p.objectStore(kw),E=await w.index("fcmSenderId").get(r);if(await w.clear(),!!E){if(n===2){const N=E;if(!N.auth||!N.p256dh||!N.endpoint)return;t={token:N.fcmToken,createTime:(x=N.createTime)!==null&&x!==void 0?x:Date.now(),subscriptionOptions:{auth:N.auth,p256dh:N.p256dh,endpoint:N.endpoint,swScope:N.swScope,vapidKey:typeof N.vapidKey=="string"?N.vapidKey:ci(N.vapidKey)}}}else if(n===3){const N=E;t={token:N.fcmToken,createTime:N.createTime,subscriptionOptions:{auth:ci(N.auth),p256dh:ci(N.p256dh),endpoint:N.endpoint,swScope:N.swScope,vapidKey:ci(N.vapidKey)}}}else if(n===4){const N=E;t={token:N.fcmToken,createTime:N.createTime,subscriptionOptions:{auth:ci(N.auth),p256dh:ci(N.p256dh),endpoint:N.endpoint,swScope:N.swScope,vapidKey:ci(N.vapidKey)}}}}}})).close(),await A1(j1),await A1("fcm_vapid_details_db"),await A1("undefined"),p9(t)?t:null}function p9(r){if(!r||!r.subscriptionOptions)return!1;const{subscriptionOptions:t}=r;return typeof r.createTime=="number"&&r.createTime>0&&typeof r.token=="string"&&r.token.length>0&&typeof t.auth=="string"&&t.auth.length>0&&typeof t.p256dh=="string"&&t.p256dh.length>0&&typeof t.endpoint=="string"&&t.endpoint.length>0&&typeof t.swScope=="string"&&t.swScope.length>0&&typeof t.vapidKey=="string"&&t.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m9="firebase-messaging-database",g9=1,Tf="firebase-messaging-store";let M1=null;function n6(){return M1||(M1=k0(m9,g9,{upgrade:(r,t)=>{switch(t){case 0:r.createObjectStore(Tf)}}})),M1}async function y9(r){const t=s6(r),i=await(await n6()).transaction(Tf).objectStore(Tf).get(t);if(i)return i;{const n=await d9(r.appConfig.senderId);if(n)return await Y2(r,n),n}}async function Y2(r,t){const s=s6(r),n=(await n6()).transaction(Tf,"readwrite");return await n.objectStore(Tf).put(t,s),await n.done,t}function s6({appConfig:r}){return r.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v9={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},ls=new C0("messaging","Messaging",v9);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x9(r,t){const s=await X2(r),i=a6(t),n={method:"POST",headers:s,body:JSON.stringify(i)};let e;try{e=await(await fetch(Q2(r.appConfig),n)).json()}catch(p){throw ls.create("token-subscribe-failed",{errorInfo:p==null?void 0:p.toString()})}if(e.error){const p=e.error.message;throw ls.create("token-subscribe-failed",{errorInfo:p})}if(!e.token)throw ls.create("token-subscribe-no-token");return e.token}async function b9(r,t){const s=await X2(r),i=a6(t.subscriptionOptions),n={method:"PATCH",headers:s,body:JSON.stringify(i)};let e;try{e=await(await fetch(`${Q2(r.appConfig)}/${t.token}`,n)).json()}catch(p){throw ls.create("token-update-failed",{errorInfo:p==null?void 0:p.toString()})}if(e.error){const p=e.error.message;throw ls.create("token-update-failed",{errorInfo:p})}if(!e.token)throw ls.create("token-update-no-token");return e.token}async function w9(r,t){const i={method:"DELETE",headers:await X2(r)};try{const e=await(await fetch(`${Q2(r.appConfig)}/${t}`,i)).json();if(e.error){const p=e.error.message;throw ls.create("token-unsubscribe-failed",{errorInfo:p})}}catch(n){throw ls.create("token-unsubscribe-failed",{errorInfo:n==null?void 0:n.toString()})}}function Q2({projectId:r}){return`${o9}/projects/${r}/registrations`}async function X2({appConfig:r,installations:t}){const s=await t.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":r.apiKey,"x-goog-firebase-installations-auth":`FIS ${s}`})}function a6({p256dh:r,auth:t,endpoint:s,vapidKey:i}){const n={web:{endpoint:s,auth:t,p256dh:r}};return i!==t6&&(n.web.applicationPubKey=i),n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _9=7*24*60*60*1e3;async function T9(r){const t=await S9(r.swRegistration,r.vapidKey),s={vapidKey:r.vapidKey,swScope:r.swRegistration.scope,endpoint:t.endpoint,auth:ci(t.getKey("auth")),p256dh:ci(t.getKey("p256dh"))},i=await y9(r.firebaseDependencies);if(i){if(A9(i.subscriptionOptions,s))return Date.now()>=i.createTime+_9?E9(r,{token:i.token,createTime:Date.now(),subscriptionOptions:s}):i.token;try{await w9(r.firebaseDependencies,i.token)}catch(n){console.warn(n)}return Fw(r.firebaseDependencies,s)}else return Fw(r.firebaseDependencies,s)}async function E9(r,t){try{const s=await b9(r.firebaseDependencies,t),i=Object.assign(Object.assign({},t),{token:s,createTime:Date.now()});return await Y2(r.firebaseDependencies,i),s}catch(s){throw s}}async function Fw(r,t){const i={token:await x9(r,t),createTime:Date.now(),subscriptionOptions:t};return await Y2(r,i),i.token}async function S9(r,t){const s=await r.pushManager.getSubscription();return s||r.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:f9(t)})}function A9(r,t){const s=t.vapidKey===r.vapidKey,i=t.endpoint===r.endpoint,n=t.auth===r.auth,e=t.p256dh===r.p256dh;return s&&i&&n&&e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nw(r){const t={from:r.from,collapseKey:r.collapse_key,messageId:r.fcmMessageId};return C9(t,r),k9(t,r),F9(t,r),t}function C9(r,t){if(!t.notification)return;r.notification={};const s=t.notification.title;s&&(r.notification.title=s);const i=t.notification.body;i&&(r.notification.body=i);const n=t.notification.image;n&&(r.notification.image=n);const e=t.notification.icon;e&&(r.notification.icon=e)}function k9(r,t){t.data&&(r.data=t.data)}function F9(r,t){var s,i,n,e,p;if(!t.fcmOptions&&!(!((s=t.notification)===null||s===void 0)&&s.click_action))return;r.fcmOptions={};const x=(n=(i=t.fcmOptions)===null||i===void 0?void 0:i.link)!==null&&n!==void 0?n:(e=t.notification)===null||e===void 0?void 0:e.click_action;x&&(r.fcmOptions.link=x);const w=(p=t.fcmOptions)===null||p===void 0?void 0:p.analytics_label;w&&(r.fcmOptions.analyticsLabel=w)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N9(r){return typeof r=="object"&&!!r&&r6 in r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I9(r){if(!r||!r.options)throw L1("App Configuration Object");if(!r.name)throw L1("App Name");const t=["projectId","apiKey","appId","messagingSenderId"],{options:s}=r;for(const i of t)if(!s[i])throw L1(i);return{appName:r.name,projectId:s.projectId,apiKey:s.apiKey,appId:s.appId,senderId:s.messagingSenderId}}function L1(r){return ls.create("missing-app-config-values",{valueName:r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D9{constructor(t,s,i){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const n=I9(t);this.firebaseDependencies={app:t,appConfig:n,installations:s,analyticsProvider:i}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function R9(r){try{r.swRegistration=await navigator.serviceWorker.register(a9,{scope:i9}),r.swRegistration.update().catch(()=>{})}catch(t){throw ls.create("failed-service-worker-registration",{browserErrorMessage:t==null?void 0:t.message})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function P9(r,t){if(!t&&!r.swRegistration&&await R9(r),!(!t&&r.swRegistration)){if(!(t instanceof ServiceWorkerRegistration))throw ls.create("invalid-sw-registration");r.swRegistration=t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O9(r,t){t?r.vapidKey=t:r.vapidKey||(r.vapidKey=t6)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function i6(r,t){if(!navigator)throw ls.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw ls.create("permission-blocked");return await O9(r,t==null?void 0:t.vapidKey),await P9(r,t==null?void 0:t.serviceWorkerRegistration),T9(r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j9(r,t,s){const i=M9(t);(await r.firebaseDependencies.analyticsProvider.get()).logEvent(i,{message_id:s[r6],message_name:s[l9],message_time:s[c9],message_device_time:Math.floor(Date.now()/1e3)})}function M9(r){switch(r){case _f.NOTIFICATION_CLICKED:return"notification_open";case _f.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L9(r,t){const s=t.data;if(!s.isFirebaseMessaging)return;r.onMessageHandler&&s.messageType===_f.PUSH_RECEIVED&&(typeof r.onMessageHandler=="function"?r.onMessageHandler(Nw(s)):r.onMessageHandler.next(Nw(s)));const i=s.data;N9(i)&&i[u9]==="1"&&await j9(r,s.messageType,i)}const Iw="@firebase/messaging",Dw="0.12.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V9=r=>{const t=new D9(r.getProvider("app").getImmediate(),r.getProvider("installations-internal").getImmediate(),r.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",s=>L9(t,s)),t},U9=r=>{const t=r.getProvider("messaging").getImmediate();return{getToken:i=>i6(t,i)}};function B9(){uo(new wi("messaging",V9,"PUBLIC")),uo(new wi("messaging-internal",U9,"PRIVATE")),Ha(Iw,Dw),Ha(Iw,Dw,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $9(){try{await sT()}catch{return!1}return typeof window<"u"&&nT()&&lF()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W9(r,t){if(!navigator)throw ls.create("only-available-in-window");return r.onMessageHandler=t,()=>{r.onMessageHandler=null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o6(r=cT()){return $9().then(t=>{if(!t)throw ls.create("unsupported-browser")},t=>{throw ls.create("indexed-db-unsupported")}),F0(Ns(r),"messaging").getImmediate()}async function z9(r,t){return r=Ns(r),i6(r,t)}function H9(r,t){return r=Ns(r),W9(r,t)}B9();const G9={apiKey:"AIzaSyCK5hwv80v9xQcO7raHcrj4eibS3HGq45c",authDomain:"bulldog-co-manager.firebaseapp.com",projectId:"bulldog-co-manager",storageBucket:"bulldog-co-manager.firebasestorage.app",messagingSenderId:"773110288400",appId:"1:773110288400:web:8539a42e8031382ba5ba95"};let Ef;O4().length===0?Ef=lT(G9):Ef=O4()[0];let sr;try{if(sr=nD(Ef),!sr)throw new Error("Firestore initialization returned undefined. Please ensure Firestore is enabled in Firebase Console.")}catch(r){console.error("Error initializing Firestore:",r);const t=r instanceof Error?r.message:"Unknown error";throw new Error(`Firestore initialization failed: ${t}

Please ensure:
1. Firestore Database is enabled in Firebase Console
2. You're using the correct Firebase project
3. Your internet connection is working`)}let q9=null;if(typeof window<"u")try{q9=o6(Ef)}catch(r){console.warn("Firebase Messaging initialization failed:",r)}const ul="cadets";async function di(r){if(r==="Master"){const t=ua(Cn(sr,ul));return(await us(t)).docs.map(i=>({id:i.id,...i.data()}))}else{const t=ua(Cn(sr,ul),Ya("company","==",r));return(await us(t)).docs.map(i=>({id:i.id,...i.data()})).sort((i,n)=>{const e=i.lastName.localeCompare(n.lastName);return e!==0?e:i.firstName.localeCompare(n.firstName)})}}async function K9(r){const t=xs(sr,ul,r),s=await z2(t);return s.exists()?{id:s.id,...s.data()}:null}async function Y9(r){const t=Object.fromEntries(Object.entries(r).filter(([i,n])=>n!==void 0));return(await G0(Cn(sr,ul),t)).id}async function Q9(r,t){const s=Object.fromEntries(Object.entries(t).filter(([n,e])=>e!==void 0)),i=xs(sr,ul,r);await jE(i,s)}async function X9(r){const t=xs(sr,ul,r);await Uf(t)}async function l6(r){const t=ua(Cn(sr,ul),Ya("militaryScienceLevel","==",r));return(await us(t)).docs.map(i=>({id:i.id,...i.data()})).sort((i,n)=>{const e=i.lastName.localeCompare(n.lastName);return e!==0?e:i.firstName.localeCompare(n.firstName)})}const bo="attendance";function c6(r,t){return`${t}_${r}`}async function J9(r,t){const s=c6(r,t),i=xs(sr,bo,s),n=await z2(i);return n.exists()?n.data():{cadetId:r,ptMonday:null,ptTuesday:null,ptWednesday:null,ptThursday:null,ptFriday:null,labThursday:null,tacticsTuesday:null,weekStartDate:t}}async function u6(r){const t=c6(r.cadetId,r.weekStartDate),s=xs(sr,bo,t);await ig(s,{cadetId:r.cadetId,weekStartDate:r.weekStartDate,ptMonday:r.ptMonday??null,ptTuesday:r.ptTuesday??null,ptWednesday:r.ptWednesday??null,ptThursday:r.ptThursday??null,ptFriday:r.ptFriday??null,labThursday:r.labThursday??null,tacticsTuesday:r.tacticsTuesday??null},{merge:!0})}async function Z9(r,t){const s=await di(r),i=new Map,n=new Set(s.map(w=>w.id)),e=ua(Cn(sr,bo),Ya("weekStartDate","==",t));return(await us(e)).docs.map(w=>w.data()).forEach(w=>{n.has(w.cadetId)&&i.set(w.cadetId,w)}),s.forEach(w=>{if(!i.has(w.id))i.set(w.id,{cadetId:w.id,ptMonday:null,ptTuesday:null,ptWednesday:null,ptThursday:null,ptFriday:null,labThursday:null,tacticsTuesday:null,weekStartDate:t});else{const E=i.get(w.id);if(!("ptTuesday"in E)){const N=E;i.set(w.id,{cadetId:w.id,ptMonday:null,ptTuesday:N.tuesday??null,ptWednesday:N.wednesday??null,ptThursday:N.thursday??null,ptFriday:null,labThursday:null,tacticsTuesday:null,weekStartDate:t})}}}),i}async function V1(r,t){const s=ua(Cn(sr,bo),Ya("cadetId","==",r)),i=await us(s);let n=0;return i.docs.forEach(e=>{const p=e.data();(t==="PT"||!t)&&(p.ptMonday==="unexcused"&&n++,p.ptTuesday==="unexcused"&&n++,p.ptWednesday==="unexcused"&&n++,p.ptThursday==="unexcused"&&n++,p.ptFriday==="unexcused"&&n++,p.tuesday==="unexcused"&&!p.ptTuesday&&n++,p.wednesday==="unexcused"&&!p.ptWednesday&&n++,p.thursday==="unexcused"&&!p.ptThursday&&!p.labThursday&&n++),(t==="Lab"||!t)&&p.labThursday==="unexcused"&&n++,(t==="Tactics"||!t)&&p.tacticsTuesday==="unexcused"&&n++}),n}async function U1(r,t){const s=ua(Cn(sr,bo),Ya("cadetId","==",r)),i=await us(s),n=[];return i.docs.forEach(e=>{const p=e.data(),x=p.weekStartDate;if(!x)return;const[w,E,N]=x.split("-").map(Number),P=new Date(w,E-1,N+1),R=new Date(w,E-1,N+2),q=new Date(w,E-1,N+3),Z=ne=>{const fe=ne.getFullYear(),G=String(ne.getMonth()+1).padStart(2,"0"),U=String(ne.getDate()).padStart(2,"0");return`${fe}-${G}-${U}`};if(t==="PT"){const ne=new Date(w,E-1,N),fe=new Date(w,E-1,N+4);p.ptMonday==="unexcused"&&n.push(Z(ne)),p.ptTuesday==="unexcused"&&n.push(Z(P)),p.ptWednesday==="unexcused"&&n.push(Z(R)),p.ptThursday==="unexcused"&&n.push(Z(q)),p.ptFriday==="unexcused"&&n.push(Z(fe)),p.tuesday==="unexcused"&&!p.ptTuesday&&n.push(Z(P)),p.wednesday==="unexcused"&&!p.ptWednesday&&n.push(Z(R)),p.thursday==="unexcused"&&!p.ptThursday&&!p.labThursday&&n.push(Z(q))}else t==="Lab"?p.labThursday==="unexcused"&&n.push(Z(q)):t==="Tactics"&&p.tacticsTuesday==="unexcused"&&n.push(Z(P))}),n.sort((e,p)=>p.localeCompare(e))}async function cg(r,t){const s=new Map;r.forEach(n=>s.set(n,0));const i=10;for(let n=0;n<r.length;n+=i){const e=r.slice(n,n+i),p=ua(Cn(sr,bo),Ya("cadetId","in",e));(await us(p)).docs.forEach(w=>{const E=w.data(),N=s.get(E.cadetId)||0;let P=0;(t==="PT"||!t)&&(E.ptMonday==="unexcused"&&P++,E.ptTuesday==="unexcused"&&P++,E.ptWednesday==="unexcused"&&P++,E.ptThursday==="unexcused"&&P++,E.ptFriday==="unexcused"&&P++,E.tuesday==="unexcused"&&!E.ptTuesday&&P++,E.wednesday==="unexcused"&&!E.ptWednesday&&P++,E.thursday==="unexcused"&&!E.ptThursday&&!E.labThursday&&P++),(t==="Lab"||!t)&&E.labThursday==="unexcused"&&P++,(t==="Tactics"||!t)&&E.tacticsTuesday==="unexcused"&&P++,s.set(E.cadetId,N+P)})}return s}async function J2(r){const t=new Map,s=ua(Cn(sr,bo),Ya("weekStartDate","==",r));return(await us(s)).docs.forEach(n=>{const e=n.data();"ptTuesday"in e?t.set(e.cadetId,e):t.set(e.cadetId,{cadetId:e.cadetId,ptMonday:null,ptTuesday:e.tuesday??null,ptWednesday:e.wednesday??null,ptThursday:e.thursday??null,ptFriday:null,labThursday:null,tacticsTuesday:null,weekStartDate:e.weekStartDate})}),t}async function e7(){const r=await us(Cn(sr,bo)),t=og(sr);r.docs.forEach(s=>{t.update(s.ref,{ptMonday:null,ptTuesday:null,ptWednesday:null,ptThursday:null,ptFriday:null,labThursday:null,tacticsTuesday:null})}),await t.commit()}function f6(){const t=new Date().toLocaleString("en-US",{timeZone:"America/New_York"});return new Date(t)}function Ta(){const r=f6(),t=r.getDay(),s=t===0?6:t-1,i=new Date(r);i.setDate(r.getDate()-s),i.setHours(0,0,0,0);const n=i.getFullYear(),e=String(i.getMonth()+1).padStart(2,"0"),p=String(i.getDate()).padStart(2,"0");return`${n}-${e}-${p}`}function Y0(r){const[t,s,i]=r.split("-").map(Number);return`${new Date(t,s-1,i).toLocaleDateString("en-US",{month:"short"})} ${(x=>{const w=["th","st","nd","rd"],E=x%100;return x+(w[(E-20)%10]||w[E]||w[0])})(i)}`}function Ac(r,t){const[s,i,n]=r.split("-").map(Number),e=new Date(s,i-1,n);e.setDate(e.getDate()+t*7);const p=e.getFullYear(),x=String(e.getMonth()+1).padStart(2,"0"),w=String(e.getDate()).padStart(2,"0");return`${p}-${x}-${w}`}function Pc(r){const[t,s,i]=r.split("-").map(Number),n=(e,p,x)=>{const w=new Date(Date.UTC(e,p-1,x)),E=w.getUTCFullYear(),N=String(w.getUTCMonth()+1).padStart(2,"0"),P=String(w.getUTCDate()).padStart(2,"0");return`${E}-${N}-${P}`};return{monday:n(t,s,i),tuesday:n(t,s,i+1),wednesday:n(t,s,i+2),thursday:n(t,s,i+3),friday:n(t,s,i+4)}}function t7(r){const[t,s,i]=r.split("-").map(Number),n=(e,p,x)=>{const w=new Date(Date.UTC(e,p-1,x)),E=w.getUTCFullYear(),N=String(w.getUTCMonth()+1).padStart(2,"0"),P=String(w.getUTCDate()).padStart(2,"0");return`${E}-${N}-${P}`};return{monday:n(t,s,i),tuesday:n(t,s,i+1),wednesday:n(t,s,i+2),thursday:n(t,s,i+3),friday:n(t,s,i+4),saturday:n(t,s,i+5),sunday:n(t,s,i+6)}}function r7(r){const[t,s,i]=r.split("-").map(Number),n=new Date(t,s-1,i),e=n.toLocaleDateString("en-US",{weekday:"short"}),p=n.toLocaleDateString("en-US",{month:"short"});return`${e} ${p} ${i}`}function sa(r){const[t,s,i]=r.split("-").map(Number),n=`${t}-${String(s).padStart(2,"0")}-${String(i).padStart(2,"0")}T12:00:00-05:00`;return new Date(n).toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric",timeZone:"America/New_York"})}function h6(r){const[t,s,i]=r.split("-").map(Number);return`${new Date(t,s-1,i).toLocaleDateString("en-US",{month:"long"})} ${(x=>{const w=["th","st","nd","rd"],E=x%100;return x+(w[(E-20)%10]||w[E]||w[0])})(i)}, ${t}`}function n7(){const r=f6(),t=r.getFullYear(),s=String(r.getMonth()+1).padStart(2,"0"),i=String(r.getDate()).padStart(2,"0");return`${t}-${s}-${i}`}function $l(r,t,s="PT"){const i={present:0,excused:0,unexcused:0};return r.forEach(n=>{let e=null;s==="PT"?t==="monday"?e=n.ptMonday??null:t==="tuesday"?e=n.ptTuesday:t==="wednesday"?e=n.ptWednesday:t==="thursday"?e=n.ptThursday:t==="friday"&&(e=n.ptFriday??null):s==="Lab"&&t==="thursday"&&(e=n.labThursday),e==="present"?i.present++:e==="excused"?i.excused++:e==="unexcused"&&i.unexcused++}),i}function s7(r,t="PT"){const s={present:0,excused:0,unexcused:0};return r.forEach(i=>{if(t==="PT")[i.ptMonday,i.ptTuesday,i.ptWednesday,i.ptThursday,i.ptFriday].filter(e=>e!==void 0).forEach(e=>{e==="present"?s.present++:e==="excused"?s.excused++:e==="unexcused"&&s.unexcused++});else if(t==="Lab"){const n=i.labThursday;n==="present"?s.present++:n==="excused"?s.excused++:n==="unexcused"&&s.unexcused++}}),s}function Rw(r,t,s,i,n="PT"){const e=new Map;return r.forEach(p=>{const x=t.get(p.cadetId);if(!x)return;let w=!1;if(n==="PT"?s==="week"?w=p.ptMonday===i||p.ptTuesday===i||p.ptWednesday===i||p.ptThursday===i||p.ptFriday===i:s==="monday"?w=p.ptMonday===i:s==="tuesday"?w=p.ptTuesday===i:s==="wednesday"?w=p.ptWednesday===i:s==="thursday"?w=p.ptThursday===i:s==="friday"&&(w=p.ptFriday===i):n==="Lab"&&(s==="week"||s==="thursday")&&(w=p.labThursday===i),w){const E=x.militaryScienceLevel;e.has(E)||e.set(E,[]),e.get(E).push({id:p.cadetId,name:`${x.lastName}, ${x.firstName}`,level:x.militaryScienceLevel})}}),e.forEach((p,x)=>{p.sort((w,E)=>w.name.localeCompare(E.name))}),e}function Pw({company:r,onBack:t,onSelectCadet:s}){const[i,n]=we.useState([]),[e,p]=we.useState(new Map),[x,w]=we.useState(new Map),[E,N]=we.useState(!0),[P,R]=we.useState(!1),[q,Z]=we.useState("week"),[ne,fe]=we.useState(Ta()),[G,U]=we.useState("PT"),[H,ee]=we.useState(new Map),[te,ue]=we.useState(new Map),[L,O]=we.useState(null),V=Pc(ne),W=r==="Ranger"&&G==="PT";we.useEffect(()=>{J()},[r,ne]),we.useEffect(()=>{i.length>0&&X()},[i]);async function J(){N(!0);try{const[Ke,jt]=await Promise.all([di(r),Z9(r,ne)]);n(Ke),p(jt),w(new Map(jt))}catch(Ke){console.error("Error loading data:",Ke),alert(`Error loading data: ${Ke instanceof Error?Ke.message:"Unknown error"}

Please check:
1. Firestore is enabled in Firebase Console
2. Internet connection is working
3. Browser console for more details`)}finally{N(!1)}}async function X(){try{const Ke=i.map(Vt=>Vt.id),[jt,mt]=await Promise.all([cg(Ke,"PT"),cg(Ke,"Lab")]);ee(jt),ue(mt)}catch(Ke){console.error("Error loading unexcused totals:",Ke)}}function K(Ke,jt,mt,Vt){w(Qt=>{const lr=new Map(Qt),Xr={...lr.get(Ke)||{cadetId:Ke,ptMonday:null,ptTuesday:null,ptWednesday:null,ptThursday:null,ptFriday:null,labThursday:null,weekStartDate:ne},weekStartDate:ne};return Vt==="PT"?jt==="monday"?Xr.ptMonday=mt||null:jt==="tuesday"?Xr.ptTuesday=mt||null:jt==="wednesday"?Xr.ptWednesday=mt||null:jt==="thursday"?Xr.ptThursday=mt||null:jt==="friday"&&(Xr.ptFriday=mt||null):Vt==="Lab"&&jt==="thursday"&&(Xr.labThursday=mt||null),lr.set(Ke,Xr),lr})}function me(Ke,jt,mt){w(Vt=>{const Qt=new Map(Vt);return i.forEach(lr=>{const Xr={...Qt.get(lr.id)||{cadetId:lr.id,ptMonday:null,ptTuesday:null,ptWednesday:null,ptThursday:null,ptFriday:null,labThursday:null,weekStartDate:ne},weekStartDate:ne};jt==="PT"?Ke==="monday"?Xr.ptMonday=mt:Ke==="tuesday"?Xr.ptTuesday=mt:Ke==="wednesday"?Xr.ptWednesday=mt:Ke==="thursday"?Xr.ptThursday=mt:Ke==="friday"&&(Xr.ptFriday=mt):jt==="Lab"&&Ke==="thursday"&&(Xr.labThursday=mt),Qt.set(lr.id,Xr)}),Qt})}async function He(Ke,jt){me(Ke,jt,"present")}async function fr(Ke,jt){me(Ke,jt,"excused")}async function at(Ke,jt){me(Ke,jt,"unexcused")}async function $e(Ke,jt){me(Ke,jt,null)}async function Ve(){R(!0);try{const Ke=[];x.forEach((mt,Vt)=>{const Qt=e.get(Vt);mt.ptMonday!==((Qt==null?void 0:Qt.ptMonday)??null)&&Ke.push({cadetId:Vt,day:"monday",status:mt.ptMonday??null,type:"PT"}),mt.ptTuesday!==((Qt==null?void 0:Qt.ptTuesday)??null)&&Ke.push({cadetId:Vt,day:"tuesday",status:mt.ptTuesday,type:"PT"}),mt.ptWednesday!==((Qt==null?void 0:Qt.ptWednesday)??null)&&Ke.push({cadetId:Vt,day:"wednesday",status:mt.ptWednesday,type:"PT"}),mt.ptThursday!==((Qt==null?void 0:Qt.ptThursday)??null)&&Ke.push({cadetId:Vt,day:"thursday",status:mt.ptThursday,type:"PT"}),mt.ptFriday!==((Qt==null?void 0:Qt.ptFriday)??null)&&Ke.push({cadetId:Vt,day:"friday",status:mt.ptFriday??null,type:"PT"}),mt.labThursday!==((Qt==null?void 0:Qt.labThursday)??null)&&Ke.push({cadetId:Vt,day:"thursday",status:mt.labThursday,type:"Lab"})}),e.forEach((mt,Vt)=>{x.has(Vt)||(mt.ptMonday!==null&&mt.ptMonday!==void 0&&Ke.push({cadetId:Vt,day:"monday",status:null,type:"PT"}),mt.ptTuesday!==null&&Ke.push({cadetId:Vt,day:"tuesday",status:null,type:"PT"}),mt.ptWednesday!==null&&Ke.push({cadetId:Vt,day:"wednesday",status:null,type:"PT"}),mt.ptThursday!==null&&Ke.push({cadetId:Vt,day:"thursday",status:null,type:"PT"}),mt.ptFriday!==null&&mt.ptFriday!==void 0&&Ke.push({cadetId:Vt,day:"friday",status:null,type:"PT"}),mt.labThursday!==null&&Ke.push({cadetId:Vt,day:"thursday",status:null,type:"Lab"}))});const jt=new Map;Ke.forEach(({cadetId:mt})=>{if(!jt.has(mt)){const Vt=x.get(mt);Vt?jt.set(mt,{...Vt}):jt.set(mt,{cadetId:mt,weekStartDate:ne,ptMonday:null,ptTuesday:null,ptWednesday:null,ptThursday:null,ptFriday:null,labThursday:null})}}),await Promise.all(Array.from(jt.values()).map(mt=>u6(mt))),p(new Map(x)),await X(),r==="Master"&&await J(),alert(r==="Master"?"Attendance saved successfully! Changes will be reflected in all company rosters.":"Attendance saved successfully!")}catch(Ke){console.error("Error saving attendance:",Ke),alert(`Error saving attendance: ${Ke instanceof Error?Ke.message:"Unknown error"}`),await J()}finally{R(!1)}}const ye=Array.from(x.values()),oe=new Map(i.map(Ke=>[Ke.id,Ke])),Fe=W?$l(ye,"monday",G):{present:0,excused:0,unexcused:0},Oe=G==="PT"?$l(ye,"tuesday",G):{present:0,excused:0,unexcused:0},Re=G==="PT"?$l(ye,"wednesday",G):{present:0,excused:0,unexcused:0},de=$l(ye,"thursday",G),Ce=W?$l(ye,"friday",G):{present:0,excused:0,unexcused:0},ce=s7(ye,G),Et=Rw(ye,oe,q,"excused",G),Xe=Rw(ye,oe,q,"unexcused",G),zt=G==="PT"?H:te,or=n7(),vt=Ta(),Ct=ne===vt;let pt=null,Rr="";Ct&&(or===V.monday?(pt="monday",Rr=V.monday):or===V.tuesday?(pt="tuesday",Rr=V.tuesday):or===V.wednesday?(pt="wednesday",Rr=V.wednesday):or===V.thursday?(pt="thursday",Rr=V.thursday):or===V.friday&&(pt="friday",Rr=V.friday));let er={present:0,excused:0,unexcused:0,assigned:i.length};pt&&(er=$l(ye,pt,G),er.assigned=i.length);const Pr=JSON.stringify(Array.from(e.entries()).sort())!==JSON.stringify(Array.from(x.entries()).sort());return E?m.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:m.jsx("div",{className:"text-gray-600",children:"Loading..."})}):m.jsxs("div",{className:"min-h-screen bg-gray-50 pb-safe-area-inset-bottom",children:[m.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-10 safe-area-inset-top",children:m.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[m.jsx("h1",{className:"text-xl font-bold text-gray-900",children:r==="Master"?"Master List":`${r} Company`}),m.jsx("button",{onClick:t,className:"text-sm text-blue-600 font-medium touch-manipulation",style:{minHeight:"44px",minWidth:"44px"},children:"Home"})]})}),m.jsxs("main",{className:"px-4 py-4",children:[m.jsxs("div",{className:"flex border-b border-gray-200 mb-4 bg-white rounded-t-lg",children:[m.jsx("button",{onClick:()=>U("PT"),className:`flex-1 py-3 text-sm font-medium touch-manipulation ${G==="PT"?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-600"}`,children:"PT"}),m.jsx("button",{onClick:()=>U("Lab"),className:`flex-1 py-3 text-sm font-medium touch-manipulation ${G==="Lab"?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-600"}`,children:"Lab"})]}),m.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-4 overflow-x-auto",children:m.jsxs("div",{className:`grid gap-2 text-center min-w-full ${W?"grid-cols-6":G==="PT"?"grid-cols-4":"grid-cols-2"}`,children:[m.jsx("div",{className:"font-semibold text-gray-700",children:"Name"}),W&&m.jsx(Cu,{date:V.monday,day:"monday",attendanceType:G,company:r,onContextMenu:(Ke,jt)=>{Ke.preventDefault(),O({day:jt,type:G,x:Ke.clientX,y:Ke.clientY})}}),G==="PT"&&m.jsxs(m.Fragment,{children:[m.jsx(Cu,{date:V.tuesday,day:"tuesday",attendanceType:G,company:r,onContextMenu:(Ke,jt)=>{Ke.preventDefault(),O({day:jt,type:G,x:Ke.clientX,y:Ke.clientY})}}),m.jsx(Cu,{date:V.wednesday,day:"wednesday",attendanceType:G,company:r,onContextMenu:(Ke,jt)=>{Ke.preventDefault(),O({day:jt,type:G,x:Ke.clientX,y:Ke.clientY})}})]}),m.jsx(Cu,{date:V.thursday,day:"thursday",attendanceType:G,company:r,onContextMenu:(Ke,jt)=>{Ke.preventDefault(),O({day:jt,type:G,x:Ke.clientX,y:Ke.clientY})}}),W&&m.jsx(Cu,{date:V.friday,day:"friday",attendanceType:G,company:r,onContextMenu:(Ke,jt)=>{Ke.preventDefault(),O({day:jt,type:G,x:Ke.clientX,y:Ke.clientY})}})]})}),L&&m.jsx(l7,{x:L.x,y:L.y,onClose:()=>O(null),onMarkAllPresent:()=>{He(L.day,L.type),O(null)},onMarkAllExcused:()=>{fr(L.day,L.type),O(null)},onMarkAllUnexcused:()=>{at(L.day,L.type),O(null)},onClearAll:()=>{$e(L.day,L.type),O(null)}}),m.jsx("div",{className:"space-y-2",children:r==="Master"?(()=>{const Ke=new Map;return i.forEach(mt=>{const Vt=mt.militaryScienceLevel;Ke.has(Vt)||Ke.set(Vt,[]),Ke.get(Vt).push(mt)}),Array.from(Ke.keys()).sort((mt,Vt)=>{const Qt=parseInt(mt.replace("MS","")),lr=parseInt(Vt.replace("MS",""));return Qt-lr}).map(mt=>m.jsxs("div",{children:[m.jsx("div",{className:"bg-gray-100 border-b-2 border-gray-300 px-4 py-2 mb-2 rounded-t-lg",children:m.jsx("h3",{className:"font-bold text-gray-900 text-sm",children:mt})}),m.jsx("div",{className:"space-y-2 mb-4",children:Ke.get(mt).map(Vt=>{const Qt=x.get(Vt.id);return m.jsx(Ow,{cadet:Vt,attendance:Qt,onStatusChange:K,onSelectCadet:s,attendanceType:G,company:r,showMondayFriday:W},Vt.id)})})]},mt))})():i.map(Ke=>{const jt=x.get(Ke.id);return m.jsx(Ow,{cadet:Ke,attendance:jt,onStatusChange:K,onSelectCadet:s,attendanceType:G,company:r,showMondayFriday:W},Ke.id)})}),i.length===0&&m.jsxs("div",{className:"text-center py-8 text-gray-500",children:["No cadets found for ",r," Company"]}),i.length>0&&m.jsx("div",{className:"mt-4 mb-4",children:m.jsx("button",{onClick:Ve,disabled:!Pr||P,className:`w-full py-3 px-4 rounded-lg font-semibold text-white touch-manipulation min-h-[44px] ${Pr&&!P?"bg-blue-600 hover:bg-blue-700 active:bg-blue-800":"bg-gray-400 cursor-not-allowed"}`,children:P?"Saving...":Pr?"Save Changes":"All Changes Saved"})}),i.length>0&&pt&&Rr&&m.jsxs("div",{className:"mb-4 bg-blue-50 rounded-lg border border-blue-200 p-4",children:[m.jsxs("div",{className:"text-sm font-semibold text-gray-900 mb-2",children:["Today's Attendance (",sa(Rr),")"]}),m.jsxs("div",{className:"grid grid-cols-4 gap-3 text-center",children:[m.jsxs("div",{children:[m.jsx("div",{className:"text-lg font-bold text-gray-900",children:er.assigned}),m.jsx("div",{className:"text-xs text-gray-600",children:"Assigned"})]}),m.jsxs("div",{children:[m.jsx("div",{className:"text-lg font-bold text-present",children:er.present}),m.jsx("div",{className:"text-xs text-gray-600",children:"Present"})]}),m.jsxs("div",{children:[m.jsx("div",{className:"text-lg font-bold text-excused",children:er.excused}),m.jsx("div",{className:"text-xs text-gray-600",children:"Excused"})]}),m.jsxs("div",{children:[m.jsx("div",{className:"text-lg font-bold text-unexcused",children:er.unexcused}),m.jsx("div",{className:"text-xs text-gray-600",children:"Unexcused"})]})]})]}),i.length>0&&m.jsx(i7,{currentWeekStart:ne,onWeekChange:fe}),i.length>0&&m.jsx(a7,{company:r,cadets:i,records:ye,mondayStats:Fe,tuesdayStats:Oe,wednesdayStats:Re,thursdayStats:de,fridayStats:Ce,weekStats:ce,weekDates:V,excusedByLevel:Et,unexcusedByLevel:Xe,selectedDay:q,onDayChange:Z,unexcusedTotals:zt,currentWeekStart:ne,onWeekChange:fe,attendanceType:G,showMondayFriday:W})]})]})}function Ow({cadet:r,attendance:t,onStatusChange:s,onSelectCadet:i,attendanceType:n,company:e,showMondayFriday:p}){const x=(t==null?void 0:t.ptMonday)??null,w=(t==null?void 0:t.ptTuesday)??null,E=(t==null?void 0:t.ptWednesday)??null,N=(t==null?void 0:t.ptThursday)??null,P=(t==null?void 0:t.ptFriday)??null,R=(t==null?void 0:t.labThursday)??null;function q(Z){return Z==="present"?"border-present text-present":Z==="excused"?"border-excused text-excused":Z==="unexcused"?"border-unexcused text-unexcused":"border-gray-300 text-gray-600"}return m.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:m.jsxs("div",{className:`grid gap-2 p-3 min-w-full ${p?"grid-cols-6":n==="PT"?"grid-cols-4":"grid-cols-2"}`,children:[m.jsx("div",{className:"flex items-center",children:m.jsxs("button",{onClick:()=>i==null?void 0:i(r.id),className:"font-medium text-blue-600 hover:text-blue-800 text-sm text-left touch-manipulation",children:[r.lastName,", ",r.firstName]})}),p&&m.jsxs("select",{value:x||"",onChange:Z=>{const ne=Z.target.value;s(r.id,"monday",ne===""?null:ne,"PT")},"aria-label":`${r.firstName} ${r.lastName} Monday PT attendance`,className:`border-2 rounded-md px-2 py-2 text-sm font-medium touch-manipulation min-h-[44px] bg-white ${q(x)} focus:outline-none focus:ring-2 focus:ring-blue-500`,children:[m.jsx("option",{value:"",children:""}),m.jsx("option",{value:"present",children:"Present"}),m.jsx("option",{value:"excused",children:"Excused"}),m.jsx("option",{value:"unexcused",children:"Unexcused"})]}),n==="PT"&&m.jsxs(m.Fragment,{children:[m.jsxs("select",{value:w||"",onChange:Z=>{const ne=Z.target.value;s(r.id,"tuesday",ne===""?null:ne,"PT")},"aria-label":`${r.firstName} ${r.lastName} Tuesday PT attendance`,className:`border-2 rounded-md px-2 py-2 text-sm font-medium touch-manipulation min-h-[44px] bg-white ${q(w)} focus:outline-none focus:ring-2 focus:ring-blue-500`,children:[m.jsx("option",{value:"",children:""}),m.jsx("option",{value:"present",children:"Present"}),m.jsx("option",{value:"excused",children:"Excused"}),m.jsx("option",{value:"unexcused",children:"Unexcused"})]}),m.jsxs("select",{value:E||"",onChange:Z=>{const ne=Z.target.value;s(r.id,"wednesday",ne===""?null:ne,"PT")},"aria-label":`${r.firstName} ${r.lastName} Wednesday PT attendance`,className:`border-2 rounded-md px-2 py-2 text-sm font-medium touch-manipulation min-h-[44px] bg-white ${q(E)} focus:outline-none focus:ring-2 focus:ring-blue-500`,children:[m.jsx("option",{value:"",children:""}),m.jsx("option",{value:"present",children:"Present"}),m.jsx("option",{value:"excused",children:"Excused"}),m.jsx("option",{value:"unexcused",children:"Unexcused"})]})]}),m.jsxs("select",{value:(n==="PT"?N:R)||"",onChange:Z=>{const ne=Z.target.value;s(r.id,"thursday",ne===""?null:ne,n)},"aria-label":`${r.firstName} ${r.lastName} Thursday ${n} attendance`,className:`border-2 rounded-md px-2 py-2 text-sm font-medium touch-manipulation min-h-[44px] bg-white ${q(n==="PT"?N:R)} focus:outline-none focus:ring-2 focus:ring-blue-500`,children:[m.jsx("option",{value:"",children:""}),m.jsx("option",{value:"present",children:"Present"}),m.jsx("option",{value:"excused",children:"Excused"}),m.jsx("option",{value:"unexcused",children:"Unexcused"})]}),p&&m.jsxs("select",{value:P||"",onChange:Z=>{const ne=Z.target.value;s(r.id,"friday",ne===""?null:ne,"PT")},"aria-label":`${r.firstName} ${r.lastName} Friday PT attendance`,className:`border-2 rounded-md px-2 py-2 text-sm font-medium touch-manipulation min-h-[44px] bg-white ${q(P)} focus:outline-none focus:ring-2 focus:ring-blue-500`,children:[m.jsx("option",{value:"",children:""}),m.jsx("option",{value:"present",children:"Present"}),m.jsx("option",{value:"excused",children:"Excused"}),m.jsx("option",{value:"unexcused",children:"Unexcused"})]})]})})}function a7({company:r,cadets:t,records:s,mondayStats:i,tuesdayStats:n,wednesdayStats:e,thursdayStats:p,fridayStats:x,weekStats:w,weekDates:E,excusedByLevel:N,unexcusedByLevel:P,selectedDay:R,onDayChange:q,unexcusedTotals:Z,currentWeekStart:ne,onWeekChange:fe,attendanceType:G,showMondayFriday:U}){const[H,ee]=we.useState(!1),[te,ue]=we.useState("summary");return Ta(),m.jsxs("div",{className:"mt-6 space-y-4",children:[m.jsxs("button",{onClick:()=>ee(!H),className:"w-full flex items-center justify-between bg-white rounded-lg border border-gray-200 p-4 hover:bg-gray-50 touch-manipulation",children:[m.jsxs("h2",{className:"text-lg font-bold text-gray-900",children:[G," Attendance Statistics"]}),m.jsx("svg",{className:`w-5 h-5 text-gray-600 transition-transform duration-200 ${H?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),H&&m.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[m.jsxs("div",{className:"flex border-b border-gray-200",children:[m.jsx("button",{onClick:()=>ue("summary"),className:`flex-1 py-3 text-sm font-medium touch-manipulation ${te==="summary"?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-600"}`,children:"Summary"}),m.jsx("button",{onClick:()=>ue("excused"),className:`flex-1 py-3 text-sm font-medium touch-manipulation ${te==="excused"?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-600"}`,children:"Excused"}),m.jsx("button",{onClick:()=>ue("unexcused"),className:`flex-1 py-3 text-sm font-medium touch-manipulation ${te==="unexcused"?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-600"}`,children:"Unexcused"})]}),m.jsxs("div",{className:"p-4",children:[te==="summary"&&m.jsx(o7,{company:r,cadets:t,records:s,mondayStats:i,tuesdayStats:n,wednesdayStats:e,thursdayStats:p,fridayStats:x,weekStats:w,weekDates:E,unexcusedTotals:Z,currentWeekStart:ne,attendanceType:G,showMondayFriday:U,onRecordsUpdate:async()=>{}}),te==="excused"&&m.jsx(jw,{cadetsByLevel:N,status:"Excused",selectedDay:R,onDayChange:q,attendanceType:G,showMondayFriday:U}),te==="unexcused"&&m.jsx(jw,{cadetsByLevel:P,status:"Unexcused",selectedDay:R,onDayChange:q,attendanceType:G,showMondayFriday:U})]})]})]})}function i7({currentWeekStart:r,onWeekChange:t}){const s=Ta();function i(){const x=Ac(r,-1);t(x)}function n(){const x=Ac(r,1);t(x)}function e(){t(s)}const p=r===s;return m.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4 mb-4",children:m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("button",{onClick:i,className:"flex items-center justify-center w-10 h-10 rounded-lg border border-gray-300 hover:bg-gray-50 active:bg-gray-100 touch-manipulation transition-colors","aria-label":"Previous week",children:m.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),m.jsxs("div",{className:"flex-1 text-center px-4",children:[m.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["Week of ",Y0(r)]}),!p&&m.jsx("button",{onClick:e,className:"text-xs text-blue-600 hover:text-blue-700 mt-1 touch-manipulation",children:"Return to Current Week"})]}),m.jsx("button",{onClick:n,className:"flex items-center justify-center w-10 h-10 rounded-lg border border-gray-300 hover:bg-gray-50 active:bg-gray-100 touch-manipulation transition-colors","aria-label":"Next week",children:m.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})})}function o7({company:r,cadets:t,records:s,mondayStats:i,tuesdayStats:n,wednesdayStats:e,thursdayStats:p,fridayStats:x,weekStats:w,weekDates:E,unexcusedTotals:N,currentWeekStart:P,attendanceType:R,showMondayFriday:q}){const[Z,ne]=we.useState(new Map),fe=new Map(t.map(ee=>[ee.id,ee]));we.useEffect(()=>{r==="Master"&&G()},[r,P,s,R]);async function G(){try{const ee=await J2(P),te=await Promise.all([di("Alpha"),di("Bravo"),di("Charlie"),di("Ranger")]),ue=new Map;["Alpha","Bravo","Charlie","Ranger"].forEach((L,O)=>{const V=te[O],W=new Set(V.map(me=>me.id)),J={present:0,excused:0,unexcused:0},X={present:0,excused:0,unexcused:0},K={present:0,excused:0,unexcused:0};for(const[me,He]of ee.entries())W.has(me)&&(R==="PT"?(He.ptTuesday==="present"?J.present++:He.ptTuesday==="excused"?J.excused++:He.ptTuesday==="unexcused"&&J.unexcused++,He.ptWednesday==="present"?X.present++:He.ptWednesday==="excused"?X.excused++:He.ptWednesday==="unexcused"&&X.unexcused++,He.ptThursday==="present"?K.present++:He.ptThursday==="excused"?K.excused++:He.ptThursday==="unexcused"&&K.unexcused++):R==="Lab"&&(He.labThursday==="present"?K.present++:He.labThursday==="excused"?K.excused++:He.labThursday==="unexcused"&&K.unexcused++));ue.set(L,{tuesday:J,wednesday:X,thursday:K})}),ne(ue)}catch(ee){console.error("Error loading company stats:",ee)}}const U=(ee,te)=>s.filter(ue=>{if(R==="PT"){if(ee==="monday")return ue.ptMonday===te;if(ee==="tuesday")return ue.ptTuesday===te;if(ee==="wednesday")return ue.ptWednesday===te;if(ee==="thursday")return ue.ptThursday===te;if(ee==="friday")return ue.ptFriday===te}else if(R==="Lab"&&ee==="thursday")return ue.labThursday===te;return!1}).map(ue=>{const L=fe.get(ue.cadetId);if(!L)return null;const O=`${L.lastName}, ${L.firstName}`;if(te==="unexcused"){const V=N.get(ue.cadetId)||0;return{name:O,count:V}}return{name:O}}).filter(ue=>ue!==null).sort((ue,L)=>ue.name.localeCompare(L.name)),H=ee=>{const te=new Map;return s.forEach(ue=>{let L=!1;if(R==="PT"?L=ue.ptMonday===ee||ue.ptTuesday===ee||ue.ptWednesday===ee||ue.ptThursday===ee||ue.ptFriday===ee:R==="Lab"&&(L=ue.labThursday===ee),L){const O=fe.get(ue.cadetId);if(O){const V=`${O.lastName}, ${O.firstName}`;if(ee==="unexcused"){const W=N.get(ue.cadetId)||0;te.set(V,W)}else te.set(V,0)}}}),Array.from(te.entries()).map(([ue,L])=>({name:ue,count:ee==="unexcused"?L:void 0})).sort((ue,L)=>ue.name.localeCompare(L.name))};return m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"space-y-3",children:[m.jsx("h3",{className:"font-semibold text-gray-900",children:"Daily Statistics"}),q&&m.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[m.jsx("div",{className:"font-semibold text-gray-900 mb-2",children:"Monday"}),m.jsx("div",{className:"text-xs text-gray-500 mb-3",children:sa(E.monday)}),m.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-3",children:[m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"text-lg font-bold text-present",children:i.present}),m.jsx("div",{className:"text-xs text-gray-600",children:"Present"})]}),m.jsx(ta,{count:i.excused,label:"Excused",cadetNames:U("monday","excused"),colorClass:"text-excused"}),m.jsx(ta,{count:i.unexcused,label:"Unexcused",cadetNames:U("monday","unexcused"),colorClass:"text-unexcused"})]})]}),R==="PT"&&m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[m.jsx("div",{className:"font-semibold text-gray-900 mb-2",children:"Tuesday"}),m.jsx("div",{className:"text-xs text-gray-500 mb-3",children:sa(E.tuesday)}),m.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-3",children:[m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"text-lg font-bold text-present",children:n.present}),m.jsx("div",{className:"text-xs text-gray-600",children:"Present"})]}),m.jsx(ta,{count:n.excused,label:"Excused",cadetNames:U("tuesday","excused"),colorClass:"text-excused"}),m.jsx(ta,{count:n.unexcused,label:"Unexcused",cadetNames:U("tuesday","unexcused"),colorClass:"text-unexcused"})]}),r==="Master"&&Z.size>0&&m.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[m.jsx("div",{className:"text-xs font-semibold text-gray-700 mb-2",children:"By Company:"}),m.jsx("div",{className:"space-y-2",children:Array.from(Z.entries()).map(([ee,te])=>m.jsxs("div",{className:"flex justify-between text-xs",children:[m.jsxs("span",{className:"text-gray-600",children:[ee,":"]}),m.jsxs("span",{className:"text-gray-900",children:["P:",te.tuesday.present," E:",te.tuesday.excused," U:",te.tuesday.unexcused]})]},ee))})]})]}),m.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[m.jsx("div",{className:"font-semibold text-gray-900 mb-2",children:"Wednesday"}),m.jsx("div",{className:"text-xs text-gray-500 mb-3",children:sa(E.wednesday)}),m.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-3",children:[m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"text-lg font-bold text-present",children:e.present}),m.jsx("div",{className:"text-xs text-gray-600",children:"Present"})]}),m.jsx(ta,{count:e.excused,label:"Excused",cadetNames:U("wednesday","excused"),colorClass:"text-excused"}),m.jsx(ta,{count:e.unexcused,label:"Unexcused",cadetNames:U("wednesday","unexcused"),colorClass:"text-unexcused"})]}),r==="Master"&&Z.size>0&&m.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[m.jsx("div",{className:"text-xs font-semibold text-gray-700 mb-2",children:"By Company:"}),m.jsx("div",{className:"space-y-2",children:Array.from(Z.entries()).map(([ee,te])=>m.jsxs("div",{className:"flex justify-between text-xs",children:[m.jsxs("span",{className:"text-gray-600",children:[ee,":"]}),m.jsxs("span",{className:"text-gray-900",children:["P:",te.wednesday.present," E:",te.wednesday.excused," U:",te.wednesday.unexcused]})]},ee))})]})]})]}),m.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[m.jsx("div",{className:"font-semibold text-gray-900 mb-2",children:"Thursday"}),m.jsx("div",{className:"text-xs text-gray-500 mb-3",children:sa(E.thursday)}),m.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-3",children:[m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"text-lg font-bold text-present",children:p.present}),m.jsx("div",{className:"text-xs text-gray-600",children:"Present"})]}),m.jsx(ta,{count:p.excused,label:"Excused",cadetNames:U("thursday","excused"),colorClass:"text-excused"}),m.jsx(ta,{count:p.unexcused,label:"Unexcused",cadetNames:U("thursday","unexcused"),colorClass:"text-unexcused"})]}),r==="Master"&&Z.size>0&&m.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[m.jsx("div",{className:"text-xs font-semibold text-gray-700 mb-2",children:"By Company:"}),m.jsx("div",{className:"space-y-2",children:Array.from(Z.entries()).map(([ee,te])=>m.jsxs("div",{className:"flex justify-between text-xs",children:[m.jsxs("span",{className:"text-gray-600",children:[ee,":"]}),m.jsxs("span",{className:"text-gray-900",children:["P:",te.thursday.present," E:",te.thursday.excused," U:",te.thursday.unexcused]})]},ee))})]})]}),q&&m.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[m.jsx("div",{className:"font-semibold text-gray-900 mb-2",children:"Friday"}),m.jsx("div",{className:"text-xs text-gray-500 mb-3",children:sa(E.friday)}),m.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-3",children:[m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"text-lg font-bold text-present",children:x.present}),m.jsx("div",{className:"text-xs text-gray-600",children:"Present"})]}),m.jsx(ta,{count:x.excused,label:"Excused",cadetNames:U("friday","excused"),colorClass:"text-excused"}),m.jsx(ta,{count:x.unexcused,label:"Unexcused",cadetNames:U("friday","unexcused"),colorClass:"text-unexcused"})]})]})]}),m.jsxs("div",{className:"mt-6",children:[m.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Weekly Totals"}),m.jsx("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:m.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[m.jsxs("div",{children:[m.jsx("div",{className:"text-2xl font-bold text-present",children:w.present}),m.jsx("div",{className:"text-sm text-gray-600",children:"Present"})]}),m.jsx(ta,{count:w.excused,label:"Excused",cadetNames:H("excused"),colorClass:"text-excused",size:"large"}),m.jsx(ta,{count:w.unexcused,label:"Unexcused",cadetNames:H("unexcused"),colorClass:"text-unexcused",size:"large"})]})})]})]})}function ta({count:r,label:t,cadetNames:s,colorClass:i,size:n="normal"}){const[e,p]=we.useState(!1),x=we.useRef(null);return we.useEffect(()=>{function w(E){x.current&&!x.current.contains(E.target)&&p(!1)}if(e){const E=setTimeout(()=>{document.addEventListener("mousedown",w),document.addEventListener("touchstart",w)},100);return()=>{clearTimeout(E),document.removeEventListener("mousedown",w),document.removeEventListener("touchstart",w)}}},[e]),r===0?m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:n==="large"?"text-2xl font-bold text-gray-400":`text-lg font-bold ${i}`,children:r}),m.jsx("div",{className:n==="large"?"text-sm text-gray-600":"text-xs text-gray-600",children:t})]}):m.jsxs("div",{className:"text-center relative",ref:x,children:[m.jsx("div",{className:`${n==="large"?"text-2xl":"text-lg"} font-bold ${i} cursor-pointer touch-manipulation`,onClick:()=>p(!e),children:r}),m.jsx("div",{className:n==="large"?"text-sm text-gray-600":"text-xs text-gray-600",children:t}),e&&s.length>0&&m.jsxs("div",{className:"absolute z-50 bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-56 bg-white text-gray-900 text-xs rounded-lg shadow-lg border border-gray-300 p-3 max-h-64 overflow-y-auto",children:[m.jsxs("div",{className:"font-semibold mb-2 text-gray-900",children:[t," Cadets:"]}),m.jsx("div",{className:"space-y-1",children:s.map((w,E)=>m.jsxs("div",{className:"text-gray-700",children:[w.name,w.count!==void 0?` (${w.count})`:""]},E))}),m.jsx("div",{className:"absolute bottom-0 left-1/2 transform -translate-x-1/2 translate-y-full w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-white"})]})]})}function jw({cadetsByLevel:r,status:t,selectedDay:s,onDayChange:i,attendanceType:n,showMondayFriday:e=!1}){const p=Array.from(r.keys()).sort(),x=Array.from(r.values()).reduce((w,E)=>w+E.length,0);return m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"View by Day/Week"}),m.jsxs("div",{className:`grid gap-2 ${e?"grid-cols-6":n==="PT"?"grid-cols-4":"grid-cols-2"}`,children:[m.jsx("button",{onClick:()=>i("week"),className:`py-2 px-3 rounded-md text-sm font-medium touch-manipulation ${s==="week"?"bg-blue-600 text-white":"bg-white text-gray-700 border border-gray-300"}`,children:"Week"}),e&&m.jsx("button",{onClick:()=>i("monday"),className:`py-2 px-3 rounded-md text-sm font-medium touch-manipulation ${s==="monday"?"bg-blue-600 text-white":"bg-white text-gray-700 border border-gray-300"}`,children:"Mon"}),n==="PT"&&m.jsxs(m.Fragment,{children:[m.jsx("button",{onClick:()=>i("tuesday"),className:`py-2 px-3 rounded-md text-sm font-medium touch-manipulation ${s==="tuesday"?"bg-blue-600 text-white":"bg-white text-gray-700 border border-gray-300"}`,children:"Tue"}),m.jsx("button",{onClick:()=>i("wednesday"),className:`py-2 px-3 rounded-md text-sm font-medium touch-manipulation ${s==="wednesday"?"bg-blue-600 text-white":"bg-white text-gray-700 border border-gray-300"}`,children:"Wed"})]}),m.jsx("button",{onClick:()=>i("thursday"),className:`py-2 px-3 rounded-md text-sm font-medium touch-manipulation ${s==="thursday"?"bg-blue-600 text-white":"bg-white text-gray-700 border border-gray-300"}`,children:"Thu"}),e&&m.jsx("button",{onClick:()=>i("friday"),className:`py-2 px-3 rounded-md text-sm font-medium touch-manipulation ${s==="friday"?"bg-blue-600 text-white":"bg-white text-gray-700 border border-gray-300"}`,children:"Fri"})]})]}),m.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[m.jsx("div",{className:"text-2xl font-bold text-gray-900",children:x}),m.jsxs("div",{className:"text-sm text-gray-600",children:["Total ",t]})]}),p.length===0?m.jsxs("div",{className:"text-center py-8 text-gray-500",children:["No ",t.toLowerCase()," cadets found"]}):p.map(w=>{const E=r.get(w);return m.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[m.jsxs("div",{className:"font-semibold text-gray-900 mb-2",children:[w," (",E.length,")"]}),m.jsx("div",{className:"space-y-1",children:E.map(N=>m.jsx("div",{className:"text-sm text-gray-700 py-1",children:N.name},N.id))})]},w)})]})}function Cu({date:r,day:t,attendanceType:s,company:i,onContextMenu:n}){const e=i!=="Master",p=x=>{e&&(x.preventDefault(),n(x,t))};return m.jsx("div",{className:`font-semibold text-gray-700 text-sm ${e?"cursor-pointer hover:bg-gray-50 rounded px-2 py-1 touch-manipulation":""}`,onContextMenu:e?x=>{x.preventDefault(),n(x,t)}:void 0,onClick:e?p:void 0,children:sa(r)})}function l7({x:r,y:t,onClose:s,onMarkAllPresent:i,onMarkAllExcused:n,onMarkAllUnexcused:e,onClearAll:p}){const x=we.useRef(null);we.useEffect(()=>{function N(R){x.current&&!x.current.contains(R.target)&&s()}const P=setTimeout(()=>{document.addEventListener("mousedown",N),document.addEventListener("touchstart",N)},100);return()=>{clearTimeout(P),document.removeEventListener("mousedown",N),document.removeEventListener("touchstart",N)}},[s]);const w=Math.min(r,window.innerWidth-200),E=Math.min(t,window.innerHeight-200);return m.jsxs("div",{ref:x,className:"fixed z-50 bg-white rounded-lg shadow-lg border border-gray-200 py-2 min-w-[180px]",style:{left:`${w}px`,top:`${E}px`},children:[m.jsx("button",{onClick:()=>{i(),s()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 touch-manipulation",children:"Mark All Present"}),m.jsx("button",{onClick:()=>{n(),s()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 touch-manipulation",children:"Mark All Excused"}),m.jsx("button",{onClick:()=>{e(),s()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 touch-manipulation",children:"Mark All Unexcused"}),m.jsx("div",{className:"border-t border-gray-200 my-1"}),m.jsx("button",{onClick:()=>{p(),s()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 touch-manipulation",children:"Clear All"})]})}const ug="pushSubscriptions",B1="BAbKf71jkqDJ3-30AGiKo3pzbDkPWQPYgPRqJTTrIPOPbtRid8HXr9cKBDmb-bP6IetkHsNEujfsKxEFsjcNvbE";let Sf=null;if(typeof window<"u"&&"serviceWorker"in navigator)try{Sf=o6(Ef)}catch(r){console.warn("Firebase Messaging initialization failed:",r)}async function Z2(){if(!("Notification"in window))throw new Error("This browser does not support notifications");if(Notification.permission==="granted")return await Mw();if(await Notification.requestPermission()!=="granted")throw new Error("Notification permission denied");return await Mw()}async function Mw(){if(!Sf)throw new Error("Firebase Messaging is not available");try{const r="/bulldog-co-manager";let t;const i=(await navigator.serviceWorker.getRegistrations()).find(e=>{var p,x;return e.scope.includes(r)&&((x=(p=e.active)==null?void 0:p.scriptURL)==null?void 0:x.includes("firebase-messaging-sw"))});i?(t=i,await t.update()):(t=await navigator.serviceWorker.register(`${r}/firebase-messaging-sw.js`,{scope:`${r}/`}),await navigator.serviceWorker.ready);let n=null;if(!B1||B1.trim().length===0)throw new Error("VAPID key not configured. Please generate a key pair in Firebase Console > Project Settings > Cloud Messaging > Web Push certificates and update VAPID_KEY in notificationService.ts");try{n=await z9(Sf,{serviceWorkerRegistration:t,vapidKey:B1})}catch(e){throw console.error("Error getting FCM token:",e),new Error(`Failed to get FCM token: ${e instanceof Error?e.message:"Unknown error"}. Please ensure your VAPID key is correct.`)}return n?(await c7(n),n):null}catch(r){throw console.error("Error getting FCM token:",r),r}}async function c7(r){try{const t=ua(Cn(sr,ug),Ya("token","==",r));(await us(t)).empty&&await G0(Cn(sr,ug),{token:r,createdAt:new Date().toISOString(),userAgent:navigator.userAgent})}catch(t){throw console.error("Error saving subscription:",t),t}}async function u7(){try{return(await us(Cn(sr,ug))).docs.map(t=>({id:t.id,token:t.data().token}))}catch(r){throw console.error("Error getting subscriptions:",r),r}}async function f7(r){try{const t=await u7();if(await G0(Cn(sr,"notificationRequests"),{message:r,subscriptionsCount:t.length,createdAt:new Date().toISOString(),status:"pending"}),"serviceWorker"in navigator&&"Notification"in window&&Notification.permission==="granted")try{await(await navigator.serviceWorker.ready).showNotification("Bulldog CO Manager",{body:r,icon:"/web-app-manifest-192x192.png",badge:"/web-app-manifest-192x192.png",tag:"bulldog-notification",requireInteraction:!1})}catch(s){console.warn("Could not show notification via service worker:",s),Notification.permission==="granted"&&new Notification("Bulldog CO Manager",{body:r,icon:"/web-app-manifest-192x192.png",tag:"bulldog-notification"})}t.length===0&&console.warn("No active subscriptions found. Notification request saved, but no users will receive it until they enable notifications.")}catch(t){throw console.error("Error sending notification:",t),t}}function h7(){return new Promise(r=>{if(!Sf){r(null);return}H9(Sf,t=>{r(t)})})}function ey(){return"Notification"in window&&"serviceWorker"in navigator&&"PushManager"in window}function ty(){return"Notification"in window?Notification.permission:"denied"}const d7=["cadets","attendance","ptPlans","trainingEvents","pushSubscriptions","notificationRequests"];async function p7(){const r={version:"1.0",timestamp:new Date().toISOString(),collections:{}};for(const t of d7)try{const n=(await us(Cn(sr,t))).docs.map(e=>({id:e.id,...e.data()})).map(e=>{const p={id:e.id};for(const[x,w]of Object.entries(e))x!=="id"&&(w&&typeof w=="object"&&"toDate"in w?p[x]=w.toDate().toISOString():w&&typeof w=="object"&&w.constructor===Object?p[x]=fg(w):p[x]=w);return p});r.collections[t]=n}catch(s){console.error(`Error exporting collection ${t}:`,s)}return r}function fg(r){if(r&&typeof r=="object"){if("toDate"in r)return r.toDate().toISOString();if(Array.isArray(r))return r.map(t=>fg(t));{const t={};for(const[s,i]of Object.entries(r))t[s]=fg(i);return t}}return r}function m7(r,t){const s=JSON.stringify(r,null,2),i=new Blob([s],{type:"application/json"}),n=URL.createObjectURL(i),e=document.createElement("a");e.href=n,e.download=t||`backup_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(e),e.click(),document.body.removeChild(e),URL.revokeObjectURL(n)}async function g7(r,t=!1){if(!r.collections)throw new Error("Invalid backup file: missing collections");const s=og(sr);let i=0;const n=500;for(const[e,p]of Object.entries(r.collections))if(!(!p||!Array.isArray(p))){if(t)try{const x=await us(Cn(sr,e)),w=og(sr);let E=0;x.docs.forEach(N=>{E<n&&(w.delete(N.ref),E++)}),E>0&&await w.commit()}catch(x){console.error(`Error deleting existing documents from ${e}:`,x)}for(const x of p){if(!x.id){console.warn(`Skipping document in ${e} without id:`,x);continue}const w=xs(sr,e,x.id),{id:E,...N}=x,P=kd(N);s.set(w,P),i++,i>=n&&(await s.commit(),i=0)}}i>0&&await s.commit()}function kd(r){if(r&&typeof r=="object"&&!Array.isArray(r)){const t={};for(const[s,i]of Object.entries(r))if(typeof i=="string"&&/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/.test(i))try{const n=new Date(i);isNaN(n.getTime())?t[s]=i:t[s]=An.fromDate(n)}catch{t[s]=i}else Array.isArray(i)?t[s]=i.map(n=>kd(n)):i&&typeof i=="object"?t[s]=kd(i):t[s]=i;return t}else if(Array.isArray(r))return r.map(t=>kd(t));return r}function y7(r){return new Promise((t,s)=>{const i=new FileReader;i.onload=n=>{var e;try{const p=(e=n.target)==null?void 0:e.result,x=JSON.parse(p);if(!x.timestamp||!x.collections){s(new Error("Invalid backup file format"));return}t(x)}catch(p){s(new Error(`Failed to parse backup file: ${p instanceof Error?p.message:"Unknown error"}`))}},i.onerror=()=>{s(new Error("Failed to read backup file"))},i.readAsText(r)})}function Fd(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var hg={exports:{}},$1={exports:{}};/*! cpexcel.js (C) 2013-present SheetJS -- http://sheetjs.com */var Lw;function v7(){return Lw||(Lw=1,function(r){var t={version:"1.15.0"};t[437]=function(){for(var s=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],n={},e=0;e!=s.length;++e)s.charCodeAt(e)!==65533&&(n[s.charAt(e)]=e),i[e]=s.charAt(e);return{enc:n,dec:i}}(),t[620]=function(){for(var s=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],n={},e=0;e!=s.length;++e)s.charCodeAt(e)!==65533&&(n[s.charAt(e)]=e),i[e]=s.charAt(e);return{enc:n,dec:i}}(),t[737]=function(){for(var s=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],n={},e=0;e!=s.length;++e)s.charCodeAt(e)!==65533&&(n[s.charAt(e)]=e),i[e]=s.charAt(e);return{enc:n,dec:i}}(),t[850]=function(){for(var s=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],n={},e=0;e!=s.length;++e)s.charCodeAt(e)!==65533&&(n[s.charAt(e)]=e),i[e]=s.charAt(e);return{enc:n,dec:i}}(),t[852]=function(){for(var s=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],n={},e=0;e!=s.length;++e)s.charCodeAt(e)!==65533&&(n[s.charAt(e)]=e),i[e]=s.charAt(e);return{enc:n,dec:i}}(),t[857]=function(){for(var s=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],n={},e=0;e!=s.length;++e)s.charCodeAt(e)!==65533&&(n[s.charAt(e)]=e),i[e]=s.charAt(e);return{enc:n,dec:i}}(),t[861]=function(){for(var s=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],n={},e=0;e!=s.length;++e)s.charCodeAt(e)!==65533&&(n[s.charAt(e)]=e),i[e]=s.charAt(e);return{enc:n,dec:i}}(),t[865]=function(){for(var s=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],n={},e=0;e!=s.length;++e)s.charCodeAt(e)!==65533&&(n[s.charAt(e)]=e),i[e]=s.charAt(e);return{enc:n,dec:i}}(),t[866]=function(){for(var s=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],n={},e=0;e!=s.length;++e)s.charCodeAt(e)!==65533&&(n[s.charAt(e)]=e),i[e]=s.charAt(e);return{enc:n,dec:i}}(),t[874]=function(){for(var s=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],n={},e=0;e!=s.length;++e)s.charCodeAt(e)!==65533&&(n[s.charAt(e)]=e),i[e]=s.charAt(e);return{enc:n,dec:i}}(),t[895]=function(){for(var s=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],n={},e=0;e!=s.length;++e)s.charCodeAt(e)!==65533&&(n[s.charAt(e)]=e),i[e]=s.charAt(e);return{enc:n,dec:i}}(),t[932]=function(){var s=[],i={},n=[],e;for(n[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),e=0;e!=n[0].length;++e)n[0][e].charCodeAt(0)!==65533&&(i[n[0][e]]=0+e,s[0+e]=n[0][e]);for(n[129]="".split(""),e=0;e!=n[129].length;++e)n[129][e].charCodeAt(0)!==65533&&(i[n[129][e]]=33024+e,s[33024+e]=n[129][e]);for(n[130]="".split(""),e=0;e!=n[130].length;++e)n[130][e].charCodeAt(0)!==65533&&(i[n[130][e]]=33280+e,s[33280+e]=n[130][e]);for(n[131]="".split(""),e=0;e!=n[131].length;++e)n[131][e].charCodeAt(0)!==65533&&(i[n[131][e]]=33536+e,s[33536+e]=n[131][e]);for(n[132]="".split(""),e=0;e!=n[132].length;++e)n[132][e].charCodeAt(0)!==65533&&(i[n[132][e]]=33792+e,s[33792+e]=n[132][e]);for(n[135]="".split(""),e=0;e!=n[135].length;++e)n[135][e].charCodeAt(0)!==65533&&(i[n[135][e]]=34560+e,s[34560+e]=n[135][e]);for(n[136]="".split(""),e=0;e!=n[136].length;++e)n[136][e].charCodeAt(0)!==65533&&(i[n[136][e]]=34816+e,s[34816+e]=n[136][e]);for(n[137]="".split(""),e=0;e!=n[137].length;++e)n[137][e].charCodeAt(0)!==65533&&(i[n[137][e]]=35072+e,s[35072+e]=n[137][e]);for(n[138]="".split(""),e=0;e!=n[138].length;++e)n[138][e].charCodeAt(0)!==65533&&(i[n[138][e]]=35328+e,s[35328+e]=n[138][e]);for(n[139]="".split(""),e=0;e!=n[139].length;++e)n[139][e].charCodeAt(0)!==65533&&(i[n[139][e]]=35584+e,s[35584+e]=n[139][e]);for(n[140]="".split(""),e=0;e!=n[140].length;++e)n[140][e].charCodeAt(0)!==65533&&(i[n[140][e]]=35840+e,s[35840+e]=n[140][e]);for(n[141]="".split(""),e=0;e!=n[141].length;++e)n[141][e].charCodeAt(0)!==65533&&(i[n[141][e]]=36096+e,s[36096+e]=n[141][e]);for(n[142]="".split(""),e=0;e!=n[142].length;++e)n[142][e].charCodeAt(0)!==65533&&(i[n[142][e]]=36352+e,s[36352+e]=n[142][e]);for(n[143]="".split(""),e=0;e!=n[143].length;++e)n[143][e].charCodeAt(0)!==65533&&(i[n[143][e]]=36608+e,s[36608+e]=n[143][e]);for(n[144]="".split(""),e=0;e!=n[144].length;++e)n[144][e].charCodeAt(0)!==65533&&(i[n[144][e]]=36864+e,s[36864+e]=n[144][e]);for(n[145]="".split(""),e=0;e!=n[145].length;++e)n[145][e].charCodeAt(0)!==65533&&(i[n[145][e]]=37120+e,s[37120+e]=n[145][e]);for(n[146]="".split(""),e=0;e!=n[146].length;++e)n[146][e].charCodeAt(0)!==65533&&(i[n[146][e]]=37376+e,s[37376+e]=n[146][e]);for(n[147]="".split(""),e=0;e!=n[147].length;++e)n[147][e].charCodeAt(0)!==65533&&(i[n[147][e]]=37632+e,s[37632+e]=n[147][e]);for(n[148]="".split(""),e=0;e!=n[148].length;++e)n[148][e].charCodeAt(0)!==65533&&(i[n[148][e]]=37888+e,s[37888+e]=n[148][e]);for(n[149]="".split(""),e=0;e!=n[149].length;++e)n[149][e].charCodeAt(0)!==65533&&(i[n[149][e]]=38144+e,s[38144+e]=n[149][e]);for(n[150]="".split(""),e=0;e!=n[150].length;++e)n[150][e].charCodeAt(0)!==65533&&(i[n[150][e]]=38400+e,s[38400+e]=n[150][e]);for(n[151]="".split(""),e=0;e!=n[151].length;++e)n[151][e].charCodeAt(0)!==65533&&(i[n[151][e]]=38656+e,s[38656+e]=n[151][e]);for(n[152]="".split(""),e=0;e!=n[152].length;++e)n[152][e].charCodeAt(0)!==65533&&(i[n[152][e]]=38912+e,s[38912+e]=n[152][e]);for(n[153]="".split(""),e=0;e!=n[153].length;++e)n[153][e].charCodeAt(0)!==65533&&(i[n[153][e]]=39168+e,s[39168+e]=n[153][e]);for(n[154]="".split(""),e=0;e!=n[154].length;++e)n[154][e].charCodeAt(0)!==65533&&(i[n[154][e]]=39424+e,s[39424+e]=n[154][e]);for(n[155]="".split(""),e=0;e!=n[155].length;++e)n[155][e].charCodeAt(0)!==65533&&(i[n[155][e]]=39680+e,s[39680+e]=n[155][e]);for(n[156]="".split(""),e=0;e!=n[156].length;++e)n[156][e].charCodeAt(0)!==65533&&(i[n[156][e]]=39936+e,s[39936+e]=n[156][e]);for(n[157]="".split(""),e=0;e!=n[157].length;++e)n[157][e].charCodeAt(0)!==65533&&(i[n[157][e]]=40192+e,s[40192+e]=n[157][e]);for(n[158]="".split(""),e=0;e!=n[158].length;++e)n[158][e].charCodeAt(0)!==65533&&(i[n[158][e]]=40448+e,s[40448+e]=n[158][e]);for(n[159]="".split(""),e=0;e!=n[159].length;++e)n[159][e].charCodeAt(0)!==65533&&(i[n[159][e]]=40704+e,s[40704+e]=n[159][e]);for(n[224]="".split(""),e=0;e!=n[224].length;++e)n[224][e].charCodeAt(0)!==65533&&(i[n[224][e]]=57344+e,s[57344+e]=n[224][e]);for(n[225]="".split(""),e=0;e!=n[225].length;++e)n[225][e].charCodeAt(0)!==65533&&(i[n[225][e]]=57600+e,s[57600+e]=n[225][e]);for(n[226]="".split(""),e=0;e!=n[226].length;++e)n[226][e].charCodeAt(0)!==65533&&(i[n[226][e]]=57856+e,s[57856+e]=n[226][e]);for(n[227]="".split(""),e=0;e!=n[227].length;++e)n[227][e].charCodeAt(0)!==65533&&(i[n[227][e]]=58112+e,s[58112+e]=n[227][e]);for(n[228]="".split(""),e=0;e!=n[228].length;++e)n[228][e].charCodeAt(0)!==65533&&(i[n[228][e]]=58368+e,s[58368+e]=n[228][e]);for(n[229]="".split(""),e=0;e!=n[229].length;++e)n[229][e].charCodeAt(0)!==65533&&(i[n[229][e]]=58624+e,s[58624+e]=n[229][e]);for(n[230]="".split(""),e=0;e!=n[230].length;++e)n[230][e].charCodeAt(0)!==65533&&(i[n[230][e]]=58880+e,s[58880+e]=n[230][e]);for(n[231]="".split(""),e=0;e!=n[231].length;++e)n[231][e].charCodeAt(0)!==65533&&(i[n[231][e]]=59136+e,s[59136+e]=n[231][e]);for(n[232]="".split(""),e=0;e!=n[232].length;++e)n[232][e].charCodeAt(0)!==65533&&(i[n[232][e]]=59392+e,s[59392+e]=n[232][e]);for(n[233]="".split(""),e=0;e!=n[233].length;++e)n[233][e].charCodeAt(0)!==65533&&(i[n[233][e]]=59648+e,s[59648+e]=n[233][e]);for(n[234]="".split(""),e=0;e!=n[234].length;++e)n[234][e].charCodeAt(0)!==65533&&(i[n[234][e]]=59904+e,s[59904+e]=n[234][e]);for(n[237]="".split(""),e=0;e!=n[237].length;++e)n[237][e].charCodeAt(0)!==65533&&(i[n[237][e]]=60672+e,s[60672+e]=n[237][e]);for(n[238]="".split(""),e=0;e!=n[238].length;++e)n[238][e].charCodeAt(0)!==65533&&(i[n[238][e]]=60928+e,s[60928+e]=n[238][e]);for(n[250]="".split(""),e=0;e!=n[250].length;++e)n[250][e].charCodeAt(0)!==65533&&(i[n[250][e]]=64e3+e,s[64e3+e]=n[250][e]);for(n[251]="".split(""),e=0;e!=n[251].length;++e)n[251][e].charCodeAt(0)!==65533&&(i[n[251][e]]=64256+e,s[64256+e]=n[251][e]);for(n[252]="".split(""),e=0;e!=n[252].length;++e)n[252][e].charCodeAt(0)!==65533&&(i[n[252][e]]=64512+e,s[64512+e]=n[252][e]);return{enc:i,dec:s}}(),t[936]=function(){var s=[],i={},n=[],e;for(n[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),e=0;e!=n[0].length;++e)n[0][e].charCodeAt(0)!==65533&&(i[n[0][e]]=0+e,s[0+e]=n[0][e]);for(n[129]="".split(""),e=0;e!=n[129].length;++e)n[129][e].charCodeAt(0)!==65533&&(i[n[129][e]]=33024+e,s[33024+e]=n[129][e]);for(n[130]="".split(""),e=0;e!=n[130].length;++e)n[130][e].charCodeAt(0)!==65533&&(i[n[130][e]]=33280+e,s[33280+e]=n[130][e]);for(n[131]="".split(""),e=0;e!=n[131].length;++e)n[131][e].charCodeAt(0)!==65533&&(i[n[131][e]]=33536+e,s[33536+e]=n[131][e]);for(n[132]="".split(""),e=0;e!=n[132].length;++e)n[132][e].charCodeAt(0)!==65533&&(i[n[132][e]]=33792+e,s[33792+e]=n[132][e]);for(n[133]="".split(""),e=0;e!=n[133].length;++e)n[133][e].charCodeAt(0)!==65533&&(i[n[133][e]]=34048+e,s[34048+e]=n[133][e]);for(n[134]="".split(""),e=0;e!=n[134].length;++e)n[134][e].charCodeAt(0)!==65533&&(i[n[134][e]]=34304+e,s[34304+e]=n[134][e]);for(n[135]="".split(""),e=0;e!=n[135].length;++e)n[135][e].charCodeAt(0)!==65533&&(i[n[135][e]]=34560+e,s[34560+e]=n[135][e]);for(n[136]="".split(""),e=0;e!=n[136].length;++e)n[136][e].charCodeAt(0)!==65533&&(i[n[136][e]]=34816+e,s[34816+e]=n[136][e]);for(n[137]="".split(""),e=0;e!=n[137].length;++e)n[137][e].charCodeAt(0)!==65533&&(i[n[137][e]]=35072+e,s[35072+e]=n[137][e]);for(n[138]="".split(""),e=0;e!=n[138].length;++e)n[138][e].charCodeAt(0)!==65533&&(i[n[138][e]]=35328+e,s[35328+e]=n[138][e]);for(n[139]="".split(""),e=0;e!=n[139].length;++e)n[139][e].charCodeAt(0)!==65533&&(i[n[139][e]]=35584+e,s[35584+e]=n[139][e]);for(n[140]="".split(""),e=0;e!=n[140].length;++e)n[140][e].charCodeAt(0)!==65533&&(i[n[140][e]]=35840+e,s[35840+e]=n[140][e]);for(n[141]="".split(""),e=0;e!=n[141].length;++e)n[141][e].charCodeAt(0)!==65533&&(i[n[141][e]]=36096+e,s[36096+e]=n[141][e]);for(n[142]="".split(""),e=0;e!=n[142].length;++e)n[142][e].charCodeAt(0)!==65533&&(i[n[142][e]]=36352+e,s[36352+e]=n[142][e]);for(n[143]="".split(""),e=0;e!=n[143].length;++e)n[143][e].charCodeAt(0)!==65533&&(i[n[143][e]]=36608+e,s[36608+e]=n[143][e]);for(n[144]="".split(""),e=0;e!=n[144].length;++e)n[144][e].charCodeAt(0)!==65533&&(i[n[144][e]]=36864+e,s[36864+e]=n[144][e]);for(n[145]="".split(""),e=0;e!=n[145].length;++e)n[145][e].charCodeAt(0)!==65533&&(i[n[145][e]]=37120+e,s[37120+e]=n[145][e]);for(n[146]="".split(""),e=0;e!=n[146].length;++e)n[146][e].charCodeAt(0)!==65533&&(i[n[146][e]]=37376+e,s[37376+e]=n[146][e]);for(n[147]="".split(""),e=0;e!=n[147].length;++e)n[147][e].charCodeAt(0)!==65533&&(i[n[147][e]]=37632+e,s[37632+e]=n[147][e]);for(n[148]="".split(""),e=0;e!=n[148].length;++e)n[148][e].charCodeAt(0)!==65533&&(i[n[148][e]]=37888+e,s[37888+e]=n[148][e]);for(n[149]="".split(""),e=0;e!=n[149].length;++e)n[149][e].charCodeAt(0)!==65533&&(i[n[149][e]]=38144+e,s[38144+e]=n[149][e]);for(n[150]="".split(""),e=0;e!=n[150].length;++e)n[150][e].charCodeAt(0)!==65533&&(i[n[150][e]]=38400+e,s[38400+e]=n[150][e]);for(n[151]="".split(""),e=0;e!=n[151].length;++e)n[151][e].charCodeAt(0)!==65533&&(i[n[151][e]]=38656+e,s[38656+e]=n[151][e]);for(n[152]="".split(""),e=0;e!=n[152].length;++e)n[152][e].charCodeAt(0)!==65533&&(i[n[152][e]]=38912+e,s[38912+e]=n[152][e]);for(n[153]="".split(""),e=0;e!=n[153].length;++e)n[153][e].charCodeAt(0)!==65533&&(i[n[153][e]]=39168+e,s[39168+e]=n[153][e]);for(n[154]="".split(""),e=0;e!=n[154].length;++e)n[154][e].charCodeAt(0)!==65533&&(i[n[154][e]]=39424+e,s[39424+e]=n[154][e]);for(n[155]="".split(""),e=0;e!=n[155].length;++e)n[155][e].charCodeAt(0)!==65533&&(i[n[155][e]]=39680+e,s[39680+e]=n[155][e]);for(n[156]="".split(""),e=0;e!=n[156].length;++e)n[156][e].charCodeAt(0)!==65533&&(i[n[156][e]]=39936+e,s[39936+e]=n[156][e]);for(n[157]="".split(""),e=0;e!=n[157].length;++e)n[157][e].charCodeAt(0)!==65533&&(i[n[157][e]]=40192+e,s[40192+e]=n[157][e]);for(n[158]="".split(""),e=0;e!=n[158].length;++e)n[158][e].charCodeAt(0)!==65533&&(i[n[158][e]]=40448+e,s[40448+e]=n[158][e]);for(n[159]="".split(""),e=0;e!=n[159].length;++e)n[159][e].charCodeAt(0)!==65533&&(i[n[159][e]]=40704+e,s[40704+e]=n[159][e]);for(n[160]="".split(""),e=0;e!=n[160].length;++e)n[160][e].charCodeAt(0)!==65533&&(i[n[160][e]]=40960+e,s[40960+e]=n[160][e]);for(n[161]="".split(""),e=0;e!=n[161].length;++e)n[161][e].charCodeAt(0)!==65533&&(i[n[161][e]]=41216+e,s[41216+e]=n[161][e]);for(n[162]="".split(""),e=0;e!=n[162].length;++e)n[162][e].charCodeAt(0)!==65533&&(i[n[162][e]]=41472+e,s[41472+e]=n[162][e]);for(n[163]="".split(""),e=0;e!=n[163].length;++e)n[163][e].charCodeAt(0)!==65533&&(i[n[163][e]]=41728+e,s[41728+e]=n[163][e]);for(n[164]="".split(""),e=0;e!=n[164].length;++e)n[164][e].charCodeAt(0)!==65533&&(i[n[164][e]]=41984+e,s[41984+e]=n[164][e]);for(n[165]="".split(""),e=0;e!=n[165].length;++e)n[165][e].charCodeAt(0)!==65533&&(i[n[165][e]]=42240+e,s[42240+e]=n[165][e]);for(n[166]="".split(""),e=0;e!=n[166].length;++e)n[166][e].charCodeAt(0)!==65533&&(i[n[166][e]]=42496+e,s[42496+e]=n[166][e]);for(n[167]="".split(""),e=0;e!=n[167].length;++e)n[167][e].charCodeAt(0)!==65533&&(i[n[167][e]]=42752+e,s[42752+e]=n[167][e]);for(n[168]="".split(""),e=0;e!=n[168].length;++e)n[168][e].charCodeAt(0)!==65533&&(i[n[168][e]]=43008+e,s[43008+e]=n[168][e]);for(n[169]="".split(""),e=0;e!=n[169].length;++e)n[169][e].charCodeAt(0)!==65533&&(i[n[169][e]]=43264+e,s[43264+e]=n[169][e]);for(n[170]="".split(""),e=0;e!=n[170].length;++e)n[170][e].charCodeAt(0)!==65533&&(i[n[170][e]]=43520+e,s[43520+e]=n[170][e]);for(n[171]="".split(""),e=0;e!=n[171].length;++e)n[171][e].charCodeAt(0)!==65533&&(i[n[171][e]]=43776+e,s[43776+e]=n[171][e]);for(n[172]="".split(""),e=0;e!=n[172].length;++e)n[172][e].charCodeAt(0)!==65533&&(i[n[172][e]]=44032+e,s[44032+e]=n[172][e]);for(n[173]="".split(""),e=0;e!=n[173].length;++e)n[173][e].charCodeAt(0)!==65533&&(i[n[173][e]]=44288+e,s[44288+e]=n[173][e]);for(n[174]="".split(""),e=0;e!=n[174].length;++e)n[174][e].charCodeAt(0)!==65533&&(i[n[174][e]]=44544+e,s[44544+e]=n[174][e]);for(n[175]="".split(""),e=0;e!=n[175].length;++e)n[175][e].charCodeAt(0)!==65533&&(i[n[175][e]]=44800+e,s[44800+e]=n[175][e]);for(n[176]="".split(""),e=0;e!=n[176].length;++e)n[176][e].charCodeAt(0)!==65533&&(i[n[176][e]]=45056+e,s[45056+e]=n[176][e]);for(n[177]="".split(""),e=0;e!=n[177].length;++e)n[177][e].charCodeAt(0)!==65533&&(i[n[177][e]]=45312+e,s[45312+e]=n[177][e]);for(n[178]="".split(""),e=0;e!=n[178].length;++e)n[178][e].charCodeAt(0)!==65533&&(i[n[178][e]]=45568+e,s[45568+e]=n[178][e]);for(n[179]="".split(""),e=0;e!=n[179].length;++e)n[179][e].charCodeAt(0)!==65533&&(i[n[179][e]]=45824+e,s[45824+e]=n[179][e]);for(n[180]="".split(""),e=0;e!=n[180].length;++e)n[180][e].charCodeAt(0)!==65533&&(i[n[180][e]]=46080+e,s[46080+e]=n[180][e]);for(n[181]="".split(""),e=0;e!=n[181].length;++e)n[181][e].charCodeAt(0)!==65533&&(i[n[181][e]]=46336+e,s[46336+e]=n[181][e]);for(n[182]="".split(""),e=0;e!=n[182].length;++e)n[182][e].charCodeAt(0)!==65533&&(i[n[182][e]]=46592+e,s[46592+e]=n[182][e]);for(n[183]="".split(""),e=0;e!=n[183].length;++e)n[183][e].charCodeAt(0)!==65533&&(i[n[183][e]]=46848+e,s[46848+e]=n[183][e]);for(n[184]="".split(""),e=0;e!=n[184].length;++e)n[184][e].charCodeAt(0)!==65533&&(i[n[184][e]]=47104+e,s[47104+e]=n[184][e]);for(n[185]="".split(""),e=0;e!=n[185].length;++e)n[185][e].charCodeAt(0)!==65533&&(i[n[185][e]]=47360+e,s[47360+e]=n[185][e]);for(n[186]="".split(""),e=0;e!=n[186].length;++e)n[186][e].charCodeAt(0)!==65533&&(i[n[186][e]]=47616+e,s[47616+e]=n[186][e]);for(n[187]="".split(""),e=0;e!=n[187].length;++e)n[187][e].charCodeAt(0)!==65533&&(i[n[187][e]]=47872+e,s[47872+e]=n[187][e]);for(n[188]="".split(""),e=0;e!=n[188].length;++e)n[188][e].charCodeAt(0)!==65533&&(i[n[188][e]]=48128+e,s[48128+e]=n[188][e]);for(n[189]="".split(""),e=0;e!=n[189].length;++e)n[189][e].charCodeAt(0)!==65533&&(i[n[189][e]]=48384+e,s[48384+e]=n[189][e]);for(n[190]="".split(""),e=0;e!=n[190].length;++e)n[190][e].charCodeAt(0)!==65533&&(i[n[190][e]]=48640+e,s[48640+e]=n[190][e]);for(n[191]="".split(""),e=0;e!=n[191].length;++e)n[191][e].charCodeAt(0)!==65533&&(i[n[191][e]]=48896+e,s[48896+e]=n[191][e]);for(n[192]="".split(""),e=0;e!=n[192].length;++e)n[192][e].charCodeAt(0)!==65533&&(i[n[192][e]]=49152+e,s[49152+e]=n[192][e]);for(n[193]="".split(""),e=0;e!=n[193].length;++e)n[193][e].charCodeAt(0)!==65533&&(i[n[193][e]]=49408+e,s[49408+e]=n[193][e]);for(n[194]="".split(""),e=0;e!=n[194].length;++e)n[194][e].charCodeAt(0)!==65533&&(i[n[194][e]]=49664+e,s[49664+e]=n[194][e]);for(n[195]="".split(""),e=0;e!=n[195].length;++e)n[195][e].charCodeAt(0)!==65533&&(i[n[195][e]]=49920+e,s[49920+e]=n[195][e]);for(n[196]="".split(""),e=0;e!=n[196].length;++e)n[196][e].charCodeAt(0)!==65533&&(i[n[196][e]]=50176+e,s[50176+e]=n[196][e]);for(n[197]="".split(""),e=0;e!=n[197].length;++e)n[197][e].charCodeAt(0)!==65533&&(i[n[197][e]]=50432+e,s[50432+e]=n[197][e]);for(n[198]="".split(""),e=0;e!=n[198].length;++e)n[198][e].charCodeAt(0)!==65533&&(i[n[198][e]]=50688+e,s[50688+e]=n[198][e]);for(n[199]="".split(""),e=0;e!=n[199].length;++e)n[199][e].charCodeAt(0)!==65533&&(i[n[199][e]]=50944+e,s[50944+e]=n[199][e]);for(n[200]="".split(""),e=0;e!=n[200].length;++e)n[200][e].charCodeAt(0)!==65533&&(i[n[200][e]]=51200+e,s[51200+e]=n[200][e]);for(n[201]="".split(""),e=0;e!=n[201].length;++e)n[201][e].charCodeAt(0)!==65533&&(i[n[201][e]]=51456+e,s[51456+e]=n[201][e]);for(n[202]="".split(""),e=0;e!=n[202].length;++e)n[202][e].charCodeAt(0)!==65533&&(i[n[202][e]]=51712+e,s[51712+e]=n[202][e]);for(n[203]="".split(""),e=0;e!=n[203].length;++e)n[203][e].charCodeAt(0)!==65533&&(i[n[203][e]]=51968+e,s[51968+e]=n[203][e]);for(n[204]="".split(""),e=0;e!=n[204].length;++e)n[204][e].charCodeAt(0)!==65533&&(i[n[204][e]]=52224+e,s[52224+e]=n[204][e]);for(n[205]="".split(""),e=0;e!=n[205].length;++e)n[205][e].charCodeAt(0)!==65533&&(i[n[205][e]]=52480+e,s[52480+e]=n[205][e]);for(n[206]="".split(""),e=0;e!=n[206].length;++e)n[206][e].charCodeAt(0)!==65533&&(i[n[206][e]]=52736+e,s[52736+e]=n[206][e]);for(n[207]="".split(""),e=0;e!=n[207].length;++e)n[207][e].charCodeAt(0)!==65533&&(i[n[207][e]]=52992+e,s[52992+e]=n[207][e]);for(n[208]="".split(""),e=0;e!=n[208].length;++e)n[208][e].charCodeAt(0)!==65533&&(i[n[208][e]]=53248+e,s[53248+e]=n[208][e]);for(n[209]="".split(""),e=0;e!=n[209].length;++e)n[209][e].charCodeAt(0)!==65533&&(i[n[209][e]]=53504+e,s[53504+e]=n[209][e]);for(n[210]="".split(""),e=0;e!=n[210].length;++e)n[210][e].charCodeAt(0)!==65533&&(i[n[210][e]]=53760+e,s[53760+e]=n[210][e]);for(n[211]="".split(""),e=0;e!=n[211].length;++e)n[211][e].charCodeAt(0)!==65533&&(i[n[211][e]]=54016+e,s[54016+e]=n[211][e]);for(n[212]="".split(""),e=0;e!=n[212].length;++e)n[212][e].charCodeAt(0)!==65533&&(i[n[212][e]]=54272+e,s[54272+e]=n[212][e]);for(n[213]="".split(""),e=0;e!=n[213].length;++e)n[213][e].charCodeAt(0)!==65533&&(i[n[213][e]]=54528+e,s[54528+e]=n[213][e]);for(n[214]="".split(""),e=0;e!=n[214].length;++e)n[214][e].charCodeAt(0)!==65533&&(i[n[214][e]]=54784+e,s[54784+e]=n[214][e]);for(n[215]="".split(""),e=0;e!=n[215].length;++e)n[215][e].charCodeAt(0)!==65533&&(i[n[215][e]]=55040+e,s[55040+e]=n[215][e]);for(n[216]="".split(""),e=0;e!=n[216].length;++e)n[216][e].charCodeAt(0)!==65533&&(i[n[216][e]]=55296+e,s[55296+e]=n[216][e]);for(n[217]="".split(""),e=0;e!=n[217].length;++e)n[217][e].charCodeAt(0)!==65533&&(i[n[217][e]]=55552+e,s[55552+e]=n[217][e]);for(n[218]="".split(""),e=0;e!=n[218].length;++e)n[218][e].charCodeAt(0)!==65533&&(i[n[218][e]]=55808+e,s[55808+e]=n[218][e]);for(n[219]="".split(""),e=0;e!=n[219].length;++e)n[219][e].charCodeAt(0)!==65533&&(i[n[219][e]]=56064+e,s[56064+e]=n[219][e]);for(n[220]="".split(""),e=0;e!=n[220].length;++e)n[220][e].charCodeAt(0)!==65533&&(i[n[220][e]]=56320+e,s[56320+e]=n[220][e]);for(n[221]="".split(""),e=0;e!=n[221].length;++e)n[221][e].charCodeAt(0)!==65533&&(i[n[221][e]]=56576+e,s[56576+e]=n[221][e]);for(n[222]="".split(""),e=0;e!=n[222].length;++e)n[222][e].charCodeAt(0)!==65533&&(i[n[222][e]]=56832+e,s[56832+e]=n[222][e]);for(n[223]="".split(""),e=0;e!=n[223].length;++e)n[223][e].charCodeAt(0)!==65533&&(i[n[223][e]]=57088+e,s[57088+e]=n[223][e]);for(n[224]="".split(""),e=0;e!=n[224].length;++e)n[224][e].charCodeAt(0)!==65533&&(i[n[224][e]]=57344+e,s[57344+e]=n[224][e]);for(n[225]="".split(""),e=0;e!=n[225].length;++e)n[225][e].charCodeAt(0)!==65533&&(i[n[225][e]]=57600+e,s[57600+e]=n[225][e]);for(n[226]="".split(""),e=0;e!=n[226].length;++e)n[226][e].charCodeAt(0)!==65533&&(i[n[226][e]]=57856+e,s[57856+e]=n[226][e]);for(n[227]="".split(""),e=0;e!=n[227].length;++e)n[227][e].charCodeAt(0)!==65533&&(i[n[227][e]]=58112+e,s[58112+e]=n[227][e]);for(n[228]="".split(""),e=0;e!=n[228].length;++e)n[228][e].charCodeAt(0)!==65533&&(i[n[228][e]]=58368+e,s[58368+e]=n[228][e]);for(n[229]="".split(""),e=0;e!=n[229].length;++e)n[229][e].charCodeAt(0)!==65533&&(i[n[229][e]]=58624+e,s[58624+e]=n[229][e]);for(n[230]="".split(""),e=0;e!=n[230].length;++e)n[230][e].charCodeAt(0)!==65533&&(i[n[230][e]]=58880+e,s[58880+e]=n[230][e]);for(n[231]="".split(""),e=0;e!=n[231].length;++e)n[231][e].charCodeAt(0)!==65533&&(i[n[231][e]]=59136+e,s[59136+e]=n[231][e]);for(n[232]="".split(""),e=0;e!=n[232].length;++e)n[232][e].charCodeAt(0)!==65533&&(i[n[232][e]]=59392+e,s[59392+e]=n[232][e]);for(n[233]="".split(""),e=0;e!=n[233].length;++e)n[233][e].charCodeAt(0)!==65533&&(i[n[233][e]]=59648+e,s[59648+e]=n[233][e]);for(n[234]="".split(""),e=0;e!=n[234].length;++e)n[234][e].charCodeAt(0)!==65533&&(i[n[234][e]]=59904+e,s[59904+e]=n[234][e]);for(n[235]="".split(""),e=0;e!=n[235].length;++e)n[235][e].charCodeAt(0)!==65533&&(i[n[235][e]]=60160+e,s[60160+e]=n[235][e]);for(n[236]="".split(""),e=0;e!=n[236].length;++e)n[236][e].charCodeAt(0)!==65533&&(i[n[236][e]]=60416+e,s[60416+e]=n[236][e]);for(n[237]="".split(""),e=0;e!=n[237].length;++e)n[237][e].charCodeAt(0)!==65533&&(i[n[237][e]]=60672+e,s[60672+e]=n[237][e]);for(n[238]="".split(""),e=0;e!=n[238].length;++e)n[238][e].charCodeAt(0)!==65533&&(i[n[238][e]]=60928+e,s[60928+e]=n[238][e]);for(n[239]="".split(""),e=0;e!=n[239].length;++e)n[239][e].charCodeAt(0)!==65533&&(i[n[239][e]]=61184+e,s[61184+e]=n[239][e]);for(n[240]="".split(""),e=0;e!=n[240].length;++e)n[240][e].charCodeAt(0)!==65533&&(i[n[240][e]]=61440+e,s[61440+e]=n[240][e]);for(n[241]="".split(""),e=0;e!=n[241].length;++e)n[241][e].charCodeAt(0)!==65533&&(i[n[241][e]]=61696+e,s[61696+e]=n[241][e]);for(n[242]="".split(""),e=0;e!=n[242].length;++e)n[242][e].charCodeAt(0)!==65533&&(i[n[242][e]]=61952+e,s[61952+e]=n[242][e]);for(n[243]="".split(""),e=0;e!=n[243].length;++e)n[243][e].charCodeAt(0)!==65533&&(i[n[243][e]]=62208+e,s[62208+e]=n[243][e]);for(n[244]="".split(""),e=0;e!=n[244].length;++e)n[244][e].charCodeAt(0)!==65533&&(i[n[244][e]]=62464+e,s[62464+e]=n[244][e]);for(n[245]="".split(""),e=0;e!=n[245].length;++e)n[245][e].charCodeAt(0)!==65533&&(i[n[245][e]]=62720+e,s[62720+e]=n[245][e]);for(n[246]="".split(""),e=0;e!=n[246].length;++e)n[246][e].charCodeAt(0)!==65533&&(i[n[246][e]]=62976+e,s[62976+e]=n[246][e]);for(n[247]="".split(""),e=0;e!=n[247].length;++e)n[247][e].charCodeAt(0)!==65533&&(i[n[247][e]]=63232+e,s[63232+e]=n[247][e]);for(n[248]="".split(""),e=0;e!=n[248].length;++e)n[248][e].charCodeAt(0)!==65533&&(i[n[248][e]]=63488+e,s[63488+e]=n[248][e]);for(n[249]="".split(""),e=0;e!=n[249].length;++e)n[249][e].charCodeAt(0)!==65533&&(i[n[249][e]]=63744+e,s[63744+e]=n[249][e]);for(n[250]="".split(""),e=0;e!=n[250].length;++e)n[250][e].charCodeAt(0)!==65533&&(i[n[250][e]]=64e3+e,s[64e3+e]=n[250][e]);for(n[251]="".split(""),e=0;e!=n[251].length;++e)n[251][e].charCodeAt(0)!==65533&&(i[n[251][e]]=64256+e,s[64256+e]=n[251][e]);for(n[252]="".split(""),e=0;e!=n[252].length;++e)n[252][e].charCodeAt(0)!==65533&&(i[n[252][e]]=64512+e,s[64512+e]=n[252][e]);for(n[253]="".split(""),e=0;e!=n[253].length;++e)n[253][e].charCodeAt(0)!==65533&&(i[n[253][e]]=64768+e,s[64768+e]=n[253][e]);for(n[254]="".split(""),e=0;e!=n[254].length;++e)n[254][e].charCodeAt(0)!==65533&&(i[n[254][e]]=65024+e,s[65024+e]=n[254][e]);return{enc:i,dec:s}}(),t[949]=function(){var s=[],i={},n=[],e;for(n[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),e=0;e!=n[0].length;++e)n[0][e].charCodeAt(0)!==65533&&(i[n[0][e]]=0+e,s[0+e]=n[0][e]);for(n[129]="".split(""),e=0;e!=n[129].length;++e)n[129][e].charCodeAt(0)!==65533&&(i[n[129][e]]=33024+e,s[33024+e]=n[129][e]);for(n[130]="".split(""),e=0;e!=n[130].length;++e)n[130][e].charCodeAt(0)!==65533&&(i[n[130][e]]=33280+e,s[33280+e]=n[130][e]);for(n[131]="".split(""),e=0;e!=n[131].length;++e)n[131][e].charCodeAt(0)!==65533&&(i[n[131][e]]=33536+e,s[33536+e]=n[131][e]);for(n[132]="".split(""),e=0;e!=n[132].length;++e)n[132][e].charCodeAt(0)!==65533&&(i[n[132][e]]=33792+e,s[33792+e]=n[132][e]);for(n[133]="".split(""),e=0;e!=n[133].length;++e)n[133][e].charCodeAt(0)!==65533&&(i[n[133][e]]=34048+e,s[34048+e]=n[133][e]);for(n[134]="".split(""),e=0;e!=n[134].length;++e)n[134][e].charCodeAt(0)!==65533&&(i[n[134][e]]=34304+e,s[34304+e]=n[134][e]);for(n[135]="".split(""),e=0;e!=n[135].length;++e)n[135][e].charCodeAt(0)!==65533&&(i[n[135][e]]=34560+e,s[34560+e]=n[135][e]);for(n[136]="".split(""),e=0;e!=n[136].length;++e)n[136][e].charCodeAt(0)!==65533&&(i[n[136][e]]=34816+e,s[34816+e]=n[136][e]);for(n[137]="".split(""),e=0;e!=n[137].length;++e)n[137][e].charCodeAt(0)!==65533&&(i[n[137][e]]=35072+e,s[35072+e]=n[137][e]);for(n[138]="".split(""),e=0;e!=n[138].length;++e)n[138][e].charCodeAt(0)!==65533&&(i[n[138][e]]=35328+e,s[35328+e]=n[138][e]);for(n[139]="".split(""),e=0;e!=n[139].length;++e)n[139][e].charCodeAt(0)!==65533&&(i[n[139][e]]=35584+e,s[35584+e]=n[139][e]);for(n[140]="".split(""),e=0;e!=n[140].length;++e)n[140][e].charCodeAt(0)!==65533&&(i[n[140][e]]=35840+e,s[35840+e]=n[140][e]);for(n[141]="".split(""),e=0;e!=n[141].length;++e)n[141][e].charCodeAt(0)!==65533&&(i[n[141][e]]=36096+e,s[36096+e]=n[141][e]);for(n[142]="".split(""),e=0;e!=n[142].length;++e)n[142][e].charCodeAt(0)!==65533&&(i[n[142][e]]=36352+e,s[36352+e]=n[142][e]);for(n[143]="".split(""),e=0;e!=n[143].length;++e)n[143][e].charCodeAt(0)!==65533&&(i[n[143][e]]=36608+e,s[36608+e]=n[143][e]);for(n[144]="".split(""),e=0;e!=n[144].length;++e)n[144][e].charCodeAt(0)!==65533&&(i[n[144][e]]=36864+e,s[36864+e]=n[144][e]);for(n[145]="".split(""),e=0;e!=n[145].length;++e)n[145][e].charCodeAt(0)!==65533&&(i[n[145][e]]=37120+e,s[37120+e]=n[145][e]);for(n[146]="".split(""),e=0;e!=n[146].length;++e)n[146][e].charCodeAt(0)!==65533&&(i[n[146][e]]=37376+e,s[37376+e]=n[146][e]);for(n[147]="".split(""),e=0;e!=n[147].length;++e)n[147][e].charCodeAt(0)!==65533&&(i[n[147][e]]=37632+e,s[37632+e]=n[147][e]);for(n[148]="".split(""),e=0;e!=n[148].length;++e)n[148][e].charCodeAt(0)!==65533&&(i[n[148][e]]=37888+e,s[37888+e]=n[148][e]);for(n[149]="".split(""),e=0;e!=n[149].length;++e)n[149][e].charCodeAt(0)!==65533&&(i[n[149][e]]=38144+e,s[38144+e]=n[149][e]);for(n[150]="".split(""),e=0;e!=n[150].length;++e)n[150][e].charCodeAt(0)!==65533&&(i[n[150][e]]=38400+e,s[38400+e]=n[150][e]);for(n[151]="".split(""),e=0;e!=n[151].length;++e)n[151][e].charCodeAt(0)!==65533&&(i[n[151][e]]=38656+e,s[38656+e]=n[151][e]);for(n[152]="".split(""),e=0;e!=n[152].length;++e)n[152][e].charCodeAt(0)!==65533&&(i[n[152][e]]=38912+e,s[38912+e]=n[152][e]);for(n[153]="".split(""),e=0;e!=n[153].length;++e)n[153][e].charCodeAt(0)!==65533&&(i[n[153][e]]=39168+e,s[39168+e]=n[153][e]);for(n[154]="".split(""),e=0;e!=n[154].length;++e)n[154][e].charCodeAt(0)!==65533&&(i[n[154][e]]=39424+e,s[39424+e]=n[154][e]);for(n[155]="".split(""),e=0;e!=n[155].length;++e)n[155][e].charCodeAt(0)!==65533&&(i[n[155][e]]=39680+e,s[39680+e]=n[155][e]);for(n[156]="".split(""),e=0;e!=n[156].length;++e)n[156][e].charCodeAt(0)!==65533&&(i[n[156][e]]=39936+e,s[39936+e]=n[156][e]);for(n[157]="".split(""),e=0;e!=n[157].length;++e)n[157][e].charCodeAt(0)!==65533&&(i[n[157][e]]=40192+e,s[40192+e]=n[157][e]);for(n[158]="".split(""),e=0;e!=n[158].length;++e)n[158][e].charCodeAt(0)!==65533&&(i[n[158][e]]=40448+e,s[40448+e]=n[158][e]);for(n[159]="".split(""),e=0;e!=n[159].length;++e)n[159][e].charCodeAt(0)!==65533&&(i[n[159][e]]=40704+e,s[40704+e]=n[159][e]);for(n[160]="".split(""),e=0;e!=n[160].length;++e)n[160][e].charCodeAt(0)!==65533&&(i[n[160][e]]=40960+e,s[40960+e]=n[160][e]);for(n[161]="".split(""),e=0;e!=n[161].length;++e)n[161][e].charCodeAt(0)!==65533&&(i[n[161][e]]=41216+e,s[41216+e]=n[161][e]);for(n[162]="".split(""),e=0;e!=n[162].length;++e)n[162][e].charCodeAt(0)!==65533&&(i[n[162][e]]=41472+e,s[41472+e]=n[162][e]);for(n[163]="".split(""),e=0;e!=n[163].length;++e)n[163][e].charCodeAt(0)!==65533&&(i[n[163][e]]=41728+e,s[41728+e]=n[163][e]);for(n[164]="".split(""),e=0;e!=n[164].length;++e)n[164][e].charCodeAt(0)!==65533&&(i[n[164][e]]=41984+e,s[41984+e]=n[164][e]);for(n[165]="".split(""),e=0;e!=n[165].length;++e)n[165][e].charCodeAt(0)!==65533&&(i[n[165][e]]=42240+e,s[42240+e]=n[165][e]);for(n[166]="".split(""),e=0;e!=n[166].length;++e)n[166][e].charCodeAt(0)!==65533&&(i[n[166][e]]=42496+e,s[42496+e]=n[166][e]);for(n[167]="".split(""),e=0;e!=n[167].length;++e)n[167][e].charCodeAt(0)!==65533&&(i[n[167][e]]=42752+e,s[42752+e]=n[167][e]);for(n[168]="".split(""),e=0;e!=n[168].length;++e)n[168][e].charCodeAt(0)!==65533&&(i[n[168][e]]=43008+e,s[43008+e]=n[168][e]);for(n[169]="".split(""),e=0;e!=n[169].length;++e)n[169][e].charCodeAt(0)!==65533&&(i[n[169][e]]=43264+e,s[43264+e]=n[169][e]);for(n[170]="".split(""),e=0;e!=n[170].length;++e)n[170][e].charCodeAt(0)!==65533&&(i[n[170][e]]=43520+e,s[43520+e]=n[170][e]);for(n[171]="".split(""),e=0;e!=n[171].length;++e)n[171][e].charCodeAt(0)!==65533&&(i[n[171][e]]=43776+e,s[43776+e]=n[171][e]);for(n[172]="".split(""),e=0;e!=n[172].length;++e)n[172][e].charCodeAt(0)!==65533&&(i[n[172][e]]=44032+e,s[44032+e]=n[172][e]);for(n[173]="".split(""),e=0;e!=n[173].length;++e)n[173][e].charCodeAt(0)!==65533&&(i[n[173][e]]=44288+e,s[44288+e]=n[173][e]);for(n[174]="".split(""),e=0;e!=n[174].length;++e)n[174][e].charCodeAt(0)!==65533&&(i[n[174][e]]=44544+e,s[44544+e]=n[174][e]);for(n[175]="".split(""),e=0;e!=n[175].length;++e)n[175][e].charCodeAt(0)!==65533&&(i[n[175][e]]=44800+e,s[44800+e]=n[175][e]);for(n[176]="".split(""),e=0;e!=n[176].length;++e)n[176][e].charCodeAt(0)!==65533&&(i[n[176][e]]=45056+e,s[45056+e]=n[176][e]);for(n[177]="".split(""),e=0;e!=n[177].length;++e)n[177][e].charCodeAt(0)!==65533&&(i[n[177][e]]=45312+e,s[45312+e]=n[177][e]);for(n[178]="".split(""),e=0;e!=n[178].length;++e)n[178][e].charCodeAt(0)!==65533&&(i[n[178][e]]=45568+e,s[45568+e]=n[178][e]);for(n[179]="".split(""),e=0;e!=n[179].length;++e)n[179][e].charCodeAt(0)!==65533&&(i[n[179][e]]=45824+e,s[45824+e]=n[179][e]);for(n[180]="".split(""),e=0;e!=n[180].length;++e)n[180][e].charCodeAt(0)!==65533&&(i[n[180][e]]=46080+e,s[46080+e]=n[180][e]);for(n[181]="".split(""),e=0;e!=n[181].length;++e)n[181][e].charCodeAt(0)!==65533&&(i[n[181][e]]=46336+e,s[46336+e]=n[181][e]);for(n[182]="".split(""),e=0;e!=n[182].length;++e)n[182][e].charCodeAt(0)!==65533&&(i[n[182][e]]=46592+e,s[46592+e]=n[182][e]);for(n[183]="".split(""),e=0;e!=n[183].length;++e)n[183][e].charCodeAt(0)!==65533&&(i[n[183][e]]=46848+e,s[46848+e]=n[183][e]);for(n[184]="".split(""),e=0;e!=n[184].length;++e)n[184][e].charCodeAt(0)!==65533&&(i[n[184][e]]=47104+e,s[47104+e]=n[184][e]);for(n[185]="".split(""),e=0;e!=n[185].length;++e)n[185][e].charCodeAt(0)!==65533&&(i[n[185][e]]=47360+e,s[47360+e]=n[185][e]);for(n[186]="".split(""),e=0;e!=n[186].length;++e)n[186][e].charCodeAt(0)!==65533&&(i[n[186][e]]=47616+e,s[47616+e]=n[186][e]);for(n[187]="".split(""),e=0;e!=n[187].length;++e)n[187][e].charCodeAt(0)!==65533&&(i[n[187][e]]=47872+e,s[47872+e]=n[187][e]);for(n[188]="".split(""),e=0;e!=n[188].length;++e)n[188][e].charCodeAt(0)!==65533&&(i[n[188][e]]=48128+e,s[48128+e]=n[188][e]);for(n[189]="".split(""),e=0;e!=n[189].length;++e)n[189][e].charCodeAt(0)!==65533&&(i[n[189][e]]=48384+e,s[48384+e]=n[189][e]);for(n[190]="".split(""),e=0;e!=n[190].length;++e)n[190][e].charCodeAt(0)!==65533&&(i[n[190][e]]=48640+e,s[48640+e]=n[190][e]);for(n[191]="".split(""),e=0;e!=n[191].length;++e)n[191][e].charCodeAt(0)!==65533&&(i[n[191][e]]=48896+e,s[48896+e]=n[191][e]);for(n[192]="".split(""),e=0;e!=n[192].length;++e)n[192][e].charCodeAt(0)!==65533&&(i[n[192][e]]=49152+e,s[49152+e]=n[192][e]);for(n[193]="".split(""),e=0;e!=n[193].length;++e)n[193][e].charCodeAt(0)!==65533&&(i[n[193][e]]=49408+e,s[49408+e]=n[193][e]);for(n[194]="".split(""),e=0;e!=n[194].length;++e)n[194][e].charCodeAt(0)!==65533&&(i[n[194][e]]=49664+e,s[49664+e]=n[194][e]);for(n[195]="".split(""),e=0;e!=n[195].length;++e)n[195][e].charCodeAt(0)!==65533&&(i[n[195][e]]=49920+e,s[49920+e]=n[195][e]);for(n[196]="".split(""),e=0;e!=n[196].length;++e)n[196][e].charCodeAt(0)!==65533&&(i[n[196][e]]=50176+e,s[50176+e]=n[196][e]);for(n[197]="".split(""),e=0;e!=n[197].length;++e)n[197][e].charCodeAt(0)!==65533&&(i[n[197][e]]=50432+e,s[50432+e]=n[197][e]);for(n[198]="".split(""),e=0;e!=n[198].length;++e)n[198][e].charCodeAt(0)!==65533&&(i[n[198][e]]=50688+e,s[50688+e]=n[198][e]);for(n[199]="".split(""),e=0;e!=n[199].length;++e)n[199][e].charCodeAt(0)!==65533&&(i[n[199][e]]=50944+e,s[50944+e]=n[199][e]);for(n[200]="".split(""),e=0;e!=n[200].length;++e)n[200][e].charCodeAt(0)!==65533&&(i[n[200][e]]=51200+e,s[51200+e]=n[200][e]);for(n[202]="".split(""),e=0;e!=n[202].length;++e)n[202][e].charCodeAt(0)!==65533&&(i[n[202][e]]=51712+e,s[51712+e]=n[202][e]);for(n[203]="".split(""),e=0;e!=n[203].length;++e)n[203][e].charCodeAt(0)!==65533&&(i[n[203][e]]=51968+e,s[51968+e]=n[203][e]);for(n[204]="".split(""),e=0;e!=n[204].length;++e)n[204][e].charCodeAt(0)!==65533&&(i[n[204][e]]=52224+e,s[52224+e]=n[204][e]);for(n[205]="".split(""),e=0;e!=n[205].length;++e)n[205][e].charCodeAt(0)!==65533&&(i[n[205][e]]=52480+e,s[52480+e]=n[205][e]);for(n[206]="".split(""),e=0;e!=n[206].length;++e)n[206][e].charCodeAt(0)!==65533&&(i[n[206][e]]=52736+e,s[52736+e]=n[206][e]);for(n[207]="".split(""),e=0;e!=n[207].length;++e)n[207][e].charCodeAt(0)!==65533&&(i[n[207][e]]=52992+e,s[52992+e]=n[207][e]);for(n[208]="".split(""),e=0;e!=n[208].length;++e)n[208][e].charCodeAt(0)!==65533&&(i[n[208][e]]=53248+e,s[53248+e]=n[208][e]);for(n[209]="".split(""),e=0;e!=n[209].length;++e)n[209][e].charCodeAt(0)!==65533&&(i[n[209][e]]=53504+e,s[53504+e]=n[209][e]);for(n[210]="".split(""),e=0;e!=n[210].length;++e)n[210][e].charCodeAt(0)!==65533&&(i[n[210][e]]=53760+e,s[53760+e]=n[210][e]);for(n[211]="".split(""),e=0;e!=n[211].length;++e)n[211][e].charCodeAt(0)!==65533&&(i[n[211][e]]=54016+e,s[54016+e]=n[211][e]);for(n[212]="".split(""),e=0;e!=n[212].length;++e)n[212][e].charCodeAt(0)!==65533&&(i[n[212][e]]=54272+e,s[54272+e]=n[212][e]);for(n[213]="".split(""),e=0;e!=n[213].length;++e)n[213][e].charCodeAt(0)!==65533&&(i[n[213][e]]=54528+e,s[54528+e]=n[213][e]);for(n[214]="".split(""),e=0;e!=n[214].length;++e)n[214][e].charCodeAt(0)!==65533&&(i[n[214][e]]=54784+e,s[54784+e]=n[214][e]);for(n[215]="".split(""),e=0;e!=n[215].length;++e)n[215][e].charCodeAt(0)!==65533&&(i[n[215][e]]=55040+e,s[55040+e]=n[215][e]);for(n[216]="".split(""),e=0;e!=n[216].length;++e)n[216][e].charCodeAt(0)!==65533&&(i[n[216][e]]=55296+e,s[55296+e]=n[216][e]);for(n[217]="".split(""),e=0;e!=n[217].length;++e)n[217][e].charCodeAt(0)!==65533&&(i[n[217][e]]=55552+e,s[55552+e]=n[217][e]);for(n[218]="".split(""),e=0;e!=n[218].length;++e)n[218][e].charCodeAt(0)!==65533&&(i[n[218][e]]=55808+e,s[55808+e]=n[218][e]);for(n[219]="".split(""),e=0;e!=n[219].length;++e)n[219][e].charCodeAt(0)!==65533&&(i[n[219][e]]=56064+e,s[56064+e]=n[219][e]);for(n[220]="".split(""),e=0;e!=n[220].length;++e)n[220][e].charCodeAt(0)!==65533&&(i[n[220][e]]=56320+e,s[56320+e]=n[220][e]);for(n[221]="".split(""),e=0;e!=n[221].length;++e)n[221][e].charCodeAt(0)!==65533&&(i[n[221][e]]=56576+e,s[56576+e]=n[221][e]);for(n[222]="".split(""),e=0;e!=n[222].length;++e)n[222][e].charCodeAt(0)!==65533&&(i[n[222][e]]=56832+e,s[56832+e]=n[222][e]);for(n[223]="".split(""),e=0;e!=n[223].length;++e)n[223][e].charCodeAt(0)!==65533&&(i[n[223][e]]=57088+e,s[57088+e]=n[223][e]);for(n[224]="".split(""),e=0;e!=n[224].length;++e)n[224][e].charCodeAt(0)!==65533&&(i[n[224][e]]=57344+e,s[57344+e]=n[224][e]);for(n[225]="".split(""),e=0;e!=n[225].length;++e)n[225][e].charCodeAt(0)!==65533&&(i[n[225][e]]=57600+e,s[57600+e]=n[225][e]);for(n[226]="".split(""),e=0;e!=n[226].length;++e)n[226][e].charCodeAt(0)!==65533&&(i[n[226][e]]=57856+e,s[57856+e]=n[226][e]);for(n[227]="".split(""),e=0;e!=n[227].length;++e)n[227][e].charCodeAt(0)!==65533&&(i[n[227][e]]=58112+e,s[58112+e]=n[227][e]);for(n[228]="".split(""),e=0;e!=n[228].length;++e)n[228][e].charCodeAt(0)!==65533&&(i[n[228][e]]=58368+e,s[58368+e]=n[228][e]);for(n[229]="".split(""),e=0;e!=n[229].length;++e)n[229][e].charCodeAt(0)!==65533&&(i[n[229][e]]=58624+e,s[58624+e]=n[229][e]);for(n[230]="".split(""),e=0;e!=n[230].length;++e)n[230][e].charCodeAt(0)!==65533&&(i[n[230][e]]=58880+e,s[58880+e]=n[230][e]);for(n[231]="".split(""),e=0;e!=n[231].length;++e)n[231][e].charCodeAt(0)!==65533&&(i[n[231][e]]=59136+e,s[59136+e]=n[231][e]);for(n[232]="".split(""),e=0;e!=n[232].length;++e)n[232][e].charCodeAt(0)!==65533&&(i[n[232][e]]=59392+e,s[59392+e]=n[232][e]);for(n[233]="".split(""),e=0;e!=n[233].length;++e)n[233][e].charCodeAt(0)!==65533&&(i[n[233][e]]=59648+e,s[59648+e]=n[233][e]);for(n[234]="".split(""),e=0;e!=n[234].length;++e)n[234][e].charCodeAt(0)!==65533&&(i[n[234][e]]=59904+e,s[59904+e]=n[234][e]);for(n[235]="".split(""),e=0;e!=n[235].length;++e)n[235][e].charCodeAt(0)!==65533&&(i[n[235][e]]=60160+e,s[60160+e]=n[235][e]);for(n[236]="".split(""),e=0;e!=n[236].length;++e)n[236][e].charCodeAt(0)!==65533&&(i[n[236][e]]=60416+e,s[60416+e]=n[236][e]);for(n[237]="".split(""),e=0;e!=n[237].length;++e)n[237][e].charCodeAt(0)!==65533&&(i[n[237][e]]=60672+e,s[60672+e]=n[237][e]);for(n[238]="".split(""),e=0;e!=n[238].length;++e)n[238][e].charCodeAt(0)!==65533&&(i[n[238][e]]=60928+e,s[60928+e]=n[238][e]);for(n[239]="".split(""),e=0;e!=n[239].length;++e)n[239][e].charCodeAt(0)!==65533&&(i[n[239][e]]=61184+e,s[61184+e]=n[239][e]);for(n[240]="".split(""),e=0;e!=n[240].length;++e)n[240][e].charCodeAt(0)!==65533&&(i[n[240][e]]=61440+e,s[61440+e]=n[240][e]);for(n[241]="".split(""),e=0;e!=n[241].length;++e)n[241][e].charCodeAt(0)!==65533&&(i[n[241][e]]=61696+e,s[61696+e]=n[241][e]);for(n[242]="".split(""),e=0;e!=n[242].length;++e)n[242][e].charCodeAt(0)!==65533&&(i[n[242][e]]=61952+e,s[61952+e]=n[242][e]);for(n[243]="".split(""),e=0;e!=n[243].length;++e)n[243][e].charCodeAt(0)!==65533&&(i[n[243][e]]=62208+e,s[62208+e]=n[243][e]);for(n[244]="".split(""),e=0;e!=n[244].length;++e)n[244][e].charCodeAt(0)!==65533&&(i[n[244][e]]=62464+e,s[62464+e]=n[244][e]);for(n[245]="".split(""),e=0;e!=n[245].length;++e)n[245][e].charCodeAt(0)!==65533&&(i[n[245][e]]=62720+e,s[62720+e]=n[245][e]);for(n[246]="".split(""),e=0;e!=n[246].length;++e)n[246][e].charCodeAt(0)!==65533&&(i[n[246][e]]=62976+e,s[62976+e]=n[246][e]);for(n[247]="".split(""),e=0;e!=n[247].length;++e)n[247][e].charCodeAt(0)!==65533&&(i[n[247][e]]=63232+e,s[63232+e]=n[247][e]);for(n[248]="".split(""),e=0;e!=n[248].length;++e)n[248][e].charCodeAt(0)!==65533&&(i[n[248][e]]=63488+e,s[63488+e]=n[248][e]);for(n[249]="".split(""),e=0;e!=n[249].length;++e)n[249][e].charCodeAt(0)!==65533&&(i[n[249][e]]=63744+e,s[63744+e]=n[249][e]);for(n[250]="".split(""),e=0;e!=n[250].length;++e)n[250][e].charCodeAt(0)!==65533&&(i[n[250][e]]=64e3+e,s[64e3+e]=n[250][e]);for(n[251]="".split(""),e=0;e!=n[251].length;++e)n[251][e].charCodeAt(0)!==65533&&(i[n[251][e]]=64256+e,s[64256+e]=n[251][e]);for(n[252]="".split(""),e=0;e!=n[252].length;++e)n[252][e].charCodeAt(0)!==65533&&(i[n[252][e]]=64512+e,s[64512+e]=n[252][e]);for(n[253]="".split(""),e=0;e!=n[253].length;++e)n[253][e].charCodeAt(0)!==65533&&(i[n[253][e]]=64768+e,s[64768+e]=n[253][e]);return{enc:i,dec:s}}(),t[950]=function(){var s=[],i={},n=[],e;for(n[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),e=0;e!=n[0].length;++e)n[0][e].charCodeAt(0)!==65533&&(i[n[0][e]]=0+e,s[0+e]=n[0][e]);for(n[161]="".split(""),e=0;e!=n[161].length;++e)n[161][e].charCodeAt(0)!==65533&&(i[n[161][e]]=41216+e,s[41216+e]=n[161][e]);for(n[162]="".split(""),e=0;e!=n[162].length;++e)n[162][e].charCodeAt(0)!==65533&&(i[n[162][e]]=41472+e,s[41472+e]=n[162][e]);for(n[163]="".split(""),e=0;e!=n[163].length;++e)n[163][e].charCodeAt(0)!==65533&&(i[n[163][e]]=41728+e,s[41728+e]=n[163][e]);for(n[164]="".split(""),e=0;e!=n[164].length;++e)n[164][e].charCodeAt(0)!==65533&&(i[n[164][e]]=41984+e,s[41984+e]=n[164][e]);for(n[165]="".split(""),e=0;e!=n[165].length;++e)n[165][e].charCodeAt(0)!==65533&&(i[n[165][e]]=42240+e,s[42240+e]=n[165][e]);for(n[166]="".split(""),e=0;e!=n[166].length;++e)n[166][e].charCodeAt(0)!==65533&&(i[n[166][e]]=42496+e,s[42496+e]=n[166][e]);for(n[167]="".split(""),e=0;e!=n[167].length;++e)n[167][e].charCodeAt(0)!==65533&&(i[n[167][e]]=42752+e,s[42752+e]=n[167][e]);for(n[168]="".split(""),e=0;e!=n[168].length;++e)n[168][e].charCodeAt(0)!==65533&&(i[n[168][e]]=43008+e,s[43008+e]=n[168][e]);for(n[169]="".split(""),e=0;e!=n[169].length;++e)n[169][e].charCodeAt(0)!==65533&&(i[n[169][e]]=43264+e,s[43264+e]=n[169][e]);for(n[170]="".split(""),e=0;e!=n[170].length;++e)n[170][e].charCodeAt(0)!==65533&&(i[n[170][e]]=43520+e,s[43520+e]=n[170][e]);for(n[171]="".split(""),e=0;e!=n[171].length;++e)n[171][e].charCodeAt(0)!==65533&&(i[n[171][e]]=43776+e,s[43776+e]=n[171][e]);for(n[172]="".split(""),e=0;e!=n[172].length;++e)n[172][e].charCodeAt(0)!==65533&&(i[n[172][e]]=44032+e,s[44032+e]=n[172][e]);for(n[173]="".split(""),e=0;e!=n[173].length;++e)n[173][e].charCodeAt(0)!==65533&&(i[n[173][e]]=44288+e,s[44288+e]=n[173][e]);for(n[174]="".split(""),e=0;e!=n[174].length;++e)n[174][e].charCodeAt(0)!==65533&&(i[n[174][e]]=44544+e,s[44544+e]=n[174][e]);for(n[175]="".split(""),e=0;e!=n[175].length;++e)n[175][e].charCodeAt(0)!==65533&&(i[n[175][e]]=44800+e,s[44800+e]=n[175][e]);for(n[176]="".split(""),e=0;e!=n[176].length;++e)n[176][e].charCodeAt(0)!==65533&&(i[n[176][e]]=45056+e,s[45056+e]=n[176][e]);for(n[177]="".split(""),e=0;e!=n[177].length;++e)n[177][e].charCodeAt(0)!==65533&&(i[n[177][e]]=45312+e,s[45312+e]=n[177][e]);for(n[178]="".split(""),e=0;e!=n[178].length;++e)n[178][e].charCodeAt(0)!==65533&&(i[n[178][e]]=45568+e,s[45568+e]=n[178][e]);for(n[179]="".split(""),e=0;e!=n[179].length;++e)n[179][e].charCodeAt(0)!==65533&&(i[n[179][e]]=45824+e,s[45824+e]=n[179][e]);for(n[180]="".split(""),e=0;e!=n[180].length;++e)n[180][e].charCodeAt(0)!==65533&&(i[n[180][e]]=46080+e,s[46080+e]=n[180][e]);for(n[181]="".split(""),e=0;e!=n[181].length;++e)n[181][e].charCodeAt(0)!==65533&&(i[n[181][e]]=46336+e,s[46336+e]=n[181][e]);for(n[182]="".split(""),e=0;e!=n[182].length;++e)n[182][e].charCodeAt(0)!==65533&&(i[n[182][e]]=46592+e,s[46592+e]=n[182][e]);for(n[183]="".split(""),e=0;e!=n[183].length;++e)n[183][e].charCodeAt(0)!==65533&&(i[n[183][e]]=46848+e,s[46848+e]=n[183][e]);for(n[184]="".split(""),e=0;e!=n[184].length;++e)n[184][e].charCodeAt(0)!==65533&&(i[n[184][e]]=47104+e,s[47104+e]=n[184][e]);for(n[185]="".split(""),e=0;e!=n[185].length;++e)n[185][e].charCodeAt(0)!==65533&&(i[n[185][e]]=47360+e,s[47360+e]=n[185][e]);for(n[186]="".split(""),e=0;e!=n[186].length;++e)n[186][e].charCodeAt(0)!==65533&&(i[n[186][e]]=47616+e,s[47616+e]=n[186][e]);for(n[187]="".split(""),e=0;e!=n[187].length;++e)n[187][e].charCodeAt(0)!==65533&&(i[n[187][e]]=47872+e,s[47872+e]=n[187][e]);for(n[188]="".split(""),e=0;e!=n[188].length;++e)n[188][e].charCodeAt(0)!==65533&&(i[n[188][e]]=48128+e,s[48128+e]=n[188][e]);for(n[189]="".split(""),e=0;e!=n[189].length;++e)n[189][e].charCodeAt(0)!==65533&&(i[n[189][e]]=48384+e,s[48384+e]=n[189][e]);for(n[190]="".split(""),e=0;e!=n[190].length;++e)n[190][e].charCodeAt(0)!==65533&&(i[n[190][e]]=48640+e,s[48640+e]=n[190][e]);for(n[191]="".split(""),e=0;e!=n[191].length;++e)n[191][e].charCodeAt(0)!==65533&&(i[n[191][e]]=48896+e,s[48896+e]=n[191][e]);for(n[192]="".split(""),e=0;e!=n[192].length;++e)n[192][e].charCodeAt(0)!==65533&&(i[n[192][e]]=49152+e,s[49152+e]=n[192][e]);for(n[193]="".split(""),e=0;e!=n[193].length;++e)n[193][e].charCodeAt(0)!==65533&&(i[n[193][e]]=49408+e,s[49408+e]=n[193][e]);for(n[194]="".split(""),e=0;e!=n[194].length;++e)n[194][e].charCodeAt(0)!==65533&&(i[n[194][e]]=49664+e,s[49664+e]=n[194][e]);for(n[195]="".split(""),e=0;e!=n[195].length;++e)n[195][e].charCodeAt(0)!==65533&&(i[n[195][e]]=49920+e,s[49920+e]=n[195][e]);for(n[196]="".split(""),e=0;e!=n[196].length;++e)n[196][e].charCodeAt(0)!==65533&&(i[n[196][e]]=50176+e,s[50176+e]=n[196][e]);for(n[197]="".split(""),e=0;e!=n[197].length;++e)n[197][e].charCodeAt(0)!==65533&&(i[n[197][e]]=50432+e,s[50432+e]=n[197][e]);for(n[198]="".split(""),e=0;e!=n[198].length;++e)n[198][e].charCodeAt(0)!==65533&&(i[n[198][e]]=50688+e,s[50688+e]=n[198][e]);for(n[201]="".split(""),e=0;e!=n[201].length;++e)n[201][e].charCodeAt(0)!==65533&&(i[n[201][e]]=51456+e,s[51456+e]=n[201][e]);for(n[202]="".split(""),e=0;e!=n[202].length;++e)n[202][e].charCodeAt(0)!==65533&&(i[n[202][e]]=51712+e,s[51712+e]=n[202][e]);for(n[203]="".split(""),e=0;e!=n[203].length;++e)n[203][e].charCodeAt(0)!==65533&&(i[n[203][e]]=51968+e,s[51968+e]=n[203][e]);for(n[204]="".split(""),e=0;e!=n[204].length;++e)n[204][e].charCodeAt(0)!==65533&&(i[n[204][e]]=52224+e,s[52224+e]=n[204][e]);for(n[205]="".split(""),e=0;e!=n[205].length;++e)n[205][e].charCodeAt(0)!==65533&&(i[n[205][e]]=52480+e,s[52480+e]=n[205][e]);for(n[206]="".split(""),e=0;e!=n[206].length;++e)n[206][e].charCodeAt(0)!==65533&&(i[n[206][e]]=52736+e,s[52736+e]=n[206][e]);for(n[207]="".split(""),e=0;e!=n[207].length;++e)n[207][e].charCodeAt(0)!==65533&&(i[n[207][e]]=52992+e,s[52992+e]=n[207][e]);for(n[208]="".split(""),e=0;e!=n[208].length;++e)n[208][e].charCodeAt(0)!==65533&&(i[n[208][e]]=53248+e,s[53248+e]=n[208][e]);for(n[209]="".split(""),e=0;e!=n[209].length;++e)n[209][e].charCodeAt(0)!==65533&&(i[n[209][e]]=53504+e,s[53504+e]=n[209][e]);for(n[210]="".split(""),e=0;e!=n[210].length;++e)n[210][e].charCodeAt(0)!==65533&&(i[n[210][e]]=53760+e,s[53760+e]=n[210][e]);for(n[211]="".split(""),e=0;e!=n[211].length;++e)n[211][e].charCodeAt(0)!==65533&&(i[n[211][e]]=54016+e,s[54016+e]=n[211][e]);for(n[212]="".split(""),e=0;e!=n[212].length;++e)n[212][e].charCodeAt(0)!==65533&&(i[n[212][e]]=54272+e,s[54272+e]=n[212][e]);for(n[213]="".split(""),e=0;e!=n[213].length;++e)n[213][e].charCodeAt(0)!==65533&&(i[n[213][e]]=54528+e,s[54528+e]=n[213][e]);for(n[214]="".split(""),e=0;e!=n[214].length;++e)n[214][e].charCodeAt(0)!==65533&&(i[n[214][e]]=54784+e,s[54784+e]=n[214][e]);for(n[215]="".split(""),e=0;e!=n[215].length;++e)n[215][e].charCodeAt(0)!==65533&&(i[n[215][e]]=55040+e,s[55040+e]=n[215][e]);for(n[216]="".split(""),e=0;e!=n[216].length;++e)n[216][e].charCodeAt(0)!==65533&&(i[n[216][e]]=55296+e,s[55296+e]=n[216][e]);for(n[217]="".split(""),e=0;e!=n[217].length;++e)n[217][e].charCodeAt(0)!==65533&&(i[n[217][e]]=55552+e,s[55552+e]=n[217][e]);for(n[218]="".split(""),e=0;e!=n[218].length;++e)n[218][e].charCodeAt(0)!==65533&&(i[n[218][e]]=55808+e,s[55808+e]=n[218][e]);for(n[219]="".split(""),e=0;e!=n[219].length;++e)n[219][e].charCodeAt(0)!==65533&&(i[n[219][e]]=56064+e,s[56064+e]=n[219][e]);for(n[220]="".split(""),e=0;e!=n[220].length;++e)n[220][e].charCodeAt(0)!==65533&&(i[n[220][e]]=56320+e,s[56320+e]=n[220][e]);for(n[221]="".split(""),e=0;e!=n[221].length;++e)n[221][e].charCodeAt(0)!==65533&&(i[n[221][e]]=56576+e,s[56576+e]=n[221][e]);for(n[222]="".split(""),e=0;e!=n[222].length;++e)n[222][e].charCodeAt(0)!==65533&&(i[n[222][e]]=56832+e,s[56832+e]=n[222][e]);for(n[223]="".split(""),e=0;e!=n[223].length;++e)n[223][e].charCodeAt(0)!==65533&&(i[n[223][e]]=57088+e,s[57088+e]=n[223][e]);for(n[224]="".split(""),e=0;e!=n[224].length;++e)n[224][e].charCodeAt(0)!==65533&&(i[n[224][e]]=57344+e,s[57344+e]=n[224][e]);for(n[225]="".split(""),e=0;e!=n[225].length;++e)n[225][e].charCodeAt(0)!==65533&&(i[n[225][e]]=57600+e,s[57600+e]=n[225][e]);for(n[226]="".split(""),e=0;e!=n[226].length;++e)n[226][e].charCodeAt(0)!==65533&&(i[n[226][e]]=57856+e,s[57856+e]=n[226][e]);for(n[227]="".split(""),e=0;e!=n[227].length;++e)n[227][e].charCodeAt(0)!==65533&&(i[n[227][e]]=58112+e,s[58112+e]=n[227][e]);for(n[228]="".split(""),e=0;e!=n[228].length;++e)n[228][e].charCodeAt(0)!==65533&&(i[n[228][e]]=58368+e,s[58368+e]=n[228][e]);for(n[229]="".split(""),e=0;e!=n[229].length;++e)n[229][e].charCodeAt(0)!==65533&&(i[n[229][e]]=58624+e,s[58624+e]=n[229][e]);for(n[230]="".split(""),e=0;e!=n[230].length;++e)n[230][e].charCodeAt(0)!==65533&&(i[n[230][e]]=58880+e,s[58880+e]=n[230][e]);for(n[231]="".split(""),e=0;e!=n[231].length;++e)n[231][e].charCodeAt(0)!==65533&&(i[n[231][e]]=59136+e,s[59136+e]=n[231][e]);for(n[232]="".split(""),e=0;e!=n[232].length;++e)n[232][e].charCodeAt(0)!==65533&&(i[n[232][e]]=59392+e,s[59392+e]=n[232][e]);for(n[233]="".split(""),e=0;e!=n[233].length;++e)n[233][e].charCodeAt(0)!==65533&&(i[n[233][e]]=59648+e,s[59648+e]=n[233][e]);for(n[234]="".split(""),e=0;e!=n[234].length;++e)n[234][e].charCodeAt(0)!==65533&&(i[n[234][e]]=59904+e,s[59904+e]=n[234][e]);for(n[235]="".split(""),e=0;e!=n[235].length;++e)n[235][e].charCodeAt(0)!==65533&&(i[n[235][e]]=60160+e,s[60160+e]=n[235][e]);for(n[236]="".split(""),e=0;e!=n[236].length;++e)n[236][e].charCodeAt(0)!==65533&&(i[n[236][e]]=60416+e,s[60416+e]=n[236][e]);for(n[237]="".split(""),e=0;e!=n[237].length;++e)n[237][e].charCodeAt(0)!==65533&&(i[n[237][e]]=60672+e,s[60672+e]=n[237][e]);for(n[238]="".split(""),e=0;e!=n[238].length;++e)n[238][e].charCodeAt(0)!==65533&&(i[n[238][e]]=60928+e,s[60928+e]=n[238][e]);for(n[239]="".split(""),e=0;e!=n[239].length;++e)n[239][e].charCodeAt(0)!==65533&&(i[n[239][e]]=61184+e,s[61184+e]=n[239][e]);for(n[240]="".split(""),e=0;e!=n[240].length;++e)n[240][e].charCodeAt(0)!==65533&&(i[n[240][e]]=61440+e,s[61440+e]=n[240][e]);for(n[241]="".split(""),e=0;e!=n[241].length;++e)n[241][e].charCodeAt(0)!==65533&&(i[n[241][e]]=61696+e,s[61696+e]=n[241][e]);for(n[242]="".split(""),e=0;e!=n[242].length;++e)n[242][e].charCodeAt(0)!==65533&&(i[n[242][e]]=61952+e,s[61952+e]=n[242][e]);for(n[243]="".split(""),e=0;e!=n[243].length;++e)n[243][e].charCodeAt(0)!==65533&&(i[n[243][e]]=62208+e,s[62208+e]=n[243][e]);for(n[244]="".split(""),e=0;e!=n[244].length;++e)n[244][e].charCodeAt(0)!==65533&&(i[n[244][e]]=62464+e,s[62464+e]=n[244][e]);for(n[245]="".split(""),e=0;e!=n[245].length;++e)n[245][e].charCodeAt(0)!==65533&&(i[n[245][e]]=62720+e,s[62720+e]=n[245][e]);for(n[246]="".split(""),e=0;e!=n[246].length;++e)n[246][e].charCodeAt(0)!==65533&&(i[n[246][e]]=62976+e,s[62976+e]=n[246][e]);for(n[247]="".split(""),e=0;e!=n[247].length;++e)n[247][e].charCodeAt(0)!==65533&&(i[n[247][e]]=63232+e,s[63232+e]=n[247][e]);for(n[248]="".split(""),e=0;e!=n[248].length;++e)n[248][e].charCodeAt(0)!==65533&&(i[n[248][e]]=63488+e,s[63488+e]=n[248][e]);for(n[249]="".split(""),e=0;e!=n[249].length;++e)n[249][e].charCodeAt(0)!==65533&&(i[n[249][e]]=63744+e,s[63744+e]=n[249][e]);return{enc:i,dec:s}}(),t[1250]=function(){for(var s=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],n={},e=0;e!=s.length;++e)s.charCodeAt(e)!==65533&&(n[s.charAt(e)]=e),i[e]=s.charAt(e);return{enc:n,dec:i}}(),t[1251]=function(){for(var s=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],n={},e=0;e!=s.length;++e)s.charCodeAt(e)!==65533&&(n[s.charAt(e)]=e),i[e]=s.charAt(e);return{enc:n,dec:i}}(),t[1252]=function(){for(var s=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],n={},e=0;e!=s.length;++e)s.charCodeAt(e)!==65533&&(n[s.charAt(e)]=e),i[e]=s.charAt(e);return{enc:n,dec:i}}(),t[1253]=function(){for(var s=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],n={},e=0;e!=s.length;++e)s.charCodeAt(e)!==65533&&(n[s.charAt(e)]=e),i[e]=s.charAt(e);return{enc:n,dec:i}}(),t[1254]=function(){for(var s=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],n={},e=0;e!=s.length;++e)s.charCodeAt(e)!==65533&&(n[s.charAt(e)]=e),i[e]=s.charAt(e);return{enc:n,dec:i}}(),t[1255]=function(){for(var s=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],n={},e=0;e!=s.length;++e)s.charCodeAt(e)!==65533&&(n[s.charAt(e)]=e),i[e]=s.charAt(e);return{enc:n,dec:i}}(),t[1256]=function(){for(var s=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],n={},e=0;e!=s.length;++e)s.charCodeAt(e)!==65533&&(n[s.charAt(e)]=e),i[e]=s.charAt(e);return{enc:n,dec:i}}(),t[1257]=function(){for(var s=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],n={},e=0;e!=s.length;++e)s.charCodeAt(e)!==65533&&(n[s.charAt(e)]=e),i[e]=s.charAt(e);return{enc:n,dec:i}}(),t[1258]=function(){for(var s=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],n={},e=0;e!=s.length;++e)s.charCodeAt(e)!==65533&&(n[s.charAt(e)]=e),i[e]=s.charAt(e);return{enc:n,dec:i}}(),t[1e4]=function(){for(var s=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],n={},e=0;e!=s.length;++e)s.charCodeAt(e)!==65533&&(n[s.charAt(e)]=e),i[e]=s.charAt(e);return{enc:n,dec:i}}(),t[10006]=function(){for(var s=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],n={},e=0;e!=s.length;++e)s.charCodeAt(e)!==65533&&(n[s.charAt(e)]=e),i[e]=s.charAt(e);return{enc:n,dec:i}}(),t[10007]=function(){for(var s=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],n={},e=0;e!=s.length;++e)s.charCodeAt(e)!==65533&&(n[s.charAt(e)]=e),i[e]=s.charAt(e);return{enc:n,dec:i}}(),t[10008]=function(){var s=[],i={},n=[],e;for(n[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),e=0;e!=n[0].length;++e)n[0][e].charCodeAt(0)!==65533&&(i[n[0][e]]=0+e,s[0+e]=n[0][e]);for(n[161]="".split(""),e=0;e!=n[161].length;++e)n[161][e].charCodeAt(0)!==65533&&(i[n[161][e]]=41216+e,s[41216+e]=n[161][e]);for(n[162]="".split(""),e=0;e!=n[162].length;++e)n[162][e].charCodeAt(0)!==65533&&(i[n[162][e]]=41472+e,s[41472+e]=n[162][e]);for(n[163]="".split(""),e=0;e!=n[163].length;++e)n[163][e].charCodeAt(0)!==65533&&(i[n[163][e]]=41728+e,s[41728+e]=n[163][e]);for(n[164]="".split(""),e=0;e!=n[164].length;++e)n[164][e].charCodeAt(0)!==65533&&(i[n[164][e]]=41984+e,s[41984+e]=n[164][e]);for(n[165]="".split(""),e=0;e!=n[165].length;++e)n[165][e].charCodeAt(0)!==65533&&(i[n[165][e]]=42240+e,s[42240+e]=n[165][e]);for(n[166]="".split(""),e=0;e!=n[166].length;++e)n[166][e].charCodeAt(0)!==65533&&(i[n[166][e]]=42496+e,s[42496+e]=n[166][e]);for(n[167]="".split(""),e=0;e!=n[167].length;++e)n[167][e].charCodeAt(0)!==65533&&(i[n[167][e]]=42752+e,s[42752+e]=n[167][e]);for(n[168]="".split(""),e=0;e!=n[168].length;++e)n[168][e].charCodeAt(0)!==65533&&(i[n[168][e]]=43008+e,s[43008+e]=n[168][e]);for(n[169]="".split(""),e=0;e!=n[169].length;++e)n[169][e].charCodeAt(0)!==65533&&(i[n[169][e]]=43264+e,s[43264+e]=n[169][e]);for(n[176]="".split(""),e=0;e!=n[176].length;++e)n[176][e].charCodeAt(0)!==65533&&(i[n[176][e]]=45056+e,s[45056+e]=n[176][e]);for(n[177]="".split(""),e=0;e!=n[177].length;++e)n[177][e].charCodeAt(0)!==65533&&(i[n[177][e]]=45312+e,s[45312+e]=n[177][e]);for(n[178]="".split(""),e=0;e!=n[178].length;++e)n[178][e].charCodeAt(0)!==65533&&(i[n[178][e]]=45568+e,s[45568+e]=n[178][e]);for(n[179]="".split(""),e=0;e!=n[179].length;++e)n[179][e].charCodeAt(0)!==65533&&(i[n[179][e]]=45824+e,s[45824+e]=n[179][e]);for(n[180]="".split(""),e=0;e!=n[180].length;++e)n[180][e].charCodeAt(0)!==65533&&(i[n[180][e]]=46080+e,s[46080+e]=n[180][e]);for(n[181]="".split(""),e=0;e!=n[181].length;++e)n[181][e].charCodeAt(0)!==65533&&(i[n[181][e]]=46336+e,s[46336+e]=n[181][e]);for(n[182]="".split(""),e=0;e!=n[182].length;++e)n[182][e].charCodeAt(0)!==65533&&(i[n[182][e]]=46592+e,s[46592+e]=n[182][e]);for(n[183]="".split(""),e=0;e!=n[183].length;++e)n[183][e].charCodeAt(0)!==65533&&(i[n[183][e]]=46848+e,s[46848+e]=n[183][e]);for(n[184]="".split(""),e=0;e!=n[184].length;++e)n[184][e].charCodeAt(0)!==65533&&(i[n[184][e]]=47104+e,s[47104+e]=n[184][e]);for(n[185]="".split(""),e=0;e!=n[185].length;++e)n[185][e].charCodeAt(0)!==65533&&(i[n[185][e]]=47360+e,s[47360+e]=n[185][e]);for(n[186]="".split(""),e=0;e!=n[186].length;++e)n[186][e].charCodeAt(0)!==65533&&(i[n[186][e]]=47616+e,s[47616+e]=n[186][e]);for(n[187]="".split(""),e=0;e!=n[187].length;++e)n[187][e].charCodeAt(0)!==65533&&(i[n[187][e]]=47872+e,s[47872+e]=n[187][e]);for(n[188]="".split(""),e=0;e!=n[188].length;++e)n[188][e].charCodeAt(0)!==65533&&(i[n[188][e]]=48128+e,s[48128+e]=n[188][e]);for(n[189]="".split(""),e=0;e!=n[189].length;++e)n[189][e].charCodeAt(0)!==65533&&(i[n[189][e]]=48384+e,s[48384+e]=n[189][e]);for(n[190]="".split(""),e=0;e!=n[190].length;++e)n[190][e].charCodeAt(0)!==65533&&(i[n[190][e]]=48640+e,s[48640+e]=n[190][e]);for(n[191]="".split(""),e=0;e!=n[191].length;++e)n[191][e].charCodeAt(0)!==65533&&(i[n[191][e]]=48896+e,s[48896+e]=n[191][e]);for(n[192]="".split(""),e=0;e!=n[192].length;++e)n[192][e].charCodeAt(0)!==65533&&(i[n[192][e]]=49152+e,s[49152+e]=n[192][e]);for(n[193]="".split(""),e=0;e!=n[193].length;++e)n[193][e].charCodeAt(0)!==65533&&(i[n[193][e]]=49408+e,s[49408+e]=n[193][e]);for(n[194]="".split(""),e=0;e!=n[194].length;++e)n[194][e].charCodeAt(0)!==65533&&(i[n[194][e]]=49664+e,s[49664+e]=n[194][e]);for(n[195]="".split(""),e=0;e!=n[195].length;++e)n[195][e].charCodeAt(0)!==65533&&(i[n[195][e]]=49920+e,s[49920+e]=n[195][e]);for(n[196]="".split(""),e=0;e!=n[196].length;++e)n[196][e].charCodeAt(0)!==65533&&(i[n[196][e]]=50176+e,s[50176+e]=n[196][e]);for(n[197]="".split(""),e=0;e!=n[197].length;++e)n[197][e].charCodeAt(0)!==65533&&(i[n[197][e]]=50432+e,s[50432+e]=n[197][e]);for(n[198]="".split(""),e=0;e!=n[198].length;++e)n[198][e].charCodeAt(0)!==65533&&(i[n[198][e]]=50688+e,s[50688+e]=n[198][e]);for(n[199]="".split(""),e=0;e!=n[199].length;++e)n[199][e].charCodeAt(0)!==65533&&(i[n[199][e]]=50944+e,s[50944+e]=n[199][e]);for(n[200]="".split(""),e=0;e!=n[200].length;++e)n[200][e].charCodeAt(0)!==65533&&(i[n[200][e]]=51200+e,s[51200+e]=n[200][e]);for(n[201]="".split(""),e=0;e!=n[201].length;++e)n[201][e].charCodeAt(0)!==65533&&(i[n[201][e]]=51456+e,s[51456+e]=n[201][e]);for(n[202]="".split(""),e=0;e!=n[202].length;++e)n[202][e].charCodeAt(0)!==65533&&(i[n[202][e]]=51712+e,s[51712+e]=n[202][e]);for(n[203]="".split(""),e=0;e!=n[203].length;++e)n[203][e].charCodeAt(0)!==65533&&(i[n[203][e]]=51968+e,s[51968+e]=n[203][e]);for(n[204]="".split(""),e=0;e!=n[204].length;++e)n[204][e].charCodeAt(0)!==65533&&(i[n[204][e]]=52224+e,s[52224+e]=n[204][e]);for(n[205]="".split(""),e=0;e!=n[205].length;++e)n[205][e].charCodeAt(0)!==65533&&(i[n[205][e]]=52480+e,s[52480+e]=n[205][e]);for(n[206]="".split(""),e=0;e!=n[206].length;++e)n[206][e].charCodeAt(0)!==65533&&(i[n[206][e]]=52736+e,s[52736+e]=n[206][e]);for(n[207]="".split(""),e=0;e!=n[207].length;++e)n[207][e].charCodeAt(0)!==65533&&(i[n[207][e]]=52992+e,s[52992+e]=n[207][e]);for(n[208]="".split(""),e=0;e!=n[208].length;++e)n[208][e].charCodeAt(0)!==65533&&(i[n[208][e]]=53248+e,s[53248+e]=n[208][e]);for(n[209]="".split(""),e=0;e!=n[209].length;++e)n[209][e].charCodeAt(0)!==65533&&(i[n[209][e]]=53504+e,s[53504+e]=n[209][e]);for(n[210]="".split(""),e=0;e!=n[210].length;++e)n[210][e].charCodeAt(0)!==65533&&(i[n[210][e]]=53760+e,s[53760+e]=n[210][e]);for(n[211]="".split(""),e=0;e!=n[211].length;++e)n[211][e].charCodeAt(0)!==65533&&(i[n[211][e]]=54016+e,s[54016+e]=n[211][e]);for(n[212]="".split(""),e=0;e!=n[212].length;++e)n[212][e].charCodeAt(0)!==65533&&(i[n[212][e]]=54272+e,s[54272+e]=n[212][e]);for(n[213]="".split(""),e=0;e!=n[213].length;++e)n[213][e].charCodeAt(0)!==65533&&(i[n[213][e]]=54528+e,s[54528+e]=n[213][e]);for(n[214]="".split(""),e=0;e!=n[214].length;++e)n[214][e].charCodeAt(0)!==65533&&(i[n[214][e]]=54784+e,s[54784+e]=n[214][e]);for(n[215]="".split(""),e=0;e!=n[215].length;++e)n[215][e].charCodeAt(0)!==65533&&(i[n[215][e]]=55040+e,s[55040+e]=n[215][e]);for(n[216]="".split(""),e=0;e!=n[216].length;++e)n[216][e].charCodeAt(0)!==65533&&(i[n[216][e]]=55296+e,s[55296+e]=n[216][e]);for(n[217]="".split(""),e=0;e!=n[217].length;++e)n[217][e].charCodeAt(0)!==65533&&(i[n[217][e]]=55552+e,s[55552+e]=n[217][e]);for(n[218]="".split(""),e=0;e!=n[218].length;++e)n[218][e].charCodeAt(0)!==65533&&(i[n[218][e]]=55808+e,s[55808+e]=n[218][e]);for(n[219]="".split(""),e=0;e!=n[219].length;++e)n[219][e].charCodeAt(0)!==65533&&(i[n[219][e]]=56064+e,s[56064+e]=n[219][e]);for(n[220]="".split(""),e=0;e!=n[220].length;++e)n[220][e].charCodeAt(0)!==65533&&(i[n[220][e]]=56320+e,s[56320+e]=n[220][e]);for(n[221]="".split(""),e=0;e!=n[221].length;++e)n[221][e].charCodeAt(0)!==65533&&(i[n[221][e]]=56576+e,s[56576+e]=n[221][e]);for(n[222]="".split(""),e=0;e!=n[222].length;++e)n[222][e].charCodeAt(0)!==65533&&(i[n[222][e]]=56832+e,s[56832+e]=n[222][e]);for(n[223]="".split(""),e=0;e!=n[223].length;++e)n[223][e].charCodeAt(0)!==65533&&(i[n[223][e]]=57088+e,s[57088+e]=n[223][e]);for(n[224]="".split(""),e=0;e!=n[224].length;++e)n[224][e].charCodeAt(0)!==65533&&(i[n[224][e]]=57344+e,s[57344+e]=n[224][e]);for(n[225]="".split(""),e=0;e!=n[225].length;++e)n[225][e].charCodeAt(0)!==65533&&(i[n[225][e]]=57600+e,s[57600+e]=n[225][e]);for(n[226]="".split(""),e=0;e!=n[226].length;++e)n[226][e].charCodeAt(0)!==65533&&(i[n[226][e]]=57856+e,s[57856+e]=n[226][e]);for(n[227]="".split(""),e=0;e!=n[227].length;++e)n[227][e].charCodeAt(0)!==65533&&(i[n[227][e]]=58112+e,s[58112+e]=n[227][e]);for(n[228]="".split(""),e=0;e!=n[228].length;++e)n[228][e].charCodeAt(0)!==65533&&(i[n[228][e]]=58368+e,s[58368+e]=n[228][e]);for(n[229]="".split(""),e=0;e!=n[229].length;++e)n[229][e].charCodeAt(0)!==65533&&(i[n[229][e]]=58624+e,s[58624+e]=n[229][e]);for(n[230]="".split(""),e=0;e!=n[230].length;++e)n[230][e].charCodeAt(0)!==65533&&(i[n[230][e]]=58880+e,s[58880+e]=n[230][e]);for(n[231]="".split(""),e=0;e!=n[231].length;++e)n[231][e].charCodeAt(0)!==65533&&(i[n[231][e]]=59136+e,s[59136+e]=n[231][e]);for(n[232]="".split(""),e=0;e!=n[232].length;++e)n[232][e].charCodeAt(0)!==65533&&(i[n[232][e]]=59392+e,s[59392+e]=n[232][e]);for(n[233]="".split(""),e=0;e!=n[233].length;++e)n[233][e].charCodeAt(0)!==65533&&(i[n[233][e]]=59648+e,s[59648+e]=n[233][e]);for(n[234]="".split(""),e=0;e!=n[234].length;++e)n[234][e].charCodeAt(0)!==65533&&(i[n[234][e]]=59904+e,s[59904+e]=n[234][e]);for(n[235]="".split(""),e=0;e!=n[235].length;++e)n[235][e].charCodeAt(0)!==65533&&(i[n[235][e]]=60160+e,s[60160+e]=n[235][e]);for(n[236]="".split(""),e=0;e!=n[236].length;++e)n[236][e].charCodeAt(0)!==65533&&(i[n[236][e]]=60416+e,s[60416+e]=n[236][e]);for(n[237]="".split(""),e=0;e!=n[237].length;++e)n[237][e].charCodeAt(0)!==65533&&(i[n[237][e]]=60672+e,s[60672+e]=n[237][e]);for(n[238]="".split(""),e=0;e!=n[238].length;++e)n[238][e].charCodeAt(0)!==65533&&(i[n[238][e]]=60928+e,s[60928+e]=n[238][e]);for(n[239]="".split(""),e=0;e!=n[239].length;++e)n[239][e].charCodeAt(0)!==65533&&(i[n[239][e]]=61184+e,s[61184+e]=n[239][e]);for(n[240]="".split(""),e=0;e!=n[240].length;++e)n[240][e].charCodeAt(0)!==65533&&(i[n[240][e]]=61440+e,s[61440+e]=n[240][e]);for(n[241]="".split(""),e=0;e!=n[241].length;++e)n[241][e].charCodeAt(0)!==65533&&(i[n[241][e]]=61696+e,s[61696+e]=n[241][e]);for(n[242]="".split(""),e=0;e!=n[242].length;++e)n[242][e].charCodeAt(0)!==65533&&(i[n[242][e]]=61952+e,s[61952+e]=n[242][e]);for(n[243]="".split(""),e=0;e!=n[243].length;++e)n[243][e].charCodeAt(0)!==65533&&(i[n[243][e]]=62208+e,s[62208+e]=n[243][e]);for(n[244]="".split(""),e=0;e!=n[244].length;++e)n[244][e].charCodeAt(0)!==65533&&(i[n[244][e]]=62464+e,s[62464+e]=n[244][e]);for(n[245]="".split(""),e=0;e!=n[245].length;++e)n[245][e].charCodeAt(0)!==65533&&(i[n[245][e]]=62720+e,s[62720+e]=n[245][e]);for(n[246]="".split(""),e=0;e!=n[246].length;++e)n[246][e].charCodeAt(0)!==65533&&(i[n[246][e]]=62976+e,s[62976+e]=n[246][e]);for(n[247]="".split(""),e=0;e!=n[247].length;++e)n[247][e].charCodeAt(0)!==65533&&(i[n[247][e]]=63232+e,s[63232+e]=n[247][e]);return{enc:i,dec:s}}(),t[10029]=function(){for(var s=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],n={},e=0;e!=s.length;++e)s.charCodeAt(e)!==65533&&(n[s.charAt(e)]=e),i[e]=s.charAt(e);return{enc:n,dec:i}}(),t[10079]=function(){for(var s=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],n={},e=0;e!=s.length;++e)s.charCodeAt(e)!==65533&&(n[s.charAt(e)]=e),i[e]=s.charAt(e);return{enc:n,dec:i}}(),t[10081]=function(){for(var s=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],n={},e=0;e!=s.length;++e)s.charCodeAt(e)!==65533&&(n[s.charAt(e)]=e),i[e]=s.charAt(e);return{enc:n,dec:i}}(),t[28591]=function(){for(var s=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],n={},e=0;e!=s.length;++e)s.charCodeAt(e)!==65533&&(n[s.charAt(e)]=e),i[e]=s.charAt(e);return{enc:n,dec:i}}(),r.exports&&typeof DO_NOT_EXPORT_CODEPAGE>"u"&&(r.exports=t);/*! cputils.js (C) 2013-present SheetJS -- http://sheetjs.com */(function(s,i){if(typeof t>"u")if(typeof Fd<"u"){var n=t;r.exports&&typeof DO_NOT_EXPORT_CODEPAGE>"u"?r.exports=i(n):s.cptable=i(n)}else throw new Error("cptable not found");else t=i(t)})(gA,function(s){var i={1200:"utf16le",1201:"utf16be",12e3:"utf32le",12001:"utf32be",16969:"utf64le",20127:"ascii",65e3:"utf7",65001:"utf8"},n=[874,1250,1251,1252,1253,1254,1255,1256,1e4],e=[932,936,949,950],p=[65001],x={},w={},E={},N={},P=function(ye){return String.fromCharCode(ye)},R=function(ye){return ye.charCodeAt(0)},q=typeof Buffer<"u",Z=function(){};if(q){var ne=!Buffer.from;if(!ne)try{Buffer.from("foo","utf8")}catch{ne=!0}Z=ne?function(Ve,ye){return ye?new Buffer(Ve,ye):new Buffer(Ve)}:Buffer.from.bind(Buffer),Buffer.allocUnsafe||(Buffer.allocUnsafe=function(Ve){return new Buffer(Ve)});var fe=1024,G=Buffer.allocUnsafe(fe),U=function(ye){for(var oe=Buffer.allocUnsafe(65536),Fe=0;Fe<65536;++Fe)oe[Fe]=0;for(var Oe=Object.keys(ye),Re=Oe.length,de=0,Ce=Oe[de];de<Re;++de)(Ce=Oe[de])&&(oe[Ce.charCodeAt(0)]=ye[Ce]);return oe},H=function(ye){var oe=U(s[ye].enc);return function(Oe,Re){var de=Oe.length,Ce,ce=0,Et=0,Xe=0,zt=0;if(typeof Oe=="string")for(Ce=Buffer.allocUnsafe(de),ce=0;ce<de;++ce)Ce[ce]=oe[Oe.charCodeAt(ce)];else if(Buffer.isBuffer(Oe)){for(Ce=Buffer.allocUnsafe(2*de),Et=0,ce=0;ce<de;++ce)Xe=Oe[ce],Xe<128?Ce[Et++]=oe[Xe]:Xe<224?(Ce[Et++]=oe[((Xe&31)<<6)+(Oe[ce+1]&63)],++ce):Xe<240?(Ce[Et++]=oe[((Xe&15)<<12)+((Oe[ce+1]&63)<<6)+(Oe[ce+2]&63)],ce+=2):(zt=((Xe&7)<<18)+((Oe[ce+1]&63)<<12)+((Oe[ce+2]&63)<<6)+(Oe[ce+3]&63),ce+=3,zt<65536?Ce[Et++]=oe[zt]:(zt-=65536,Ce[Et++]=oe[55296+(zt>>10&1023)],Ce[Et++]=oe[56320+(zt&1023)]));Ce=Ce.slice(0,Et)}else for(Ce=Buffer.allocUnsafe(de),ce=0;ce<de;++ce)Ce[ce]=oe[Oe[ce].charCodeAt(0)];return!Re||Re==="buf"?Ce:Re!=="arr"?Ce.toString("binary"):[].slice.call(Ce)}},ee=function(ye){var oe=s[ye].dec,Fe=Buffer.allocUnsafe(131072),Oe=0,Re="";for(Oe=0;Oe<oe.length;++Oe)if(Re=oe[Oe]){var de=Re.charCodeAt(0);Fe[2*Oe]=de&255,Fe[2*Oe+1]=de>>8}return function(ce){var Et=ce.length,Xe=0,zt=0;if(2*Et>fe&&(fe=2*Et,G=Buffer.allocUnsafe(fe)),Buffer.isBuffer(ce))for(Xe=0;Xe<Et;Xe++)zt=2*ce[Xe],G[2*Xe]=Fe[zt],G[2*Xe+1]=Fe[zt+1];else if(typeof ce=="string")for(Xe=0;Xe<Et;Xe++)zt=2*ce.charCodeAt(Xe),G[2*Xe]=Fe[zt],G[2*Xe+1]=Fe[zt+1];else for(Xe=0;Xe<Et;Xe++)zt=2*ce[Xe],G[2*Xe]=Fe[zt],G[2*Xe+1]=Fe[zt+1];return G.slice(0,2*Et).toString("ucs2")}},te=function(ye){for(var oe=s[ye].enc,Fe=Buffer.allocUnsafe(131072),Oe=0;Oe<131072;++Oe)Fe[Oe]=0;for(var Re=Object.keys(oe),de=0,Ce=Re[de];de<Re.length;++de)if(Ce=Re[de]){var ce=Ce.charCodeAt(0);Fe[2*ce]=oe[Ce]&255,Fe[2*ce+1]=oe[Ce]>>8}return function(Xe,zt){var or=Xe.length,vt=Buffer.allocUnsafe(2*or),Ct=0,pt=0,Rr=0,er=0,Pr=0;if(typeof Xe=="string"){for(Ct=er=0;Ct<or;++Ct)pt=Xe.charCodeAt(Ct)*2,vt[er++]=Fe[pt+1]||Fe[pt],Fe[pt+1]>0&&(vt[er++]=Fe[pt]);vt=vt.slice(0,er)}else if(Buffer.isBuffer(Xe)){for(Ct=er=0;Ct<or;++Ct)Pr=Xe[Ct],Pr<128?pt=Pr:Pr<224?(pt=((Pr&31)<<6)+(Xe[Ct+1]&63),++Ct):Pr<240?(pt=((Pr&15)<<12)+((Xe[Ct+1]&63)<<6)+(Xe[Ct+2]&63),Ct+=2):(pt=((Pr&7)<<18)+((Xe[Ct+1]&63)<<12)+((Xe[Ct+2]&63)<<6)+(Xe[Ct+3]&63),Ct+=3),pt<65536?(pt*=2,vt[er++]=Fe[pt+1]||Fe[pt],Fe[pt+1]>0&&(vt[er++]=Fe[pt])):(Rr=pt-65536,pt=2*(55296+(Rr>>10&1023)),vt[er++]=Fe[pt+1]||Fe[pt],Fe[pt+1]>0&&(vt[er++]=Fe[pt]),pt=2*(56320+(Rr&1023)),vt[er++]=Fe[pt+1]||Fe[pt],Fe[pt+1]>0&&(vt[er++]=Fe[pt]));vt=vt.slice(0,er)}else for(Ct=er=0;Ct<or;Ct++)pt=Xe[Ct].charCodeAt(0)*2,vt[er++]=Fe[pt+1]||Fe[pt],Fe[pt+1]>0&&(vt[er++]=Fe[pt]);return!zt||zt==="buf"?vt:zt!=="arr"?vt.toString("binary"):[].slice.call(vt)}},ue=function(ye){var oe=s[ye].dec,Fe=Buffer.allocUnsafe(131072),Oe=0,Re,de=0,Ce=0,ce=0;for(ce=0;ce<65536;++ce)Fe[2*ce]=255,Fe[2*ce+1]=253;for(Oe=0;Oe<oe.length;++Oe)(Re=oe[Oe])&&(de=Re.charCodeAt(0),Ce=2*Oe,Fe[Ce]=de&255,Fe[Ce+1]=de>>8);return function(Xe){var zt=Xe.length,or=Buffer.allocUnsafe(2*zt),vt=0,Ct=0,pt=0;if(Buffer.isBuffer(Xe))for(vt=0;vt<zt;vt++)Ct=2*Xe[vt],Fe[Ct]===255&&Fe[Ct+1]===253&&(Ct=2*((Xe[vt]<<8)+Xe[vt+1]),++vt),or[pt++]=Fe[Ct],or[pt++]=Fe[Ct+1];else if(typeof Xe=="string")for(vt=0;vt<zt;vt++)Ct=2*Xe.charCodeAt(vt),Fe[Ct]===255&&Fe[Ct+1]===253&&(Ct=2*((Xe.charCodeAt(vt)<<8)+Xe.charCodeAt(vt+1)),++vt),or[pt++]=Fe[Ct],or[pt++]=Fe[Ct+1];else for(vt=0;vt<zt;vt++)Ct=2*Xe[vt],Fe[Ct]===255&&Fe[Ct+1]===253&&(Ct=2*((Xe[vt]<<8)+Xe[vt+1]),++vt),or[pt++]=Fe[Ct],or[pt++]=Fe[Ct+1];return or.slice(0,pt).toString("ucs2")}};x[65001]=function Ve(ye){if(typeof ye=="string")return Ve(ye.split("").map(R));var oe=ye.length,Fe=0,Oe=0;4*oe>fe&&(fe=4*oe,G=Buffer.allocUnsafe(fe));var Re=0;oe>=3&&ye[0]==239&&ye[1]==187&&ye[2]==191&&(Re=3);for(var de=1,Ce=0,ce=0;Re<oe;Re+=de)de=1,ce=ye[Re],ce<128?Fe=ce:ce<224?(Fe=(ce&31)*64+(ye[Re+1]&63),de=2):ce<240?(Fe=((ce&15)<<12)+(ye[Re+1]&63)*64+(ye[Re+2]&63),de=3):(Fe=(ce&7)*262144+((ye[Re+1]&63)<<12)+(ye[Re+2]&63)*64+(ye[Re+3]&63),de=4),Fe<65536?(G[Ce++]=Fe&255,G[Ce++]=Fe>>8):(Fe-=65536,Oe=55296+(Fe>>10&1023),Fe=56320+(Fe&1023),G[Ce++]=Oe&255,G[Ce++]=Oe>>>8,G[Ce++]=Fe&255,G[Ce++]=Fe>>>8&255);return G.slice(0,Ce).toString("ucs2")},w[65001]=function(ye,oe){if(q&&Buffer.isBuffer(ye))return!oe||oe==="buf"?ye:oe!=="arr"?ye.toString("binary"):[].slice.call(ye);var Fe=ye.length,Oe=0,Re=0,de=0,Ce=typeof ye=="string";4*Fe>fe&&(fe=4*Fe,G=Buffer.allocUnsafe(fe));for(var ce=0;ce<Fe;++ce)Oe=Ce?ye.charCodeAt(ce):ye[ce].charCodeAt(0),Oe<=127?G[de++]=Oe:Oe<=2047?(G[de++]=192+(Oe>>6),G[de++]=128+(Oe&63)):Oe>=55296&&Oe<=57343?(Oe-=55296,++ce,Re=(Ce?ye.charCodeAt(ce):ye[ce].charCodeAt(0))-56320+(Oe<<10),G[de++]=240+(Re>>>18&7),G[de++]=144+(Re>>>12&63),G[de++]=128+(Re>>>6&63),G[de++]=128+(Re&63)):(G[de++]=224+(Oe>>12),G[de++]=128+(Oe>>6&63),G[de++]=128+(Oe&63));return!oe||oe==="buf"?G.slice(0,de):oe!=="arr"?G.slice(0,de).toString("binary"):[].slice.call(G,0,de)}}var L=function(){if(q){if(E[n[0]])return;var ye=0,oe=0;for(ye=0;ye<n.length;++ye)oe=n[ye],s[oe]&&(E[oe]=ee(oe),N[oe]=H(oe));for(ye=0;ye<e.length;++ye)oe=e[ye],s[oe]&&(E[oe]=ue(oe),N[oe]=te(oe));for(ye=0;ye<p.length;++ye)oe=p[ye],x[oe]&&(E[oe]=x[oe]),w[oe]&&(N[oe]=w[oe])}},O=function(Ve,ye){return""},V=function(ye){delete E[ye],delete N[ye]},W=function(){if(q){if(!E[n[0]])return;n.forEach(V),e.forEach(V),p.forEach(V)}me=O,He=0},J={encache:L,decache:W,sbcs:n,dbcs:e};L();var X="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",K="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'(),-./:?",me=O,He=0,fr=function Ve(ye,oe,Fe){if(ye===He&&me)return me(oe,Fe);if(N[ye])return me=N[He=ye],me(oe,Fe);q&&Buffer.isBuffer(oe)&&(oe=oe.toString("utf8"));var Oe=oe.length,Re=q?Buffer.allocUnsafe(4*Oe):[],de=0,Ce=0,ce=0,Et=0,Xe=s[ye],zt,or="",vt=typeof oe=="string";if(Xe&&(zt=Xe.enc))for(Ce=0;Ce<Oe;++Ce,++ce)de=zt[vt?oe.charAt(Ce):oe[Ce]],de>255?(Re[ce]=de>>8,Re[++ce]=de&255):Re[ce]=de&255;else if(or=i[ye])switch(or){case"utf8":if(q&&vt){Re=Z(oe,or),ce=Re.length;break}for(Ce=0;Ce<Oe;++Ce,++ce)de=vt?oe.charCodeAt(Ce):oe[Ce].charCodeAt(0),de<=127?Re[ce]=de:de<=2047?(Re[ce]=192+(de>>6),Re[++ce]=128+(de&63)):de>=55296&&de<=57343?(de-=55296,Et=(vt?oe.charCodeAt(++Ce):oe[++Ce].charCodeAt(0))-56320+(de<<10),Re[ce]=240+(Et>>>18&7),Re[++ce]=144+(Et>>>12&63),Re[++ce]=128+(Et>>>6&63),Re[++ce]=128+(Et&63)):(Re[ce]=224+(de>>12),Re[++ce]=128+(de>>6&63),Re[++ce]=128+(de&63));break;case"ascii":if(q&&typeof oe=="string"){Re=Z(oe,or),ce=Re.length;break}for(Ce=0;Ce<Oe;++Ce,++ce)if(de=vt?oe.charCodeAt(Ce):oe[Ce].charCodeAt(0),de<=127)Re[ce]=de;else throw new Error("bad ascii "+de);break;case"utf16le":if(q&&typeof oe=="string"){Re=Z(oe,or),ce=Re.length;break}for(Ce=0;Ce<Oe;++Ce)de=vt?oe.charCodeAt(Ce):oe[Ce].charCodeAt(0),Re[ce++]=de&255,Re[ce++]=de>>8;break;case"utf16be":for(Ce=0;Ce<Oe;++Ce)de=vt?oe.charCodeAt(Ce):oe[Ce].charCodeAt(0),Re[ce++]=de>>8,Re[ce++]=de&255;break;case"utf32le":for(Ce=0;Ce<Oe;++Ce)de=vt?oe.charCodeAt(Ce):oe[Ce].charCodeAt(0),de>=55296&&de<=57343&&(de=65536+(de-55296<<10)+(oe[++Ce].charCodeAt(0)-56320)),Re[ce++]=de&255,de>>=8,Re[ce++]=de&255,de>>=8,Re[ce++]=de&255,de>>=8,Re[ce++]=de&255;break;case"utf32be":for(Ce=0;Ce<Oe;++Ce)de=vt?oe.charCodeAt(Ce):oe[Ce].charCodeAt(0),de>=55296&&de<=57343&&(de=65536+(de-55296<<10)+(oe[++Ce].charCodeAt(0)-56320)),Re[ce+3]=de&255,de>>=8,Re[ce+2]=de&255,de>>=8,Re[ce+1]=de&255,de>>=8,Re[ce]=de&255,ce+=4;break;case"utf7":for(Ce=0;Ce<Oe;Ce++){var Ct=vt?oe.charAt(Ce):oe[Ce].charAt(0);if(Ct==="+"){Re[ce++]=43,Re[ce++]=45;continue}if(K.indexOf(Ct)>-1){Re[ce++]=Ct.charCodeAt(0);continue}var pt=Ve(1201,Ct);Re[ce++]=43,Re[ce++]=X.charCodeAt(pt[0]>>2),Re[ce++]=X.charCodeAt(((pt[0]&3)<<4)+((pt[1]||0)>>4)),Re[ce++]=X.charCodeAt(((pt[1]&15)<<2)+((pt[2]||0)>>6)),Re[ce++]=45}break;default:throw new Error("Unsupported magic: "+ye+" "+i[ye])}else throw new Error("Unrecognized CP: "+ye);return Re=Re.slice(0,ce),q?!Fe||Fe==="buf"?Re:Fe!=="arr"?Re.toString("binary"):[].slice.call(Re):Fe=="str"?Re.map(P).join(""):Re},at=function Ve(ye,oe){var Fe;if(Fe=E[ye])return Fe(oe);if(typeof oe=="string")return Ve(ye,oe.split("").map(R));var Oe=oe.length,Re=new Array(Oe),de="",Ce=0,ce=0,Et=1,Xe=0,zt=0,or=s[ye],vt,Ct="";if(or&&(vt=or.dec))for(ce=0;ce<Oe;ce+=Et){if(Et=2,de=vt[(oe[ce]<<8)+oe[ce+1]],de||(Et=1,de=vt[oe[ce]]),!de)throw new Error("Unrecognized code: "+oe[ce]+" "+oe[ce+Et-1]+" "+ce+" "+Et+" "+vt[oe[ce]]);Re[Xe++]=de}else if(Ct=i[ye])switch(Ct){case"utf8":for(Oe>=3&&oe[0]==239&&oe[1]==187&&oe[2]==191&&(ce=3);ce<Oe;ce+=Et)Et=1,oe[ce]<128?Ce=oe[ce]:oe[ce]<224?(Ce=(oe[ce]&31)*64+(oe[ce+1]&63),Et=2):oe[ce]<240?(Ce=((oe[ce]&15)<<12)+(oe[ce+1]&63)*64+(oe[ce+2]&63),Et=3):(Ce=(oe[ce]&7)*262144+((oe[ce+1]&63)<<12)+(oe[ce+2]&63)*64+(oe[ce+3]&63),Et=4),Ce<65536||(Ce-=65536,zt=55296+(Ce>>10&1023),Ce=56320+(Ce&1023),Re[Xe++]=String.fromCharCode(zt)),Re[Xe++]=String.fromCharCode(Ce);break;case"ascii":if(q&&Buffer.isBuffer(oe))return oe.toString(Ct);for(ce=0;ce<Oe;ce++)Re[ce]=String.fromCharCode(oe[ce]);Xe=Oe;break;case"utf16le":if(Oe>=2&&oe[0]==255&&oe[1]==254&&(ce=2),q&&Buffer.isBuffer(oe))return oe.toString(Ct);for(Et=2;ce+1<Oe;ce+=Et)Re[Xe++]=String.fromCharCode((oe[ce+1]<<8)+oe[ce]);break;case"utf16be":for(Oe>=2&&oe[0]==254&&oe[1]==255&&(ce=2),Et=2;ce+1<Oe;ce+=Et)Re[Xe++]=String.fromCharCode((oe[ce]<<8)+oe[ce+1]);break;case"utf32le":for(Oe>=4&&oe[0]==255&&oe[1]==254&&oe[2]===0&&oe[3]===0&&(ce=4),Et=4;ce<Oe;ce+=Et)Ce=(oe[ce+3]<<24)+(oe[ce+2]<<16)+(oe[ce+1]<<8)+oe[ce],Ce>65535?(Ce-=65536,Re[Xe++]=String.fromCharCode(55296+(Ce>>10&1023)),Re[Xe++]=String.fromCharCode(56320+(Ce&1023))):Re[Xe++]=String.fromCharCode(Ce);break;case"utf32be":for(Oe>=4&&oe[3]==255&&oe[2]==254&&oe[1]===0&&oe[0]===0&&(ce=4),Et=4;ce<Oe;ce+=Et)Ce=(oe[ce]<<24)+(oe[ce+1]<<16)+(oe[ce+2]<<8)+oe[ce+3],Ce>65535?(Ce-=65536,Re[Xe++]=String.fromCharCode(55296+(Ce>>10&1023)),Re[Xe++]=String.fromCharCode(56320+(Ce&1023))):Re[Xe++]=String.fromCharCode(Ce);break;case"utf7":for(Oe>=4&&oe[0]==43&&oe[1]==47&&oe[2]==118&&(Oe>=5&&oe[3]==56&&oe[4]==45?ce=5:(oe[3]==56||oe[3]==57||oe[3]==43||oe[3]==47)&&(ce=4));ce<Oe;ce+=Et){if(oe[ce]!==43){Et=1,Re[Xe++]=String.fromCharCode(oe[ce]);continue}if(Et=1,oe[ce+1]===45){Et=2,Re[Xe++]="+";continue}for(;String.fromCharCode(oe[ce+Et]).match(/[A-Za-z0-9+\/]/);)Et++;var pt=0;oe[ce+Et]===45&&(++Et,pt=1);for(var Rr=[],er="",Pr=0,Ke=0,jt=0,mt=0,Vt=0,Qt=0,lr=0,hn=1;hn<Et-pt&&(mt=X.indexOf(String.fromCharCode(oe[ce+hn++])),Vt=X.indexOf(String.fromCharCode(oe[ce+hn++])),Pr=mt<<2|Vt>>4,Rr.push(Pr),Qt=X.indexOf(String.fromCharCode(oe[ce+hn++])),!(Qt===-1||(Ke=(Vt&15)<<4|Qt>>2,Rr.push(Ke),lr=X.indexOf(String.fromCharCode(oe[ce+hn++])),lr===-1)));)jt=(Qt&3)<<6|lr,lr<64&&Rr.push(jt);for(er=Ve(1201,Rr),hn=0;hn<er.length;++hn)Re[Xe++]=er.charAt(hn)}break;default:throw new Error("Unsupported magic: "+ye+" "+i[ye])}else throw new Error("Unrecognized CP: "+ye);return Re.slice(0,Xe).join("")},$e=function(ye){return!!(s[ye]||i[ye])};return s.utils={decode:at,encode:fr,hascp:$e,magic:i,cache:J},s})}($1)),$1.exports}const x7={},b7=Object.freeze(Object.defineProperty({__proto__:null,default:x7},Symbol.toStringTag,{value:"Module"})),W1=vA(b7);(function(r,t){var s={};function i(n){n.version="0.18.5",n.style_version="1.2.0";var e,p=1200,x=1252;typeof cptable<"u"?e=cptable:typeof Fd<"u"&&(e=v7());var w=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],E={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},N=function(a){w.indexOf(a)!=-1&&(x=E[0]=a)},P=function(a){N(p=a)};function R(){P(1200),N(1252)}function q(a){for(var o=[],l=0,c=a.length;l<c;++l)o[l]=a.charCodeAt(l);return o}function Z(a){for(var o=[],l=0;l<a.length>>1;++l)o[l]=String.fromCharCode(a.charCodeAt(2*l+1)+(a.charCodeAt(2*l)<<8));return o.join("")}var ne=function(a){var o=a.charCodeAt(0),l=a.charCodeAt(1);return o==255&&l==254?function(c){for(var u=[],h=0;h<c.length>>1;++h)u[h]=String.fromCharCode(c.charCodeAt(2*h)+(c.charCodeAt(2*h+1)<<8));return u.join("")}(a.slice(2)):o==254&&l==255?Z(a.slice(2)):o==65279?a.slice(1):a},fe=function(a){return String.fromCharCode(a)},G=function(a){return String.fromCharCode(a)};e!==void 0&&(P=function(a){N(p=a)},ne=function(a){return a.charCodeAt(0)===255&&a.charCodeAt(1)===254?e.utils.decode(1200,q(a.slice(2))):a},fe=function(a){return p===1200?String.fromCharCode(a):e.utils.decode(p,[255&a,a>>8])[0]},G=function(a){return e.utils.decode(x,[a])[0]});var U="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function H(a){for(var o,l,c,u,h,f="",d=0,y=0,v=0;v<a.length;)u=(o=a.charCodeAt(v++))>>2,h=(3&o)<<4|(l=a.charCodeAt(v++))>>4,d=(15&l)<<2|(c=a.charCodeAt(v++))>>6,y=63&c,isNaN(l)?d=y=64:isNaN(c)&&(y=64),f+=U.charAt(u)+U.charAt(h)+U.charAt(d)+U.charAt(y);return f}function ee(a){var o,l,c,u,h,f,d="";a=a.replace(/[^\w\+\/\=]/g,"");for(var y=0;y<a.length;)o=U.indexOf(a.charAt(y++))<<2|(u=U.indexOf(a.charAt(y++)))>>4,d+=String.fromCharCode(o),l=(15&u)<<4|(h=U.indexOf(a.charAt(y++)))>>2,h!==64&&(d+=String.fromCharCode(l)),c=(3&h)<<6|(f=U.indexOf(a.charAt(y++))),f!==64&&(d+=String.fromCharCode(c));return d}var te=typeof Buffer<"u"&&typeof process<"u"&&process.versions!==void 0&&!!process.versions.node,ue=function(){if(typeof Buffer>"u")return function(){};var a=!Buffer.from;if(!a)try{Buffer.from("foo","utf8")}catch{a=!0}return a?function(o,l){return l?new Buffer(o,l):new Buffer(o)}:Buffer.from.bind(Buffer)}();function L(a){return te?Buffer.alloc?Buffer.alloc(a):new Buffer(a):new(typeof Uint8Array<"u"?Uint8Array:Array)(a)}function O(a){return te?Buffer.allocUnsafe?Buffer.allocUnsafe(a):new Buffer(a):new(typeof Uint8Array<"u"?Uint8Array:Array)(a)}var V=function(a){return te?ue(a,"binary"):a.split("").map(function(o){return 255&o.charCodeAt(0)})};function W(a){if(typeof ArrayBuffer>"u")return V(a);for(var o=new ArrayBuffer(a.length),l=new Uint8Array(o),c=0;c!=a.length;++c)l[c]=255&a.charCodeAt(c);return o}function J(a){if(Array.isArray(a))return a.map(function(c){return String.fromCharCode(c)}).join("");for(var o=[],l=0;l<a.length;++l)o[l]=String.fromCharCode(a[l]);return o.join("")}function X(a){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(a instanceof ArrayBuffer)return X(new Uint8Array(a));for(var o=new Array(a.length),l=0;l<a.length;++l)o[l]=a[l];return o}var K=te?function(a){return Buffer.concat(a.map(function(o){return Buffer.isBuffer(o)?o:ue(o)}))}:function(a){if(typeof Uint8Array>"u")return[].concat.apply([],a.map(function(h){return Array.isArray(h)?h:[].slice.call(h)}));for(var l=0,o=0,l=0;l<a.length;++l)o+=a[l].length;for(var c,u=new Uint8Array(o),o=l=0;l<a.length;o+=c,++l)if(c=a[l].length,a[l]instanceof Uint8Array)u.set(a[l],o);else{if(typeof a[l]=="string")throw"wtf";u.set(new Uint8Array(a[l]),o)}return u},me=/\u0000/g,He=/[\u0001-\u0006]/g;function fr(a){for(var o="",l=a.length-1;0<=l;)o+=a.charAt(l--);return o}function at(a,o){return a=""+a,o<=a.length?a:Cr("0",o-a.length)+a}function $e(a,o){return a=""+a,o<=a.length?a:Cr(" ",o-a.length)+a}function Ve(a,o){return a=""+a,o<=a.length?a:a+Cr(" ",o-a.length)}var ye=Math.pow(2,32);function oe(u,o){if(ye<u||u<-ye)return l=u,c=o,l=""+Math.round(l),c<=l.length?l:Cr("0",c-l.length)+l;var l,c,u=Math.round(u);return(o=o)<=(u=""+(u=u)).length?u:Cr("0",o-u.length)+u}function Fe(a,o){return o=o||0,a.length>=7+o&&(32|a.charCodeAt(o))==103&&(32|a.charCodeAt(o+1))==101&&(32|a.charCodeAt(o+2))==110&&(32|a.charCodeAt(o+3))==101&&(32|a.charCodeAt(o+4))==114&&(32|a.charCodeAt(o+5))==97&&(32|a.charCodeAt(o+6))==108}var Oe=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Re=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]],de={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Ce={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},ce={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Et(a,o,l){for(var c=a<0?-1:1,u=a*c,h=0,f=1,d=0,y=1,v=0,b=0,_=Math.floor(u);v<o&&(d=(_=Math.floor(u))*f+h,b=_*v+y,!(u-_<5e-8));)u=1/(u-_),h=f,f=d,y=v,v=b;return o<b&&(d=o<v?(b=y,h):(b=v,f)),l?(l=Math.floor(c*d/b),[l,c*d-l*b,b]):[0,c*d,b]}function Xe(d,o,l){if(2958465<d||d<0)return null;var c=0|d,u=Math.floor(86400*(d-c)),h=0,f=[],d={D:c,T:u,u:86400*(d-c)-u,y:0,m:0,d:0,H:0,M:0,S:0,q:0};return Math.abs(d.u)<1e-6&&(d.u=0),o&&o.date1904&&(c+=1462),.9999<d.u&&(d.u=0,++u==86400&&(d.T=u=0,++c,++d.D)),c===60?(f=l?[1317,10,29]:[1900,2,29],h=3):c===0?(f=l?[1317,8,29]:[1900,1,0],h=6):(60<c&&--c,(o=new Date(1900,0,1)).setDate(o.getDate()+c-1),f=[o.getFullYear(),o.getMonth()+1,o.getDate()],h=o.getDay(),c<60&&(h=(h+6)%7),l&&(h=function(y,v){return v[0]-=581,v=y.getDay(),y<60&&(v=(v+6)%7),v}(o,f))),d.y=f[0],d.m=f[1],d.d=f[2],d.S=u%60,u=Math.floor(u/60),d.M=u%60,u=Math.floor(u/60),d.H=u,d.q=h,d}var zt=new Date(1899,11,31,0,0,0),or=zt.getTime(),vt=new Date(1900,2,1,0,0,0);function Ct(a,o){var l=a.getTime();return o?l-=1262304e5:vt<=a&&(l+=864e5),(l-(or+6e4*(a.getTimezoneOffset()-zt.getTimezoneOffset())))/864e5}function pt(a){return a.indexOf(".")==-1?a:a.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Rr(a){var o,l,c,u=Math.floor(Math.log(Math.abs(a))*Math.LOG10E),h=-4<=u&&u<=-1?a.toPrecision(10+u):Math.abs(u)<=9?(l=(o=a)<0?12:11,(c=pt(o.toFixed(12))).length<=l||(c=o.toPrecision(10)).length<=l?c:o.toExponential(5)):u===10?a.toFixed(10).substr(0,12):(h=pt((a=a).toFixed(11))).length>(a<0?12:11)||h==="0"||h==="-0"?a.toPrecision(6):h;return pt((h=h.toUpperCase()).indexOf("E")==-1?h:h.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2"))}function er(a,o){switch(typeof a){case"string":return a;case"boolean":return a?"TRUE":"FALSE";case"number":return(0|a)===a?a.toString(10):Rr(a);case"undefined":return"";case"object":if(a==null)return"";if(a instanceof Date)return Rt(14,Ct(a,o&&o.date1904),o)}throw new Error("unsupported value in General format: "+a)}function Pr(a){if(a.length<=3)return a;for(var o=a.length%3,l=a.substr(0,o);o!=a.length;o+=3)l+=(0<l.length?",":"")+a.substr(o,3);return l}var Ke=/%/g,jt=/# (\?+)( ?)\/( ?)(\d+)/,mt=/^#*0*\.([0#]+)/,Vt=/\).*[0#]/,Qt=/\(###\) ###\\?-####/;function lr(a){for(var o,l="",c=0;c!=a.length;++c)switch(o=a.charCodeAt(c)){case 35:break;case 63:l+=" ";break;case 48:l+="0";break;default:l+=String.fromCharCode(o)}return l}function hn(a,o){return o=Math.pow(10,o),""+Math.round(a*o)/o}function Xr(c,o){var l=c-Math.floor(c),c=Math.pow(10,o);return o<(""+Math.round(l*c)).length?0:Math.round(l*c)}function _r(a,o,l){if(a.charCodeAt(0)===40&&!o.match(Vt)){var c=o.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return 0<=l?_r("n",c,l):"("+_r("n",c,-l)+")"}if(o.charCodeAt(o.length-1)===44)return function(F,j,B){for(var z=j.length-1;j.charCodeAt(z-1)===44;)--z;return Vn(F,j.substr(0,z),B/Math.pow(10,3*(j.length-z)))}(a,o,l);if(o.indexOf("%")!==-1)return d=a,v=l,y=(b=o).replace(Ke,""),b=b.length-y.length,Vn(d,y,v*Math.pow(10,2*b))+Cr("%",b);var u;if(o.indexOf("E")!==-1)return function F(j,B){var z,ae=j.indexOf("E")-j.indexOf(".")-1;if(j.match(/^#+0.0E\+0$/)){if(B==0)return"0.0E+0";if(B<0)return"-"+F(j,-B);var he=j.indexOf(".");he===-1&&(he=j.indexOf("E"));var le=Math.floor(Math.log(B)*Math.LOG10E)%he;if(le<0&&(le+=he),(z=(B/Math.pow(10,le)).toPrecision(1+ae+(he+le)%he)).indexOf("e")===-1){var ve=Math.floor(Math.log(B)*Math.LOG10E);for(z.indexOf(".")===-1?z=z.charAt(0)+"."+z.substr(1)+"E+"+(ve-z.length+le):z+="E+"+(ve-le);z.substr(0,2)==="0.";)z=(z=z.charAt(0)+z.substr(2,he)+"."+z.substr(2+he)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");z=z.replace(/\+-/,"-")}z=z.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(Ie,De,_e,Ue){return De+_e+Ue.substr(0,(he+le)%he)+"."+Ue.substr(le)+"E"})}else z=B.toExponential(ae);return j.match(/E\+00$/)&&z.match(/e[+-]\d$/)&&(z=z.substr(0,z.length-1)+"0"+z.charAt(z.length-1)),(z=j.match(/E\-/)&&z.match(/e\+/)?z.replace(/e\+/,"e"):z).replace("e","E")}(o,l);if(o.charCodeAt(0)===36)return"$"+_r(a,o.substr(o.charAt(1)==" "?2:1),l);var h,f,d,y,v,b,_,T=Math.abs(l),S=l<0?"-":"";if(o.match(/^00+$/))return S+oe(T,o.length);if(o.match(/^[#?]+$/))return(u=(u=oe(l,0))==="0"?"":u).length>o.length?u:lr(o.substr(0,o.length-u.length))+u;if(h=o.match(jt))return _=h,d=T,y=S,v=parseInt(_[4],10),b=Math.round(d*v),d=Math.floor(b/v),y+(d===0?"":""+d)+" "+((b-=d*v)==0?Cr(" ",_[1].length+1+_[4].length):$e(b,_[1].length)+_[2]+"/"+_[3]+at(v,_[4].length));if(o.match(/^#+0+$/))return S+oe(T,o.length-o.indexOf("0"));if(h=o.match(mt))return u=hn(l,h[1].length).replace(/^([^\.]+)$/,"$1."+lr(h[1])).replace(/\.$/,"."+lr(h[1])).replace(/\.(\d*)$/,function(F,j){return"."+j+Cr("0",lr(h[1]).length-j.length)}),o.indexOf("0.")!==-1?u:u.replace(/^0\./,".");if(o=o.replace(/^#+([0.])/,"$1"),h=o.match(/^(0*)\.(#*)$/))return S+hn(T,h[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,h[1].length?"0.":".");if(h=o.match(/^#{1,3},##0(\.?)$/))return S+Pr(oe(T,0));if(h=o.match(/^#,##0\.([#0]*0)$/))return l<0?"-"+_r(a,o,-l):Pr(""+(Math.floor(l)+(_=l,(I=h[1].length)<(""+Math.round((_-Math.floor(_))*Math.pow(10,I))).length?1:0)))+"."+at(Xr(l,h[1].length),h[1].length);if(h=o.match(/^#,#*,#0/))return _r(a,o.replace(/^#,#*,/,""),l);if(h=o.match(/^([0#]+)(\\?-([0#]+))+$/))return u=fr(_r(a,o.replace(/[\\-]/g,""),l)),f=0,fr(fr(o.replace(/\\/g,"")).replace(/[0#]/g,function(F){return f<u.length?u.charAt(f++):F==="0"?"0":""}));if(o.match(Qt))return"("+(u=_r(a,"##########",l)).substr(0,3)+") "+u.substr(3,3)+"-"+u.substr(6);var I="";if(h=o.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(h[4].length,7),k=Et(T,Math.pow(10,f)-1,!1),u=S,(I=Vn("n",h[1],k[1])).charAt(I.length-1)==" "&&(I=I.substr(0,I.length-1)+"0"),u+=I+h[2]+"/"+h[3],(I=Ve(k[2],f)).length<h[4].length&&(I=lr(h[4].substr(h[4].length-I.length))+I),u+=I;if(h=o.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(Math.max(h[1].length,h[4].length),7),S+((k=Et(T,Math.pow(10,f)-1,!0))[0]||(k[1]?"":"0"))+" "+(k[1]?$e(k[1],f)+h[2]+"/"+h[3]+Ve(k[2],f):Cr(" ",2*f+1+h[2].length+h[3].length));if(h=o.match(/^[#0?]+$/))return u=oe(l,0),o.length<=u.length?u:lr(o.substr(0,o.length-u.length))+u;if(h=o.match(/^([#0?]+)\.([#0]+)$/)){u=""+l.toFixed(Math.min(h[2].length,10)).replace(/([^0])0+$/,"$1"),f=u.indexOf(".");var k=o.indexOf(".")-f,M=o.length-u.length-k;return lr(o.substr(0,k)+u+o.substr(o.length-M))}if(h=o.match(/^00,000\.([#0]*0)$/))return f=Xr(l,h[1].length),l<0?"-"+_r(a,o,-l):Pr((M=l)<2147483647&&-2147483648<M?""+(0<=M?0|M:M-1|0):""+Math.floor(M)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(F){return"00,"+(F.length<3?at(0,3-F.length):"")+F})+"."+at(f,h[1].length);switch(o){case"###,##0.00":return _r(a,"#,##0.00",l);case"###,###":case"##,###":case"#,###":var D=Pr(oe(T,0));return D!=="0"?S+D:"";case"###,###.00":return _r(a,"###,##0.00",l).replace(/^0\./,".");case"#,###.00":return _r(a,"#,##0.00",l).replace(/^0\./,".")}throw new Error("unsupported format |"+o+"|")}function Or(a,o,l){if(a.charCodeAt(0)===40&&!o.match(Vt)){var c=o.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return 0<=l?Or("n",c,l):"("+Or("n",c,-l)+")"}if(o.charCodeAt(o.length-1)===44)return function(k,M,D){for(var F=M.length-1;M.charCodeAt(F-1)===44;)--F;return Vn(k,M.substr(0,F),D/Math.pow(10,3*(M.length-F)))}(a,o,l);if(o.indexOf("%")!==-1)return u=a,f=l,c=(h=o).replace(Ke,""),h=h.length-c.length,Vn(u,c,f*Math.pow(10,2*h))+Cr("%",h);var u,h,f,d;if(o.indexOf("E")!==-1)return function k(M,D){var F,j=M.indexOf("E")-M.indexOf(".")-1;if(M.match(/^#+0.0E\+0$/)){if(D==0)return"0.0E+0";if(D<0)return"-"+k(M,-D);var B=M.indexOf(".");B===-1&&(B=M.indexOf("E"));var z,ae=Math.floor(Math.log(D)*Math.LOG10E)%B;ae<0&&(ae+=B),(F=(D/Math.pow(10,ae)).toPrecision(1+j+(B+ae)%B)).match(/[Ee]/)||(z=Math.floor(Math.log(D)*Math.LOG10E),F.indexOf(".")===-1?F=F.charAt(0)+"."+F.substr(1)+"E+"+(z-F.length+ae):F+="E+"+(z-ae),F=F.replace(/\+-/,"-")),F=F.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(he,le,ve,Ie){return le+ve+Ie.substr(0,(B+ae)%B)+"."+Ie.substr(ae)+"E"})}else F=D.toExponential(j);return M.match(/E\+00$/)&&F.match(/e[+-]\d$/)&&(F=F.substr(0,F.length-1)+"0"+F.charAt(F.length-1)),(F=M.match(/E\-/)&&F.match(/e\+/)?F.replace(/e\+/,"e"):F).replace("e","E")}(o,l);if(o.charCodeAt(0)===36)return"$"+Or(a,o.substr(o.charAt(1)==" "?2:1),l);var y,v,b=Math.abs(l),_=l<0?"-":"";if(o.match(/^00+$/))return _+at(b,o.length);if(o.match(/^[#?]+$/))return(d=l===0?"":""+l).length>o.length?d:lr(o.substr(0,o.length-d.length))+d;if(y=o.match(jt))return _+((T=b)===0?"":""+T)+Cr(" ",(T=y)[1].length+2+T[4].length);if(o.match(/^#+0+$/))return _+at(b,o.length-o.indexOf("0"));if(y=o.match(mt))return d=(d=(""+l).replace(/^([^\.]+)$/,"$1."+lr(y[1])).replace(/\.$/,"."+lr(y[1]))).replace(/\.(\d*)$/,function(k,M){return"."+M+Cr("0",lr(y[1]).length-M.length)}),o.indexOf("0.")!==-1?d:d.replace(/^0\./,".");if(o=o.replace(/^#+([0.])/,"$1"),y=o.match(/^(0*)\.(#*)$/))return _+(""+b).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,y[1].length?"0.":".");if(y=o.match(/^#{1,3},##0(\.?)$/))return _+Pr(""+b);if(y=o.match(/^#,##0\.([#0]*0)$/))return l<0?"-"+Or(a,o,-l):Pr(""+l)+"."+Cr("0",y[1].length);if(y=o.match(/^#,#*,#0/))return Or(a,o.replace(/^#,#*,/,""),l);if(y=o.match(/^([0#]+)(\\?-([0#]+))+$/))return d=fr(Or(a,o.replace(/[\\-]/g,""),l)),v=0,fr(fr(o.replace(/\\/g,"")).replace(/[0#]/g,function(k){return v<d.length?d.charAt(v++):k==="0"?"0":""}));if(o.match(Qt))return"("+(d=Or(a,"##########",l)).substr(0,3)+") "+d.substr(3,3)+"-"+d.substr(6);var T="";if(y=o.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return v=Math.min(y[4].length,7),S=Et(b,Math.pow(10,v)-1,!1),d=_,(T=Vn("n",y[1],S[1])).charAt(T.length-1)==" "&&(T=T.substr(0,T.length-1)+"0"),d+=T+y[2]+"/"+y[3],(T=Ve(S[2],v)).length<y[4].length&&(T=lr(y[4].substr(y[4].length-T.length))+T),d+=T;if(y=o.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return v=Math.min(Math.max(y[1].length,y[4].length),7),_+((S=Et(b,Math.pow(10,v)-1,!0))[0]||(S[1]?"":"0"))+" "+(S[1]?$e(S[1],v)+y[2]+"/"+y[3]+Ve(S[2],v):Cr(" ",2*v+1+y[2].length+y[3].length));if(y=o.match(/^[#0?]+$/))return d=""+l,o.length<=d.length?d:lr(o.substr(0,o.length-d.length))+d;if(y=o.match(/^([#0]+)\.([#0]+)$/)){d=""+l.toFixed(Math.min(y[2].length,10)).replace(/([^0])0+$/,"$1"),v=d.indexOf(".");var T=o.indexOf(".")-v,S=o.length-d.length-T;return lr(o.substr(0,T)+d+o.substr(o.length-S))}if(y=o.match(/^00,000\.([#0]*0)$/))return l<0?"-"+Or(a,o,-l):Pr(""+l).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?at(0,3-k.length):"")+k})+"."+at(0,y[1].length);switch(o){case"###,###":case"##,###":case"#,###":var I=Pr(""+b);return I!=="0"?_+I:"";default:if(o.match(/\.[0#?]*$/))return Or(a,o.slice(0,o.lastIndexOf(".")),l)+lr(o.slice(o.lastIndexOf(".")))}throw new Error("unsupported format |"+o+"|")}function Vn(a,o,l){return((0|l)===l?Or:_r)(a,o,l)}var Ai=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Is(a){for(var o=0,l="",c="";o<a.length;)switch(l=a.charAt(o)){case"G":Fe(a,o)&&(o+=6),o++;break;case'"':for(;a.charCodeAt(++o)!==34&&o<a.length;);++o;break;case"\\":case"_":o+=2;break;case"@":++o;break;case"B":case"b":if(a.charAt(o+1)==="1"||a.charAt(o+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(a.substr(o,3).toUpperCase()==="A/P"||a.substr(o,5).toUpperCase()==="AM/PM"||a.substr(o,5).toUpperCase()==="/")return!0;++o;break;case"[":for(c=l;a.charAt(o++)!=="]"&&o<a.length;)c+=a.charAt(o);if(c.match(Ai))return!0;break;case".":case"0":case"#":for(;o<a.length&&(-1<"0#?.,E+-%".indexOf(l=a.charAt(++o))||l=="\\"&&a.charAt(o+1)=="-"&&-1<"0#".indexOf(a.charAt(o+2))););break;case"?":for(;a.charAt(++o)===l;);break;case"*":++o,a.charAt(o)!=" "&&a.charAt(o)!="*"||++o;break;case"(":case")":++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;o<a.length&&-1<"0123456789".indexOf(a.charAt(++o)););break;case" ":default:++o}return!1}function vl(a,o,l,c){for(var u,h,f,d=[],y="",v=0,b="",_="t",T="H";v<a.length;)switch(b=a.charAt(v)){case"G":if(!Fe(a,v))throw new Error("unrecognized character "+b+" in "+a);d[d.length]={t:"G",v:"General"},v+=7;break;case'"':for(y="";(f=a.charCodeAt(++v))!==34&&v<a.length;)y+=String.fromCharCode(f);d[d.length]={t:"t",v:y},++v;break;case"\\":var S=a.charAt(++v),I=S==="("||S===")"?S:"t";d[d.length]={t:I,v:S},++v;break;case"_":d[d.length]={t:"t",v:" "},v+=2;break;case"@":d[d.length]={t:"T",v:o},++v;break;case"B":case"b":if(a.charAt(v+1)==="1"||a.charAt(v+1)==="2"){if(u==null&&(u=Xe(o,l,a.charAt(v+1)==="2"))==null)return"";d[d.length]={t:"X",v:a.substr(v,2)},_=b,v+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":b=b.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(o<0||u==null&&(u=Xe(o,l))==null)return"";for(y=b;++v<a.length&&a.charAt(v).toLowerCase()===b;)y+=b;(b=b==="m"&&_.toLowerCase()==="h"?"M":b)==="h"&&(b=T),d[d.length]={t:b,v:y},_=b;break;case"A":case"a":case"":if(S={t:b,v:b},u==null&&(u=Xe(o,l)),a.substr(v,3).toUpperCase()==="A/P"?(u!=null&&(S.v=12<=u.H?"P":"A"),S.t="T",T="h",v+=3):a.substr(v,5).toUpperCase()==="AM/PM"?(u!=null&&(S.v=12<=u.H?"PM":"AM"),S.t="T",v+=5,T="h"):a.substr(v,5).toUpperCase()==="/"?(u!=null&&(S.v=12<=u.H?"":""),S.t="T",v+=5,T="h"):(S.t="t",++v),u==null&&S.t==="T")return"";d[d.length]=S,_=b;break;case"[":for(y=b;a.charAt(v++)!=="]"&&v<a.length;)y+=a.charAt(v);if(y.slice(-1)!=="]")throw'unterminated "[" block: |'+y+"|";if(y.match(Ai)){if(u==null&&(u=Xe(o,l))==null)return"";d[d.length]={t:"Z",v:y.toLowerCase()},_=y.charAt(1)}else-1<y.indexOf("$")&&(y=(y.match(/\$([^-\[\]]*)/)||[])[1]||"$",Is(a)||(d[d.length]={t:"t",v:y}));break;case".":if(u!=null){for(y=b;++v<a.length&&(b=a.charAt(v))==="0";)y+=b;d[d.length]={t:"s",v:y};break}case"0":case"#":for(y=b;++v<a.length&&-1<"0#?.,E+-%".indexOf(b=a.charAt(v));)y+=b;d[d.length]={t:"n",v:y};break;case"?":for(y=b;a.charAt(++v)===b;)y+=b;d[d.length]={t:b,v:y},_=b;break;case"*":++v,a.charAt(v)!=" "&&a.charAt(v)!="*"||++v;break;case"(":case")":d[d.length]={t:c===1?"t":b,v:b},++v;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(y=b;v<a.length&&-1<"0123456789".indexOf(a.charAt(++v));)y+=a.charAt(v);d[d.length]={t:"D",v:y};break;case" ":d[d.length]={t:b,v:b},++v;break;case"$":d[d.length]={t:"t",v:"$"},++v;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(b)===-1)throw new Error("unrecognized character "+b+" in "+a);d[d.length]={t:"t",v:b},++v}var k,M=0,D=0;for(v=d.length-1,_="t";0<=v;--v)switch(d[v].t){case"h":case"H":d[v].t=T,_="h",M<1&&(M=1);break;case"s":(k=d[v].v.match(/\.0+$/))&&(D=Math.max(D,k[0].length-1)),M<3&&(M=3);case"d":case"y":case"M":case"e":_=d[v].t;break;case"m":_==="s"&&(d[v].t="M",M<2&&(M=2));break;case"X":break;case"Z":(M=(M=M<1&&d[v].v.match(/[Hh]/)?1:M)<2&&d[v].v.match(/[Mm]/)?2:M)<3&&d[v].v.match(/[Ss]/)&&(M=3)}switch(M){case 0:break;case 1:.5<=u.u&&(u.u=0,++u.S),60<=u.S&&(u.S=0,++u.M),60<=u.M&&(u.M=0,++u.H);break;case 2:.5<=u.u&&(u.u=0,++u.S),60<=u.S&&(u.S=0,++u.M)}var F,j="";for(v=0;v<d.length;++v)switch(d[v].t){case"t":case"T":case" ":case"D":break;case"X":d[v].v="",d[v].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":d[v].v=function(Ie,De,_e,Ue){var it,nt="",Ye=0,Je=0,Ge=_e.y,je=0;switch(Ie){case 98:Ge=_e.y+543;case 121:switch(De.length){case 1:case 2:it=Ge%100,je=2;break;default:it=Ge%1e4,je=4}break;case 109:switch(De.length){case 1:case 2:it=_e.m,je=De.length;break;case 3:return Re[_e.m-1][1];case 5:return Re[_e.m-1][0];default:return Re[_e.m-1][2]}break;case 100:switch(De.length){case 1:case 2:it=_e.d,je=De.length;break;case 3:return Oe[_e.q][0];default:return Oe[_e.q][1]}break;case 104:switch(De.length){case 1:case 2:it=1+(_e.H+11)%12,je=De.length;break;default:throw"bad hour format: "+De}break;case 72:switch(De.length){case 1:case 2:it=_e.H,je=De.length;break;default:throw"bad hour format: "+De}break;case 77:switch(De.length){case 1:case 2:it=_e.M,je=De.length;break;default:throw"bad minute format: "+De}break;case 115:if(De!="s"&&De!="ss"&&De!=".0"&&De!=".00"&&De!=".000")throw"bad second format: "+De;return _e.u!==0||De!="s"&&De!="ss"?(60*(Je=2<=Ue?Ue===3?1e3:100:Ue===1?10:1)<=(Ye=Math.round(Je*(_e.S+_e.u)))&&(Ye=0),De==="s"?Ye===0?"0":""+Ye/Je:(nt=at(Ye,2+Ue),De==="ss"?nt.substr(0,2):"."+nt.substr(2,De.length-1))):at(_e.S,De.length);case 90:switch(De){case"[h]":case"[hh]":it=24*_e.D+_e.H;break;case"[m]":case"[mm]":it=60*(24*_e.D+_e.H)+_e.M;break;case"[s]":case"[ss]":it=60*(60*(24*_e.D+_e.H)+_e.M)+Math.round(_e.S+_e.u);break;default:throw"bad abstime format: "+De}je=De.length===3?1:2;break;case 101:it=Ge,je=1}return 0<je?at(it,je):""}(d[v].t.charCodeAt(0),d[v].v,u,D),d[v].t="t";break;case"n":case"?":for(F=v+1;d[F]!=null&&((b=d[F].t)==="?"||b==="D"||(b===" "||b==="t")&&d[F+1]!=null&&(d[F+1].t==="?"||d[F+1].t==="t"&&d[F+1].v==="/")||d[v].t==="("&&(b===" "||b==="n"||b===")")||b==="t"&&(d[F].v==="/"||d[F].v===" "&&d[F+1]!=null&&d[F+1].t=="?"));)d[v].v+=d[F].v,d[F]={v:"",t:";"},++F;j+=d[v].v,v=F-1;break;case"G":d[v].t="t",d[v].v=er(o,l)}var B,z,ae="";if(0<j.length){j.charCodeAt(0)==40?(B=o<0&&j.charCodeAt(0)===45?-o:o,z=Vn("n",j,B)):(z=Vn("n",j,B=o<0&&1<c?-o:o),B<0&&d[0]&&d[0].t=="t"&&(z=z.substr(1),d[0].v="-"+d[0].v)),F=z.length-1;for(var he=d.length,v=0;v<d.length;++v)if(d[v]!=null&&d[v].t!="t"&&-1<d[v].v.indexOf(".")){he=v;break}var le=d.length;if(he===d.length&&z.indexOf("E")===-1){for(v=d.length-1;0<=v;--v)d[v]!=null&&"n?".indexOf(d[v].t)!==-1&&(F>=d[v].v.length-1?(F-=d[v].v.length,d[v].v=z.substr(F+1,d[v].v.length)):F<0?d[v].v="":(d[v].v=z.substr(0,F+1),F=-1),d[v].t="t",le=v);0<=F&&le<d.length&&(d[le].v=z.substr(0,F+1)+d[le].v)}else if(he!==d.length&&z.indexOf("E")===-1){for(F=z.indexOf(".")-1,v=he;0<=v;--v)if(d[v]!=null&&"n?".indexOf(d[v].t)!==-1){for(h=-1<d[v].v.indexOf(".")&&v===he?d[v].v.indexOf(".")-1:d[v].v.length-1,ae=d[v].v.substr(h+1);0<=h;--h)0<=F&&(d[v].v.charAt(h)==="0"||d[v].v.charAt(h)==="#")&&(ae=z.charAt(F--)+ae);d[v].v=ae,d[v].t="t",le=v}for(0<=F&&le<d.length&&(d[le].v=z.substr(0,F+1)+d[le].v),F=z.indexOf(".")+1,v=he;v<d.length;++v)if(d[v]!=null&&("n?(".indexOf(d[v].t)!==-1||v===he)){for(h=-1<d[v].v.indexOf(".")&&v===he?d[v].v.indexOf(".")+1:0,ae=d[v].v.substr(0,h);h<d[v].v.length;++h)F<z.length&&(ae+=z.charAt(F++));d[v].v=ae,d[v].t="t",le=v}}}for(v=0;v<d.length;++v)d[v]!=null&&-1<"n?".indexOf(d[v].t)&&(B=1<c&&o<0&&0<v&&d[v-1].v==="-"?-o:o,d[v].v=Vn(d[v].t,d[v].v,B),d[v].t="t");var ve="";for(v=0;v!==d.length;++v)d[v]!=null&&(ve+=d[v].v);return ve}var fa=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Ci(a,o){if(o!=null){var l=parseFloat(o[2]);switch(o[1]){case"=":if(a==l)return 1;break;case">":if(l<a)return 1;break;case"<":if(a<l)return 1;break;case"<>":if(a!=l)return 1;break;case">=":if(l<=a)return 1;break;case"<=":if(a<=l)return 1}}}function Ne(a,o){var l=function(f){for(var d=[],y=!1,v=0,b=0;v<f.length;++v)switch(f.charCodeAt(v)){case 34:y=!y;break;case 95:case 42:case 92:++v;break;case 59:d[d.length]=f.substr(b,v-b),b=v+1}if(d[d.length]=f.substr(b),y===!0)throw new Error("Format |"+f+"| unterminated string ");return d}(a),c=l.length,u=l[c-1].indexOf("@");if(c<4&&-1<u&&--c,4<l.length)throw new Error("cannot find right format for |"+l.join("|")+"|");if(typeof o!="number")return[4,l.length===4||-1<u?l[l.length-1]:"@"];switch(l.length){case 1:l=-1<u?["General","General","General",l[0]]:[l[0],l[0],l[0],"@"];break;case 2:l=-1<u?[l[0],l[0],l[0],l[1]]:[l[0],l[1],l[0],"@"];break;case 3:l=-1<u?[l[0],l[1],l[0],l[2]]:[l[0],l[1],l[2],"@"]}var h=0<o?l[0]:o<0?l[1]:l[2];return l[0].indexOf("[")===-1&&l[1].indexOf("[")===-1?[c,h]:l[0].match(/\[[=<>]/)==null&&l[1].match(/\[[=<>]/)==null?[c,h]:(a=l[0].match(fa),h=l[1].match(fa),Ci(o,a)?[c,l[0]]:Ci(o,h)?[c,l[1]]:[c,l[a!=null&&h!=null?2:1]])}function Rt(a,o,l){l==null&&(l={});var c="";switch(typeof a){case"string":c=a=="m/d/yy"&&l.dateNF?l.dateNF:a;break;case"number":(c=(c=a==14&&l.dateNF?l.dateNF:(l.table!=null?l.table:de)[a])==null?l.table&&l.table[Ce[a]]||de[Ce[a]]:c)==null&&(c=ce[a]||"General")}if(Fe(c,0))return er(o,l);var u=Ne(c,o=o instanceof Date?Ct(o,l.date1904):o);if(Fe(u[1]))return er(o,l);if(o===!0)o="TRUE";else if(o===!1)o="FALSE";else if(o===""||o==null)return"";return vl(u[1],o,l,u[0])}function Vr(a,o){if(typeof o!="number"){o=+o||-1;for(var l=0;l<392;++l)if(de[l]!=null){if(de[l]==a){o=l;break}}else o<0&&(o=l);o<0&&(o=391)}return de[o]=a,o}function Ds(a){for(var o=0;o!=392;++o)a[o]!==void 0&&Vr(a[o],o)}function Rs(){var a;(a=a||{})[0]="General",a[1]="0",a[2]="0.00",a[3]="#,##0",a[4]="#,##0.00",a[9]="0%",a[10]="0.00%",a[11]="0.00E+00",a[12]="# ?/?",a[13]="# ??/??",a[14]="m/d/yy",a[15]="d-mmm-yy",a[16]="d-mmm",a[17]="mmm-yy",a[18]="h:mm AM/PM",a[19]="h:mm:ss AM/PM",a[20]="h:mm",a[21]="h:mm:ss",a[22]="m/d/yy h:mm",a[37]="#,##0 ;(#,##0)",a[38]="#,##0 ;[Red](#,##0)",a[39]="#,##0.00;(#,##0.00)",a[40]="#,##0.00;[Red](#,##0.00)",a[45]="mm:ss",a[46]="[h]:mm:ss",a[47]="mmss.0",a[48]="##0.0E+0",a[49]="@",a[56]='"/ "hh""mm""ss" "',de=a}var Qa={format:Rt,load:Vr,_table:de,load_table:Ds,parse_date_code:Xe,is_date:Is,get_table:function(){return Qa._table=de}},Wf={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},ki=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g,Ws,Oc=function(){var a={};a.version="1.2.0";var o=function(){for(var F=0,j=new Array(256),B=0;B!=256;++B)F=1&(F=1&(F=1&(F=1&(F=1&(F=1&(F=1&(F=1&(F=B)?-306674912^F>>>1:F>>>1)?-306674912^F>>>1:F>>>1)?-306674912^F>>>1:F>>>1)?-306674912^F>>>1:F>>>1)?-306674912^F>>>1:F>>>1)?-306674912^F>>>1:F>>>1)?-306674912^F>>>1:F>>>1)?-306674912^F>>>1:F>>>1,j[B]=F;return typeof Int32Array<"u"?new Int32Array(j):j}(),l=function(F){for(var j=0,B=0,ae=0,z=new(typeof Int32Array<"u"?Int32Array:Array)(4096),ae=0;ae!=256;++ae)z[ae]=F[ae];for(ae=0;ae!=256;++ae)for(B=F[ae],j=256+ae;j<4096;j+=256)B=z[j]=B>>>8^F[255&B];var he=[];for(ae=1;ae!=16;++ae)he[ae-1]=typeof Int32Array<"u"?z.subarray(256*ae,256*ae+256):z.slice(256*ae,256*ae+256);return he}(o),c=l[0],u=l[1],h=l[2],f=l[3],d=l[4],y=l[5],v=l[6],b=l[7],_=l[8],T=l[9],S=l[10],I=l[11],k=l[12],M=l[13],D=l[14];return a.table=o,a.bstr=function(F,j){for(var B=-1^j,z=0,ae=F.length;z<ae;)B=B>>>8^o[255&(B^F.charCodeAt(z++))];return~B},a.buf=function(F,j){for(var B=-1^j,z=F.length-15,ae=0;ae<z;)B=D[F[ae++]^255&B]^M[F[ae++]^B>>8&255]^k[F[ae++]^B>>16&255]^I[F[ae++]^B>>>24]^S[F[ae++]]^T[F[ae++]]^_[F[ae++]]^b[F[ae++]]^v[F[ae++]]^y[F[ae++]]^d[F[ae++]]^f[F[ae++]]^h[F[ae++]]^u[F[ae++]]^c[F[ae++]]^o[F[ae++]];for(z+=15;ae<z;)B=B>>>8^o[255&(B^F[ae++])];return~B},a.str=function(F,j){for(var B,z=-1^j,ae=0,he=F.length,le=0;ae<he;)z=(le=F.charCodeAt(ae++))<128?z>>>8^o[255&(z^le)]:le<2048?(z=z>>>8^o[255&(z^(192|le>>6&31))])>>>8^o[255&(z^(128|63&le))]:55296<=le&&le<57344?(le=64+(1023&le),B=1023&F.charCodeAt(ae++),(z=(z=(z=z>>>8^o[255&(z^(240|le>>8&7))])>>>8^o[255&(z^(128|le>>2&63))])>>>8^o[255&(z^(128|B>>6&15|(3&le)<<4))])>>>8^o[255&(z^(128|63&B))]):(z=(z=z>>>8^o[255&(z^(224|le>>12&15))])>>>8^o[255&(z^(128|le>>6&63))])>>>8^o[255&(z^(128|63&le))];return~z},a}(),wt=function(){var a,o={};function l(Q){if(Q.charAt(Q.length-1)=="/")return Q.slice(0,-1).indexOf("/")===-1?Q:l(Q.slice(0,-1));var Te=Q.lastIndexOf("/");return Te===-1?Q:Q.slice(0,Te+1)}function c(Q){if(Q.charAt(Q.length-1)=="/")return c(Q.slice(0,-1));var Te=Q.lastIndexOf("/");return Te===-1?Q:Q.slice(Te+1)}function u(Q){xn(Q,0);for(var Te,se={};Q.l<=Q.length-4;){var xe=Q.read_shift(2),re=Q.read_shift(2),Me=Q.l+re,be={};xe===21589&&(1&(Te=Q.read_shift(1))&&(be.mtime=Q.read_shift(4)),5<re&&(2&Te&&(be.atime=Q.read_shift(4)),4&Te&&(be.ctime=Q.read_shift(4))),be.mtime&&(be.mt=new Date(1e3*be.mtime))),Q.l=Me,se[xe]=be}return se}function h(){return a=a||W1}function f(Q,Te){if(Q[0]==80&&Q[1]==75)return Sr(Q,Te);if((32|Q[0])==109&&(32|Q[1])==105)return function(ze,kt){if(F(ze.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ct=kt&&kt.root||"",Qe=(te&&Buffer.isBuffer(ze)?ze.toString("binary"):F(ze)).split(`\r
`),It=0,Dt="";for(It=0;It<Qe.length;++It)if(Dt=Qe[It],/^Content-Location:/i.test(Dt)&&(Dt=Dt.slice(Dt.indexOf("file")),ct=ct||Dt.slice(0,Dt.lastIndexOf("/")+1),Dt.slice(0,ct.length)!=ct))for(;0<ct.length&&(ct=(ct=ct.slice(0,ct.length-1)).slice(0,ct.lastIndexOf("/")+1),Dt.slice(0,ct.length)!=ct););if(ze=(Qe[1]||"").match(/boundary="(.*?)"/),!ze)throw new Error("MAD cannot find boundary");var zr="--"+(ze[1]||""),Mt={FileIndex:[],FullPaths:[]};y(Mt);var Kt,Tt=0;for(It=0;It<Qe.length;++It){var ir=Qe[It];ir!==zr&&ir!==zr+"--"||(Tt++&&function(cr,ot,yt){for(var ft,Zt="",xr="",In="",On=0;On<10;++On){var _n=ot[On];if(!_n||_n.match(/^\s*$/))break;var es=_n.match(/^(.*?):\s*([^\s].*)$/);if(es)switch(es[1].toLowerCase()){case"content-location":Zt=es[2].trim();break;case"content-type":In=es[2].trim();break;case"content-transfer-encoding":xr=es[2].trim()}}switch(++On,xr.toLowerCase()){case"base64":ft=V(ee(ot.slice(On).join("")));break;case"quoted-printable":ft=function(ts){for(var Bo=[],ps=0;ps<ts.length;++ps){for(var oi=ts[ps];ps<=ts.length&&oi.charAt(oi.length-1)=="=";)oi=oi.slice(0,oi.length-1)+ts[++ps];Bo.push(oi)}for(var $o=0;$o<Bo.length;++$o)Bo[$o]=Bo[$o].replace(/[=][0-9A-Fa-f]{2}/g,function(dA){return String.fromCharCode(parseInt(dA.slice(1),16))});return V(Bo.join(`\r
`))}(ot.slice(On));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+xr)}yt=ea(cr,Zt.slice(yt.length),ft,{unsafe:!0}),In&&(yt.ctype=In)}(Mt,Qe.slice(Kt,It),ct),Kt=It)}return Mt}(Q,Te);if(Q.length<512)throw new Error("CFB file size "+Q.length+" < 512");var se,xe,re,Me=3,be=512,et=0,Se=[],ge=Q.slice(0,512);xn(ge,0);var ke=function(ze){if(ze[ze.l]==80&&ze[ze.l+1]==75)return[0,0];ze.chk(I,"Header Signature: "),ze.l+=16;var kt=ze.read_shift(2,"u");return[ze.read_shift(2,"u"),kt]}(ge);switch(Me=ke[0]){case 3:be=512;break;case 4:be=4096;break;case 0:if(ke[1]==0)return Sr(Q,Te);default:throw new Error("Major Version: Expected 3 or 4 saw "+Me)}be!==512&&xn(ge=Q.slice(0,be),28);var We=Q.slice(0,be);(function(ze,kt){var ct=9;switch(ze.l+=2,ct=ze.read_shift(2)){case 9:if(kt!=3)throw new Error("Sector Shift: Expected 9 saw "+ct);break;case 12:if(kt!=4)throw new Error("Sector Shift: Expected 12 saw "+ct);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ct)}ze.chk("0600","Mini Sector Shift: "),ze.chk("000000000000","Reserved: ")})(ge,Me);var St=ge.read_shift(4,"i");if(Me===3&&St!==0)throw new Error("# Directory Sectors: Expected 0 saw "+St);ge.l+=4,xe=ge.read_shift(4,"i"),ge.l+=4,ge.chk("00100000","Mini Stream Cutoff Size: "),re=ge.read_shift(4,"i"),se=ge.read_shift(4,"i"),At=ge.read_shift(4,"i"),et=ge.read_shift(4,"i");for(var _t,ut=0;ut<109&&!((_t=ge.read_shift(4,"i"))<0);++ut)Se[ut]=_t;var st=function(ze,kt){for(var ct=Math.ceil(ze.length/kt)-1,Qe=[],It=1;It<ct;++It)Qe[It-1]=ze.slice(It*kt,(It+1)*kt);return Qe[ct-1]=ze.slice(ct*kt),Qe}(Q,be);(function ze(kt,ct,Qe,It,Dt){var zr=S;if(kt===S){if(ct!==0)throw new Error("DIFAT chain shorter than expected")}else if(kt!==-1){var Mt=Qe[kt],Kt=(It>>>2)-1;if(Mt){for(var Tt=0;Tt<Kt&&(zr=Ra(Mt,4*Tt))!==S;++Tt)Dt.push(zr);ze(Ra(Mt,It-4),ct-1,Qe,It,Dt)}}})(At,et,st,be,Se);var gt=function(ze,kt,ct,Qe){var It=ze.length,Dt=[],zr=[],Mt=[],Kt=[],Tt=Qe-1,ir=0,cr=0,ot=0,yt=0;for(ir=0;ir<It;++ir)if(Mt=[],It<=(ot=ir+kt)&&(ot-=It),!zr[ot]){Kt=[];var ft=[];for(cr=ot;0<=cr;){ft[cr]=!0,zr[cr]=!0,Mt[Mt.length]=cr,Kt.push(ze[cr]);var Zt=ct[Math.floor(4*cr/Qe)];if(Qe<4+(yt=4*cr&Tt))throw new Error("FAT boundary crossed: "+cr+" 4 "+Qe);if(!ze[Zt]||(cr=Ra(ze[Zt],yt),ft[cr]))break}Dt[ot]={nodes:Mt,data:Kc([Kt])}}return Dt}(st,xe,Se,be);gt[xe].name="!Directory",0<se&&re!==S&&(gt[re].name="!MiniFAT"),gt[Se[0]].name="!FAT",gt.fat_addrs=Se,gt.ssz=be;var St=[],At=[],et=[];return function(ze,kt,ct,Qe,It,Dt,zr){for(var Mt,Kt=0,Tt=ct.length?2:0,ir=ze[xe].data,cr=0,ot=0;cr<ir.length;cr+=128){var yt=ir.slice(cr,cr+128);xn(yt,64),ot=yt.read_shift(2),Mt=Oi(yt,0,ot-Tt),ct.push(Mt);var ft={name:Mt,type:yt.read_shift(1),color:yt.read_shift(1),L:yt.read_shift(4,"i"),R:yt.read_shift(4,"i"),C:yt.read_shift(4,"i"),clsid:yt.read_shift(16),state:yt.read_shift(4,"i"),start:0,size:0};yt.read_shift(2)+yt.read_shift(2)+yt.read_shift(2)+yt.read_shift(2)!==0&&(ft.ct=d(yt,yt.l-8)),yt.read_shift(2)+yt.read_shift(2)+yt.read_shift(2)+yt.read_shift(2)!==0&&(ft.mt=d(yt,yt.l-8)),ft.start=yt.read_shift(4,"i"),ft.size=yt.read_shift(4,"i"),ft.size<0&&ft.start<0&&(ft.size=ft.type=0,ft.start=S,ft.name=""),ft.type===5?(Kt=ft.start,0<Qe&&Kt!==S&&(ze[Kt].name="!StreamData")):4096<=ft.size?(ft.storage="fat",ze[ft.start]===void 0&&(ze[ft.start]=function(Zt,xr,In,On,_n){var es=[],ts=[];_n=_n||[];var Bo=On-1,ps=0,oi=0;for(ps=xr;0<=ps;){_n[ps]=!0,es[es.length]=ps,ts.push(Zt[ps]);var $o=In[Math.floor(4*ps/On)];if(On<4+(oi=4*ps&Bo))throw new Error("FAT boundary crossed: "+ps+" 4 "+On);if(!Zt[$o])break;ps=Ra(Zt[$o],oi)}return{nodes:es,data:Kc([ts])}}(kt,ft.start,ze.fat_addrs,ze.ssz)),ze[ft.start].name=ft.name,ft.content=ze[ft.start].data.slice(0,ft.size)):(ft.storage="minifat",ft.size<0?ft.size=0:Kt!==S&&ft.start!==S&&ze[Kt]&&(ft.content=function(Zt,xr,In){for(var On=Zt.start,_n=Zt.size,es=[],ts=On;In&&0<_n&&0<=ts;)es.push(xr.slice(ts*T,ts*T+T)),_n-=T,ts=Ra(In,4*ts);return es.length===0?Ae(0):K(es).slice(0,Zt.size)}(ft,ze[Kt].data,(ze[zr]||{}).data))),ft.content&&xn(ft.content,0),It[Mt]=ft,Dt.push(ft)}}(gt,st,St,se,{},At,re),function(ze,kt,ct){for(var Qe=0,It=0,Dt=0,zr=0,Mt=0,Kt=ct.length,Tt=[],ir=[];Qe<Kt;++Qe)Tt[Qe]=ir[Qe]=Qe,kt[Qe]=ct[Qe];for(;Mt<ir.length;++Mt)Qe=ir[Mt],It=ze[Qe].L,Dt=ze[Qe].R,zr=ze[Qe].C,Tt[Qe]===Qe&&(It!==-1&&Tt[It]!==It&&(Tt[Qe]=Tt[It]),Dt!==-1&&Tt[Dt]!==Dt&&(Tt[Qe]=Tt[Dt])),zr!==-1&&(Tt[zr]=Qe),It!==-1&&Qe!=Tt[Qe]&&(Tt[It]=Tt[Qe],ir.lastIndexOf(It)<Mt&&ir.push(It)),Dt!==-1&&Qe!=Tt[Qe]&&(Tt[Dt]=Tt[Qe],ir.lastIndexOf(Dt)<Mt&&ir.push(Dt));for(Qe=1;Qe<Kt;++Qe)Tt[Qe]===Qe&&(Dt!==-1&&Tt[Dt]!==Dt?Tt[Qe]=Tt[Dt]:It!==-1&&Tt[It]!==It&&(Tt[Qe]=Tt[It]));for(Qe=1;Qe<Kt;++Qe)if(ze[Qe].type!==0){if((Mt=Qe)!=Tt[Mt])for(;Mt=Tt[Mt],kt[Qe]=kt[Mt]+"/"+kt[Qe],Mt!==0&&Tt[Mt]!==-1&&Mt!=Tt[Mt];);Tt[Qe]=-1}for(kt[0]+="/",Qe=1;Qe<Kt;++Qe)ze[Qe].type!==2&&(kt[Qe]+="/")}(At,et,St),St.shift(),et={FileIndex:At,FullPaths:et},Te&&Te.raw&&(et.raw={header:We,sectors:st}),et}function d(Q,Te){return new Date(1e3*(dn(Q,Te+4)/1e7*Math.pow(2,32)+dn(Q,Te)/1e7-11644473600))}function y(Q,xe){var se=xe||{},xe=se.root||"Root Entry";if(Q.FullPaths||(Q.FullPaths=[]),Q.FileIndex||(Q.FileIndex=[]),Q.FullPaths.length!==Q.FileIndex.length)throw new Error("inconsistent CFB structure");Q.FullPaths.length===0&&(Q.FullPaths[0]=xe+"/",Q.FileIndex[0]={name:xe,type:5}),se.CLSID&&(Q.FileIndex[0].clsid=se.CLSID),xe=Q,se="Sh33tJ5",wt.find(xe,"/"+se)||((Q=Ae(4))[0]=55,Q[1]=Q[3]=50,Q[2]=54,xe.FileIndex.push({name:se,type:2,content:Q,size:4,L:69,R:69,C:69}),xe.FullPaths.push(xe.FullPaths[0]+se),v(xe))}function v(Q,Te){y(Q);for(var se=!1,xe=!1,re=Q.FullPaths.length-1;0<=re;--re){var Me=Q.FileIndex[re];switch(Me.type){case 0:xe?se=!0:(Q.FileIndex.pop(),Q.FullPaths.pop());break;case 1:case 2:case 5:xe=!0,isNaN(Me.R*Me.L*Me.C)&&(se=!0),-1<Me.R&&-1<Me.L&&Me.R==Me.L&&(se=!0);break;default:se=!0}}if(se||Te){for(var be=new Date(1987,1,19),Se=0,ge=Object.create?Object.create(null):{},ke=[],re=0;re<Q.FullPaths.length;++re)ge[Q.FullPaths[re]]=!0,Q.FileIndex[re].type!==0&&ke.push([Q.FullPaths[re],Q.FileIndex[re]]);for(re=0;re<ke.length;++re){var We=l(ke[re][0]);(xe=ge[We])||(ke.push([We,{name:c(We).replace("/",""),type:1,clsid:M,ct:be,mt:be,content:null}]),ge[We]=!0)}for(ke.sort(function(st,gt){return function(St,At){for(var et,ze=St.split("/"),kt=At.split("/"),ct=0,Qe=Math.min(ze.length,kt.length);ct<Qe;++ct){if(et=ze[ct].length-kt[ct].length)return et;if(ze[ct]!=kt[ct])return ze[ct]<kt[ct]?-1:1}return ze.length-kt.length}(st[0],gt[0])}),Q.FullPaths=[],Q.FileIndex=[],re=0;re<ke.length;++re)Q.FullPaths[re]=ke[re][0],Q.FileIndex[re]=ke[re][1];for(re=0;re<ke.length;++re){var _t=Q.FileIndex[re],ut=Q.FullPaths[re];if(_t.name=c(ut).replace("/",""),_t.L=_t.R=_t.C=-(_t.color=1),_t.size=_t.content?_t.content.length:0,_t.start=0,_t.clsid=_t.clsid||M,re===0)_t.C=1<ke.length?1:-1,_t.size=0,_t.type=5;else if(ut.slice(-1)=="/"){for(Se=re+1;Se<ke.length&&l(Q.FullPaths[Se])!=ut;++Se);for(_t.C=Se>=ke.length?-1:Se,Se=re+1;Se<ke.length&&l(Q.FullPaths[Se])!=l(ut);++Se);_t.R=Se>=ke.length?-1:Se,_t.type=1}else l(Q.FullPaths[re+1]||"")==l(ut)&&(_t.R=re+1),_t.type=2}}}function b(Q,Te){var se=Te||{};if(se.fileType=="mad")return function(ut,st){for(var gt=st||{},St=gt.boundary||"SheetJS",At=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(St="------="+St).slice(2)+'"',"","",""],et=ut.FullPaths[0],ze=et,kt=ut.FileIndex[0],ct=1;ct<ut.FullPaths.length;++ct)if(ze=ut.FullPaths[ct].slice(et.length),(kt=ut.FileIndex[ct]).size&&kt.content&&ze!="Sh33tJ5"){ze=ze.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Tt){return"_x"+Tt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Tt){return"_u"+Tt.charCodeAt(0).toString(16)+"_"});for(var Qe=kt.content,It=te&&Buffer.isBuffer(Qe)?Qe.toString("binary"):F(Qe),Dt=0,zr=Math.min(1024,It.length),Mt=0,Kt=0;Kt<=zr;++Kt)32<=(Mt=It.charCodeAt(Kt))&&Mt<128&&++Dt;Qe=4*zr/5<=Dt,At.push(St),At.push("Content-Location: "+(gt.root||"file:///C:/SheetJS/")+ze),At.push("Content-Transfer-Encoding: "+(Qe?"quoted-printable":"base64")),At.push("Content-Type: "+function(ot,ir){if(ot.ctype)return ot.ctype;var cr=ot.name||"",ot=cr.match(/\.([^\.]+)$/);return ot&&Nn[ot[1]]||ir&&(ot=(cr=ir).match(/[\.\\]([^\.\\])+$/))&&Nn[ot[1]]?Nn[ot[1]]:"application/octet-stream"}(kt,ze)),At.push(""),At.push((Qe?function(Tt){Tt=Tt.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(In){return In=In.charCodeAt(0).toString(16).toUpperCase(),"="+(In.length==1?"0"+In:In)}),(Tt=Tt.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)==`
`&&(Tt="=0D"+Tt.slice(1)),Tt=Tt.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,`
=0A`).replace(/([^\r\n])\n/gm,"$1=0A");for(var ir=[],cr=Tt.split(`\r
`),ot=0;ot<cr.length;++ot){var yt=cr[ot];if(yt.length!=0)for(var ft=0;ft<yt.length;){var Zt=76,xr=yt.slice(ft,ft+Zt);xr.charAt(Zt-1)=="="?Zt--:xr.charAt(Zt-2)=="="?Zt-=2:xr.charAt(Zt-3)=="="&&(Zt-=3),xr=yt.slice(ft,ft+Zt),(ft+=Zt)<yt.length&&(xr+="="),ir.push(xr)}else ir.push("")}return ir.join(`\r
`)}:function(Tt){for(var ir=H(Tt),cr=[],ot=0;ot<ir.length;ot+=76)cr.push(ir.slice(ot,ot+76));return cr.join(`\r
`)+`\r
`})(It))}return At.push(St+`--\r
`),At.join(`\r
`)}(Q,se);if(v(Q),se.fileType==="zip")return function(ut,gt){var gt=gt||{},St=[],At=[],et=Ae(1),ze=gt.compression?8:0,kt=0,ct=0,Qe=0,It=0,Dt=0,zr=ut.FullPaths[0],Mt=zr,Kt=ut.FileIndex[0],Tt=[],ir=0;for(ct=1;ct<ut.FullPaths.length;++ct)if(Mt=ut.FullPaths[ct].slice(zr.length),(Kt=ut.FileIndex[ct]).size&&Kt.content&&Mt!="Sh33tJ5"){var cr=It,ot=Ae(Mt.length);for(Qe=0;Qe<Mt.length;++Qe)ot.write_shift(1,127&Mt.charCodeAt(Qe));ot=ot.slice(0,ot.l),Tt[Dt]=Oc.buf(Kt.content,0);var yt=Kt.content;ze==8&&(yt=function(ft){return _?_.deflateRawSync(ft):lt(ft)}(yt)),(et=Ae(30)).write_shift(4,67324752),et.write_shift(2,20),et.write_shift(2,kt),et.write_shift(2,ze),Kt.mt?function(ft,Zt){var xr=(Zt=typeof Zt=="string"?new Date(Zt):Zt).getHours();xr=(xr=xr<<6|Zt.getMinutes())<<5|Zt.getSeconds()>>>1,ft.write_shift(2,xr),xr=(xr=(xr=Zt.getFullYear()-1980)<<4|Zt.getMonth()+1)<<5|Zt.getDate(),ft.write_shift(2,xr)}(et,Kt.mt):et.write_shift(4,0),et.write_shift(-4,Tt[Dt]),et.write_shift(4,yt.length),et.write_shift(4,Kt.content.length),et.write_shift(2,ot.length),et.write_shift(2,0),It+=et.length,St.push(et),It+=ot.length,St.push(ot),It+=yt.length,St.push(yt),(et=Ae(46)).write_shift(4,33639248),et.write_shift(2,0),et.write_shift(2,20),et.write_shift(2,kt),et.write_shift(2,ze),et.write_shift(4,0),et.write_shift(-4,Tt[Dt]),et.write_shift(4,yt.length),et.write_shift(4,Kt.content.length),et.write_shift(2,ot.length),et.write_shift(2,0),et.write_shift(2,0),et.write_shift(2,0),et.write_shift(2,0),et.write_shift(4,0),et.write_shift(4,cr),ir+=et.l,At.push(et),ir+=ot.length,At.push(ot),++Dt}return(et=Ae(22)).write_shift(4,101010256),et.write_shift(2,0),et.write_shift(2,0),et.write_shift(2,Dt),et.write_shift(2,Dt),et.write_shift(4,ir),et.write_shift(4,It),et.write_shift(2,0),K([K(St),K(At),et])}(Q,se);for(var xe=function(ut){for(var st=0,gt=0,St=0;St<ut.FileIndex.length;++St){var At=ut.FileIndex[St];At.content&&0<(At=At.content.length)&&(At<4096?st+=At+63>>6:gt+=At+511>>9)}for(var et=ut.FullPaths.length+3>>2,ze=st+127>>7,kt=(st+7>>3)+gt+et+ze,ct=kt+127>>7,Qe=ct<=109?0:Math.ceil((ct-109)/127);ct<kt+ct+Qe+127>>7;)Qe=++ct<=109?0:Math.ceil((ct-109)/127);return et=[1,Qe,ct,ze,et,gt,st,0],ut.FileIndex[0].size=st<<6,et[7]=(ut.FileIndex[0].start=et[0]+et[1]+et[2]+et[3]+et[4]+et[5])+(et[6]+7>>3),et}(Q),re=Ae(xe[7]<<9),be=0,Me=0,be=0;be<8;++be)re.write_shift(1,k[be]);for(be=0;be<8;++be)re.write_shift(2,0);for(re.write_shift(2,62),re.write_shift(2,3),re.write_shift(2,65534),re.write_shift(2,9),re.write_shift(2,6),be=0;be<3;++be)re.write_shift(2,0);for(re.write_shift(4,0),re.write_shift(4,xe[2]),re.write_shift(4,xe[0]+xe[1]+xe[2]+xe[3]-1),re.write_shift(4,0),re.write_shift(4,4096),re.write_shift(4,xe[3]?xe[0]+xe[1]+xe[2]-1:S),re.write_shift(4,xe[3]),re.write_shift(-4,xe[1]?xe[0]-1:S),re.write_shift(4,xe[1]),be=0;be<109;++be)re.write_shift(-4,be<xe[2]?xe[1]+be:-1);if(xe[1])for(Me=0;Me<xe[1];++Me){for(;be<236+127*Me;++be)re.write_shift(-4,be<xe[2]?xe[1]+be:-1);re.write_shift(-4,Me===xe[1]-1?S:Me+1)}function Se(ut){for(Me+=ut;be<Me-1;++be)re.write_shift(-4,be+1);ut&&(++be,re.write_shift(-4,S))}for(Me=be=0,Me+=xe[1];be<Me;++be)re.write_shift(-4,D.DIFSECT);for(Me+=xe[2];be<Me;++be)re.write_shift(-4,D.FATSECT);Se(xe[3]),Se(xe[4]);for(var ge=0,ke=0,We=Q.FileIndex[0];ge<Q.FileIndex.length;++ge)(We=Q.FileIndex[ge]).content&&((ke=We.content.length)<4096||(We.start=Me,Se(ke+511>>9)));for(Se(xe[6]+7>>3);511&re.l;)re.write_shift(-4,D.ENDOFCHAIN);for(ge=Me=be=0;ge<Q.FileIndex.length;++ge)(We=Q.FileIndex[ge]).content&&(!(ke=We.content.length)||4096<=ke||(We.start=Me,Se(ke+63>>6)));for(;511&re.l;)re.write_shift(-4,D.ENDOFCHAIN);for(be=0;be<xe[4]<<2;++be){var _t=Q.FullPaths[be];if(_t&&_t.length!==0){if(We=Q.FileIndex[be],be===0&&(We.start=We.size?We.start-1:S),_t=be===0&&se.root||We.name,ke=2*(_t.length+1),re.write_shift(64,_t,"utf16le"),re.write_shift(2,ke),re.write_shift(1,We.type),re.write_shift(1,We.color),re.write_shift(-4,We.L),re.write_shift(-4,We.R),re.write_shift(-4,We.C),We.clsid)re.write_shift(16,We.clsid,"hex");else for(ge=0;ge<4;++ge)re.write_shift(4,0);re.write_shift(4,We.state||0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,We.start),re.write_shift(4,We.size),re.write_shift(4,0)}else{for(ge=0;ge<17;++ge)re.write_shift(4,0);for(ge=0;ge<3;++ge)re.write_shift(4,-1);for(ge=0;ge<12;++ge)re.write_shift(4,0)}}for(be=1;be<Q.FileIndex.length;++be)if(4096<=(We=Q.FileIndex[be]).size)if(re.l=We.start+1<<9,te&&Buffer.isBuffer(We.content))We.content.copy(re,re.l,0,We.size),re.l+=We.size+511&-512;else{for(ge=0;ge<We.size;++ge)re.write_shift(1,We.content[ge]);for(;511&ge;++ge)re.write_shift(1,0)}for(be=1;be<Q.FileIndex.length;++be)if(0<(We=Q.FileIndex[be]).size&&We.size<4096)if(te&&Buffer.isBuffer(We.content))We.content.copy(re,re.l,0,We.size),re.l+=We.size+63&-64;else{for(ge=0;ge<We.size;++ge)re.write_shift(1,We.content[ge]);for(;63&ge;++ge)re.write_shift(1,0)}if(te)re.l=re.length;else for(;re.l<re.length;)re.write_shift(1,0);return re}o.version="1.2.1";var _,T=64,S=-2,I="d0cf11e0a1b11ae1",k=[208,207,17,224,161,177,26,225],M="00000000000000000000000000000000",D={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:S,FREESECT:-1,HEADER_SIGNATURE:I,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:M,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function F(Q){for(var Te=new Array(Q.length),se=0;se<Q.length;++se)Te[se]=String.fromCharCode(Q[se]);return Te.join("")}for(var j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],B=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],z=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],ae,he=typeof Uint8Array<"u",le=he?new Uint8Array(256):[],ve=0;ve<256;++ve)le[ve]=255&((ae=139536&((ae=ve)<<1|ae<<11)|558144&(ae<<5|ae<<15))>>16|ae>>8|ae);function Ie(Q,xe){var se=7&xe,xe=xe>>>3;return(Q[xe]|(se<=5?0:Q[1+xe]<<8))>>>se&7}function De(Q,xe){var se=7&xe,xe=xe>>>3;return(Q[xe]|(se<=3?0:Q[1+xe]<<8))>>>se&31}function _e(Q,xe){var se=7&xe,xe=xe>>>3;return(Q[xe]|(se<=1?0:Q[1+xe]<<8))>>>se&127}function Ue(Q,be,se){var xe=7&be,re=be>>>3,Me=(1<<se)-1,be=Q[re]>>>xe;return se<8-xe?be&Me:(be|=Q[1+re]<<8-xe,se<16-xe?be&Me:(be|=Q[2+re]<<16-xe,se<24-xe?be&Me:(be|=Q[3+re]<<24-xe)&Me))}function it(Q,Te,se){var xe=7&Te,re=Te>>>3;return xe<=5?Q[re]|=(7&se)<<xe:(Q[re]|=se<<xe&255,Q[1+re]=(7&se)>>8-xe),Te+3}function nt(Q,Te,se){var xe=Te>>>3;return se<<=7&Te,Q[xe]|=255&se,se>>>=8,Q[1+xe]=se,Te+8}function Ye(Q,Te,se){var xe=Te>>>3;return se<<=7&Te,Q[xe]|=255&se,se>>>=8,Q[1+xe]=255&se,Q[2+xe]=se>>>8,Te+16}function Je(Q,Te){var se=Q.length,xe=Te<2*se?2*se:Te+5,re=0;if(Te<=se)return Q;if(te){var Me=O(xe);if(Q.copy)Q.copy(Me);else for(;re<Q.length;++re)Me[re]=Q[re];return Me}if(he){var be=new Uint8Array(xe);if(be.set)be.set(Q);else for(;re<se;++re)be[re]=Q[re];return be}return Q.length=xe,Q}function Ge(Q){for(var Te=new Array(Q),se=0;se<Q;++se)Te[se]=0;return Te}function je(Q,Te,se){for(var xe,re=1,ke=0,Me=0,be=0,Se=Q.length,ge=he?new Uint16Array(32):Ge(32),ke=0;ke<32;++ke)ge[ke]=0;for(ke=Se;ke<se;++ke)Q[ke]=0;Se=Q.length;var We=he?new Uint16Array(Se):Ge(Se);for(ke=0;ke<Se;++ke)ge[xe=Q[ke]]++,re<xe&&(re=xe),We[ke]=0;for(ge[0]=0,ke=1;ke<=re;++ke)ge[ke+16]=be=be+ge[ke-1]<<1;for(ke=0;ke<Se;++ke)(be=Q[ke])!=0&&(We[ke]=ge[be+16]++);var _t,ut,st,gt;for(ke=0;ke<Se;++ke)if((_t=Q[ke])!=0)for(ut=We[ke],st=re,gt=void 0,gt=le[255&ut],be=(st<=8?gt>>>8-st:(gt=gt<<8|le[ut>>8&255],st<=16?gt>>>16-st:(gt=gt<<8|le[ut>>16&255])>>>24-st))>>re-_t,Me=(1<<re+4-_t)-1;0<=Me;--Me)Te[be|Me<<_t]=15&_t|ke<<4;return re}var ht=he?new Uint16Array(512):Ge(512),xt=he?new Uint16Array(32):Ge(32);if(!he){for(var Nt=0;Nt<512;++Nt)ht[Nt]=0;for(Nt=0;Nt<32;++Nt)xt[Nt]=0}(function(){for(var Q=[],Te=0;Te<32;Te++)Q.push(5);je(Q,xt,32);for(var se=[],Te=0;Te<=143;Te++)se.push(8);for(;Te<=255;Te++)se.push(9);for(;Te<=279;Te++)se.push(7);for(;Te<=287;Te++)se.push(8);je(se,ht,288)})();var Jt=function(){for(var Q=he?new Uint8Array(32768):[],Te=0,se=0;Te<z.length-1;++Te)for(;se<z[Te+1];++se)Q[se]=Te;for(;se<32768;++se)Q[se]=29;for(var xe=he?new Uint8Array(259):[],Te=0,se=0;Te<B.length-1;++Te)for(;se<B[Te+1];++se)xe[se]=Te;return function(re,Me){return(re.length<8?function(be,Se){for(var ge=0;ge<be.length;){var ke=Math.min(65535,be.length-ge),We=ge+ke==be.length;for(Se.write_shift(1,+We),Se.write_shift(2,ke),Se.write_shift(2,65535&~ke);0<ke--;)Se[Se.l++]=be[ge++]}return Se.l}:function(be,Se){for(var ge=0,ke=0,We=he?new Uint16Array(32768):[];ke<be.length;){var _t=Math.min(65535,be.length-ke);if(_t<10){for(7&(ge=it(Se,ge,+(ke+_t==be.length)))&&(ge+=8-(7&ge)),Se.l=ge/8|0,Se.write_shift(2,_t),Se.write_shift(2,65535&~_t);0<_t--;)Se[Se.l++]=be[ke++];ge=8*Se.l}else{ge=it(Se,ge,+(ke+_t==be.length)+2);for(var ut=0;0<_t--;){var st=be[ke],ut=32767&(ut<<5^st),gt=-1,St=0;if((gt=We[ut])&&(ke<(gt|=-32768&ke)&&(gt-=32768),gt<ke))for(;be[gt+St]==be[ke+St]&&St<250;)++St;if(2<St){(st=xe[St])<=22?ge=nt(Se,ge,le[st+1]>>1)-1:(nt(Se,ge,3),nt(Se,ge+=5,le[st-23]>>5),ge+=3);var At=st<8?0:st-4>>2;0<At&&(Ye(Se,ge,St-B[st]),ge+=At),st=Q[ke-gt],ge=nt(Se,ge,le[st]>>3),ge-=3;var et=st<4?0:st-2>>1;0<et&&(Ye(Se,ge,ke-gt-z[st]),ge+=et);for(var ze=0;ze<St;++ze)We[ut]=32767&ke,ut=32767&(ut<<5^be[ke]),++ke;_t-=St-1}else st<=143?st+=48:(At=((At=1)&At)<<(7&(et=ge)),Se[et>>>3]|=At,ge=et+1),ge=nt(Se,ge,le[st]),We[ut]=32767&ke,++ke}ge=nt(Se,ge,0)-1}}return Se.l=(ge+7)/8|0,Se.l})(re,Me)}}();function lt(se){var Te=Ae(50+Math.floor(1.1*se.length)),se=Jt(se,Te);return Te.slice(0,se)}var Le=he?new Uint16Array(32768):Ge(32768),Ut=he?new Uint16Array(32768):Ge(32768),pr=he?new Uint16Array(128):Ge(128),ar=1,Nr=1;function un(Q,Te){if(Q[0]==3&&!(3&Q[1]))return[L(Te),2];for(var se=0,xe=0,re=O(Te||1<<18),Me=0,be=re.length>>>0,Se=0,ge=0;!(1&xe);)if(xe=Ie(Q,se),se+=3,xe>>>1!=0)for(ge=xe>>1==1?(Se=9,5):(se=function(St,At){var et,ze,kt,ct=De(St,At)+257,Qe=De(St,At+=5)+1,It=(kt=7&(ze=At+=5),4+(((et=St)[ze=ze>>>3]|(kt<=4?0:et[1+ze]<<8))>>>kt&15));At+=4;for(var Dt=0,zr=he?new Uint8Array(19):Ge(19),Mt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Kt=1,Tt=he?new Uint8Array(8):Ge(8),ir=he?new Uint8Array(8):Ge(8),cr=zr.length,ot=0;ot<It;++ot)zr[j[ot]]=Dt=Ie(St,At),Kt<Dt&&(Kt=Dt),Tt[Dt]++,At+=3;var yt=0;for(Tt[0]=0,ot=1;ot<=Kt;++ot)ir[ot]=yt=yt+Tt[ot-1]<<1;for(ot=0;ot<cr;++ot)(yt=zr[ot])!=0&&(Mt[ot]=ir[yt]++);for(var ft,ot=0;ot<cr;++ot)if((ft=zr[ot])!=0){yt=le[Mt[ot]]>>8-ft;for(var Zt=(1<<7-ft)-1;0<=Zt;--Zt)pr[yt|Zt<<ft]=7&ft|ot<<3}for(var xr,In,On,_n=[],Kt=1;_n.length<ct+Qe;)switch(At+=7&(yt=pr[_e(St,At)]),yt>>>=3){case 16:for(Dt=3+(On=void 0,On=7&(In=At),((xr=St)[In=In>>>3]|(On<=6?0:xr[1+In]<<8))>>>On&3),At+=2,yt=_n[_n.length-1];0<Dt--;)_n.push(yt);break;case 17:for(Dt=3+Ie(St,At),At+=3;0<Dt--;)_n.push(0);break;case 18:for(Dt=11+_e(St,At),At+=7;0<Dt--;)_n.push(0);break;default:_n.push(yt),Kt<yt&&(Kt=yt)}var es=_n.slice(0,ct),ts=_n.slice(ct);for(ot=ct;ot<286;++ot)es[ot]=0;for(ot=Qe;ot<30;++ot)ts[ot]=0;return ar=je(es,Le,286),Nr=je(ts,Ut,30),At}(Q,se),Se=ar,Nr);;){!Te&&be<Me+32767&&(be=(re=Je(re,Me+32767)).length);var ke=Ue(Q,se,Se),We=(xe>>>1==1?ht:Le)[ke];if(se+=15&We,((We>>>=4)>>>8&255)==0)re[Me++]=We;else{if(We==256)break;var _t=(We-=257)<8?0:We-4>>2;5<_t&&(_t=0);var ut=Me+B[We];0<_t&&(ut+=Ue(Q,se,_t),se+=_t),ke=Ue(Q,se,ge),se+=15&(We=(xe>>>1==1?xt:Ut)[ke]);var ke=(We>>>=4)<4?0:We-2>>1,st=z[We];for(0<ke&&(st+=Ue(Q,se,ke),se+=ke),!Te&&be<ut&&(be=(re=Je(re,ut+100)).length);Me<ut;)re[Me]=re[Me-st],++Me}}else{7&se&&(se+=8-(7&se));var gt=Q[se>>>3]|Q[1+(se>>>3)]<<8;if(se+=32,0<gt)for(!Te&&be<Me+gt&&(be=(re=Je(re,Me+gt)).length);0<gt--;)re[Me++]=Q[se>>>3],se+=8}return Te?[re,se+7>>>3]:[re.slice(0,Me),se+7>>>3]}function ie(Q,Te){return Te=un(Q.slice(Q.l||0),Te),Q.l+=Te[1],Te[0]}function Ir(Q,Te){if(!Q)throw new Error(Te);typeof console<"u"&&console.error(Te)}function Sr(Q,Te){var se=Q;xn(se,0);var xe={FileIndex:[],FullPaths:[]};y(xe,{root:Te.root});for(var re=se.length-4;(se[re]!=80||se[re+1]!=75||se[re+2]!=5||se[re+3]!=6)&&0<=re;)--re;se.l=re+4,se.l+=4;var Me=se.read_shift(2);for(se.l+=6,Te=se.read_shift(4),se.l=Te,re=0;re<Me;++re){se.l+=20;var be=se.read_shift(4),Se=se.read_shift(4),ge=se.read_shift(2),ke=se.read_shift(2),We=se.read_shift(2);se.l+=8;var _t=se.read_shift(4),ut=u(se.slice(se.l+ge,se.l+ge+ke));se.l+=ge+ke+We,We=se.l,se.l=_t+4,function(st,gt,St,At,et){st.l+=2;var ze=st.read_shift(2),kt=st.read_shift(2),ct=function(xr){var ot=65535&xr.read_shift(2),yt=65535&xr.read_shift(2),ft=new Date,Zt=31&yt,xr=15&(yt>>>=5);return yt>>>=4,ft.setMilliseconds(0),ft.setFullYear(1980+yt),ft.setMonth(xr-1),ft.setDate(Zt),xr=31&ot,Zt=63&(ot>>>=5),ot>>>=6,ft.setHours(ot),ft.setMinutes(Zt),ft.setSeconds(xr<<1),ft}(st);if(8257&ze)throw new Error("Unsupported ZIP encryption");st.read_shift(4);for(var Qe,It=st.read_shift(4),Dt=st.read_shift(4),zr=st.read_shift(2),Mt=st.read_shift(2),Kt="",Tt=0;Tt<zr;++Tt)Kt+=String.fromCharCode(st[st.l++]);Mt&&(((Qe=u(st.slice(st.l,st.l+Mt)))[21589]||{}).mt&&(ct=Qe[21589].mt),((et||{})[21589]||{}).mt&&(ct=et[21589].mt)),st.l+=Mt;var ir=st.slice(st.l,st.l+It);switch(kt){case 8:ir=function(cr,ft){if(!_)return ie(cr,ft);var yt=new _.InflateRaw,ft=yt._processChunk(cr.slice(cr.l),yt._finishFlushFlag);return cr.l+=yt.bytesRead,ft}(st,Dt);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+kt)}Mt=!1,8&ze&&(st.read_shift(4)==134695760&&(st.read_shift(4),Mt=!0),It=st.read_shift(4),Dt=st.read_shift(4)),It!=gt&&Ir(Mt,"Bad compressed size: "+gt+" != "+It),Dt!=St&&Ir(Mt,"Bad uncompressed size: "+St+" != "+Dt),ea(At,Kt,ir,{unsafe:!0,mt:ct})}(se,be,Se,xe,ut),se.l=We}return xe}var Nn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ea(Q,Te,se,xe){var re=xe&&xe.unsafe;re||y(Q);var Me,be=!re&&wt.find(Q,Te);return be||(Me=Q.FullPaths[0],Me=Te.slice(0,Me.length)==Me?Te:(Me.slice(-1)!="/"&&(Me+="/"),(Me+Te).replace("//","/")),be={name:c(Te),type:2},Q.FileIndex.push(be),Q.FullPaths.push(Me),re||wt.utils.cfb_gc(Q)),be.content=se,be.size=se?se.length:0,xe&&(xe.CLSID&&(be.clsid=xe.CLSID),xe.mt&&(be.mt=xe.mt),xe.ct&&(be.ct=xe.ct)),be}return o.find=function(Q,Te){var se=Q.FullPaths.map(function(ge){return ge.toUpperCase()}),xe=se.map(function(ge){var ke=ge.split("/");return ke[ke.length-(ge.slice(-1)=="/"?2:1)]}),re=!1;Te.charCodeAt(0)===47?(re=!0,Te=se[0].slice(0,-1)+Te):re=Te.indexOf("/")!==-1;var Se=Te.toUpperCase(),Me=(re===!0?se:xe).indexOf(Se);if(Me!==-1)return Q.FileIndex[Me];var be=!Se.match(He),Se=Se.replace(me,"");for(be&&(Se=Se.replace(He,"!")),Me=0;Me<se.length;++Me)if((be?se[Me].replace(He,"!"):se[Me]).replace(me,"")==Se||(be?xe[Me].replace(He,"!"):xe[Me]).replace(me,"")==Se)return Q.FileIndex[Me];return null},o.read=function(Q,Te){var se,xe,re=Te&&Te.type;switch(re||te&&Buffer.isBuffer(Q)&&(re="buffer"),re||"base64"){case"file":return se=Q,xe=Te,h(),f(a.readFileSync(se),xe);case"base64":return f(V(ee(Q)),Te);case"binary":return f(V(Q),Te)}return f(Q,Te)},o.parse=f,o.write=function(Q,Te){var se=b(Q,Te);switch(Te&&Te.type||"buffer"){case"file":return h(),a.writeFileSync(Te.filename,se),se;case"binary":return typeof se=="string"?se:F(se);case"base64":return H(typeof se=="string"?se:F(se));case"buffer":if(te)return Buffer.isBuffer(se)?se:ue(se);case"array":return typeof se=="string"?V(se):se}return se},o.writeFile=function(Q,Te,se){h(),se=b(Q,se),a.writeFileSync(Te,se)},o.utils={cfb_new:function(Q){var Te={};return y(Te,Q),Te},cfb_add:ea,cfb_del:function(Q,Te){y(Q);var se=wt.find(Q,Te);if(se){for(var xe=0;xe<Q.FileIndex.length;++xe)if(Q.FileIndex[xe]==se)return Q.FileIndex.splice(xe,1),Q.FullPaths.splice(xe,1),!0}return!1},cfb_mov:function(Q,Te,se){y(Q);var xe=wt.find(Q,Te);if(xe){for(var re=0;re<Q.FileIndex.length;++re)if(Q.FileIndex[re]==xe)return Q.FileIndex[re].name=c(se),Q.FullPaths[re]=se,!0}return!1},cfb_gc:function(Q){v(Q,!0)},ReadShift:Mi,CheckField:Yn,prep_blob:xn,bconcat:K,use_zlib:function(Q){try{var Te=new Q.InflateRaw;if(Te._processChunk(new Uint8Array([3,0]),Te._finishFlushFlag),!Te.bytesRead)throw new Error("zlib does not expose bytesRead");_=Q}catch(se){console.error("cannot use native zlib: "+(se.message||se))}},_deflateRaw:lt,_inflateRaw:ie,consts:D},o}();if(typeof Fd<"u")try{Ws=W1}catch{}function zf(a){return typeof a=="string"?W(a):Array.isArray(a)?function(o){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(o)}(a):a}function Aa(a,o,l){if(Ws!==void 0&&Ws.writeFileSync)return l?Ws.writeFileSync(a,o,l):Ws.writeFileSync(a,o);if(typeof Deno<"u"){if(l&&typeof o=="string")switch(l){case"utf8":o=new TextEncoder(l).encode(o);break;case"binary":o=W(o);break;default:throw new Error("Unsupported encoding "+l)}return Deno.writeFileSync(a,o)}var c=l=="utf8"?Os(o):o;if(typeof IE_SaveFile<"u")return IE_SaveFile(c,a);if(typeof Blob<"u"){if(c=new Blob([zf(c)],{type:"application/octet-stream"}),typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(c,a);if(typeof saveAs<"u")return saveAs(c,a);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var u=URL.createObjectURL(c);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(u)},6e4),chrome.downloads.download({url:u,filename:a,saveAs:!0});if(c=document.createElement("a"),c.download!=null)return c.download=a,c.href=u,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(u)},6e4),u}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var h=File(a);return h.open("w"),h.encoding="binary",Array.isArray(o)&&(o=J(o)),h.write(o),h.close(),o}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+a)}function Gr(a){for(var o=Object.keys(a),l=[],c=0;c<o.length;++c)Object.prototype.hasOwnProperty.call(a,o[c])&&l.push(o[c]);return l}function Fi(a,o){for(var l=[],c=Gr(a),u=0;u!==c.length;++u)l[a[c[u]][o]]==null&&(l[a[c[u]][o]]=c[u]);return l}function wo(a){for(var o=[],l=Gr(a),c=0;c!==l.length;++c)o[a[l[c]]]=l[c];return o}function yn(a){for(var o=[],l=Gr(a),c=0;c!==l.length;++c)o[a[l[c]]]=parseInt(l[c],10);return o}var _o=new Date(1899,11,30,0,0,0);function qr(a,o){var l=a.getTime();return(l-(_o.getTime()+6e4*(a.getTimezoneOffset()-_o.getTimezoneOffset())))/864e5}var Ca=new Date,Q0=_o.getTime()+6e4*(Ca.getTimezoneOffset()-_o.getTimezoneOffset()),Hf=Ca.getTimezoneOffset();function ha(a){var o=new Date;return o.setTime(24*a*60*60*1e3+Q0),o.getTimezoneOffset()!==Hf&&o.setTime(o.getTime()+6e4*(o.getTimezoneOffset()-Hf)),o}var xl=new Date("2017-02-19T19:06:09.000Z"),Gf=isNaN(xl.getFullYear())?new Date("2/19/17"):xl,bl=Gf.getFullYear()==2017;function Ur(a,o){var l=new Date(a);return bl?(0<o?l.setTime(l.getTime()+60*l.getTimezoneOffset()*1e3):o<0&&l.setTime(l.getTime()-60*l.getTimezoneOffset()*1e3),l):a instanceof Date?a:Gf.getFullYear()==1917&&!isNaN(l.getFullYear())?(o=l.getFullYear(),-1<a.indexOf(""+o)||l.setFullYear(l.getFullYear()+100),l):(l=a.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+l[0],+l[1]-1,+l[2],+l[3]||0,+l[4]||0,+l[5]||0),l=-1<a.indexOf("Z")?new Date(l.getTime()-60*l.getTimezoneOffset()*1e3):l)}function da(a,o){if(te&&Buffer.isBuffer(a)){if(o){if(a[0]==255&&a[1]==254)return Os(a.slice(2).toString("utf16le"));if(a[1]==254&&a[2]==255)return Os(Z(a.slice(2).toString("binary")))}return a.toString("binary")}if(typeof TextDecoder<"u")try{if(o){if(a[0]==255&&a[1]==254)return Os(new TextDecoder("utf-16le").decode(a.slice(2)));if(a[0]==254&&a[1]==255)return Os(new TextDecoder("utf-16be").decode(a.slice(2)))}var l={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(a)&&(a=new Uint8Array(a)),new TextDecoder("latin1").decode(a).replace(/[]/g,function(h){return l[h]||h})}catch{}for(var c=[],u=0;u!=a.length;++u)c.push(String.fromCharCode(a[u]));return c.join("")}function Tr(a){if(typeof JSON<"u"&&!Array.isArray(a))return JSON.parse(JSON.stringify(a));if(typeof a!="object"||a==null)return a;if(a instanceof Date)return new Date(a.getTime());var o,l={};for(o in a)Object.prototype.hasOwnProperty.call(a,o)&&(l[o]=Tr(a[o]));return l}function Cr(a,o){for(var l="";l.length<o;)l+=a;return l}function _s(c){var o=Number(c);if(!isNaN(o))return isFinite(o)?o:NaN;if(!/\d/.test(c))return o;var l=1,c=c.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return l*=100,""});return isNaN(o=Number(c))?(c=c.replace(/[(](.*)[)]/,function(u,h){return l=-l,h}),isNaN(o=Number(c))?o:o/l):o/l}var qf=["january","february","march","april","may","june","july","august","september","october","november","december"];function ka(a){var o=new Date(a),l=new Date(NaN),c=o.getYear(),u=o.getMonth(),h=o.getDate();if(isNaN(h))return l;var f=a.toLowerCase();if(f.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(3<(f=f.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length&&qf.indexOf(f)==-1)return l}else if(f.match(/[a-z]/))return l;return c<0||8099<c||(!(0<u||1<h)||c==101)&&a.match(/[^-0-9:,\/\\]/)?l:o}var wl,Kf=(wl="abacaba".split(/(:?b)/i).length==5,function(a,o,l){if(wl||typeof o=="string")return a.split(o);for(var c=a.split(o),u=[c[0]],h=1;h<c.length;++h)u.push(l),u.push(c[h]);return u});function jc(a){return a?a.content&&a.type?da(a.content,!0):a.data?ne(a.data):a.asNodeBuffer&&te?ne(a.asNodeBuffer().toString("binary")):a.asBinary?ne(a.asBinary()):a._data&&a._data.getContent?ne(da(Array.prototype.slice.call(a._data.getContent(),0))):null:null}function Yf(a){if(!a)return null;if(a.data)return q(a.data);if(a.asNodeBuffer&&te)return a.asNodeBuffer();if(a._data&&a._data.getContent){var o=a._data.getContent();return typeof o=="string"?q(o):Array.prototype.slice.call(o)}return a.content&&a.type?a.content:null}function Un(a,o){for(var l=a.FullPaths||Gr(a.files),c=o.toLowerCase().replace(/[\/]/g,"\\"),u=c.replace(/\\/g,"/"),h=0;h<l.length;++h){var f=l[h].replace(/^Root Entry[\/]/,"").toLowerCase();if(c==f||u==f)return a.files?a.files[l[h]]:a.FileIndex[h]}return null}function _l(a,o){if(a=Un(a,o),a==null)throw new Error("Cannot find file "+o+" in zip");return a}function Jr(a,o,l){if(!l)return((l=_l(a,o))&&l.name.slice(-4)===".bin"?Yf:jc)(l);if(!o)return null;try{return Jr(a,o)}catch{return null}}function kn(a,o,l){if(!l)return jc(_l(a,o));if(!o)return null;try{return kn(a,o)}catch{return null}}function Fa(a){for(var o=a.FullPaths||Gr(a.files),l=[],c=0;c<o.length;++c)o[c].slice(-1)!="/"&&l.push(o[c].replace(/^Root Entry[\/]/,""));return l.sort()}function Wt(a,o,l){if(a.FullPaths){if(typeof l=="string"){var c=(te?ue:function(u){for(var h=[],f=0,d=u.length+250,y=L(u.length+255),v=0;v<u.length;++v){var b,_=u.charCodeAt(v);_<128?y[f++]=_:_<2048?(y[f++]=192|_>>6&31,y[f++]=128|63&_):55296<=_&&_<57344?(_=64+(1023&_),b=1023&u.charCodeAt(++v),y[f++]=240|_>>8&7,y[f++]=128|_>>2&63,y[f++]=128|b>>6&15|(3&_)<<4,y[f++]=128|63&b):(y[f++]=224|_>>12&15,y[f++]=128|_>>6&63,y[f++]=128|63&_),d<f&&(h.push(y.slice(0,f)),f=0,y=L(65535),d=65530)}return h.push(y.slice(0,f)),K(h)})(l);return wt.utils.cfb_add(a,o,c)}wt.utils.cfb_add(a,o,l)}else a.file(o,l)}function Mc(){return wt.utils.cfb_new()}function Lc(a,o){switch(o.type){case"base64":return wt.read(a,{type:"base64"});case"binary":return wt.read(a,{type:"binary"});case"buffer":case"array":return wt.read(a,{type:"buffer"})}throw new Error("Unrecognized type "+o.type)}function Ni(a,o){if(a.charAt(0)=="/")return a.slice(1);var l=o.split("/");o.slice(-1)!="/"&&l.pop();for(var c=a.split("/");c.length!==0;){var u=c.shift();u===".."?l.pop():u!=="."&&l.push(u)}return l.join("/")}var Zr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Vc=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Ph=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,vn=Zr.match(Ph)?Ph:/<[^>]*>/g,Qf=/<\w*:/,Xf=/<(\/?)\w+:/;function Lt(a,o,l){for(var c={},u=0,h=0;u!==a.length&&(h=a.charCodeAt(u))!==32&&h!==10&&h!==13;++u);if(o||(c[0]=a.slice(0,u)),u===a.length)return c;var f,d,y,v=a.match(Vc),b=0,_=0,T="",S="";if(v)for(_=0;_!=v.length;++_){for(S=v[_],h=0;h!=S.length&&S.charCodeAt(h)!==61;++h);for(T=S.slice(0,h).trim();S.charCodeAt(h+1)==32;)++h;for(d=(u=S.charCodeAt(h+1))==34||u==39?1:0,f=S.slice(h+1+d,S.length-d),b=0;b!=T.length&&T.charCodeAt(b)!==58;++b);b===T.length?(c[T=0<T.indexOf("_")?T.slice(0,T.indexOf("_")):T]=f,c[T.toLowerCase()]=f):c[y=(b===5&&T.slice(0,5)==="xmlns"?"xmlns":"")+T.slice(b+1)]&&T.slice(b-3,b)=="ext"||(c[y]=f,c[y.toLowerCase()]=f)}return c}function zs(a){return a.replace(Xf,"<$1")}var Uc,Bc,Jf={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},pa=wo(Jf),qt=(Uc=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,Bc=/_x([\da-fA-F]{4})_/gi,function a(o){var l=o+"",c=l.indexOf("<![CDATA[");return c==-1?l.replace(Uc,function(u,h){return Jf[u]||String.fromCharCode(parseInt(h,-1<u.indexOf("x")?16:10))||u}).replace(Bc,function(u,h){return String.fromCharCode(parseInt(h,16))}):(o=l.indexOf("]]>"),a(l.slice(0,c))+l.slice(c+9,o)+a(l.slice(o+3)))}),Ii=/[&<>'"]/g,Tl=/[\u0000-\u0008\u000b-\u001f]/g;function Er(a){return(a+"").replace(Ii,function(o){return pa[o]}).replace(Tl,function(o){return"_x"+("000"+o.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Br(a){return Er(a).replace(/ /g,"_x0020_")}var To=/[\u0000-\u001f]/g;function Xa(a){return(a+"").replace(Ii,function(o){return pa[o]}).replace(/\n/g,"<br/>").replace(To,function(o){return"&#x"+("000"+o.charCodeAt(0).toString(16)).slice(-4)+";"})}var Di,Zf=(Di=/&#(\d+);/g,function(a){return a.replace(Di,eh)});function eh(a,o){return String.fromCharCode(parseInt(o,10))}function $r(a){switch(a){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function $c(a){for(var o,l,c,u,h="",f=0,d=0;f<a.length;)(o=a.charCodeAt(f++))<128?h+=String.fromCharCode(o):(l=a.charCodeAt(f++),191<o&&o<224?(d=(31&o)<<6,d|=63&l,h+=String.fromCharCode(d)):(c=a.charCodeAt(f++),o<240?h+=String.fromCharCode((15&o)<<12|(63&l)<<6|63&c):(u=((7&o)<<18|(63&l)<<12|(63&c)<<6|63&(d=a.charCodeAt(f++)))-65536,h+=String.fromCharCode(55296+(u>>>10&1023)),h+=String.fromCharCode(56320+(1023&u)))));return h}function th(a){for(var o,l,c=L(2*a.length),u=1,h=0,f=0,d=0;d<a.length;d+=u)u=1,(l=a.charCodeAt(d))<128?o=l:l<224?(o=64*(31&l)+(63&a.charCodeAt(d+1)),u=2):l<240?(o=4096*(15&l)+64*(63&a.charCodeAt(d+1))+(63&a.charCodeAt(d+2)),u=3):(u=4,o=262144*(7&l)+4096*(63&a.charCodeAt(d+1))+64*(63&a.charCodeAt(d+2))+(63&a.charCodeAt(d+3)),f=55296+((o-=65536)>>>10&1023),o=56320+(1023&o)),f!==0&&(c[h++]=255&f,c[h++]=f>>>8,f=0),c[h++]=o%256,c[h++]=o>>>8;return c.slice(0,h).toString("ucs2")}function rh(a){return ue(a,"binary").toString("utf8")}var Ja,Ps,Eo,Vl="foo bar baz",kr=te&&(rh(Vl)==$c(Vl)?rh:th(Vl)==$c(Vl)&&th)||$c,Os=te?function(a){return ue(a,"utf8").toString("binary")}:function(a){for(var o,l=[],c=0,u=0;c<a.length;)switch(!0){case(u=a.charCodeAt(c++))<128:l.push(String.fromCharCode(u));break;case u<2048:l.push(String.fromCharCode(192+(u>>6))),l.push(String.fromCharCode(128+(63&u)));break;case(55296<=u&&u<57344):u-=55296,o=a.charCodeAt(c++)-56320+(u<<10),l.push(String.fromCharCode(240+(o>>18&7))),l.push(String.fromCharCode(144+(o>>12&63))),l.push(String.fromCharCode(128+(o>>6&63))),l.push(String.fromCharCode(128+(63&o)));break;default:l.push(String.fromCharCode(224+(u>>12))),l.push(String.fromCharCode(128+(u>>6&63))),l.push(String.fromCharCode(128+(63&u)))}return l.join("")},Hs=(Ja={},function(a,o){var l=a+"|"+(o||"");return Ja[l]||(Ja[l]=new RegExp("<(?:\\w+:)?"+a+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+a+">",o||""))}),nh=(Ps=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(a){return[new RegExp("&"+a[0]+";","ig"),a[1]]}),function(a){for(var o=a.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),l=0;l<Ps.length;++l)o=o.replace(Ps[l][0],Ps[l][1]);return o}),X0=(Eo={},function(a){return Eo[a]!==void 0?Eo[a]:Eo[a]=new RegExp("<(?:vt:)?"+a+">([\\s\\S]*?)</(?:vt:)?"+a+">","g")}),J0=/<\/?(?:vt:)?variant>/g,Na=/<(?:vt:)([^>]*)>([\s\S]*)</;function sh(c,o){var l=Lt(c),c=c.match(X0(l.baseType))||[],u=[];if(c.length==l.size)return c.forEach(function(h){h=h.replace(J0,"").match(Na),h&&u.push({v:kr(h[2]),t:h[1]})}),u;if(o.WTF)throw new Error("unexpected vector length "+c.length+" != "+l.size);return u}var ah=/(^\s|\s$|\n)/;function cn(a,o){return"<"+a+(o.match(ah)?' xml:space="preserve"':"")+">"+o+"</"+a+">"}function Ia(a){return Gr(a).map(function(o){return" "+o+'="'+a[o]+'"'}).join("")}function Ze(a,o,l){return"<"+a+(l!=null?Ia(l):"")+(o!=null?(o.match(ah)?' xml:space="preserve"':"")+">"+o+"</"+a:"/")+">"}function Za(a,o){try{return a.toISOString().replace(/\.\d*/,"")}catch(l){if(o)throw l}return""}function ei(a){if(te&&Buffer.isBuffer(a))return a.toString("utf8");if(typeof a=="string")return a;if(typeof Uint8Array<"u"&&a instanceof Uint8Array)return kr(J(X(a)));throw new Error("Bad input format: expected Buffer or string")}var Ri=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,rn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Dr=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],fs={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function ih(a){for(var o=[],l=0;l<a[0].length;++l)if(a[0][l])for(var c=0,u=a[0][l].length;c<u;c+=10240)o.push.apply(o,a[0][l].slice(c,c+10240));return o}function Wc(a,o,l){for(var c=[],u=o;u<l;u+=2)c.push(String.fromCharCode(qs(a,u)));return c.join("").replace(me,"")}function zc(a,o,l){for(var c=[],u=o;u<o+l;++u)c.push(("0"+a[u].toString(16)).slice(-2));return c.join("")}function Hc(a,o,l){for(var c=[],u=o;u<l;u++)c.push(String.fromCharCode(Da(a,u)));return c.join("")}function So(a,o){var l=dn(a,o);return 0<l?ti(a,o+4,o+4+l-1):""}function Gc(a,o){var l=dn(a,o);return 0<l?ti(a,o+4,o+4+l-1):""}function Gs(a,o){var l=2*dn(a,o);return 0<l?ti(a,o+4,o+4+l-1):""}function qc(a,o){var l=dn(a,o);return 0<l?Oi(a,o+4,o+4+l):""}function oh(a,o){var l=dn(a,o);return 0<l?ti(a,o+4,o+4+l):""}function Pi(a,o){for(var l=1-2*(a[o+7]>>>7),c=((127&a[o+7])<<4)+(a[o+6]>>>4&15),u=15&a[o+6],h=5;0<=h;--h)u=256*u+a[o+h];return c==2047?u==0?1/0*l:NaN:(c==0?c=-1022:(c-=1023,u+=Math.pow(2,52)),l*Math.pow(2,c-52)*u)}var Kc=te?function(a){return 0<a[0].length&&Buffer.isBuffer(a[0][0])?Buffer.concat(a[0].map(function(o){return Buffer.isBuffer(o)?o:ue(o)})):ih(a)}:ih,Oi=te?function(a,o,l){return Buffer.isBuffer(a)?a.toString("utf16le",o,l).replace(me,""):Wc(a,o,l)}:Wc,Ao=te?function(a,o,l){return Buffer.isBuffer(a)?a.toString("hex",o,o+l):zc(a,o,l)}:zc,ti=te?function(a,o,l){return Buffer.isBuffer(a)?a.toString("utf8",o,l):Hc(a,o,l)}:Hc,ji=So,Yc=Gc,El=Gs,ri=qc,Sl=oh,Co=Pi,ko=function(a){return Array.isArray(a)||typeof Uint8Array<"u"&&a instanceof Uint8Array};te&&(ji=function(a,o){if(!Buffer.isBuffer(a))return So(a,o);var l=a.readUInt32LE(o);return 0<l?a.toString("utf8",o+4,o+4+l-1):""},Yc=function(a,o){if(!Buffer.isBuffer(a))return Gc(a,o);var l=a.readUInt32LE(o);return 0<l?a.toString("utf8",o+4,o+4+l-1):""},El=function(a,o){if(!Buffer.isBuffer(a))return Gs(a,o);var l=2*a.readUInt32LE(o);return a.toString("utf16le",o+4,o+4+l-1)},ri=function(a,o){if(!Buffer.isBuffer(a))return qc(a,o);var l=a.readUInt32LE(o);return a.toString("utf16le",o+4,o+4+l)},Sl=function(a,o){if(!Buffer.isBuffer(a))return oh(a,o);var l=a.readUInt32LE(o);return a.toString("utf8",o+4,o+4+l)},Co=function(a,o){return Buffer.isBuffer(a)?a.readDoubleLE(o):Pi(a,o)},ko=function(a){return Buffer.isBuffer(a)||Array.isArray(a)||typeof Uint8Array<"u"&&a instanceof Uint8Array}),e!==void 0&&(Oi=function(a,o,l){return e.utils.decode(1200,a.slice(o,l)).replace(me,"")},ti=function(a,o,l){return e.utils.decode(65001,a.slice(o,l))},ji=function(a,o){var l=dn(a,o);return 0<l?e.utils.decode(x,a.slice(o+4,o+4+l-1)):""},Yc=function(a,o){var l=dn(a,o);return 0<l?e.utils.decode(p,a.slice(o+4,o+4+l-1)):""},El=function(a,o){var l=2*dn(a,o);return 0<l?e.utils.decode(1200,a.slice(o+4,o+4+l-1)):""},ri=function(a,o){var l=dn(a,o);return 0<l?e.utils.decode(1200,a.slice(o+4,o+4+l)):""},Sl=function(a,o){var l=dn(a,o);return 0<l?e.utils.decode(65001,a.slice(o+4,o+4+l)):""});var Da=function(a,o){return a[o]},qs=function(a,o){return 256*a[o+1]+a[o]},Al=function(a,o){return o=256*a[o+1]+a[o],o<32768?o:-1*(65535-o+1)},dn=function(a,o){return a[o+3]*(1<<24)+(a[o+2]<<16)+(a[o+1]<<8)+a[o]},Ra=function(a,o){return a[o+3]<<24|a[o+2]<<16|a[o+1]<<8|a[o]},ni=function(a,o){return a[o]<<24|a[o+1]<<16|a[o+2]<<8|a[o+3]};function Mi(a,o){var l,c,u,h,f,d,y="",v=[];switch(o){case"dbcs":if(d=this.l,te&&Buffer.isBuffer(this))y=this.slice(this.l,this.l+2*a).toString("utf16le");else for(f=0;f<a;++f)y+=String.fromCharCode(qs(this,d)),d+=2;a*=2;break;case"utf8":y=ti(this,this.l,this.l+a);break;case"utf16le":a*=2,y=Oi(this,this.l,this.l+a);break;case"wstr":if(e===void 0)return Mi.call(this,a,"dbcs");y=e.utils.decode(p,this.slice(this.l,this.l+2*a)),a*=2;break;case"lpstr-ansi":y=ji(this,this.l),a=4+dn(this,this.l);break;case"lpstr-cp":y=Yc(this,this.l),a=4+dn(this,this.l);break;case"lpwstr":y=El(this,this.l),a=4+2*dn(this,this.l);break;case"lpp4":a=4+dn(this,this.l),y=ri(this,this.l),2&a&&(a+=2);break;case"8lpp4":a=4+dn(this,this.l),y=Sl(this,this.l),3&a&&(a+=4-(3&a));break;case"cstr":for(a=0,y="";(u=Da(this,this.l+a++))!==0;)v.push(fe(u));y=v.join("");break;case"_wstr":for(a=0,y="";(u=qs(this,this.l+a))!==0;)v.push(fe(u)),a+=2;a+=2,y=v.join("");break;case"dbcs-cont":for(y="",d=this.l,f=0;f<a;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return u=Da(this,d),this.l=d+1,h=Mi.call(this,a-f,u?"dbcs-cont":"sbcs-cont"),v.join("")+h;v.push(fe(qs(this,d))),d+=2}y=v.join(""),a*=2;break;case"cpstr":if(e!==void 0){y=e.utils.decode(p,this.slice(this.l,this.l+a));break}case"sbcs-cont":for(y="",d=this.l,f=0;f!=a;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return u=Da(this,d),this.l=d+1,h=Mi.call(this,a-f,u?"dbcs-cont":"sbcs-cont"),v.join("")+h;v.push(fe(Da(this,d))),d+=1}y=v.join("");break;default:switch(a){case 1:return l=Da(this,this.l),this.l++,l;case 2:return l=(o==="i"?Al:qs)(this,this.l),this.l+=2,l;case 4:case-4:return o==="i"||!(128&this[this.l+3])?(l=(0<a?Ra:ni)(this,this.l),this.l+=4,l):(c=dn(this,this.l),this.l+=4,c);case 8:case-8:if(o==="f")return c=a==8?Co(this,this.l):Co([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,c;a=8;case 16:y=Ao(this,this.l,a)}}return this.l+=a,y}var lh=function(a,o,l){a[l]=255&o,a[l+1]=o>>>8&255,a[l+2]=o>>>16&255,a[l+3]=o>>>24&255},ch=function(a,o,l){a[l]=255&o,a[l+1]=o>>8&255,a[l+2]=o>>16&255,a[l+3]=o>>24&255},uh=function(a,o,l){a[l]=255&o,a[l+1]=o>>>8&255};function Cl(a,o,l){var c=0,u=0;if(l==="dbcs"){for(u=0;u!=o.length;++u)uh(this,o.charCodeAt(u),this.l+2*u);c=2*o.length}else if(l==="sbcs"){if(e!==void 0&&x==874)for(u=0;u!=o.length;++u){var h=e.utils.encode(x,o.charAt(u));this[this.l+u]=h[0]}else for(o=o.replace(/[^\x00-\x7F]/g,"_"),u=0;u!=o.length;++u)this[this.l+u]=255&o.charCodeAt(u);c=o.length}else{if(l==="hex"){for(;u<a;++u)this[this.l++]=parseInt(o.slice(2*u,2*u+2),16)||0;return this}if(l==="utf16le"){for(var f=Math.min(this.l+a,this.length),u=0;u<Math.min(o.length,a);++u){var d=o.charCodeAt(u);this[this.l++]=255&d,this[this.l++]=d>>8}for(;this.l<f;)this[this.l++]=0;return this}switch(a){case 1:c=1,this[this.l]=255&o;break;case 2:c=2,this[this.l]=255&o,o>>>=8,this[this.l+1]=255&o;break;case 3:c=3,this[this.l]=255&o,o>>>=8,this[this.l+1]=255&o,o>>>=8,this[this.l+2]=255&o;break;case 4:c=4,lh(this,o,this.l);break;case 8:if(c=8,l==="f"){(function(y,v,b){var _=(v<0||1/v==-1/0?1:0)<<7,T=0,S=0,I=_?-v:v;isFinite(I)?I==0?T=S=0:(T=Math.floor(Math.log(I)/Math.LN2),S=I*Math.pow(2,52-T),T<=-1023&&(!isFinite(S)||S<Math.pow(2,52))?T=-1022:(S-=Math.pow(2,52),T+=1023)):(T=2047,S=isNaN(v)?26985:0);for(var k=0;k<=5;++k,S/=256)y[b+k]=255&S;y[b+6]=(15&T)<<4|15&S,y[b+7]=T>>4|_})(this,o,this.l);break}case 16:break;case-4:c=4,ch(this,o,this.l)}}return this.l+=c,this}function Yn(a,o){var l=Ao(this,this.l,a.length>>1);if(l!==a)throw new Error(o+"Expected "+a+" saw "+l);this.l+=a.length>>1}function xn(a,o){a.l=o,a.read_shift=Mi,a.chk=Yn,a.write_shift=Cl}function Fn(a,o){a.l+=o}function Ae(a){return a=L(a),xn(a,0),a}function g(a,o,l){if(a){xn(a,a.l||0);for(var c,u=a.length,h=0;a.l<u;){128&(h=a.read_shift(1))&&(h=(127&h)+((127&a.read_shift(1))<<7));for(var f,d=mu[h]||mu[65535],y=127&(f=a.read_shift(1)),v=1;v<4&&128&f;++v)y+=(127&(f=a.read_shift(1)))<<7*v;c=a.l+y;var b=d.f&&d.f(a,y,l);if(a.l=c,o(b,d,h))return}}}function A(){function a(f){return xn(f=Ae(f),0),f}function o(){h&&(h.length>h.l&&((h=h.slice(0,h.l)).l=h.length),0<h.length&&c.push(h),h=null)}function l(f){return h&&f<h.length-h.l?h:(o(),h=a(Math.max(f+1,u)))}var c=[],u=te?256:2048,h=a(u);return{next:l,push:function(f){o(),(h=f).l==null&&(h.l=h.length),l(u)},end:function(){return o(),K(c)},_bufs:c}}function C(a,o,l,c){var u=+o;if(!isNaN(u)){o=1+(128<=u?1:0)+1,128<=(c=c||mu[u].p||(l||[]).length||0)&&++o,16384<=c&&++o,2097152<=c&&++o;var h=a.next(o);u<=127?h.write_shift(1,u):(h.write_shift(1,128+(127&u)),h.write_shift(1,u>>7));for(var f=0;f!=4;++f){if(!(128<=c)){h.write_shift(1,c);break}h.write_shift(1,128+(127&c)),c>>=7}0<c&&ko(l)&&a.push(l)}}function Y(a,o,l){var c=Tr(a);if(o.s?(c.cRel&&(c.c+=o.s.c),c.rRel&&(c.r+=o.s.r)):(c.cRel&&(c.c+=o.c),c.rRel&&(c.r+=o.r)),!l||l.biff<12){for(;256<=c.c;)c.c-=256;for(;65536<=c.r;)c.r-=65536}return c}function pe(a,o,l){return a=Tr(a),a.s=Y(a.s,o.s,l),a.e=Y(a.e,o.s,l),a}function Ee(a,o){if(a.cRel&&a.c<0)for(a=Tr(a);a.c<0;)a.c+=8<o?16384:256;if(a.rRel&&a.r<0)for(a=Tr(a);a.r<0;)a.r+=8<o?1048576:5<o?65536:16384;var l=Pt(a);return a.cRel||a.cRel==null||(l=l.replace(/^([A-Z])/,"$$$1")),l=!a.rRel&&a.rRel!=null?l.replace(/([A-Z]|^)(\d+)$/,"$1$$$2"):l}function tt(a,o){return a.s.r!=0||a.s.rRel||a.e.r!=(12<=o.biff?1048575:8<=o.biff?65536:16384)||a.e.rRel?a.s.c!=0||a.s.cRel||a.e.c!=(12<=o.biff?16383:255)||a.e.cRel?Ee(a.s,o.biff)+":"+Ee(a.e,o.biff):(a.s.rRel?"":"$")+tr(a.s.r)+":"+(a.e.rRel?"":"$")+tr(a.e.r):(a.s.cRel?"":"$")+Yt(a.s.c)+":"+(a.e.cRel?"":"$")+Yt(a.e.c)}function Fr(a){return parseInt(a.replace(/\$(\d+)$/,"$1"),10)-1}function tr(a){return""+(a+1)}function hr(a){for(var o=a.replace(/^\$([A-Z])/,"$1"),l=0,c=0;c!==o.length;++c)l=26*l+o.charCodeAt(c)-64;return l-1}function Yt(a){if(a<0)throw new Error("invalid column "+a);var o="";for(++a;a;a=Math.floor((a-1)/26))o=String.fromCharCode((a-1)%26+65)+o;return o}function rr(a){for(var o=0,l=0,c=0;c<a.length;++c){var u=a.charCodeAt(c);48<=u&&u<=57?o=10*o+(u-48):65<=u&&u<=90&&(l=26*l+(u-64))}return{c:l-1,r:o-1}}function Pt(a){for(var o=a.c+1,l="";o;o=(o-1)/26|0)l=String.fromCharCode((o-1)%26+65)+l;return l+(a.r+1)}function Wr(a){var o=a.indexOf(":");return o==-1?{s:rr(a),e:rr(a)}:{s:rr(a.slice(0,o)),e:rr(a.slice(o+1))}}function Bt(a,o){return o===void 0||typeof o=="number"?Bt(a.s,a.e):(a=typeof a!="string"?Pt(a):a)==(o=typeof o!="string"?Pt(o):o)?a:a+":"+o}function nr(a){for(var o={s:{c:0,r:0},e:{c:0,r:0}},h=0,l=0,c=0,u=a.length,h=0;l<u&&!((c=a.charCodeAt(l)-64)<1||26<c);++l)h=26*h+c;for(o.s.c=--h,h=0;l<u&&!((c=a.charCodeAt(l)-48)<0||9<c);++l)h=10*h+c;if(o.s.r=--h,l===u||c!=10)return o.e.c=o.s.c,o.e.r=o.s.r,o;for(++l,h=0;l!=u&&!((c=a.charCodeAt(l)-64)<1||26<c);++l)h=26*h+c;for(o.e.c=--h,h=0;l!=u&&!((c=a.charCodeAt(l)-48)<0||9<c);++l)h=10*h+c;return o.e.r=--h,o}function x6(a,o){var l=a.t=="d"&&o instanceof Date;if(a.z!=null)try{return a.w=Rt(a.z,l?qr(o):o)}catch{}try{return a.w=Rt((a.XF||{}).numFmtId||(l?14:0),l?qr(o):o)}catch{return""+o}}function Pa(a,o,l){return a==null||a.t==null||a.t=="z"?"":a.w!==void 0?a.w:(a.t=="d"&&!a.z&&l&&l.dateNF&&(a.z=l.dateNF),a.t=="e"?si[a.v]||a.v:x6(a,o??a.v))}function Li(a,c){var l=c&&c.sheet?c.sheet:"Sheet1",c={};return c[l]=a,{SheetNames:[l],Sheets:c}}function sy(a,o,l){var c=l||{},u=a?Array.isArray(a):c.dense,h=a||(u?[]:{}),f=0,d=0;h&&c.origin!=null&&(typeof c.origin=="number"?f=c.origin:(f=(y=typeof c.origin=="string"?rr(c.origin):c.origin).r,d=y.c),h["!ref"]||(h["!ref"]="A1:A1"));var y,v={s:{c:1e7,r:1e7},e:{c:0,r:0}};h["!ref"]&&(y=nr(h["!ref"]),v.s.c=y.s.c,v.s.r=y.s.r,v.e.c=Math.max(v.e.c,y.e.c),v.e.r=Math.max(v.e.r,y.e.r),f==-1&&(v.e.r=f=y.e.r+1));for(var b=0;b!=o.length;++b)if(o[b]){if(!Array.isArray(o[b]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=o[b].length;++_)if(o[b][_]!==void 0){var T={v:o[b][_]},S=f+b,I=d+_;if(v.s.r>S&&(v.s.r=S),v.s.c>I&&(v.s.c=I),v.e.r<S&&(v.e.r=S),v.e.c<I&&(v.e.c=I),!o[b][_]||typeof o[b][_]!="object"||Array.isArray(o[b][_])||o[b][_]instanceof Date)if(Array.isArray(T.v)&&(T.f=o[b][_][1],T.v=T.v[0]),T.v===null)if(T.f)T.t="n";else if(c.nullError)T.t="e",T.v=0;else{if(!c.sheetStubs)continue;T.t="z"}else typeof T.v=="number"?T.t="n":typeof T.v=="boolean"?T.t="b":T.v instanceof Date?(T.z=c.dateNF||de[14],c.cellDates?(T.t="d",T.w=Rt(T.z,qr(T.v))):(T.t="n",T.v=qr(T.v),T.w=Rt(T.z,T.v))):T.t="s";else T=o[b][_];u?(h[S]||(h[S]=[]),h[S][I]&&h[S][I].z&&(T.z=h[S][I].z),h[S][I]=T):(h[S=Pt({c:I,r:S})]&&h[S].z&&(T.z=h[S].z),h[S]=T)}}return v.s.c<1e7&&(h["!ref"]=Bt(v)),h}function kl(a,o){return sy(null,a,o)}function ma(a,o){return(o=o||Ae(4)).write_shift(4,a),o}function Qn(a){var o=a.read_shift(4);return o===0?"":a.read_shift(o,"dbcs")}function Pn(a,o){var l=!1;return o==null&&(l=!0,o=Ae(4+2*a.length)),o.write_shift(4,a.length),0<a.length&&o.write_shift(0,a,"dbcs"),l?o.slice(0,o.l):o}function Z0(a,o){var l,c=a.l,u=a.read_shift(1),f=Qn(a),h=[],f={t:f,h:f};if(1&u){for(var d=a.read_shift(4),y=0;y!=d;++y)h.push({ich:(l=a).read_shift(2),ifnt:l.read_shift(2)});f.r=h}else f.r=[{ich:0,ifnt:0}];return a.l=c+o,f}var b6=Z0;function w6(a,o){var l,c=!1;return o==null&&(c=!0,o=Ae(23+4*a.t.length)),o.write_shift(1,1),Pn(a.t,o),o.write_shift(4,1),l={ich:0,ifnt:0},(a=(a=o)||Ae(4)).write_shift(2,l.ich||0),a.write_shift(2,l.ifnt||0),c?o.slice(0,o.l):o}function Ks(a){var o=a.read_shift(4),l=a.read_shift(2);return l+=a.read_shift(1)<<16,a.l++,{c:o,iStyleRef:l}}function Fo(a,o){return(o=o??Ae(8)).write_shift(-4,a.c),o.write_shift(3,a.iStyleRef||a.s),o.write_shift(1,0),o}function No(a){var o=a.read_shift(2);return o+=a.read_shift(1)<<16,a.l++,{c:-1,iStyleRef:o}}function Io(a,o){return(o=o??Ae(4)).write_shift(3,a.iStyleRef||a.s),o.write_shift(1,0),o}var _6=Qn,ay=Pn;function ep(a){var o=a.read_shift(4);return o===0||o===4294967295?"":a.read_shift(o,"dbcs")}function fh(a,o){var l=!1;return o==null&&(l=!0,o=Ae(127)),o.write_shift(4,0<a.length?a.length:4294967295),0<a.length&&o.write_shift(0,a,"dbcs"),l?o.slice(0,o.l):o}var T6=Qn,tp=ep,rp=fh;function np(a){var o=a.slice(a.l,a.l+4),l=1&o[0],c=2&o[0];return a.l+=4,o=c==0?Co([0,0,0,0,252&o[0],o[1],o[2],o[3]],0):Ra(o,0)>>2,l?o/100:o}function iy(a,o){o==null&&(o=Ae(4));var l=0,c=0,u=100*a;if(a==(0|a)&&-536870912<=a&&a<1<<29?c=1:u==(0|u)&&-536870912<=u&&u<1<<29&&(l=c=1),!c)throw new Error("unsupported RkNumber "+a);o.write_shift(-4,((l?u:a)<<2)+(l+2))}function oy(a){var o={s:{},e:{}};return o.s.r=a.read_shift(4),o.e.r=a.read_shift(4),o.s.c=a.read_shift(4),o.e.c=a.read_shift(4),o}var Do=oy,Fl=function(a,o){return(o=o||Ae(16)).write_shift(4,a.s.r),o.write_shift(4,a.e.r),o.write_shift(4,a.s.c),o.write_shift(4,a.e.c),o};function Xn(a){if(a.length-a.l<8)throw"XLS Xnum Buffer underflow";return a.read_shift(8,"f")}function Nl(a,o){return(o||Ae(8)).write_shift(8,a,"f")}function hh(a,o){if(o=o||Ae(8),!a||a.auto)return o.write_shift(4,0),o.write_shift(4,0),o;a.index!=null?(o.write_shift(1,2),o.write_shift(1,a.index)):a.theme!=null?(o.write_shift(1,6),o.write_shift(1,a.theme)):(o.write_shift(1,5),o.write_shift(1,0));var l=a.tint||0;return 0<l?l*=32767:l<0&&(l*=32768),o.write_shift(2,l),a.rgb&&a.theme==null?(typeof(a=a.rgb||"FFFFFF")=="number"&&(a=("000000"+a.toString(16)).slice(-6)),o.write_shift(1,parseInt(a.slice(0,2),16)),o.write_shift(1,parseInt(a.slice(2,4),16)),o.write_shift(1,parseInt(a.slice(4,6),16)),o.write_shift(1,255)):(o.write_shift(2,0),o.write_shift(1,0),o.write_shift(1,0)),o}function ly(a,o){var l=a.read_shift(4);switch(l){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[a.read_shift(4)]||""}if(400<l)throw new Error("Unsupported Clipboard: "+l.toString(16));return a.l-=4,a.read_shift(0,o==1?"lpstr":"lpwstr")}var sp=2,Ts=3,cy=12,uy=81,E6=[80,uy],ap={1:{n:"CodePage",t:sp},2:{n:"Category",t:80},3:{n:"PresentationFormat",t:80},4:{n:"ByteCount",t:Ts},5:{n:"LineCount",t:Ts},6:{n:"ParagraphCount",t:Ts},7:{n:"SlideCount",t:Ts},8:{n:"NoteCount",t:Ts},9:{n:"HiddenCount",t:Ts},10:{n:"MultimediaClipCount",t:Ts},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:80},15:{n:"Company",t:80},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:Ts},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:Ts,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:80},27:{n:"ContentStatus",t:80},28:{n:"Language",t:80},29:{n:"Version",t:80},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},ip={1:{n:"CodePage",t:sp},2:{n:"Title",t:80},3:{n:"Subject",t:80},4:{n:"Author",t:80},5:{n:"Keywords",t:80},6:{n:"Comments",t:80},7:{n:"Template",t:80},8:{n:"LastAuthor",t:80},9:{n:"RevNumber",t:80},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:Ts},15:{n:"WordCount",t:Ts},16:{n:"CharCount",t:Ts},17:{n:"Thumbnail",t:71},18:{n:"Application",t:80},19:{n:"DocSecurity",t:Ts},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},fy={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},S6=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Qc=Tr([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].map(function(a){return[a>>16&255,a>>8&255,255&a]})),si={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},hy={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},op={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},dh={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function lp(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function dy(a,o){var l,c=function(y){for(var v=[],b=Gr(y),_=0;_!==b.length;++_)v[y[b[_]]]==null&&(v[y[b[_]]]=[]),v[y[b[_]]].push(b[_]);return v}(op),u=[];u[u.length]=Zr,u[u.length]=Ze("Types",null,{xmlns:rn.CT,"xmlns:xsd":rn.xsd,"xmlns:xsi":rn.xsi}),u=u.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(y){return Ze("Default",null,{Extension:y[0],ContentType:y[1]})}));function h(y){a[y]&&0<a[y].length&&(l=a[y][0],u[u.length]=Ze("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:dh[y][o.bookType]||dh[y].xlsx}))}function f(y){(a[y]||[]).forEach(function(v){u[u.length]=Ze("Override",null,{PartName:(v[0]=="/"?"":"/")+v,ContentType:dh[y][o.bookType]||dh[y].xlsx})})}function d(y){(a[y]||[]).forEach(function(v){u[u.length]=Ze("Override",null,{PartName:(v[0]=="/"?"":"/")+v,ContentType:c[y][0]})})}return h("workbooks"),f("sheets"),f("charts"),d("themes"),["strs","styles"].forEach(h),["coreprops","extprops","custprops"].forEach(d),d("vba"),d("comments"),d("threadedcomments"),d("drawings"),f("metadata"),d("people"),2<u.length&&(u[u.length]="</Types>",u[1]=u[1].replace("/>",">")),u.join("")}var Xt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Xc(a){var o=a.lastIndexOf("/");return a.slice(0,o+1)+"_rels/"+a.slice(o+1)+".rels"}function Jc(a,o){var l={"!id":{}};if(!a)return l;o.charAt(0)!=="/"&&(o="/"+o);var c={};return(a.match(vn)||[]).forEach(function(u){var h,f=Lt(u);f[0]==="<Relationship"&&((h={}).Type=f.Type,h.Target=f.Target,h.Id=f.Id,f.TargetMode&&(h.TargetMode=f.TargetMode),u=f.TargetMode==="External"?f.Target:Ni(f.Target,o),l[u]=h,c[f.Id]=h)}),l["!id"]=c,l}function Il(a){var o=[Zr,Ze("Relationships",null,{xmlns:rn.RELS})];return Gr(a["!id"]).forEach(function(l){o[o.length]=Ze("Relationship",null,a["!id"][l])}),2<o.length&&(o[o.length]="</Relationships>",o[1]=o[1].replace("/>",">")),o.join("")}function jr(a,o,l,c,u,h){if(u=u||{},a["!id"]||(a["!id"]={}),a["!idx"]||(a["!idx"]=1),o<0)for(o=a["!idx"];a["!id"]["rId"+o];++o);if(a["!idx"]=o+1,u.Id="rId"+o,u.Type=c,u.Target=l,-1<[Xt.HLINK,Xt.XPATH,Xt.XMISS].indexOf(u.Type)&&(u.TargetMode="External"),a["!id"][u.Id])throw new Error("Cannot rewrite rId "+o);return a["!id"][u.Id]=u,a[("/"+u.Target).replace("//","/")]=u,o}var A6="application/vnd.oasis.opendocument.spreadsheet";function py(a,o,l){return['  <rdf:Description rdf:about="'+a+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(l||"odf")+"#"+o+`"/>
`,`  </rdf:Description>
`].join("")}function my(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+n.version+"</meta:generator></office:meta></office:document-meta>"}var Ys=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],C6=function(){for(var a=new Array(Ys.length),o=0;o<Ys.length;++o){var l=Ys[o],l="(?:"+l[0].slice(0,l[0].indexOf(":"))+":)"+l[0].slice(l[0].indexOf(":")+1);a[o]=new RegExp("<"+l+"[^>]*>([\\s\\S]*?)</"+l+">")}return a}();function gy(a){var o={};a=kr(a);for(var l=0;l<Ys.length;++l){var c=Ys[l],u=a.match(C6[l]);u!=null&&0<u.length&&(o[c[1]]=qt(u[1])),c[2]==="date"&&o[c[1]]&&(o[c[1]]=Ur(o[c[1]]))}return o}function cp(a,o,l,c,u){u[a]==null&&o!=null&&o!==""&&(o=Er(u[a]=o),c[c.length]=l?Ze(a,o,l):cn(a,o))}function yy(a,o){var l=o||{},c=[Zr,Ze("cp:coreProperties",null,{"xmlns:cp":rn.CORE_PROPS,"xmlns:dc":rn.dc,"xmlns:dcterms":rn.dcterms,"xmlns:dcmitype":rn.dcmitype,"xmlns:xsi":rn.xsi})],u={};if(!a&&!l.Props)return c.join("");a&&(a.CreatedDate!=null&&cp("dcterms:created",typeof a.CreatedDate=="string"?a.CreatedDate:Za(a.CreatedDate,l.WTF),{"xsi:type":"dcterms:W3CDTF"},c,u),a.ModifiedDate!=null&&cp("dcterms:modified",typeof a.ModifiedDate=="string"?a.ModifiedDate:Za(a.ModifiedDate,l.WTF),{"xsi:type":"dcterms:W3CDTF"},c,u));for(var h=0;h!=Ys.length;++h){var f=Ys[h],d=l.Props&&l.Props[f[1]]!=null?l.Props[f[1]]:a?a[f[1]]:null;d===!0?d="1":d===!1?d="0":typeof d=="number"&&(d=String(d)),d!=null&&cp(f[0],d,null,c,u)}return 2<c.length&&(c[c.length]="</cp:coreProperties>",c[1]=c[1].replace("/>",">")),c.join("")}var Ro=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],vy=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function xy(a,o,l,c){var u=[];if(typeof a=="string")u=sh(a,c);else for(var h=0;h<a.length;++h)u=u.concat(a[h].map(function(b){return{v:b}}));var f,d=typeof o=="string"?sh(o,c).map(function(b){return b.v}):o,y=0;if(0<d.length)for(var v=0;v!==u.length;v+=2){switch(f=+u[v+1].v,u[v].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":l.Worksheets=f,l.SheetNames=d.slice(y,y+f);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":l.NamedRanges=f,l.DefinedNames=d.slice(y,y+f);break;case"Charts":case"Diagramme":l.Chartsheets=f,l.ChartNames=d.slice(y,y+f)}y+=f}}function by(a){var o=[],l=Ze;return(a=a||{}).Application="SheetJS",o[o.length]=Zr,o[o.length]=Ze("Properties",null,{xmlns:rn.EXT_PROPS,"xmlns:vt":rn.vt}),Ro.forEach(function(c){if(a[c[1]]!==void 0){var u;switch(c[2]){case"string":u=Er(String(a[c[1]]));break;case"bool":u=a[c[1]]?"true":"false"}u!==void 0&&(o[o.length]=l(c[0],u))}}),o[o.length]=l("HeadingPairs",l("vt:vector",l("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+l("vt:variant",l("vt:i4",String(a.Worksheets))),{size:2,baseType:"variant"})),o[o.length]=l("TitlesOfParts",l("vt:vector",a.SheetNames.map(function(c){return"<vt:lpstr>"+Er(c)+"</vt:lpstr>"}).join(""),{size:a.Worksheets,baseType:"lpstr"})),2<o.length&&(o[o.length]="</Properties>",o[1]=o[1].replace("/>",">")),o.join("")}var k6=/<[^>]+>[^<]*/g;function wy(a){var o=[Zr,Ze("Properties",null,{xmlns:rn.CUST_PROPS,"xmlns:vt":rn.vt})];if(!a)return o.join("");var l=1;return Gr(a).forEach(function(c){++l,o[o.length]=Ze("property",function(u,h){switch(typeof u){case"string":var f=Ze("vt:lpwstr",Er(u));return f=f.replace(/&quot;/g,"_x0022_");case"number":return Ze((0|u)==u?"vt:i4":"vt:r8",Er(String(u)));case"boolean":return Ze("vt:bool",u?"true":"false")}if(u instanceof Date)return Ze("vt:filetime",Za(u));throw new Error("Unable to serialize "+u)}(a[c]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:l,name:Er(c)})}),2<o.length&&(o[o.length]="</Properties>",o[1]=o[1].replace("/>",">")),o.join("")}var _y,up={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function fp(l){var o=l.read_shift(4),l=l.read_shift(4);return new Date(1e3*(l/1e7*Math.pow(2,32)+o/1e7-11644473600)).toISOString().replace(/\.000/,"")}function Ty(a,o,l){var c=a.l,u=a.read_shift(0,"lpstr-cp");if(l)for(;a.l-c&3;)++a.l;return u}function Ey(a,o,l){var c=a.read_shift(0,"lpwstr");return c}function Sy(a,o,l){return o===31?Ey(a):Ty(a,0,l)}function Ay(a,o,l){return Sy(a,o,l===!1?0:4)}function F6(a){for(var o,l,c,u=a.read_shift(4),h=[],f=0;f<u/2;++f)h.push((c=l=void 0,l=(o=a).l,c=ph(o,uy),o[o.l]==0&&o[o.l+1]==0&&o.l-l&2&&(o.l+=2),[c,ph(o,Ts)]));return h}function Cy(a,o){for(var l=a.read_shift(4),c={},u=0;u!=l;++u){var h=a.read_shift(4),f=a.read_shift(4);c[h]=a.read_shift(f,o===1200?"utf16le":"utf8").replace(me,"").replace(He,"!"),o===1200&&f%2&&(a.l+=2)}return 3&a.l&&(a.l=a.l>>3<<2),c}function ky(a){var o=a.read_shift(4),l=a.slice(a.l,a.l+o);return a.l+=o,0<(3&o)&&(a.l+=4-(3&o)&3),l}function ph(a,o,l){var c,u,h=a.read_shift(2),f=l||{};if(a.l+=2,o!==cy&&h!==o&&E6.indexOf(o)===-1&&((65534&o)!=4126||(65534&h)!=4126))throw new Error("Expected type "+o+" saw "+h);switch(o===cy?h:o){case 2:return c=a.read_shift(2,"i"),f.raw||(a.l+=2),c;case 3:return c=a.read_shift(4,"i");case 11:return a.read_shift(4)!==0;case 19:return c=a.read_shift(4);case 30:return Ty(a,0,4).replace(me,"");case 31:return Ey(a);case 64:return fp(a);case 65:return ky(a);case 71:return(u={}).Size=(c=a).read_shift(4),c.l+=u.Size+3-(u.Size-1)%4,u;case 80:return Ay(a,h,!f.raw).replace(me,"");case 81:return function(d,y){if(!y)throw new Error("VtUnalignedString must have positive length");return Sy(d,y,0)}(a,h).replace(me,"");case 4108:return F6(a);case 4126:case 4127:return(h==4127?function(d){for(var y=d.read_shift(4),v=[],b=0;b!=y;++b){var _=d.l;v[b]=d.read_shift(0,"lpwstr").replace(me,""),d.l-_&2&&(d.l+=2)}return v}:function(d){for(var y=d.read_shift(4),v=[],b=0;b!=y;++b)v[b]=d.read_shift(0,"lpstr-cp").replace(me,"");return v})(a);default:throw new Error("TypedPropertyValue unrecognized type "+o+" "+h)}}function Fy(a,o){var l,c,u,h=Ae(4),f=Ae(4);switch(h.write_shift(4,a==80?31:a),a){case 3:f.write_shift(-4,o);break;case 5:(f=Ae(8)).write_shift(8,o,"f");break;case 11:f.write_shift(4,o?1:0);break;case 64:c=(typeof(l=o)=="string"?new Date(Date.parse(l)):l).getTime()/1e3+11644473600,u=c%Math.pow(2,32),l=(c-u)/Math.pow(2,32),l*=1e7,0<(c=(u*=1e7)/Math.pow(2,32)|0)&&(u%=Math.pow(2,32),l+=c),(c=Ae(8)).write_shift(4,u),c.write_shift(4,l),f=c;break;case 31:case 80:for((f=Ae(4+2*(o.length+1)+(o.length%2?0:2))).write_shift(4,o.length+1),f.write_shift(0,o,"dbcs");f.l!=f.length;)f.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+a+" "+o)}return K([h,f])}function Ny(a,o){for(var l=a.l,c=a.read_shift(4),u=a.read_shift(4),h=[],v=0,f=0,d=-1,y={},v=0;v!=u;++v){var b=a.read_shift(4),_=a.read_shift(4);h[v]=[b,_+l]}h.sort(function(D,F){return D[1]-F[1]});var T={};for(v=0;v!=u;++v){if(a.l!==h[v][1]){var S=!0;if(0<v&&o)switch(o[h[v-1][0]].t){case 2:a.l+2===h[v][1]&&(a.l+=2,S=!1);break;case 80:case 4108:a.l<=h[v][1]&&(a.l=h[v][1],S=!1)}if((!o||v==0)&&a.l<=h[v][1]&&(S=!1,a.l=h[v][1]),S)throw new Error("Read Error: Expected address "+h[v][1]+" at "+a.l+" :"+v)}if(o){var I=o[h[v][0]];if(T[I.n]=ph(a,I.t,{raw:!0}),I.p==="version"&&(T[I.n]=String(T[I.n]>>16)+"."+("0000"+String(65535&T[I.n])).slice(-4)),I.n=="CodePage")switch(T[I.n]){case 0:T[I.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:P(f=T[I.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+T[I.n])}}else if(h[v][0]===1)f=T.CodePage=ph(a,sp),P(f),d!==-1&&(M=a.l,a.l=h[d][1],y=Cy(a,f),a.l=M);else if(h[v][0]===0)f!==0?y=Cy(a,f):(d=v,a.l=h[v+1][1]);else{var k,M=y[h[v][0]];switch(a[a.l]){case 65:a.l+=4,k=ky(a);break;case 30:case 31:a.l+=4,k=Ay(a,a[a.l-4]).replace(/\u0000+$/,"");break;case 3:a.l+=4,k=a.read_shift(4,"i");break;case 19:a.l+=4,k=a.read_shift(4);break;case 5:a.l+=4,k=a.read_shift(8,"f");break;case 11:a.l+=4,k=pn(a,4);break;case 64:a.l+=4,k=Ur(fp(a));break;default:throw new Error("unparsed value: "+a[a.l])}T[M]=k}}return a.l=l+c,T}var Iy=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Dy(a,o,l){var c,u,h,f,d=Ae(8),y=[],v=[],b=8,_=0,T=Ae(8),S=Ae(8);if(T.write_shift(4,2),T.write_shift(4,1200),S.write_shift(4,1),v.push(T),y.push(S),b+=8+T.length,!o){(S=Ae(8)).write_shift(4,0),y.unshift(S);var I=[Ae(4)];for(I[0].write_shift(4,a.length),_=0;_<a.length;++_){var k=a[_][0];for((T=Ae(8+2*(k.length+1)+(k.length%2?0:2))).write_shift(4,_+2),T.write_shift(4,k.length+1),T.write_shift(0,k,"dbcs");T.l!=T.length;)T.write_shift(1,0);I.push(T)}T=K(I),v.unshift(T),b+=8+T.length}for(_=0;_<a.length;++_)o&&!o[a[_][0]]||-1<Iy.indexOf(a[_][0])||-1<vy.indexOf(a[_][0])||a[_][1]!=null&&(h=a[_][1],c=0,T=o?((f=l[c=+o[a[_][0]]]).p=="version"&&typeof h=="string"&&(h=(+(u=h.split("."))[0]<<16)+(+u[1]||0)),Fy(f.t,h)):((f=function(D){switch(typeof D){case"boolean":return 11;case"number":return(0|D)==D?3:5;case"string":return 31;case"object":if(D instanceof Date)return 64}return-1}(h))==-1&&(f=31,h=String(h)),Fy(f,h)),v.push(T),(S=Ae(8)).write_shift(4,o?c:2+_),y.push(S),b+=8+T.length);for(var M=8*(v.length+1),_=0;_<v.length;++_)y[_].write_shift(4,M),M+=v[_].length;return d.write_shift(4,b),d.write_shift(4,v.length),K([d].concat(y).concat(v))}function Ry(a,o,l){var c=a.content;if(!c)return{};xn(c,0);var u,h=0;c.chk("feff","Byte Order: "),c.read_shift(2);var f=c.read_shift(4),d=c.read_shift(16);if(d!==wt.utils.consts.HEADER_CLSID&&d!==l)throw new Error("Bad PropertySet CLSID "+d);if((a=c.read_shift(4))!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(l=c.read_shift(16),d=c.read_shift(4),a===1&&d!==c.l)throw new Error("Length mismatch: "+d+" !== "+c.l);a===2&&(u=c.read_shift(16),h=c.read_shift(4));var y,v,b=Ny(c,o),_={SystemIdentifier:f};for(y in b)_[y]=b[y];if(_.FMTID=l,a===1)return _;if(h-c.l==2&&(c.l+=2),c.l!==h)throw new Error("Length mismatch 2: "+c.l+" !== "+h);try{v=Ny(c,null)}catch{}for(y in v)_[y]=v[y];return _.FMTID=[l,u],_}function Py(a,o,l,c,u,h){var f=Ae(u?68:48),d=[f];return f.write_shift(2,65534),f.write_shift(2,0),f.write_shift(4,842412599),f.write_shift(16,wt.utils.consts.HEADER_CLSID,"hex"),f.write_shift(4,u?2:1),f.write_shift(16,o,"hex"),f.write_shift(4,u?68:48),c=Dy(a,l,c),d.push(c),u&&(u=Dy(u,null,null),f.write_shift(16,h,"hex"),f.write_shift(4,68+c.length),d.push(u)),K(d)}function Vi(a,o){return a.read_shift(o),null}function pn(a,o){return a.read_shift(o)===1}function hs(a,o){return(o=o||Ae(2)).write_shift(2,+!!a),o}function bn(a){return a.read_shift(2,"u")}function Qs(a,o){return(o=o||Ae(2)).write_shift(2,a),o}function Oy(a,o){return function(l,c,u){for(var h=[],f=l.l+c;l.l<f;)h.push(u(l,f-l.l));if(f!==l.l)throw new Error("Slurp error");return h}(a,o,bn)}function jy(a,o,l){return(l=l||Ae(2)).write_shift(1,o=="e"?+a:+!!a),l.write_shift(1,o=="e"?1:0),l}function Zc(a,o,l){var c=a.read_shift(l&&12<=l.biff?2:1),u="sbcs-cont",h=p;return l&&8<=l.biff&&(p=1200),l&&l.biff!=8?l.biff==12&&(u="wstr"):a.read_shift(1)&&(u="dbcs-cont"),2<=l.biff&&l.biff<=5&&(u="cpstr"),u=c?a.read_shift(c,u):"",p=h,u}function Po(a,o,l){if(l){if(2<=l.biff&&l.biff<=5)return a.read_shift(o,"cpstr");if(12<=l.biff)return a.read_shift(o,"dbcs-cont")}return a.read_shift(1)===0?a.read_shift(o,"sbcs-cont"):a.read_shift(o,"dbcs-cont")}function eu(a,o,l){var c=a.read_shift(l&&l.biff==2?1:2);return c===0?(a.l++,""):Po(a,c,l)}function Oo(a,o,l){if(5<l.biff)return eu(a,0,l);var c=a.read_shift(1);return c===0?(a.l++,""):a.read_shift(c,l.biff<=4||!a.lens?"cpstr":"sbcs-cont")}function My(a,o,l){return(l=l||Ae(3+2*a.length)).write_shift(2,a.length),l.write_shift(1,1),l.write_shift(31,a,"utf16le"),l}function N6(a){var o,l,c,u,h=a.read_shift(16);switch(h){case"e0c9ea79f9bace118c8200aa004ba90b":return l=(o=a).read_shift(4),c=o.l,u=!1,24<l&&(o.l+=l-24,o.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(u=!0),o.l=c),l=o.read_shift((u?l-24:l)>>1,"utf16le").replace(me,""),u&&(o.l+=24),l;case"0303000000000000c000000000000046":return function(f){for(var d=f.read_shift(2),y="";0<d--;)y+="../";var v=f.read_shift(0,"lpstr-ansi");if(f.l+=2,f.read_shift(2)!=57005)throw new Error("Bad FileMoniker");if(f.read_shift(4)===0)return y+v.replace(/\\/g,"/");if(v=f.read_shift(4),f.read_shift(2)!=3)throw new Error("Bad FileMoniker");return y+f.read_shift(v>>1,"utf16le").replace(me,"")}(a);default:throw new Error("Unsupported Moniker "+h)}}function mh(a){var o=a.read_shift(4);return 0<o?a.read_shift(o,"utf16le").replace(me,""):""}function Ly(a,o){(o=o||Ae(6+2*a.length)).write_shift(4,1+a.length);for(var l=0;l<a.length;++l)o.write_shift(2,a.charCodeAt(l));return o.write_shift(2,0),o}function Vy(a){return[a.read_shift(1),a.read_shift(1),a.read_shift(1),a.read_shift(1)]}function Uy(a){return a=Vy(a),a[3]=0,a}function Oa(a){return{r:a.read_shift(2),c:a.read_shift(2),ixfe:a.read_shift(2)}}function jo(a,o,l,c){return(c=c||Ae(6)).write_shift(2,a),c.write_shift(2,o),c.write_shift(2,l||0),c}function By(a){return[a.read_shift(2),np(a)]}function gh(a){var o=a.read_shift(2),l=a.read_shift(2);return{s:{c:a.read_shift(2),r:o},e:{c:a.read_shift(2),r:l}}}function $y(a,o){return(o=o||Ae(8)).write_shift(2,a.s.r),o.write_shift(2,a.e.r),o.write_shift(2,a.s.c),o.write_shift(2,a.e.c),o}function Wy(a){var o=a.read_shift(2),l=a.read_shift(2);return{s:{c:a.read_shift(1),r:o},e:{c:a.read_shift(1),r:l}}}var I6=Wy;function zy(a){a.l+=4;var o=a.read_shift(2),l=a.read_shift(2),c=a.read_shift(2);return a.l+=12,[l,o,c]}function Jn(a){a.l+=2,a.l+=a.read_shift(2)}var D6={0:Jn,4:Jn,5:Jn,6:Jn,7:function(a){return a.l+=4,a.cf=a.read_shift(2),{}},8:Jn,9:Jn,10:Jn,11:Jn,12:Jn,13:function(a){var o={};return a.l+=4,a.l+=16,o.fSharedNote=a.read_shift(2),a.l+=4,o},14:Jn,15:Jn,16:Jn,17:Jn,18:Jn,19:Jn,20:Jn,21:zy};function yh(a,o){var l={BIFFVer:0,dt:0};switch(l.BIFFVer=a.read_shift(2),2<=(o-=2)&&(l.dt=a.read_shift(2),a.l-=2),l.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(6<o)throw new Error("Unexpected BIFF Ver "+l.BIFFVer)}return a.read_shift(o),l}function hp(a,o,l){var c=1536,u=16;switch(l.bookType){case"biff8":break;case"biff5":c=1280,u=8;break;case"biff4":c=4,u=6;break;case"biff3":c=3,u=6;break;case"biff2":c=2,u=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}return l=Ae(u),l.write_shift(2,c),l.write_shift(2,o),4<u&&l.write_shift(2,29282),6<u&&l.write_shift(2,1997),8<u&&(l.write_shift(2,49161),l.write_shift(2,1),l.write_shift(2,1798),l.write_shift(2,0)),l}function R6(a){var o=Ae(8);o.write_shift(4,a.Count),o.write_shift(4,a.Unique);for(var l,c,u,h=[],f=0;f<a.length;++f)h[f]=(l=a[f],u=c=void 0,c=l.t||"",(u=Ae(3)).write_shift(2,c.length),u.write_shift(1,1),(l=Ae(2*c.length)).write_shift(2*c.length,c,"utf16le"),K([u,l]));var d=K([o].concat(h));return d.parts=[o.length].concat(h.map(function(y){return y.length})),d}function Hy(a,o,l){var c=0;return l&&l.biff==2||(c=a.read_shift(2)),a=a.read_shift(2),l&&l.biff==2&&(c=1-(a>>15),a&=32767),[{Unsynced:1&c,DyZero:(2&c)>>1,ExAsc:(4&c)>>2,ExDsc:(8&c)>>3},a]}var Ul=Oo;function Gy(a,h,f){var c=a.l+h,d=f.biff!=8&&f.biff?2:4,u=a.read_shift(d),h=a.read_shift(d),f=a.read_shift(2),d=a.read_shift(2);return a.l=c,{s:{r:u,c:f},e:{r:h,c:d}}}function qy(a,o,l,c){return l=l&&l.biff==5,(c=c||Ae(l?16:20)).write_shift(2,0),a.style?(c.write_shift(2,a.numFmtId||0),c.write_shift(2,65524)):(c.write_shift(2,a.numFmtId||0),c.write_shift(2,o<<4)),o=0,0<a.numFmtId&&l&&(o|=1024),c.write_shift(4,o),c.write_shift(4,0),l||c.write_shift(4,0),c.write_shift(2,0),c}function Ky(a,o,l){var c=Oa(a);return l.biff!=2&&o!=9||++a.l,a=(o=a).read_shift(1),a=o.read_shift(1)===1?a:a===1,c.val=a,c.t=a===!0||a===!1?"b":"e",c}function Yy(a,o,l){return o===0?"":Oo(a,0,l)}function Qy(a,o,l){var c,u=a.read_shift(2),u={fBuiltIn:1&u,fWantAdvise:u>>>1&1,fWantPict:u>>>2&1,fOle:u>>>3&1,fOleLink:u>>>4&1,cf:u>>>5&1023,fIcon:u>>>15&1};return l.sbcch===14849&&(c=function(h,v,d){h.l+=4,v-=4;var y=h.l+v,v=Zc(h,0,d);if((d=h.read_shift(2))!==(y-=h.l))throw new Error("Malformed AddinUdf: padding = "+y+" != "+d);return h.l+=d,v}(a,o-2,l)),u.body=c||a.read_shift(o-2),typeof c=="string"&&(u.Name=c),u}var P6=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Xy(a,y,l){var c=a.l+y,u=a.read_shift(2),h=a.read_shift(1),f=a.read_shift(1),d=a.read_shift(l&&l.biff==2?1:2),y=0;return(!l||5<=l.biff)&&(l.biff!=5&&(a.l+=2),y=a.read_shift(2),l.biff==5&&(a.l+=2),a.l+=4),f=Po(a,f,l),32&u&&(f=P6[f.charCodeAt(0)]),u=c-a.l,l&&l.biff==2&&--u,{chKey:h,Name:f,itab:y,rgce:c!=a.l&&d!==0&&0<u?function(v,I,_,k){var S,I=v.l+I,k=uu(v,k,_);return I!==v.l&&(S=cu(v,I-v.l,k,_)),[k,S]}(a,u,l,d):[]}}function Jy(a,o,l){if(l.biff<8)return function(d,y){return d[d.l+1]==3&&d[d.l]++,y=Zc(d,0,y),y.charCodeAt(0)==3?y.slice(1):y}(a,l);for(var c,u,h=[],o=a.l+o,f=a.read_shift(8<l.biff?4:2);f--!=0;)h.push((c=a,l.biff,u=8<(u=l).biff?4:2,[c.read_shift(u),c.read_shift(u,"i"),c.read_shift(u,"i")]));if(a.l!=o)throw new Error("Bad ExternSheet: "+a.l+" != "+o);return h}function Zy(a,o,l){var c=I6(a);switch(l.biff){case 2:a.l++,o-=7;break;case 3:case 4:a.l+=2,o-=8;break;default:a.l+=6,o-=12}return[c,function(u,h,f){var d,y=u.l+h,v=f.biff==2?1:2,b=u.read_shift(v);if(b==65535)return[[],Fn(u,h-2)];var _=uu(u,b,f);return h!==b+v&&(d=cu(u,h-b-v,_,f)),u.l=y,[_,d]}(a,o,l)]}var O6={8:function(a,o){var l=a.l+o;a.l+=10;var c=a.read_shift(2);return a.l+=4,a.l+=2,a.l+=2,a.l+=2,a.l+=4,o=a.read_shift(1),a.l+=o,a.l=l,{fmt:c}}};function j6(a){var o=Ae(24),l=rr(a[0]);o.write_shift(2,l.r),o.write_shift(2,l.r),o.write_shift(2,l.c),o.write_shift(2,l.c);for(var c="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),u=0;u<16;++u)o.write_shift(1,parseInt(c[u],16));return K([o,function(h){var f=Ae(512),d=0,y=h.Target,v=-1<(h=(y=y.slice(0,7)=="file://"?y.slice(7):y).indexOf("#"))?31:23;switch(y.charAt(0)){case"#":v=28;break;case".":v&=-3}f.write_shift(4,2),f.write_shift(4,v);for(var b=[8,6815827,6619237,4849780,83],d=0;d<b.length;++d)f.write_shift(4,b[d]);if(v==28)Ly(y=y.slice(1),f);else if(2&v){for(b="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),d=0;d<b.length;++d)f.write_shift(1,parseInt(b[d],16));var _=-1<h?y.slice(0,h):y;for(f.write_shift(4,2*(_.length+1)),d=0;d<_.length;++d)f.write_shift(2,_.charCodeAt(d));f.write_shift(2,0),8&v&&Ly(-1<h?y.slice(h+1):"",f)}else{for(b="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),d=0;d<b.length;++d)f.write_shift(1,parseInt(b[d],16));for(var T=0;y.slice(3*T,3*T+3)=="../"||y.slice(3*T,3*T+3)=="..\\";)++T;for(f.write_shift(2,T),f.write_shift(4,y.length-3*T+1),d=0;d<y.length-3*T;++d)f.write_shift(1,255&y.charCodeAt(d+3*T));for(f.write_shift(1,0),f.write_shift(2,65535),f.write_shift(2,57005),d=0;d<6;++d)f.write_shift(4,0)}return f.slice(0,f.l)}(a[1])])}function ev(a,y,l){if(!l.cellStyles)return Fn(a,y);var c=l&&12<=l.biff?4:2,u=a.read_shift(c),h=a.read_shift(c),f=a.read_shift(c),d=a.read_shift(c),y=a.read_shift(2);return c==2&&(a.l+=2),d={s:u,e:h,w:f,ixfe:d,flags:y},(5<=l.biff||!l.biff)&&(d.level=y>>8&7),d}var M6=Oa,L6=Oy,Xp=eu,tv,rv,vh,V6=[2,3,48,49,131,139,140,245],dp=(tv={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},rv=wo({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127}),vh={B:8,C:250,L:1,D:8,"?":0,"":0},{to_workbook:function(a,o){try{return Li(nv(a,o),o)}catch(l){if(o&&o.WTF)throw l}return{SheetNames:[],Sheets:{}}},to_sheet:nv,from_sheet:function(a,o){if(0<=+(o=o||{}).codepage&&P(+o.codepage),o.type=="string")throw new Error("Cannot write DBF to JS string");for(var l=A(),c=(o=Uh(a,{header:1,raw:!0,cellDates:!0}))[0],u=o.slice(1),h=a["!cols"]||[],v=0,f=0,d=0,y=1,v=0;v<c.length;++v)if(((h[v]||{}).DBF||{}).name)c[v]=h[v].DBF.name,++d;else if(c[v]!=null){if(++d,typeof c[v]=="number"&&(c[v]=c[v].toString(10)),typeof c[v]!="string")throw new Error("DBF Invalid column name "+c[v]+" |"+typeof c[v]+"|");if(c.indexOf(c[v])!==v){for(f=0;f<1024;++f)if(c.indexOf(c[v]+"_"+f)==-1){c[v]+="_"+f;break}}}var b=nr(a["!ref"]),_=[],T=[],S=[];for(v=0;v<=b.e.c-b.s.c;++v){for(var I="",k="",M=0,D=[],f=0;f<u.length;++f)u[f][v]!=null&&D.push(u[f][v]);if(D.length!=0&&c[v]!=null){for(f=0;f<D.length;++f){switch(typeof D[f]){case"number":k="B";break;case"string":k="C";break;case"boolean":k="L";break;case"object":k=D[f]instanceof Date?"D":"C";break;default:k="C"}M=Math.max(M,String(D[f]).length),I=I&&I!=k?"C":k}250<M&&(M=250),(k=((h[v]||{}).DBF||{}).type)=="C"&&h[v].DBF.len>M&&(M=h[v].DBF.len),I=="B"&&k=="N"&&(I="N",S[v]=h[v].DBF.dec,M=h[v].DBF.len),T[v]=I=="C"||k=="N"?M:vh[I]||0,y+=T[v],_[v]=I}else _[v]="?"}var F,j,B=l.next(32);for(B.write_shift(4,318902576),B.write_shift(4,u.length),B.write_shift(2,296+32*d),B.write_shift(2,y),v=0;v<4;++v)B.write_shift(4,0);for(B.write_shift(4,0|(+rv[x]||3)<<8),f=v=0;v<c.length;++v)c[v]!=null&&(F=l.next(32),j=(c[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11),F.write_shift(1,j,"sbcs"),F.write_shift(1,_[v]=="?"?"C":_[v],"sbcs"),F.write_shift(4,f),F.write_shift(1,T[v]||vh[_[v]]||0),F.write_shift(1,S[v]||0),F.write_shift(1,2),F.write_shift(4,0),F.write_shift(1,0),F.write_shift(4,0),F.write_shift(4,0),f+=T[v]||vh[_[v]]||0);var z=l.next(264);for(z.write_shift(4,13),v=0;v<65;++v)z.write_shift(4,0);for(v=0;v<u.length;++v){var ae=l.next(y);for(ae.write_shift(1,0),f=0;f<c.length;++f)if(c[f]!=null)switch(_[f]){case"L":ae.write_shift(1,u[v][f]==null?63:u[v][f]?84:70);break;case"B":ae.write_shift(8,u[v][f]||0,"f");break;case"N":var he="0";for(typeof u[v][f]=="number"&&(he=u[v][f].toFixed(S[f]||0)),d=0;d<T[f]-he.length;++d)ae.write_shift(1,32);ae.write_shift(1,he,"sbcs");break;case"D":u[v][f]?(ae.write_shift(4,("0000"+u[v][f].getFullYear()).slice(-4),"sbcs"),ae.write_shift(2,("00"+(u[v][f].getMonth()+1)).slice(-2),"sbcs"),ae.write_shift(2,("00"+u[v][f].getDate()).slice(-2),"sbcs")):ae.write_shift(8,"00000000","sbcs");break;case"C":var le=String(u[v][f]!=null?u[v][f]:"").slice(0,T[f]);for(ae.write_shift(1,le,"sbcs"),d=0;d<T[f]-le.length;++d)ae.write_shift(1,32)}}return l.next(1).write_shift(1,26),l.end()}});function nv(a,o){return o=o||{},o.dateNF||(o.dateNF="yyyymmdd"),a=kl(function(l,c){var u=[],h=L(1);switch(c.type){case"base64":h=V(ee(l));break;case"binary":h=V(l);break;case"buffer":case"array":h=l}xn(h,0);var f=h.read_shift(1),d=!!(136&f),y=!1,v=!1;switch(f){case 2:case 3:break;case 48:case 49:d=y=!0;break;case 131:case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var b=0,_=521;f==2&&(b=h.read_shift(2)),h.l+=3,1048576<(b=f!=2?h.read_shift(4):b)&&(b=1e6),f!=2&&(_=h.read_shift(2));var T=h.read_shift(2),S=c.codepage||1252;f!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(S=tv[h[h.l]]),h.l+=1,h.l+=2),v&&(h.l+=36);for(var I=[],k={},M=Math.min(h.length,f==2?521:_-10-(y?264:0)),D=v?32:11;h.l<M&&h[h.l]!=13;)switch((k={}).name=e.utils.decode(S,h.slice(h.l,h.l+D)).replace(/[\u0000\r\n].*$/g,""),h.l+=D,k.type=String.fromCharCode(h.read_shift(1)),f==2||v||(k.offset=h.read_shift(4)),k.len=h.read_shift(1),f==2&&(k.offset=h.read_shift(2)),k.dec=h.read_shift(1),k.name.length&&I.push(k),f!=2&&(h.l+=v?13:14),k.type){case"B":y&&k.len==8||!c.WTF||console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(h[h.l]!==13&&(h.l=_-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=_;var F=0,j=0;for(u[0]=[],j=0;j!=I.length;++j)u[0][j]=I[j].name;for(;0<b--;)if(h[h.l]!==42)for(++h.l,u[++F]=[],j=j=0;j!=I.length;++j){var B=h.slice(h.l,h.l+I[j].len);h.l+=I[j].len,xn(B,0);var z=e.utils.decode(S,B);switch(I[j].type){case"C":z.trim().length&&(u[F][j]=z.replace(/\s+$/,""));break;case"D":z.length===8?u[F][j]=new Date(+z.slice(0,4),+z.slice(4,6)-1,+z.slice(6,8)):u[F][j]=z;break;case"F":u[F][j]=parseFloat(z.trim());break;case"+":case"I":u[F][j]=v?2147483648^B.read_shift(-4,"i"):B.read_shift(4,"i");break;case"L":switch(z.trim().toUpperCase()){case"Y":case"T":u[F][j]=!0;break;case"N":case"F":u[F][j]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+z+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[F][j]="##MEMO##"+(v?parseInt(z.trim(),10):B.read_shift(4));break;case"N":(z=z.replace(/\u0000/g,"").trim())&&z!="."&&(u[F][j]=+z||0);break;case"@":u[F][j]=new Date(B.read_shift(-8,"f")-621356832e5);break;case"T":u[F][j]=new Date(864e5*(B.read_shift(4)-2440588)+B.read_shift(4));break;case"Y":u[F][j]=B.read_shift(4,"i")/1e4+B.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[F][j]=-B.read_shift(-8,"f");break;case"B":if(y&&I[j].len==8){u[F][j]=B.read_shift(8,"f");break}case"G":case"P":B.l+=I[j].len;break;case"0":if(I[j].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+I[j].type)}}else h.l+=T;if(f!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=I,u}(a,o),o),a["!cols"]=o.DBF.map(function(l){return{wch:l.len,DBF:l}}),delete o.DBF,a}var xh,sv,av,iv,ov=(xh={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},sv=new RegExp("\x1BN("+Gr(xh).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),av=function(a,o){return o=xh[o],typeof o=="number"?G(o):o},iv=function(a,o,l){return l=o.charCodeAt(0)-32<<4|l.charCodeAt(0)-48,l==59?a:G(l)},xh["|"]=254,{to_workbook:function(a,o){return Li(lv(a,o),o)},to_sheet:lv,from_sheet:function(a,o){var l,c,u=["ID;PWXL;N;E"],h=[],f=nr(a["!ref"]),d=Array.isArray(a),y=`\r
`;u.push("P;PGeneral"),u.push("F;P0;DG0G8;M255"),a["!cols"]&&(l=u,a["!cols"].forEach(function(T,S){S="F;W"+(S+1)+" "+(S+1)+" ",T.hidden?S+="0":(typeof T.width!="number"||T.wpx||(T.wpx=nu(T.width)),typeof T.wpx!="number"||T.wch||(T.wch=su(T.wpx)),typeof T.wch=="number"&&(S+=Math.round(T.wch))),S.charAt(S.length-1)!=" "&&l.push(S)})),a["!rows"]&&(c=u,a["!rows"].forEach(function(T,S){var I="F;";T.hidden?I+="M0;":T.hpt?I+="M"+20*T.hpt+";":T.hpx&&(I+="M"+20*au(T.hpx)+";"),2<I.length&&c.push(I+"R"+(S+1))})),u.push("B;Y"+(f.e.r-f.s.r+1)+";X"+(f.e.c-f.s.c+1)+";D"+[f.s.c,f.s.r,f.e.c,f.e.r].join(" "));for(var v=f.s.r;v<=f.e.r;++v)for(var b=f.s.c;b<=f.e.c;++b){var _=Pt({r:v,c:b});(_=d?(a[v]||[])[b]:a[_])&&(_.v!=null||_.f&&!_.F)&&h.push(function(T,S,I){var k="C;Y"+(S+1)+";X"+(I+1)+";K";switch(T.t){case"n":k+=T.v||0,T.f&&!T.F&&(k+=";E"+kp(T.f,{r:S,c:I}));break;case"b":k+=T.v?"TRUE":"FALSE";break;case"e":k+=T.w||T.v;break;case"d":k+='"'+(T.w||T.v)+'"';break;case"s":k+='"'+T.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return k}(_,v,b))}return u.join(y)+y+h.join(y)+y+"E"+y}});function bh(T,o){var l,c,u=T.split(/[\n\r]+/),h=-1,f=-1,d=0,y=0,v=[],b=[],_=null,T={},S=[],I=[],k=0;for(0<=+o.codepage&&P(+o.codepage);d!==u.length;++d){k=0;var M,D=u[d].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,iv).replace(sv,av),F=D.replace(/;;/g,"\0").split(";").map(function(Ue){return Ue.replace(/\u0000/g,";")}),j=F[0];if(0<D.length)switch(j){case"ID":case"E":case"B":case"O":case"W":break;case"P":F[1].charAt(0)=="P"&&b.push(D.slice(3).replace(/;;/g,";"));break;case"C":for(var B=!1,z=!1,ae=!1,he=!1,le=-1,ve=-1,y=1;y<F.length;++y)switch(F[y].charAt(0)){case"A":break;case"X":f=parseInt(F[y].slice(1))-1,z=!0;break;case"Y":for(h=parseInt(F[y].slice(1))-1,z||(f=0),c=v.length;c<=h;++c)v[c]=[];break;case"K":(M=F[y].slice(1)).charAt(0)==='"'?M=M.slice(1,M.length-1):M==="TRUE"?M=!0:M==="FALSE"?M=!1:isNaN(_s(M))?isNaN(ka(M).getDate())||(M=Ur(M)):(M=_s(M),_!==null&&Is(_)&&(M=ha(M))),e!==void 0&&typeof M=="string"&&(o||{}).type!="string"&&(o||{}).codepage&&(M=e.utils.decode(o.codepage,M)),B=!0;break;case"E":he=!0;var Ie=Ml(F[y].slice(1),{r:h,c:f});v[h][f]=[v[h][f],Ie];break;case"S":ae=!0,v[h][f]=[v[h][f],"S5S"];break;case"G":break;case"R":le=parseInt(F[y].slice(1))-1;break;case"C":ve=parseInt(F[y].slice(1))-1;break;default:if(o&&o.WTF)throw new Error("SYLK bad record "+D)}if(B&&(v[h][f]&&v[h][f].length==2?v[h][f][0]=M:v[h][f]=M,_=null),ae){if(he)throw new Error("SYLK shared formula cannot have own formula");var De=-1<le&&v[le][ve];if(!De||!De[1])throw new Error("SYLK shared formula cannot find base");v[h][f][1]=nx(De[1],{r:h-le,c:f-ve})}break;case"F":var _e=0;for(y=1;y<F.length;++y)switch(F[y].charAt(0)){case"X":f=parseInt(F[y].slice(1))-1,++_e;break;case"Y":for(h=parseInt(F[y].slice(1))-1,c=v.length;c<=h;++c)v[c]=[];break;case"M":k=parseInt(F[y].slice(1))/20;break;case"F":case"G":break;case"P":_=b[parseInt(F[y].slice(1))];break;case"S":case"D":case"N":break;case"W":for(l=F[y].slice(1).split(" "),c=parseInt(l[0],10);c<=parseInt(l[1],10);++c)k=parseInt(l[2],10),I[c-1]=k===0?{hidden:!0}:{wch:k},Ui(I[c-1]);break;case"C":I[f=parseInt(F[y].slice(1))-1]||(I[f]={});break;case"R":S[h=parseInt(F[y].slice(1))-1]||(S[h]={}),0<k?(S[h].hpt=k,S[h].hpx=Ol(k)):k===0&&(S[h].hidden=!0);break;default:if(o&&o.WTF)throw new Error("SYLK bad record "+D)}_e<1&&(_=null);break;default:if(o&&o.WTF)throw new Error("SYLK bad record "+D)}}return 0<S.length&&(T["!rows"]=S),0<I.length&&(T["!cols"]=I),[v=o&&o.sheetRows?v.slice(0,o.sheetRows):v,T]}function lv(c,o){var l=function(f,d){switch(d.type){case"base64":return bh(ee(f),d);case"binary":return bh(f,d);case"buffer":return bh(te&&Buffer.isBuffer(f)?f.toString("binary"):J(f),d);case"array":return bh(da(f),d)}throw new Error("Unrecognized type "+d.type)}(c,o),c=l[0],u=l[1],h=kl(c,o);return Gr(u).forEach(function(f){h[f]=u[f]}),h}var cv={to_workbook:function(a,o){return Li(uv(a,o),o)},to_sheet:uv,from_sheet:function(a){var o=[],l=nr(a["!ref"]),c=Array.isArray(a);_h(o,"TABLE",0,1,"sheetjs"),_h(o,"VECTORS",0,l.e.r-l.s.r+1,""),_h(o,"TUPLES",0,l.e.c-l.s.c+1,""),_h(o,"DATA",0,0,"");for(var u=l.s.r;u<=l.e.r;++u){ja(o,-1,0,"BOT");for(var h=l.s.c;h<=l.e.c;++h){var f,d=Pt({r:u,c:h});if(f=c?(a[u]||[])[h]:a[d])switch(f.t){case"n":var y=f.w;(y=!y&&f.v!=null?f.v:y)==null?f.f&&!f.F?ja(o,1,0,"="+f.f):ja(o,1,0,""):ja(o,0,y,"V");break;case"b":ja(o,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":ja(o,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Rt(f.z||de[14],qr(Ur(f.v)))),ja(o,0,f.w,"V");break;default:ja(o,1,0,"")}else ja(o,1,0,"")}}return ja(o,-1,0,"EOD"),o.join(`\r
`)}};function wh(a,o){for(var l=a.split(`
`),c=-1,u=-1,h=0,f=[];h!==l.length;++h)if(l[h].trim()!=="BOT"){if(!(c<0)){for(var d=l[h].trim().split(","),y=d[0],v=d[1],b=l[++h]||"";1&(b.match(/["]/g)||[]).length&&h<l.length-1;)b+=`
`+l[++h];switch(b=b.trim(),+y){case-1:if(b==="BOT"){f[++c]=[],u=0;continue}if(b!=="EOD")throw new Error("Unrecognized DIF special command "+b);break;case 0:b==="TRUE"?f[c][u]=!0:b==="FALSE"?f[c][u]=!1:isNaN(_s(v))?isNaN(ka(v).getDate())?f[c][u]=v:f[c][u]=Ur(v):f[c][u]=_s(v),++u;break;case 1:b=(b=b.slice(1,b.length-1)).replace(/""/g,'"'),b&&b.match(/^=".*"$/)&&(b=b.slice(2,-1)),f[c][u++]=b!==""?b:null}if(b==="EOD")break}}else f[++c]=[],u=0;return f=o&&o.sheetRows?f.slice(0,o.sheetRows):f}function uv(a,o){return kl(function(l,c){switch(c.type){case"base64":return wh(ee(l),c);case"binary":return wh(l,c);case"buffer":return wh(te&&Buffer.isBuffer(l)?l.toString("binary"):J(l),c);case"array":return wh(da(l),c)}throw new Error("Unrecognized type "+c.type)}(a,o),o)}function _h(a,o,l,c,u){a.push(o),a.push(l+","+c),a.push('"'+u.replace(/"/g,'""')+'"')}function ja(a,o,l,c){a.push(o+","+l),a.push(o==1?'"'+c.replace(/"/g,'""')+'"':c)}var fv,pp,hv,dv,pv=(fv=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),pp=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,hv=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),dv="--SocialCalcSpreadsheetControlSave--",{to_workbook:function(a,o){return Li(mv(a,o),o)},to_sheet:mv,from_sheet:function(a){return[fv,pp,hv,pp,function(o){if(!o||!o["!ref"])return"";for(var l,c,u=[],h=[],f=Wr(o["!ref"]),d=Array.isArray(o),y=f.s.r;y<=f.e.r;++y)for(var v=f.s.c;v<=f.e.c;++v)if(c=Pt({r:y,c:v}),(l=d?(o[y]||[])[v]:o[c])&&l.v!=null&&l.t!=="z"){switch(h=["cell",c,"t"],l.t){case"s":case"str":h.push(mp(l.v));break;case"n":l.f?(h[2]="vtf",h[3]="n",h[4]=l.v,h[5]=mp(l.f)):(h[2]="v",h[3]=l.v);break;case"b":h[2]="vt"+(l.f?"f":"c"),h[3]="nl",h[4]=l.v?"1":"0",h[5]=mp(l.f||(l.v?"TRUE":"FALSE"));break;case"d":var b=qr(Ur(l.v));h[2]="vtc",h[3]="nd",h[4]=""+b,h[5]=l.w||Rt(l.z||de[14],b);break;case"e":continue}u.push(h.join(":"))}return u.push("sheet:c:"+(f.e.c-f.s.c+1)+":r:"+(f.e.r-f.s.r+1)+":tvf:1"),u.push("valueformat:1:text-wiki"),u.join(`
`)}(a),dv].join(`
`)}});function mp(a){return a.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function mv(a,o){return kl(function(l,c){for(var u,h=l.split(`
`),f=-1,d=0,y=[];d!==h.length;++d){var v=h[d].trim().split(":");if(v[0]==="cell"){var b=rr(v[1]);if(y.length<=b.r)for(f=y.length;f<=b.r;++f)y[f]||(y[f]=[]);switch(f=b.r,u=b.c,v[2]){case"t":y[f][u]=v[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`);break;case"v":y[f][u]=+v[3];break;case"vtf":var _=v[v.length-1];case"vtc":v[3]==="nl"?y[f][u]=!!+v[4]:y[f][u]=+v[4],v[2]=="vtf"&&(y[f][u]=[y[f][u],_])}}}return y=c&&c.sheetRows?y.slice(0,c.sheetRows):y}(a,o),o)}var gp,Th,Dl=(gp={44:",",9:"	",59:";",124:"|"},Th={44:3,9:2,59:1,124:0},{to_workbook:function(a,o){return Li(vv(a,o),o)},to_sheet:vv,from_sheet:function(a){for(var o=[],l=nr(a["!ref"]),c=Array.isArray(a),u=l.s.r;u<=l.e.r;++u){for(var h=[],f=l.s.c;f<=l.e.c;++f){var d=Pt({r:u,c:f});if((d=c?(a[u]||[])[f]:a[d])&&d.v!=null){for(var y=(d.w||(Pa(d),d.w)||"").slice(0,10);y.length<10;)y+=" ";h.push(y+(f===0?" ":""))}else h.push("          ")}o.push(h.join(""))}return o.join(`
`)}});function gv(a,o,l,c,u){u.raw?o[l][c]=a:a===""||(a==="TRUE"?o[l][c]=!0:a==="FALSE"?o[l][c]=!1:isNaN(_s(a))?isNaN(ka(a).getDate())?o[l][c]=a:o[l][c]=Ur(a):o[l][c]=_s(a))}function yv(a){for(var o={},l=!1,c=0,u=0;c<a.length;++c)(u=a.charCodeAt(c))==34?l=!l:!l&&u in gp&&(o[u]=(o[u]||0)+1);for(c in u=[],o)Object.prototype.hasOwnProperty.call(o,c)&&u.push([o[c],c]);if(!u.length)for(c in o=Th)Object.prototype.hasOwnProperty.call(o,c)&&u.push([o[c],c]);return u.sort(function(h,f){return h[0]-f[0]||Th[h[1]]-Th[f[1]]}),gp[u.pop()[1]]||44}function U6(a,c){var l=c||{},c="",u=l.dense?[]:{},h={s:{c:0,r:0},e:{c:0,r:0}};a.slice(0,4)=="sep="?a.charCodeAt(5)==13&&a.charCodeAt(6)==10?(c=a.charAt(4),a=a.slice(7)):a.charCodeAt(5)==13||a.charCodeAt(5)==10?(c=a.charAt(4),a=a.slice(6)):c=yv(a.slice(0,1024)):c=l&&l.FS?l.FS:yv(a.slice(0,1024));var f=0,d=0,y=0,v=0,b=0,_=c.charCodeAt(0),T=!1,S=0,I=a.charCodeAt(0);a=a.replace(/\r\n/gm,`
`);var k=l.dateNF!=null?(c=(c=typeof(c=l.dateNF)=="number"?de[c]:c).replace(ki,"(\\d+)"),new RegExp("^"+c+"$")):null;function M(){var D,F=a.slice(v,b),j={};if((F=F.charAt(0)=='"'&&F.charAt(F.length-1)=='"'?F.slice(1,-1).replace(/""/g,'"'):F).length===0?j.t="z":l.raw||F.trim().length===0?(j.t="s",j.v=F):F.charCodeAt(0)==61?F.charCodeAt(1)==34&&F.charCodeAt(F.length-1)==34?(j.t="s",j.v=F.slice(2,-1).replace(/""/g,'"')):F.length!=1?(j.t="n",j.f=F.slice(1)):(j.t="s",j.v=F):F=="TRUE"?(j.t="b",j.v=!0):F=="FALSE"?(j.t="b",j.v=!1):isNaN(y=_s(F))?!isNaN(ka(F).getDate())||k&&F.match(k)?(j.z=l.dateNF||de[14],D=0,k&&F.match(k)&&(F=function(B,z){var ae=-1,he=-1,le=-1,ve=-1,Ie=-1,De=-1;(B.match(ki)||[]).forEach(function(Ue,it){var nt=parseInt(z[it+1],10);switch(Ue.toLowerCase().charAt(0)){case"y":ae=nt;break;case"d":le=nt;break;case"h":ve=nt;break;case"s":De=nt;break;case"m":0<=ve?Ie=nt:he=nt}}),0<=De&&Ie==-1&&0<=he&&(Ie=he,he=-1);var _e=(""+(0<=ae?ae:new Date().getFullYear())).slice(-4)+"-"+("00"+(1<=he?he:1)).slice(-2)+"-"+("00"+(1<=le?le:1)).slice(-2);return(_e=_e.length==7?"0"+_e:_e).length==8&&(_e="20"+_e),B=("00"+(0<=ve?ve:0)).slice(-2)+":"+("00"+(0<=Ie?Ie:0)).slice(-2)+":"+("00"+(0<=De?De:0)).slice(-2),ve==-1&&Ie==-1&&De==-1?_e:ae==-1&&he==-1&&le==-1?B:_e+"T"+B}(l.dateNF,F.match(k)||[]),D=1),l.cellDates?(j.t="d",j.v=Ur(F,D)):(j.t="n",j.v=qr(Ur(F,D))),l.cellText!==!1&&(j.w=Rt(j.z,j.v instanceof Date?qr(j.v):j.v)),l.cellNF||delete j.z):(j.t="s",j.v=F):(!(j.t="n")!==l.cellText&&(j.w=F),j.v=y),j.t=="z"||(l.dense?(u[f]||(u[f]=[]),u[f][d]=j):u[Pt({c:d,r:f})]=j),v=b+1,I=a.charCodeAt(v),h.e.c<d&&(h.e.c=d),h.e.r<f&&(h.e.r=f),S!=_)return d=0,++f,l.sheetRows&&l.sheetRows<=f?1:void 0;++d}e:for(;b<a.length;++b)switch(S=a.charCodeAt(b)){case 34:I===34&&(T=!T);break;case _:case 10:case 13:if(!T&&M())break e}return 0<b-v&&M(),u["!ref"]=Bt(h),u}function B6(a,o){return!o||!o.PRN||o.FS||a.slice(0,4)=="sep="||0<=a.indexOf("	")||0<=a.indexOf(",")||0<=a.indexOf(";")?U6(a,o):kl(function(l,c){var u=c||{},h=[];if(!l||l.length===0)return h;for(var f=l.split(/[\r\n]/),d=f.length-1;0<=d&&f[d].length===0;)--d;for(var y=10,v=0,b=0;b<=d;++b)(v=f[b].indexOf(" "))==-1?v=f[b].length:v++,y=Math.max(y,v);for(b=0;b<=d;++b){h[b]=[];var _=0;for(gv(f[b].slice(0,y).trim(),h,b,_,u),_=1;_<=(f[b].length-y)/10+1;++_)gv(f[b].slice(y+10*(_-1),y+10*_).trim(),h,b,_,u)}return h=u.sheetRows?h.slice(0,u.sheetRows):h}(a,o),o)}function vv(a,o){var l="",c=o.type=="string"?[0,0,0,0]:zp(a,o);switch(o.type){case"base64":l=ee(a);break;case"binary":l=a;break;case"buffer":l=o.codepage==65001?a.toString("utf8"):o.codepage&&e!==void 0?e.utils.decode(o.codepage,a):te&&Buffer.isBuffer(a)?a.toString("binary"):J(a);break;case"array":l=da(a);break;case"string":l=a;break;default:throw new Error("Unrecognized type "+o.type)}return c[0]==239&&c[1]==187&&c[2]==191?l=kr(l.slice(3)):o.type!="string"&&o.type!="buffer"&&o.codepage==65001?l=kr(l):o.type=="binary"&&e!==void 0&&o.codepage&&(l=e.utils.decode(o.codepage,e.utils.encode(28591,l))),l.slice(0,19)=="socialcalc:version:"?pv.to_sheet(o.type=="string"?l:kr(l),o):B6(l,o)}var Eh,yp,vp,xv,Mo=(Eh={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},yp=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""],vp={0:{n:"BOF",f:bn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(a,o,l){var c={s:{c:0,r:0},e:{c:0,r:0}};return o==8&&l.qpro?(c.s.c=a.read_shift(1),a.l++,c.s.r=a.read_shift(2),c.e.c=a.read_shift(1),a.l++,c.e.r=a.read_shift(2)):(c.s.c=a.read_shift(2),c.s.r=a.read_shift(2),o==12&&l.qpro&&(a.l+=2),c.e.c=a.read_shift(2),c.e.r=a.read_shift(2),o==12&&l.qpro&&(a.l+=2),c.s.c==65535&&(c.s.c=c.e.c=c.s.r=c.e.r=0)),c}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(a,o,l){return(l=Sh(a,0,l))[1].v=a.read_shift(2,"i"),l}},14:{n:"NUMBER",f:function(a,o,l){return(l=Sh(a,0,l))[1].v=a.read_shift(8,"f"),l}},15:{n:"LABEL",f:wv},16:{n:"FORMULA",f:function(a,o,l){var c=a.l+o;return(o=Sh(a,0,l))[1].v=a.read_shift(8,"f"),l.qpro?a.l=c:(c=a.read_shift(2),function(u,h){xn(u,0);for(var f=[],d=0,y="",v="",b="",_="";u.l<u.length;){var T=u[u.l++];switch(T){case 0:f.push(u.read_shift(8,"f"));break;case 1:v=Rl(h[0].c,u.read_shift(2),!0),y=Rl(h[0].r,u.read_shift(2),!1),f.push(v+y);break;case 2:var S=Rl(h[0].c,u.read_shift(2),!0),I=Rl(h[0].r,u.read_shift(2),!1);v=Rl(h[0].c,u.read_shift(2),!0),y=Rl(h[0].r,u.read_shift(2),!1),f.push(S+I+":"+v+y);break;case 3:if(u.l<u.length)return console.error("WK1 premature formula end");break;case 4:f.push("("+f.pop()+")");break;case 5:f.push(u.read_shift(2));break;case 6:for(var k="";T=u[u.l++];)k+=String.fromCharCode(T);f.push('"'+k.replace(/"/g,'""')+'"');break;case 8:f.push("-"+f.pop());break;case 23:f.push("+"+f.pop());break;case 22:f.push("NOT("+f.pop()+")");break;case 20:case 21:_=f.pop(),b=f.pop(),f.push(["AND","OR"][T-20]+"("+b+","+_+")");break;default:if(T<32&&yp[T])_=f.pop(),b=f.pop(),f.push(b+yp[T]+_);else{if(!Eh[T])return T<=7?console.error("WK1 invalid opcode "+T.toString(16)):T<=24?console.error("WK1 unsupported op "+T.toString(16)):T<=30?console.error("WK1 invalid opcode "+T.toString(16)):T<=115?console.error("WK1 unsupported function opcode "+T.toString(16)):console.error("WK1 unrecognized opcode "+T.toString(16));if((d=(d=Eh[T][1])==69?u[u.l++]:d)>f.length)return console.error("WK1 bad formula parse 0x"+T.toString(16)+":|"+f.join("|")+"|");I=f.slice(-d),f.length-=d,f.push(Eh[T][0]+"("+I.join(",")+")")}}}f.length==1?h[1].f=""+f[0]:console.error("WK1 bad formula parse |"+f.join("|")+"|")}(a.slice(a.l,a.l+c),o),a.l+=c),o}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:wv},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ev},222:{n:"SHEETNAMELP",f:function(a,o){var l=a[a.l++];o-1<l&&(l=o-1);for(var c="";c.length<l;)c+=String.fromCharCode(a[a.l++]);return c}},65535:{n:""}},xv={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(a,o){var l=tu(a);return l[1].t="s",l[1].v=a.read_shift(o-4,"cstr"),l}},23:{n:"NUMBER17",f:_v},24:{n:"NUMBER18",f:function(a,o){var l=tu(a);l[1].v=a.read_shift(2);var c=l[1].v>>1;if(1&l[1].v)switch(7&c){case 0:c=5e3*(c>>3);break;case 1:c=500*(c>>3);break;case 2:c=(c>>3)/20;break;case 3:c=(c>>3)/200;break;case 4:c=(c>>3)/2e3;break;case 5:c=(c>>3)/2e4;break;case 6:c=(c>>3)/16;break;case 7:c=(c>>3)/64}return l[1].v=c,l}},25:{n:"FORMULA19",f:function(a,o){var l=_v(a);return a.l+=o-14,l}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(a,o){for(var l={},c=a.l+o;a.l<c;){var u=a.read_shift(2);if(u==14e3){for(l[u]=[0,""],l[u][0]=a.read_shift(2);a[a.l];)l[u][1]+=String.fromCharCode(a[a.l]),a.l++;a.l++}}return l}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(c,o){var l=tu(c),c=c.read_shift(4);return l[1].v=c>>6,l}},38:{n:"??"},39:{n:"NUMBER27",f:Tv},40:{n:"FORMULA28",f:function(a,o){var l=Tv(a);return a.l+=o-10,l}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ev},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(a,o,l){if(l.qpro&&!(o<21))return l=a.read_shift(1),a.l+=17,a.l+=1,a.l+=2,[l,a.read_shift(o-21,"cstr")]}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},{sheet_to_wk1:function(a,o){var l=o||{};if(0<=+l.codepage&&P(+l.codepage),l.type=="string")throw new Error("Cannot write WK1 to JS string");var c=A(),u=nr(a["!ref"]),h=Array.isArray(a),f=[];rt(c,0,(o=1030,(l=Ae(2)).write_shift(2,o),l)),rt(c,6,(o=u,(l=Ae(8)).write_shift(2,o.s.c),l.write_shift(2,o.s.r),l.write_shift(2,o.e.c),l.write_shift(2,o.e.r),l));for(var d,y,v,b,_=Math.min(u.e.r,8191),T=u.s.r;T<=_;++T)for(var S=tr(T),I=u.s.c;I<=u.e.c;++I){T===u.s.r&&(f[I]=Yt(I));var k=f[I]+S,k=h?(a[T]||[])[I]:a[k];k&&k.t!="z"&&(k.t=="n"?(0|k.v)==k.v&&-32768<=k.v&&k.v<=32767?rt(c,13,(d=T,y=I,v=k.v,b=void 0,(b=Ae(7)).write_shift(1,255),b.write_shift(2,y),b.write_shift(2,d),b.write_shift(2,v,"i"),b)):rt(c,14,(y=T,d=I,v=k.v,b=void 0,(b=Ae(13)).write_shift(1,255),b.write_shift(2,d),b.write_shift(2,y),b.write_shift(8,v,"f"),b)):rt(c,15,function(M,D,F){var j=Ae(7+F.length);j.write_shift(1,255),j.write_shift(2,D),j.write_shift(2,M),j.write_shift(1,39);for(var B=0;B<j.length;++B){var z=F.charCodeAt(B);j.write_shift(1,128<=z?95:z)}return j.write_shift(1,0),j}(T,I,Pa(k).slice(0,239))))}return rt(c,1),c.end()},book_to_wk3:function(a,o){if(0<=+(o=o||{}).codepage&&P(+o.codepage),o.type=="string")throw new Error("Cannot write WK3 to JS string");var l=A();rt(l,0,function(k){var M=Ae(26);M.write_shift(2,4096),M.write_shift(2,4),M.write_shift(4,0);for(var D=0,F=0,j=0,B=0;B<k.SheetNames.length;++B){var z=k.SheetNames[B],z=k.Sheets[z];z&&z["!ref"]&&(++j,z=Wr(z["!ref"]),D<z.e.r&&(D=z.e.r),F<z.e.c&&(F=z.e.c))}return 8191<D&&(D=8191),M.write_shift(2,D),M.write_shift(1,j),M.write_shift(1,F),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(1,1),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(4,0),M}(a));for(var c=0,u=0;c<a.SheetNames.length;++c)(a.Sheets[a.SheetNames[c]]||{})["!ref"]&&rt(l,27,function(k,M){var D=Ae(5+k.length);D.write_shift(2,14e3),D.write_shift(2,M);for(var F=0;F<k.length;++F){var j=k.charCodeAt(F);D[D.l++]=127<j?95:j}return D[D.l++]=0,D}(a.SheetNames[c],u++));for(var h=0,c=0;c<a.SheetNames.length;++c){var f=a.Sheets[a.SheetNames[c]];if(f&&f["!ref"]){for(var d=nr(f["!ref"]),y=Array.isArray(f),v=[],b=Math.min(d.e.r,8191),_=d.s.r;_<=b;++_)for(var T=tr(_),S=d.s.c;S<=d.e.c;++S){_===d.s.r&&(v[S]=Yt(S));var I=v[S]+T,I=y?(f[_]||[])[S]:f[I];I&&I.t!="z"&&(I.t=="n"?rt(l,23,function(ae,le,he,j){var B=Ae(14);if(B.write_shift(2,ae),B.write_shift(1,he),B.write_shift(1,le),j==0)return B.write_shift(4,0),B.write_shift(4,0),B.write_shift(2,65535),B;var z=0,ae=0,he=0,le=0;return j<0&&(z=1,j=-j),ae=0|Math.log2(j),j/=Math.pow(2,ae-31),!(2147483648&(le=j>>>0))&&(++ae,le=(j/=2)>>>0),j-=le,le|=2147483648,le>>>=0,j*=Math.pow(2,32),he=j>>>0,B.write_shift(4,he),B.write_shift(4,le),ae+=16383+(z?32768:0),B.write_shift(2,ae),B}(_,S,h,I.v)):rt(l,22,function(M,D,F,j){var B=Ae(6+j.length);B.write_shift(2,M),B.write_shift(1,F),B.write_shift(1,D),B.write_shift(1,39);for(var z=0;z<j.length;++z){var ae=j.charCodeAt(z);B.write_shift(1,128<=ae?95:ae)}return B.write_shift(1,0),B}(_,S,h,Pa(I).slice(0,239))))}++h}}return rt(l,1),l.end()},to_workbook:function(a,o){switch(o.type){case"base64":return xp(V(ee(a)),o);case"binary":return xp(V(a),o);case"buffer":case"array":return xp(a,o)}throw"Unsupported type "+o.type}});function bv(a,o,l){if(a){xn(a,a.l||0);for(var c=l.Enum||vp;a.l<a.length;){var u=a.read_shift(2),h=c[u]||c[65535],d=a.read_shift(2),f=a.l+d,d=h.f&&h.f(a,d,l);if(a.l=f,o(d,h,u))return}}}function xp(a,o){if(!a)return a;var l=o||{},c=l.dense?[]:{},u="Sheet1",h="",f=0,d={},y=[],v=[],b={s:{r:0,c:0},e:{r:0,c:0}},_=l.sheetRows||0;if(a[2]==0&&(a[3]==8||a[3]==9)&&16<=a.length&&a[14]==5&&a[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(a[2]==2)l.Enum=vp,bv(a,function(k,M,D){switch(D){case 0:4096<=(l.vers=k)&&(l.qpro=!0);break;case 6:b=k;break;case 204:k&&(h=k);break;case 222:h=k;break;case 15:case 51:l.qpro||(k[1].v=k[1].v.slice(1));case 13:case 14:case 16:D==14&&(112&k[2])==112&&1<(15&k[2])&&(15&k[2])<15&&(k[1].z=l.dateNF||de[14],l.cellDates&&(k[1].t="d",k[1].v=ha(k[1].v))),l.qpro&&k[3]>f&&(c["!ref"]=Bt(b),d[u]=c,y.push(u),c=l.dense?[]:{},b={s:{r:0,c:0},e:{r:0,c:0}},f=k[3],u=h||"Sheet"+(f+1),h="");var F=l.dense?(c[k[0].r]||[])[k[0].c]:c[Pt(k[0])];if(F){F.t=k[1].t,F.v=k[1].v,k[1].z!=null&&(F.z=k[1].z),k[1].f!=null&&(F.f=k[1].f);break}l.dense?(c[k[0].r]||(c[k[0].r]=[]),c[k[0].r][k[0].c]=k[1]):c[Pt(k[0])]=k[1]}},l);else{if(a[2]!=26&&a[2]!=14)throw new Error("Unrecognized LOTUS BOF "+a[2]);l.Enum=xv,a[2]==14&&(l.qpro=!0,a.l=0),bv(a,function(k,M,D){switch(D){case 204:u=k;break;case 22:k[1].v=k[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(k[3]>f&&(c["!ref"]=Bt(b),d[u]=c,y.push(u),c=l.dense?[]:{},b={s:{r:0,c:0},e:{r:0,c:0}},f=k[3],u="Sheet"+(f+1)),0<_&&k[0].r>=_)break;l.dense?(c[k[0].r]||(c[k[0].r]=[]),c[k[0].r][k[0].c]=k[1]):c[Pt(k[0])]=k[1],b.e.c<k[0].c&&(b.e.c=k[0].c),b.e.r<k[0].r&&(b.e.r=k[0].r);break;case 27:k[14e3]&&(v[k[14e3][0]]=k[14e3][1]);break;case 1537:v[k[0]]=k[1],k[0]==f&&(u=k[1])}},l)}if(c["!ref"]=Bt(b),d[h||u]=c,y.push(h||u),!v.length)return{SheetNames:y,Sheets:d};for(var T={},S=[],I=0;I<v.length;++I)d[y[I]]?(S.push(v[I]||y[I]),T[v[I]]=d[v[I]]||d[y[I]]):(S.push(v[I]),T[v[I]]={"!ref":"A1"});return{SheetNames:S,Sheets:T}}function Sh(a,o,l){var c=[{c:0,r:0},{t:"n",v:0},0,0];return l.qpro&&l.vers!=20768?(c[0].c=a.read_shift(1),c[3]=a.read_shift(1),c[0].r=a.read_shift(2),a.l+=2):(c[2]=a.read_shift(1),c[0].c=a.read_shift(2),c[0].r=a.read_shift(2)),c}function wv(a,u,l){var c=a.l+u,u=Sh(a,0,l);return u[1].t="s",l.vers!=20768?(l.qpro&&a.l++,u[1].v=a.read_shift(c-a.l,"cstr"),u):(a.l++,c=a.read_shift(1),u[1].v=a.read_shift(c,"utf8"),u)}function Rl(a,o,l){var c=32768&o;return(c?"":"$")+(l?Yt:tr)(o=(c?a:0)+(8192<=(o&=-32769)?o-16384:o))}function tu(a){var o=[{c:0,r:0},{t:"n",v:0},0];return o[0].r=a.read_shift(2),o[3]=a[a.l++],o[0].c=a[a.l++],o}function _v(h,o){var l=tu(h),c=h.read_shift(4),u=h.read_shift(4);if((f=h.read_shift(2))==65535)return c===0&&u===3221225472?(l[1].t="e",l[1].v=15):c===0&&u===3489660928?(l[1].t="e",l[1].v=42):l[1].v=0,l;var h=32768&f,f=(32767&f)-16446;return l[1].v=(1-2*h)*(u*Math.pow(2,32+f)+c*Math.pow(2,f)),l}function Tv(c,o){var l=tu(c),c=c.read_shift(8,"f");return l[1].v=c,l}function Ev(a,o){return a[a.l+o-1]==0?a.read_shift(o,"cstr"):""}var Sv,Av,Cv,kv,$6=(Sv=Hs("t"),Av=Hs("rPr"),Cv=/<(?:\w+:)?r>/g,kv=/<\/(?:\w+:)?r>/,function(a){return a.replace(Cv,"").split(kv).map(W6).filter(function(o){return o.v})});function W6(a){var o=a.match(Sv);return o?(o={t:"s",v:qt(o[1])},a=a.match(Av),a&&(o.s=function(l){var c={},u=l.match(vn),h=0,f=!1;if(u)for(;h!=u.length;++h){var d=Lt(u[h]);switch(d[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!d.val)break;case"<shadow>":case"<shadow/>":c.shadow=1;break;case"</shadow>":break;case"<charset":if(d.val=="1")break;c.cp=E[parseInt(d.val,10)];break;case"<outline":if(!d.val)break;case"<outline>":case"<outline/>":c.outline=1;break;case"</outline>":break;case"<rFont":c.name=d.val;break;case"<sz":c.sz=d.val;break;case"<strike":if(!d.val)break;case"<strike>":case"<strike/>":c.strike=1;break;case"</strike>":break;case"<u":if(!d.val)break;switch(d.val){case"double":c.uval="double";break;case"singleAccounting":c.uval="single-accounting";break;case"doubleAccounting":c.uval="double-accounting"}case"<u>":case"<u/>":c.u=1;break;case"</u>":break;case"<b":if(d.val=="0")break;case"<b>":case"<b/>":c.b=1;break;case"</b>":break;case"<i":if(d.val=="0")break;case"<i>":case"<i/>":c.i=1;break;case"</i>":break;case"<color":d.rgb&&(c.color=d.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":c.family=d.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":c.valign=d.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":f=!0;break;case"</ext>":f=!1;break;default:if(d[0].charCodeAt(1)!==47&&!f)throw new Error("Unrecognized rich format "+d[0])}}return c}(a[1])),o):{t:"s",v:""}}var Fv,z6=(Fv=/(\r\n|\n)/g,function(a){return a.map(H6).join("")});function H6(a){var o,l,c,u=[[],a.v,[]];return a.v?(a.s&&(o=a.s,l=u[0],c=u[2],a=[],o.u&&a.push("text-decoration: underline;"),o.uval&&a.push("text-underline-style:"+o.uval+";"),o.sz&&a.push("font-size:"+o.sz+"pt;"),o.outline&&a.push("text-effect: outline;"),o.shadow&&a.push("text-shadow: auto;"),l.push('<span style="'+a.join("")+'">'),o.b&&(l.push("<b>"),c.push("</b>")),o.i&&(l.push("<i>"),c.push("</i>")),o.strike&&(l.push("<s>"),c.push("</s>")),(a=o.valign||"")=="superscript"||a=="super"?a="sup":a=="subscript"&&(a="sub"),a!=""&&(l.push("<"+a+">"),c.push("</"+a+">")),c.push("</span>")),u[0].join("")+u[1].replace(Fv,"<br/>")+u[2].join("")):""}var G6=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,q6=/<(?:\w+:)?r>/,K6=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function bp(a,c){var l=!c||c.cellHTML,c={};return a?(a.match(/^\s*<(?:\w+:)?t[^>]*>/)?(c.t=qt(kr(a.slice(a.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),c.r=kr(a),l&&(c.h=Xa(c.t))):a.match(q6)&&(c.r=kr(a),c.t=qt(kr((a.replace(K6,"").match(G6)||[]).join("").replace(vn,""))),l&&(c.h=z6($6(c.r)))),c):{t:""}}var Y6=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Q6=/<(?:\w+:)?(?:si|sstItem)>/g,X6=/<\/(?:\w+:)?(?:si|sstItem)>/,J6=/^\s|\s$|[\t\n\r]/;function Nv(a,o){if(!o.bookSST)return"";var l=[Zr];l[l.length]=Ze("sst",null,{xmlns:Dr[0],count:a.Count,uniqueCount:a.Unique});for(var c,u,h=0;h!=a.length;++h)a[h]!=null&&(u="<si>",(c=a[h]).r?u+=c.r:(u+="<t",c.t||(c.t=""),c.t.match(J6)&&(u+=' xml:space="preserve"'),u+=">"+Er(c.t)+"</t>"),u+="</si>",l[l.length]=u);return 2<l.length&&(l[l.length]="</sst>",l[1]=l[1].replace("/>",">")),l.join("")}var Z6=function(a,o){var l=!1;return o==null&&(l=!0,o=Ae(15+4*a.t.length)),o.write_shift(1,0),Pn(a.t,o),l?o.slice(0,o.l):o};function e5(a){var o,l,c=A();C(c,159,(o=a,(l=l||Ae(8)).write_shift(4,o.Count),l.write_shift(4,o.Unique),l));for(var u=0;u<a.length;++u)C(c,19,Z6(a[u]));return C(c,160),c.end()}function Iv(a){if(e!==void 0)return e.utils.encode(x,a);for(var o=[],l=a.split(""),c=0;c<l.length;++c)o[c]=l[c].charCodeAt(0);return o}function ai(a,o){var l={};return l.Major=a.read_shift(2),l.Minor=a.read_shift(2),4<=o&&(a.l+=o-4),l}function t5(a){var o=[];a.l+=4;for(var l=a.read_shift(4);0<l--;)o.push(function(c){for(var h=c.read_shift(4),u=c.l+h-4,h={},f=c.read_shift(4),d=[];0<f--;)d.push({t:c.read_shift(4),v:c.read_shift(0,"lpp4")});if(h.name=c.read_shift(0,"lpp4"),h.comps=d,c.l!=u)throw new Error("Bad DataSpaceMapEntry: "+c.l+" != "+u);return h}(a));return o}function r5(a){var o,l,l=(l={},(o=a).read_shift(4),o.l+=4,l.id=o.read_shift(0,"lpp4"),l.name=o.read_shift(0,"lpp4"),l.R=ai(o,4),l.U=ai(o,4),l.W=ai(o,4),l);if(l.ename=a.read_shift(0,"8lpp4"),l.blksz=a.read_shift(4),l.cmode=a.read_shift(4),a.read_shift(4)!=4)throw new Error("Bad !Primary record");return l}function Dv(a,l){var l=a.l+l,c={};c.Flags=63&a.read_shift(4),a.l+=4,c.AlgID=a.read_shift(4);var u=!1;switch(c.AlgID){case 26126:case 26127:case 26128:u=c.Flags==36;break;case 26625:u=c.Flags==4;break;case 0:u=c.Flags==16||c.Flags==4||c.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+c.AlgID}if(!u)throw new Error("Encryption Flags/AlgID mismatch");return c.AlgIDHash=a.read_shift(4),c.KeySize=a.read_shift(4),c.ProviderType=a.read_shift(4),a.l+=8,c.CSPName=a.read_shift(l-a.l>>1,"utf16le"),a.l=l,c}function Rv(a,c){var l={},c=a.l+c;return a.l+=4,l.Salt=a.slice(a.l,a.l+16),a.l+=16,l.Verifier=a.slice(a.l,a.l+16),a.l+=16,a.read_shift(4),l.VerifierHash=a.slice(a.l,c),a.l=c,l}function n5(a){var o=ai(a);switch(o.Minor){case 2:return[o.Minor,function(u){if((63&u.read_shift(4))!=36)throw new Error("EncryptionInfo mismatch");var c=u.read_shift(4),c=Dv(u,c),u=Rv(u,u.length-u.l);return{t:"Std",h:c,v:u}}(a)];case 3:return[o.Minor,function(){throw new Error("File is password-protected: ECMA-376 Extensible")}()];case 4:return[o.Minor,function(u){var c=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];u.l+=4;var u=u.read_shift(u.length-u.l,"utf8"),h={};return u.replace(vn,function(f){var d=Lt(f);switch(zs(d[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":c.forEach(function(y){h[y]=d[y]});break;case"<dataIntegrity":h.encryptedHmacKey=d.encryptedHmacKey,h.encryptedHmacValue=d.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":h.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":h.uri=d.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":h.encs.push(d);break;default:throw d[0]}}),h}(a)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+o.Minor)}function wp(a){var o,l=0,c=Iv(a),u=c.length+1,h=L(u);for(h[0]=c.length,o=1;o!=u;++o)h[o]=c[o-1];for(o=u-1;0<=o;--o)l=((16384&l?1:0)|l<<1&32767)^h[o];return 52811^l}var _p,Pv,Ov,jv=(_p=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],Pv=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],Ov=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],function(a){for(var o,l,c=Iv(a),u=function(y){for(var v=Pv[y.length-1],b=104,_=y.length-1;0<=_;--_)for(var T=y[_],S=0;S!=7;++S)64&T&&(v^=Ov[b]),T*=2,--b;return v}(c),h=c.length,f=L(16),d=0;d!=16;++d)f[d]=0;for((1&h)==1&&(o=u>>8,f[h]=Pl(_p[0],o),--h,o=255&u,a=c[c.length-1],f[h]=Pl(a,o));0<h;)o=u>>8,f[--h]=Pl(c[h],o),o=255&u,f[--h]=Pl(c[h],o);for(l=(h=15)-c.length;0<l;)o=u>>8,f[h]=Pl(_p[l],o),--l,o=255&u,f[--h]=Pl(c[h],o),--h,--l;return f});function Pl(a,o){return 255&((o=a^o)/2|128*o)}var s5=function(a){var o=0,l=jv(a);return function(c){return c=function(u,h,f,d,y){var v,b;for(y=y||h,d=d||jv(u),v=0;v!=h.length;++v)b=h[v],b=255&((b^=d[f])>>5|b<<3),y[v]=b,++f;return[y,f,d]}("",c,o,l),o=c[1],c[0]}};function a5(a,o,l){return l=l||{},l.Info=a.read_shift(2),a.l-=2,l.Info===1?l.Data=function(c){var u={},h=u.EncryptionVersionInfo=ai(c,4);if(h.Major!=1||h.Minor!=1)throw"unrecognized version code "+h.Major+" : "+h.Minor;return u.Salt=c.read_shift(16),u.EncryptedVerifier=c.read_shift(16),u.EncryptedVerifierHash=c.read_shift(16),u}(a):l.Data=function(c,u){var h={},f=h.EncryptionVersionInfo=ai(c,4);if(u-=4,f.Minor!=2)throw new Error("unrecognized minor version code: "+f.Minor);if(4<f.Major||f.Major<2)throw new Error("unrecognized major version code: "+f.Major);return h.Flags=c.read_shift(4),u-=4,f=c.read_shift(4),u-=4,h.EncryptionHeader=Dv(c,f),u-=f,h.EncryptionVerifier=Rv(c,u),h}(a,o),l}var Mv={to_workbook:function(a,o){return Li(Lv(a,o),o)},to_sheet:Lv,from_sheet:function(a){for(var o=["{\\rtf1\\ansi"],l=nr(a["!ref"]),c=Array.isArray(a),u=l.s.r;u<=l.e.r;++u){o.push("\\trowd\\trautofit1");for(var h=l.s.c;h<=l.e.c;++h)o.push("\\cellx"+(h+1));for(o.push("\\pard\\intbl"),h=l.s.c;h<=l.e.c;++h){var f=Pt({r:u,c:h});(f=c?(a[u]||[])[h]:a[f])&&(f.v!=null||f.f&&!f.F)&&(o.push(" "+(f.w||(Pa(f),f.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}};function Lv(a,o){switch(o.type){case"base64":return Ah(ee(a),o);case"binary":return Ah(a,o);case"buffer":return Ah(te&&Buffer.isBuffer(a)?a.toString("binary"):J(a),o);case"array":return Ah(da(a),o)}throw new Error("Unrecognized type "+o.type)}function Ah(c,o){var l=(o||{}).dense?[]:{},c=c.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(h,f){Array.isArray(l)&&(l[f]=[]);for(var d,y=/\\\w+\b/g,v=0,b=-1;d=y.exec(h);)d[0]==="\\cell"&&(++b,(d=(d=h.slice(v,y.lastIndex-d[0].length))[0]==" "?d.slice(1):d).length&&(d={v:d,t:"s"},Array.isArray(l)?l[f][b]=d:l[Pt({r:f,c:b})]=d)),v=y.lastIndex;b>u.e.c&&(u.e.c=b)}),l["!ref"]=Bt(u),l}function ru(a){for(var o=0,l=1;o!=3;++o)l=256*l+(255<a[o]?255:a[o]<0?0:a[o]);return l.toString(16).toUpperCase().slice(1)}function Ch(a,o){return o===0?a:(a=function(b){var c=b[0]/255,u=b[1]/255,h=b[2]/255,f=Math.max(c,u,h),d=Math.min(c,u,h),y=f-d;if(y==0)return[0,0,c];var v=0,b=0,b=y/(1<(d=f+d)?2-d:d);switch(f){case c:v=((u-h)/y+6)%6;break;case u:v=(h-c)/y+2;break;case h:v=(c-u)/y+4}return[v/6,b,d/2]}((a=(a=a).slice(a[0]==="#"?1:0).slice(0,6),[parseInt(a.slice(0,2),16),parseInt(a.slice(2,4),16),parseInt(a.slice(4,6),16)])),a[2]=o<0?a[2]*(1+o):1-(1-a[2])*(1-o),ru(function(f){var c,u=f[0],h=f[1],f=f[2],d=2*h*(f<.5?f:1-f),y=[f=f-d/2,f,f],v=6*u;if(h!==0)switch(0|v){case 0:case 6:c=d*v,y[0]+=d,y[1]+=c;break;case 1:c=d*(2-v),y[0]+=c,y[1]+=d;break;case 2:c=d*(v-2),y[1]+=d,y[2]+=c;break;case 3:c=d*(4-v),y[1]+=c,y[2]+=d;break;case 4:c=d*(v-4),y[2]+=d,y[0]+=c;break;case 5:c=d*(6-v),y[2]+=c,y[0]+=d}for(var b=0;b!=3;++b)y[b]=Math.round(255*y[b]);return y}(a)))}var Vv=6,i5=15,o5=1,Zn=Vv;function nu(a){return Math.floor((a+Math.round(128/Zn)/256)*Zn)}function su(a){return Math.floor((a-5)/Zn*100+.5)/100}function kh(a){return Math.round((a*Zn+5)/Zn*256)/256}function Tp(a){return kh(su(nu(a)))}function Ep(a){var o=Math.abs(a-Tp(a)),l=Zn;if(.005<o)for(Zn=o5;Zn<i5;++Zn)Math.abs(a-Tp(a))<=o&&(o=Math.abs(a-Tp(a)),l=Zn);Zn=l}function Ui(a){a.width?(a.wpx=nu(a.width),a.wch=su(a.wpx),a.MDW=Zn):a.wpx?(a.wch=su(a.wpx),a.width=kh(a.wch),a.MDW=Zn):typeof a.wch=="number"&&(a.width=kh(a.wch),a.wpx=nu(a.width),a.MDW=Zn),a.customWidth&&delete a.customWidth}var Uv=96;function au(a){return 96*a/Uv}function Ol(a){return a*Uv/96}var l5={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"},Fh=["numFmtId","fillId","fontId","borderId","xfId"],Nh=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"],Bv,$v,Wv,zv,Hv,iu,c5=(Bv=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,$v=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,Wv=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,zv=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,Hv=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/,function(a,o,l){var c,u,h,f,d,y={};return a&&((c=(a=a.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(Bv))&&function(v,b,_){b.NumberFmt=[];for(var T=Gr(de),S=0;S<T.length;++S)b.NumberFmt[T[S]]=de[T[S]];var I=v[0].match(vn);if(I)for(S=0;S<I.length;++S){var k=Lt(I[S]);switch(zs(k[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":var M=qt(kr(k.formatCode)),D=parseInt(k.numFmtId,10);if(b.NumberFmt[D]=M,0<D){if(392<D){for(D=392;60<D&&b.NumberFmt[D]!=null;--D);b.NumberFmt[D]=M}Vr(M,D)}break;case"</numFmt>":break;default:if(_.WTF)throw new Error("unrecognized "+k[0]+" in numFmts")}}}(c,y,l),(c=a.match(zv))&&function(v,b,_,T){b.Fonts=[];var S={},I=!1;(v[0].match(vn)||[]).forEach(function(k){var M,D=Lt(k);switch(zs(D[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":b.Fonts.push(S),S={};break;case"<name":D.val&&(S.name=kr(D.val));break;case"<name/>":case"</name>":break;case"<b":S.bold=D.val?$r(D.val):1;break;case"<b/>":S.bold=1;break;case"<i":S.italic=D.val?$r(D.val):1;break;case"<i/>":S.italic=1;break;case"<u":switch(D.val){case"none":S.underline=0;break;case"single":S.underline=1;break;case"double":S.underline=2;break;case"singleAccounting":S.underline=33;break;case"doubleAccounting":S.underline=34}break;case"<u/>":S.underline=1;break;case"<strike":S.strike=D.val?$r(D.val):1;break;case"<strike/>":S.strike=1;break;case"<outline":S.outline=D.val?$r(D.val):1;break;case"<outline/>":S.outline=1;break;case"<shadow":S.shadow=D.val?$r(D.val):1;break;case"<shadow/>":S.shadow=1;break;case"<condense":S.condense=D.val?$r(D.val):1;break;case"<condense/>":S.condense=1;break;case"<extend":S.extend=D.val?$r(D.val):1;break;case"<extend/>":S.extend=1;break;case"<sz":D.val&&(S.sz=+D.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":D.val&&(S.vertAlign=D.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":D.val&&(S.family=parseInt(D.val,10));break;case"<family/>":case"</family>":break;case"<scheme":D.val&&(S.scheme=D.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(D.val=="1")break;D.codepage=E[parseInt(D.val,10)];break;case"<color":S.color||(S.color={}),D.auto&&(S.color.auto=$r(D.auto)),D.rgb?S.color.rgb=D.rgb.slice(-6):D.indexed?(S.color.index=parseInt(D.indexed,10),M=Qc[S.color.index],M=(M=S.color.index==81?Qc[1]:M)||Qc[1],S.color.rgb=M[0].toString(16)+M[1].toString(16)+M[2].toString(16)):D.theme&&(S.color.theme=parseInt(D.theme,10),D.tint&&(S.color.tint=parseFloat(D.tint)),D.theme&&_.themeElements&&_.themeElements.clrScheme&&(S.color.rgb=Ch(_.themeElements.clrScheme[S.color.theme].rgb,S.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":I=!0;break;case"</AlternateContent>":I=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":I=!0;break;case"</ext>":I=!1;break;default:if(T&&T.WTF&&!I)throw new Error("unrecognized "+D[0]+" in fonts")}})}(c,y,o,l),(c=a.match(Wv))&&function(v,b,_){b.Fills=[];var T={},S=!1;(v[0].match(vn)||[]).forEach(function(I){var k=Lt(I);switch(zs(k[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":T={},b.Fills.push(T);break;case"</fill>":case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":b.Fills.push(T),T={};break;case"<patternFill":case"<patternFill>":k.patternType&&(T.patternType=k.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":T.bgColor||(T.bgColor={}),k.indexed&&(T.bgColor.indexed=parseInt(k.indexed,10)),k.theme&&(T.bgColor.theme=parseInt(k.theme,10)),k.tint&&(T.bgColor.tint=parseFloat(k.tint)),k.rgb&&(T.bgColor.rgb=k.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":T.fgColor||(T.fgColor={}),k.theme&&(T.fgColor.theme=parseInt(k.theme,10)),k.tint&&(T.fgColor.tint=parseFloat(k.tint)),k.rgb!=null&&(T.fgColor.rgb=k.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":case"</stop>":break;case"<color":case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":S=!0;break;case"</ext>":S=!1;break;default:if(_&&_.WTF&&!S)throw new Error("unrecognized "+k[0]+" in fills")}})}(c,y,l),(c=a.match(Hv))&&function(v,b,_){b.Borders=[];var T={},S=!1;(v[0].match(vn)||[]).forEach(function(I){var k=Lt(I);switch(zs(k[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":T={},k.diagonalUp&&(T.diagonalUp=$r(k.diagonalUp)),k.diagonalDown&&(T.diagonalDown=$r(k.diagonalDown)),b.Borders.push(T);break;case"</border>":case"<left/>":break;case"<left":case"<left>":case"</left>":case"<right/>":break;case"<right":case"<right>":case"</right>":case"<top/>":break;case"<top":case"<top>":case"</top>":case"<bottom/>":break;case"<bottom":case"<bottom>":case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":break;case"<start":case"<start>":case"<start/>":case"</start>":break;case"<end":case"<end>":case"<end/>":case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":S=!0;break;case"</ext>":S=!1;break;default:if(_&&_.WTF&&!S)throw new Error("unrecognized "+k[0]+" in borders")}})}(c,y,l),(c=a.match($v))&&(c=c,h=l,d=!((u=y).CellXf=[]),(c[0].match(vn)||[]).forEach(function(v){var b=Lt(v),_=0;switch(zs(b[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(delete(f=b)[0],_=0;_<Fh.length;++_)f[Fh[_]]&&(f[Fh[_]]=parseInt(f[Fh[_]],10));for(_=0;_<Nh.length;++_)f[Nh[_]]&&(f[Nh[_]]=$r(f[Nh[_]]));if(u.NumberFmt&&392<f.numFmtId){for(_=392;60<_;--_)if(u.NumberFmt[f.numFmtId]==u.NumberFmt[_]){f.numFmtId=_;break}}u.CellXf.push(f);break;case"</xf>":break;case"<alignment":case"<alignment/>":var T={};b.vertical&&(T.vertical=b.vertical),b.horizontal&&(T.horizontal=b.horizontal),b.textRotation!=null&&(T.textRotation=b.textRotation),b.indent&&(T.indent=b.indent),b.wrapText&&(T.wrapText=$r(b.wrapText)),f.alignment=T;break;case"</alignment>":case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":d=!0;break;case"</AlternateContent>":d=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":d=!0;break;case"</ext>":d=!1;break;default:if(h&&h.WTF&&!d)throw new Error("unrecognized "+b[0]+" in cellXfs")}}))),y});function Gv(a,o){if(iu!==void 0)return iu.toXml();var l,c,u,h,f=[Zr,Ze("styleSheet",null,{xmlns:Dr[0],"xmlns:vt":rn.vt})];return a.SSF&&(c=a.SSF,u=["<numFmts>"],[[5,8],[23,26],[41,44],[50,392]].forEach(function(d){for(var y=d[0];y<=d[1];++y)c[y]!=null&&(u[u.length]=Ze("numFmt",null,{numFmtId:y,formatCode:Er(c[y])}))}),(l=u.length===1?"":(u[u.length]="</numFmts>",u[0]=Ze("numFmts",null,{count:u.length-2}).replace("/>",">"),u.join("")))!=null)&&(f[f.length]=l),f[f.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',f[f.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',f[f.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',f[f.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',o=o.cellXfs,(h=[])[h.length]="<cellXfs/>",o.forEach(function(d){h[h.length]=Ze("xf",null,d)}),h[h.length]="</cellXfs>",(l=h.length===2?"":(h[0]=Ze("cellXfs",null,{count:h.length-2}).replace("/>",">"),h.join("")))&&(f[f.length]=l),f[f.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',f[f.length]='<dxfs count="0"/>',f[f.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',2<f.length&&(f[f.length]="</styleSheet>",f[1]=f[1].replace("/>",">")),f.join("")}function u5(a,o){var l;(o=o||Ae(153)).write_shift(2,20*a.sz),l=a,c=(c=o)||Ae(2),l=(l.italic?2:0)|(l.strike?8:0)|(l.outline?16:0)|(l.shadow?32:0)|(l.condense?64:0)|(l.extend?128:0),c.write_shift(1,l),c.write_shift(1,0),o.write_shift(2,a.bold?700:400);var c=0;return a.vertAlign=="superscript"?c=1:a.vertAlign=="subscript"&&(c=2),o.write_shift(2,c),o.write_shift(1,a.underline||0),o.write_shift(1,a.family||0),o.write_shift(1,a.charset||0),o.write_shift(1,0),hh(a.color,o),c=0,a.scheme=="major"&&(c=1),a.scheme=="minor"&&(c=2),o.write_shift(1,c),Pn(a.name,o),o.length>o.l?o.slice(0,o.l):o}var qv,f5=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],h5=Fn;function Kv(a,o){o=o||Ae(84),a=(qv=qv||wo(f5))[a.patternType],a==null&&(a=40),o.write_shift(4,a);var l=0;if(a!=40)for(hh({auto:1},o),hh({auto:1},o);l<12;++l)o.write_shift(4,0);else{for(;l<4;++l)o.write_shift(4,0);for(;l<12;++l)o.write_shift(4,0)}return o.length>o.l?o.slice(0,o.l):o}function Yv(a,o,l){return(l=l||Ae(16)).write_shift(2,o||0),l.write_shift(2,a.numFmtId||0),l.write_shift(2,0),l.write_shift(2,0),l.write_shift(2,0),l.write_shift(1,0),l.write_shift(1,0),l.write_shift(1,0),l.write_shift(1,0),l.write_shift(1,0),l.write_shift(1,0),l}function ou(a,o){return(o=o||Ae(10)).write_shift(1,0),o.write_shift(1,0),o.write_shift(4,0),o.write_shift(4,0),o}Ca=Fn;function d5(a,o){var l;o&&(l=0,[[5,8],[23,26],[41,44],[50,392]].forEach(function(c){for(var u=c[0];u<=c[1];++u)o[u]!=null&&++l}),l!=0&&(C(a,615,ma(l)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(c){for(var u,h,f,d=c[0];d<=c[1];++d)o[d]!=null&&C(a,44,(u=d,h=o[d],(f=(f=void 0)||Ae(6+4*h.length)).write_shift(2,u),Pn(h,f),h=f.length>f.l?f.slice(0,f.l):f,f.l==null&&(f.l=f.length),h))}),C(a,616)))}function p5(a){var o;C(a,613,ma(1)),C(a,46,((o=o||Ae(51)).write_shift(1,0),ou(0,o),ou(0,o),ou(0,o),ou(0,o),ou(0,o),o.length>o.l?o.slice(0,o.l):o)),C(a,614)}function m5(a){var o,l;C(a,619,ma(1)),C(a,48,(o={xfId:0,builtinId:0,name:"Normal"},(l=l||Ae(52)).write_shift(4,o.xfId),l.write_shift(2,1),l.write_shift(1,+o.builtinId),l.write_shift(1,0),fh(o.name||"",l),l.length>l.l?l.slice(0,l.l):l)),C(a,620)}function g5(a){var o,l,c,u;C(a,508,(o=0,l="TableStyleMedium9",c="PivotStyleMedium4",(u=Ae(2052)).write_shift(4,o),fh(l,u),fh(c,u),u.length>u.l?u.slice(0,u.l):u)),C(a,509)}function y5(a,o){var l,c=A();return C(c,278),d5(c,a.SSF),C(a=c,611,ma(1)),C(a,43,u5({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),C(a,612),C(a=c,603,ma(2)),C(a,45,Kv({patternType:"none"})),C(a,45,Kv({patternType:"gray125"})),C(a,604),p5(c),C(a=c,626,ma(1)),C(a,47,Yv({numFmtId:0},65535)),C(a,627),l=c,o=o.cellXfs,C(l,617,ma(o.length)),o.forEach(function(u){C(l,47,Yv(u,0))}),C(l,618),m5(c),C(o=c,505,ma(0)),C(o,506),g5(c),C(c,279),c.end()}var v5=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function x5(a,o,l){o.themeElements.clrScheme=[];var c={};(a[0].match(vn)||[]).forEach(function(u){var h=Lt(u);switch(h[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":c.rgb=h.val;break;case"<a:sysClr":c.rgb=h.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":h[0].charAt(1)==="/"?(o.themeElements.clrScheme[v5.indexOf(h[0])]=c,c={}):c.name=h[0].slice(3,h[0].length-1);break;default:if(l&&l.WTF)throw new Error("Unrecognized "+h[0]+" in clrScheme")}})}function b5(){}function w5(){}var _5=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,T5=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,E5=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/,S5=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Qv(a,o){var l,c,u,h,f,d={};if(!(l=(a=!a||a.length===0?Sp():a).match(S5)))throw new Error("themeElements not found in theme");return c=l[0],h=o,(u=d).themeElements={},[["clrScheme",_5,x5],["fontScheme",T5,b5],["fmtScheme",E5,w5]].forEach(function(y){if(!(f=c.match(y[1])))throw new Error(y[0]+" not found in themeElements");y[2](f,u,h)}),d.raw=a,d}function Sp(a,o){return o&&o.themeXLSX?o.themeXLSX:a&&typeof a.raw=="string"?a.raw:(a=[Zr],a[a.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',a[a.length]="<a:themeElements>",a[a.length]='<a:clrScheme name="Office">',a[a.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',a[a.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',a[a.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',a[a.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',a[a.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',a[a.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',a[a.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',a[a.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',a[a.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',a[a.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',a[a.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',a[a.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',a[a.length]="</a:clrScheme>",a[a.length]='<a:fontScheme name="Office">',a[a.length]="<a:majorFont>",a[a.length]='<a:latin typeface="Cambria"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface=" "/>',a[a.length]='<a:font script="Hang" typeface=" "/>',a[a.length]='<a:font script="Hans" typeface=""/>',a[a.length]='<a:font script="Hant" typeface=""/>',a[a.length]='<a:font script="Arab" typeface="Times New Roman"/>',a[a.length]='<a:font script="Hebr" typeface="Times New Roman"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="MoolBoran"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Times New Roman"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:majorFont>",a[a.length]="<a:minorFont>",a[a.length]='<a:latin typeface="Calibri"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface=" "/>',a[a.length]='<a:font script="Hang" typeface=" "/>',a[a.length]='<a:font script="Hans" typeface=""/>',a[a.length]='<a:font script="Hant" typeface=""/>',a[a.length]='<a:font script="Arab" typeface="Arial"/>',a[a.length]='<a:font script="Hebr" typeface="Arial"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="DaunPenh"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Arial"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:minorFont>",a[a.length]="</a:fontScheme>",a[a.length]='<a:fmtScheme name="Office">',a[a.length]="<a:fillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="1"/>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="0"/>',a[a.length]="</a:gradFill>",a[a.length]="</a:fillStyleLst>",a[a.length]="<a:lnStyleLst>",a[a.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]="</a:lnStyleLst>",a[a.length]="<a:effectStyleLst>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',a[a.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',a[a.length]="</a:effectStyle>",a[a.length]="</a:effectStyleLst>",a[a.length]="<a:bgFillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]="</a:bgFillStyleLst>",a[a.length]="</a:fmtScheme>",a[a.length]="</a:themeElements>",a[a.length]="<a:objectDefaults>",a[a.length]="<a:spDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',a[a.length]="</a:spDef>",a[a.length]="<a:lnDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',a[a.length]="</a:lnDef>",a[a.length]="</a:objectDefaults>",a[a.length]="<a:extraClrSchemeLst/>",a[a.length]="</a:theme>",a.join(""))}function A5(a){var o={};switch(o.xclrType=a.read_shift(2),o.nTintShade=a.read_shift(2),o.xclrType){case 0:a.l+=4;break;case 1:o.xclrValue=Fn(a,4);break;case 2:o.xclrValue=Vy(a);break;case 3:o.xclrValue=a.read_shift(4);break;case 4:a.l+=4}return a.l+=8,o}function C5(a){var o=a.read_shift(2),l=a.read_shift(2)-4,c=[o];switch(o){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:c[1]=A5(a);break;case 6:c[1]=Fn(a,l);break;case 14:case 15:c[1]=a.read_shift(l==1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+o+" "+l)}return c}function k5(){var a,o,l,c=A();return C(c,332),C(c,334,ma(1)),C(c,335,((l=Ae(12+2*(o={name:"XLDAPR",version:12e4,flags:3496657072}).name.length)).write_shift(4,o.flags),l.write_shift(4,o.version),Pn(o.name,l),l.slice(0,l.l))),C(c,336),C(c,339,(a=1,(l=Ae(8+2*(o="XLDAPR").length)).write_shift(4,a),Pn(o,l),l.slice(0,l.l))),C(c,52),C(c,35,ma(514)),C(c,4096,ma(0)),C(c,4097,Qs(1)),C(c,36),C(c,53),C(c,340),C(c,337,(a=1,o=!0,(l=Ae(8)).write_shift(4,a),l.write_shift(4,o?1:0),l)),C(c,51,function(u){var h=Ae(4+8*u.length);h.write_shift(4,u.length);for(var f=0;f<u.length;++f)h.write_shift(4,u[f][0]),h.write_shift(4,u[f][1]);return h}([[1,0]])),C(c,338),C(c,333),c.end()}function Xv(){var a=[Zr];return a.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),a.join("")}var jl=1024;function Jv(a,o){for(var l=[21600,21600],c=["m0,0l0",l[1],l[0],l[1],l[0],"0xe"].join(","),u=[Ze("xml",null,{"xmlns:v":fs.v,"xmlns:o":fs.o,"xmlns:x":fs.x,"xmlns:mv":fs.mv}).replace(/\/>/,">"),Ze("o:shapelayout",Ze("o:idmap",null,{"v:ext":"edit",data:a}),{"v:ext":"edit"}),Ze("v:shapetype",[Ze("v:stroke",null,{joinstyle:"miter"}),Ze("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:l.join(","),path:c})];jl<1e3*a;)jl+=1e3;return o.forEach(function(h){var f=rr(h[0]),y={color2:"#BEFF82",type:"gradient"};y.type=="gradient"&&(y.angle="-180");var d=y.type=="gradient"?Ze("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,y=Ze("v:fill",d,y);++jl,u=u.concat(["<v:shape"+Ia({id:"_x0000_s"+jl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(h[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",y,Ze("v:shadow",null,{on:"t",obscured:"t"}),Ze("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",cn("x:Anchor",[f.c+1,0,f.r+1,0,f.c+3,20,f.r+5,20].join(",")),cn("x:AutoFill","False"),cn("x:Row",String(f.r)),cn("x:Column",String(f.c)),h[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),u.push("</xml>"),u.join("")}function Zv(a,o,l,c){var u,h=Array.isArray(a);o.forEach(function(f){var d,y=rr(f.ref);(u=h?(a[y.r]||(a[y.r]=[]),a[y.r][y.c]):a[f.ref])||(u={t:"z"},h?a[y.r][y.c]=u:a[f.ref]=u,(d=nr(a["!ref"]||"BDWGO1000001:A1")).s.r>y.r&&(d.s.r=y.r),d.e.r<y.r&&(d.e.r=y.r),d.s.c>y.c&&(d.s.c=y.c),d.e.c<y.c&&(d.e.c=y.c),(d=Bt(d))!==a["!ref"]&&(a["!ref"]=d)),u.c||(u.c=[]);var v={a:f.author,t:f.t,r:f.r,T:l};f.h&&(v.h=f.h);for(var b=u.c.length-1;0<=b;--b){if(!l&&u.c[b].T)return;l&&!u.c[b].T&&u.c.splice(b,1)}if(l&&c){for(b=0;b<c.length;++b)if(v.a==c[b].id){v.a=c[b].name||v.a;break}}u.c.push(v)})}function ex(a){var o=[Zr,Ze("comments",null,{xmlns:Dr[0]})],l=[];return o.push("<authors>"),a.forEach(function(c){c[1].forEach(function(u){var h=Er(u.a);l.indexOf(h)==-1&&(l.push(h),o.push("<author>"+h+"</author>")),u.T&&u.ID&&l.indexOf("tc="+u.ID)==-1&&(l.push("tc="+u.ID),o.push("<author>tc="+u.ID+"</author>"))})}),l.length==0&&(l.push("SheetJ5"),o.push("<author>SheetJ5</author>")),o.push("</authors>"),o.push("<commentList>"),a.forEach(function(c){var u=0,h=[];if(c[1][0]&&c[1][0].T&&c[1][0].ID?u=l.indexOf("tc="+c[1][0].ID):c[1].forEach(function(y){y.a&&(u=l.indexOf(Er(y.a))),h.push(y.t||"")}),o.push('<comment ref="'+c[0]+'" authorId="'+u+'"><text>'),h.length<=1)o.push(cn("t",Er(h[0]||"")));else{for(var f=`Comment:
    `+h[0]+`
`,d=1;d<h.length;++d)f+=`Reply:
    `+h[d]+`
`;o.push(cn("t",Er(f)))}o.push("</text></comment>")}),o.push("</commentList>"),2<o.length&&(o[o.length]="</comments>",o[1]=o[1].replace("/>",">")),o.join("")}xl=Qn;function F5(a){var o=A(),l=[];return C(o,628),C(o,630),a.forEach(function(c){c[1].forEach(function(u){-1<l.indexOf(u.a)||(l.push(u.a.slice(0,54)),C(o,632,Pn(u.a.slice(0,54))))})}),C(o,631),C(o,633),a.forEach(function(c){c[1].forEach(function(u){u.iauthor=l.indexOf(u.a);var h,f={s:rr(c[0]),e:rr(c[0])};C(o,635,(f=[f,u],(h=h??Ae(36)).write_shift(4,f[1].iauthor),Fl(f[0],h),h.write_shift(4,0),h.write_shift(4,0),h.write_shift(4,0),h.write_shift(4,0),h)),u.t&&0<u.t.length&&C(o,637,w6(u)),C(o,636),delete u.iauthor})}),C(o,634),C(o,629),o.end()}var N5="application/vnd.ms-office.vbaProject",tx=["xlsb","xlsm","xlam","biff8","xla"],Ap,rx,Ml=(rx=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,function(a,o){return Ap=o,a.replace(rx,I5)});function I5(a,o,l,c){var u=!1,h=!1;return l.length==0?h=!0:l.charAt(0)=="["&&(h=!0,l=l.slice(1,-1)),c.length==0?u=!0:c.charAt(0)=="["&&(u=!0,c=c.slice(1,-1)),l=0<l.length?0|parseInt(l,10):0,c=0<c.length?0|parseInt(c,10):0,u?c+=Ap.c:--c,h?l+=Ap.r:--l,o+(u?"":"$")+Yt(c)+(h?"":"$")+tr(l)}var Cp=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,kp=function(a,o){return a.replace(Cp,function(l,c,u,h,f,d){return h=hr(h)-(u?0:o.c),d=Fr(d)-(f?0:o.r),c+"R"+(d==0?"":f?1+d:"["+d+"]")+"C"+(h==0?"":u?1+h:"["+h+"]")})};function nx(a,o){return a.replace(Cp,function(l,c,u,h,f,d){return c+(u=="$"?u+h:Yt(hr(h)+o.c))+(f=="$"?f+d:tr(Fr(d)+o.r))})}function sx(a){return a.replace(/_xlfn\./g,"")}function wn(a){a.l+=1}function Bi(a,o){return o=a.read_shift(o==1?1:2),[16383&o,o>>14&1,o>>15&1]}function ax(f,o,u){var h=2;if(u){if(2<=u.biff&&u.biff<=5)return ix(f);u.biff==12&&(h=4)}var c=f.read_shift(h),u=f.read_shift(h),h=Bi(f,2),f=Bi(f,2);return{s:{r:c,c:h[0],cRel:h[1],rRel:h[2]},e:{r:u,c:f[0],cRel:f[1],rRel:f[2]}}}function ix(u){var o=Bi(u,2),l=Bi(u,2),c=u.read_shift(1),u=u.read_shift(1);return{s:{r:o[0],c,cRel:o[1],rRel:o[2]},e:{r:l[0],c:u,cRel:l[1],rRel:l[2]}}}function ox(f,o,h){if(h&&2<=h.biff&&h.biff<=5)return u=Bi(c=f,2),c=c.read_shift(1),{r:u[0],c,cRel:u[1],rRel:u[2]};var c,u,h=f.read_shift(h&&h.biff==12?4:2),f=Bi(f,2);return{r:h,c:f[0],cRel:f[1],rRel:f[2]}}function D5(f,o,h){if(h=h&&h.biff?h.biff:8,2<=h&&h<=5)return function(_){var y=_.read_shift(2),v=_.read_shift(1),b=(32768&y)>>15,_=(16384&y)>>14;return y&=16383,b==1&&8192<=y&&(y-=16384),_==1&&128<=v&&(v-=256),{r:y,c:v,cRel:_,rRel:b}}(f);var c=f.read_shift(12<=h?4:2),u=f.read_shift(2),h=(16384&u)>>14,f=(32768&u)>>15;if(u&=16383,f==1)for(;524287<c;)c-=1048576;if(h==1)for(;8191<u;)u-=16384;return{r:c,c:u,cRel:h,rRel:f}}function lx(a){var o=1&a[a.l+1];return a.l+=4,[o,1]}function cx(a){return[a.read_shift(1),a.read_shift(1)]}function R5(a,o,l){var c=0,u=0;l.biff==12?(c=a.read_shift(4),u=a.read_shift(4)):(u=1+a.read_shift(1),c=1+a.read_shift(2)),2<=l.biff&&l.biff<8&&(--c,--u==0&&(u=256));for(var h=0,f=[];h!=c&&(f[h]=[]);++h)for(var d=0;d!=u;++d)f[h][d]=function(y,v){var b=[y.read_shift(1)];if(v==12)switch(b[0]){case 2:b[0]=4;break;case 4:b[0]=16;break;case 0:b[0]=1;break;case 1:b[0]=2}switch(b[0]){case 4:b[1]=pn(y,1)?"TRUE":"FALSE",v!=12&&(y.l+=7);break;case 37:case 16:b[1]=si[y[y.l]],y.l+=v==12?4:8;break;case 0:y.l+=8;break;case 1:b[1]=Xn(y);break;case 2:b[1]=Oo(y,0,{biff:0<v&&v<8?2:v});break;default:throw new Error("Bad SerAr: "+b[0])}return b}(a,l.biff);return f}function lu(a,o,l){return a.l+=2,[(a=(c=a).read_shift(2),c=c.read_shift(2),{r:a,c:255&c,fQuoted:!!(16384&c),cRel:c>>15,rRel:c>>15})];var c}function Fp(a){return a.l+=6,[]}function ux(a){return a.l+=2,[bn(a),1&a.read_shift(2)]}var P5=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"],fx={1:{n:"PtgExp",f:function(a,o,l){return a.l++,l&&l.biff==12?[a.read_shift(4,"i"),0]:[a.read_shift(2),a.read_shift(l&&l.biff==2?1:2)]}},2:{n:"PtgTbl",f:Fn},3:{n:"PtgAdd",f:wn},4:{n:"PtgSub",f:wn},5:{n:"PtgMul",f:wn},6:{n:"PtgDiv",f:wn},7:{n:"PtgPower",f:wn},8:{n:"PtgConcat",f:wn},9:{n:"PtgLt",f:wn},10:{n:"PtgLe",f:wn},11:{n:"PtgEq",f:wn},12:{n:"PtgGe",f:wn},13:{n:"PtgGt",f:wn},14:{n:"PtgNe",f:wn},15:{n:"PtgIsect",f:wn},16:{n:"PtgUnion",f:wn},17:{n:"PtgRange",f:wn},18:{n:"PtgUplus",f:wn},19:{n:"PtgUminus",f:wn},20:{n:"PtgPercent",f:wn},21:{n:"PtgParen",f:wn},22:{n:"PtgMissArg",f:wn},23:{n:"PtgStr",f:function(a,o,l){return a.l++,Zc(a,0,l)}},26:{n:"PtgSheet",f:function(a,o,l){return a.l+=5,a.l+=2,a.l+=l.biff==2?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(a,o,l){return a.l+=l.biff==2?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(a){return a.l++,si[a.read_shift(1)]}},29:{n:"PtgBool",f:function(a){return a.l++,a.read_shift(1)!==0}},30:{n:"PtgInt",f:function(a){return a.l++,a.read_shift(2)}},31:{n:"PtgNum",f:function(a){return a.l++,Xn(a)}},32:{n:"PtgArray",f:function(a,o,l){var c=(96&a[a.l++])>>5;return a.l+=l.biff==2?6:l.biff==12?14:7,[c]}},33:{n:"PtgFunc",f:function(a,o,l){var c=(96&a[a.l])>>5;return a.l+=1,l=a.read_shift(l&&l.biff<=3?1:2),[z5[l],px[l],c]}},34:{n:"PtgFuncVar",f:function(a,o,l){var c=a[a.l++],u=a.read_shift(1),h=l&&l.biff<=3?[c==88?-1:0,a.read_shift(1)]:[(h=a)[h.l+1]>>7,32767&h.read_shift(2)];return[u,(h[0]===0?px:W5)[h[1]]]}},35:{n:"PtgName",f:function(a,o,l){var c=a.read_shift(1)>>>5&3,u=!l||8<=l.biff?4:2,u=a.read_shift(u);switch(l.biff){case 2:a.l+=5;break;case 3:case 4:a.l+=8;break;case 5:a.l+=12}return[c,0,u]}},36:{n:"PtgRef",f:function(a,o,l){var c=(96&a[a.l])>>5;return a.l+=1,[c,ox(a,0,l)]}},37:{n:"PtgArea",f:function(a,o,l){return[(96&a[a.l++])>>5,ax(a,2<=l.biff&&l.biff,l)]}},38:{n:"PtgMemArea",f:function(a,o,l){var c=a.read_shift(1)>>>5&3;return a.l+=l&&l.biff==2?3:4,[c,a.read_shift(l&&l.biff==2?1:2)]}},39:{n:"PtgMemErr",f:Fn},40:{n:"PtgMemNoMem",f:Fn},41:{n:"PtgMemFunc",f:function(a,o,l){return[a.read_shift(1)>>>5&3,a.read_shift(l&&l.biff==2?1:2)]}},42:{n:"PtgRefErr",f:function(a,o,l){var c=a.read_shift(1)>>>5&3;return a.l+=4,l.biff<8&&a.l--,l.biff==12&&(a.l+=2),[c]}},43:{n:"PtgAreaErr",f:function(a,o,l){var c=(96&a[a.l++])>>5;return a.l+=l&&8<l.biff?12:l.biff<8?6:8,[c]}},44:{n:"PtgRefN",f:function(a,o,l){var c=(96&a[a.l])>>5;return a.l+=1,[c,D5(a,0,l)]}},45:{n:"PtgAreaN",f:function(a,o,l){return[(96&a[a.l++])>>5,function(y,d){if(d.biff<8)return ix(y);var h=y.read_shift(d.biff==12?4:2),f=y.read_shift(d.biff==12?4:2),d=Bi(y,2),y=Bi(y,2);return{s:{r:h,c:d[0],cRel:d[1],rRel:d[2]},e:{r:f,c:y[0],cRel:y[1],rRel:y[2]}}}(a,l)]}},46:{n:"PtgMemAreaN",f:function(a){return[a.read_shift(1)>>>5&3,a.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(a){return[a.read_shift(1)>>>5&3,a.read_shift(2)]}},57:{n:"PtgNameX",f:function(a,o,l){return l.biff==5?function(c){var u=c.read_shift(1)>>>5&3,h=c.read_shift(2,"i");c.l+=8;var f=c.read_shift(2);return c.l+=12,[u,h,f]}(a):[a.read_shift(1)>>>5&3,a.read_shift(2),a.read_shift(4)]}},58:{n:"PtgRef3d",f:function(a,o,l){var c=(96&a[a.l])>>5;a.l+=1;var u=a.read_shift(2);return l&&l.biff==5&&(a.l+=12),[c,u,ox(a,0,l)]}},59:{n:"PtgArea3d",f:function(a,o,l){var c=(96&a[a.l++])>>5,u=a.read_shift(2,"i");if(l)switch(l.biff){case 5:a.l+=12;break}return[c,u,ax(a,0,l)]}},60:{n:"PtgRefErr3d",f:function(a,o,l){var c=(96&a[a.l++])>>5,u=a.read_shift(2),h=4;if(l)switch(l.biff){case 5:h=15;break;case 12:h=6}return a.l+=h,[c,u]}},61:{n:"PtgAreaErr3d",f:function(a,o,l){var c=(96&a[a.l++])>>5,u=a.read_shift(2),h=8;if(l)switch(l.biff){case 5:a.l+=12,h=6;break;case 12:h=12}return a.l+=h,[c,u]}},255:{}},O5={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},j5={1:{n:"PtgElfLel",f:ux},2:{n:"PtgElfRw",f:lu},3:{n:"PtgElfCol",f:lu},6:{n:"PtgElfRwV",f:lu},7:{n:"PtgElfColV",f:lu},10:{n:"PtgElfRadical",f:lu},11:{n:"PtgElfRadicalS",f:Fp},13:{n:"PtgElfColS",f:Fp},15:{n:"PtgElfColSV",f:Fp},16:{n:"PtgElfRadicalLel",f:ux},25:{n:"PtgList",f:function(h){h.l+=2;var o=h.read_shift(2),l=h.read_shift(2),c=h.read_shift(4),u=h.read_shift(2),h=h.read_shift(2);return{ixti:o,coltype:3&l,rt:P5[l>>2&31],idx:c,c:u,C:h}}},29:{n:"PtgSxName",f:function(a){return a.l+=2,[a.read_shift(4)]}},255:{}},M5={0:{n:"PtgAttrNoop",f:function(a){return a.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(a,o,l){var c=255&a[a.l+1]?1:0;return a.l+=l&&l.biff==2?3:4,[c]}},2:{n:"PtgAttrIf",f:function(a,o,l){var c=255&a[a.l+1]?1:0;return a.l+=2,[c,a.read_shift(l&&l.biff==2?1:2)]}},4:{n:"PtgAttrChoose",f:function(a,o,l){a.l+=2;for(var c=a.read_shift(l&&l.biff==2?1:2),u=[],h=0;h<=c;++h)u.push(a.read_shift(l&&l.biff==2?1:2));return u}},8:{n:"PtgAttrGoto",f:function(a,o,l){var c=255&a[a.l+1]?1:0;return a.l+=2,[c,a.read_shift(l&&l.biff==2?1:2)]}},16:{n:"PtgAttrSum",f:function(a,o,l){a.l+=l&&l.biff==2?3:4}},32:{n:"PtgAttrBaxcel",f:lx},33:{n:"PtgAttrBaxcel",f:lx},64:{n:"PtgAttrSpace",f:function(a){return a.read_shift(2),cx(a)}},65:{n:"PtgAttrSpaceSemi",f:function(a){return a.read_shift(2),cx(a)}},128:{n:"PtgAttrIfError",f:function(a){var o=255&a[a.l+1]?1:0;return a.l+=2,[o,a.read_shift(2)]}},255:{}};function cu(a,o,l,c){if(c.biff<8)return Fn(a,o);for(var u=a.l+o,h=[],f=0;f!==l.length;++f)switch(l[f][0]){case"PtgArray":l[f][1]=R5(a,0,c),h.push(l[f][1]);break;case"PtgMemArea":l[f][2]=function(d,y){for(var v=d.read_shift(y.biff==12?4:2),b=[],_=0;_!=v;++_)b.push((y.biff==12?Do:gh)(d));return b}(a,(l[f][1],c)),h.push(l[f][2]);break;case"PtgExp":c&&c.biff==12&&(l[f][1][1]=a.read_shift(4),h.push(l[f][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+l[f][0]}return(o=u-a.l)!==0&&h.push(Fn(a,o)),h}function uu(a,o,l){for(var c,u,h=a.l+o,f=[];h!=a.l;)o=h-a.l,u=a[a.l],c=fx[u]||fx[O5[u]],(c=u===24||u===25?(u===24?j5:M5)[a[a.l+1]]:c)&&c.f?f.push([c.n,c.f(a,o,l)]):Fn(a,o);return f}var L5={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function hx(a,o,l){if(!a)return"SH33TJSERR0";if(8<l.biff&&(!a.XTI||!a.XTI[o]))return a.SheetNames[o];if(!a.XTI)return"SH33TJSERR6";var c=a.XTI[o];if(l.biff<8)return 1e4<o&&(o-=65536),(o=o<0?-o:o)==0?"":a.XTI[o-1];if(!c)return"SH33TJSERR1";var u="";if(8<l.biff)switch(a[c[0]][0]){case 357:return u=c[1]==-1?"#REF":a.SheetNames[c[1]],c[1]==c[2]?u:u+":"+a.SheetNames[c[2]];case 358:return l.SID!=null?a.SheetNames[l.SID]:"SH33TJSSAME"+a[c[0]][0];case 355:default:return"SH33TJSSRC"+a[c[0]][0]}switch(a[c[0]][0][0]){case 1025:return u=c[1]==-1?"#REF":a.SheetNames[c[1]]||"SH33TJSERR3",c[1]==c[2]?u:u+":"+a.SheetNames[c[2]];case 14849:return a[c[0]].slice(1).map(function(h){return h.Name}).join(";;");default:return a[c[0]][0][3]?(u=c[1]==-1?"#REF":a[c[0]][0][3][c[1]]||"SH33TJSERR4",c[1]==c[2]?u:u+":"+a[c[0]][0][3][c[2]]):"SH33TJSERR2"}}function dx(a,o,l){return o=hx(a,o,l),o=="#REF"?o:function(c,u){if(!(c||u&&u.biff<=5&&2<=u.biff))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(c)?"'"+c+"'":c}(o,l)}function ds(a,o,l,c,u){var h,f,d,y=u&&u.biff||8,v={s:{c:0,r:0}},b=[],_=0,T=0,S="";if(!a[0]||!a[0][0])return"";for(var I=-1,k="",M=0,D=a[0].length;M<D;++M){var F=a[0][M];switch(F[0]){case"PtgUminus":b.push("-"+b.pop());break;case"PtgUplus":b.push("+"+b.pop());break;case"PtgPercent":b.push(b.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(it=b.pop(),h=b.pop(),0<=I){switch(a[0][I][1][0]){case 0:k=Cr(" ",a[0][I][1][1]);break;case 1:k=Cr("\r",a[0][I][1][1]);break;default:if(k="",u.WTF)throw new Error("Unexpected PtgAttrSpaceType "+a[0][I][1][0])}h+=k,I=-1}b.push(h+L5[F[0]]+it);break;case"PtgIsect":it=b.pop(),h=b.pop(),b.push(h+" "+it);break;case"PtgUnion":it=b.pop(),h=b.pop(),b.push(h+","+it);break;case"PtgRange":it=b.pop(),h=b.pop(),b.push(h+":"+it);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":break;case"PtgRef":f=Y(F[1][1],v,u),b.push(Ee(f,y));break;case"PtgRefN":f=l?Y(F[1][1],l,u):F[1][1],b.push(Ee(f,y));break;case"PtgRef3d":_=F[1][1],f=Y(F[1][2],v,u),S=dx(c,_,u),b.push(S+"!"+Ee(f,y));break;case"PtgFunc":case"PtgFuncVar":var B=F[1][0],j=F[1][1],B=B||0,z=(B&=127)==0?[]:b.slice(-B);b.length-=B,j==="User"&&(j=z.shift()),b.push(j+"("+z.join(",")+")");break;case"PtgBool":b.push(F[1]?"TRUE":"FALSE");break;case"PtgInt":b.push(F[1]);break;case"PtgNum":b.push(String(F[1]));break;case"PtgStr":b.push('"'+F[1].replace(/"/g,'""')+'"');break;case"PtgErr":b.push(F[1]);break;case"PtgAreaN":d=pe(F[1][1],l?{s:l}:v,u),b.push(tt(d,u));break;case"PtgArea":d=pe(F[1][1],v,u),b.push(tt(d,u));break;case"PtgArea3d":_=F[1][1],d=F[1][2],S=dx(c,_,u),b.push(S+"!"+tt(d,u));break;case"PtgAttrSum":b.push("SUM("+b.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":T=F[1][2];var ae=(c.names||[])[T-1]||(c[0]||[])[T],he=ae?ae.Name:"SH33TJSNAME"+String(T);he&&he.slice(0,6)=="_xlfn."&&!u.xlfn&&(he=he.slice(6)),b.push(he);break;case"PtgNameX":var le,ve=F[1][1],T=F[1][2];if(!(u.biff<=5)){ae="",((c[ve]||[])[0]||[])[0]==14849||(((c[ve]||[])[0]||[])[0]==1025?c[ve][T]&&0<c[ve][T].itab&&(ae=c.SheetNames[c[ve][T].itab-1]+"!"):ae=c.SheetNames[T-1]+"!"),c[ve]&&c[ve][T]?ae+=c[ve][T].Name:c[0]&&c[0][T]?ae+=c[0][T].Name:(he=(hx(c,ve,u)||"").split(";;"))[T-1]?ae=he[T-1]:ae+="SH33TJSERRX",b.push(ae);break}le=(le=c[ve=ve<0?-ve:ve]?c[ve][T]:le)||{Name:"SH33TJSERRY"},b.push(le.Name);break;case"PtgParen":var Ie="(",De=")";if(0<=I){switch(k="",a[0][I][1][0]){case 2:Ie=Cr(" ",a[0][I][1][1])+Ie;break;case 3:Ie=Cr("\r",a[0][I][1][1])+Ie;break;case 4:De=Cr(" ",a[0][I][1][1])+De;break;case 5:De=Cr("\r",a[0][I][1][1])+De;break;default:if(u.WTF)throw new Error("Unexpected PtgAttrSpaceType "+a[0][I][1][0])}I=-1}b.push(Ie+b.pop()+De);break;case"PtgRefErr":case"PtgRefErr3d":b.push("#REF!");break;case"PtgExp":f={c:F[1][1],r:F[1][0]};var _e={c:l.c,r:l.r};if(c.sharedf[Pt(f)])ve=c.sharedf[Pt(f)],b.push(ds(ve,0,_e,c,u));else{for(var Ue=!1,it=0;it!=c.arrayf.length;++it)if(h=c.arrayf[it],!(f.c<h[0].s.c||f.c>h[0].e.c||f.r<h[0].s.r||f.r>h[0].e.r)){b.push(ds(h[1],0,_e,c,u)),Ue=!0;break}Ue||b.push(F[1])}break;case"PtgArray":b.push("{"+function(Je){for(var Ge=[],je=0;je<Je.length;++je){for(var ht=Je[je],xt=[],Nt=0;Nt<ht.length;++Nt){var Jt=ht[Nt];Jt?Jt[0]===2?xt.push('"'+Jt[1].replace(/"/g,'""')+'"'):xt.push(Jt[1]):xt.push("")}Ge.push(xt.join(","))}return Ge.join(";")}(F[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":I=M;break;case"PtgTbl":case"PtgMemErr":break;case"PtgMissArg":b.push("");break;case"PtgAreaErr":case"PtgAreaErr3d":b.push("#REF!");break;case"PtgList":b.push("Table"+F[1].idx+"[#"+F[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":default:throw new Error("Unrecognized Formula Token: "+String(F))}if(u.biff!=3&&0<=I&&["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(a[0][M][0])==-1){var nt=!0;switch((F=a[0][I])[1][0]){case 4:nt=!1;case 0:k=Cr(" ",F[1][1]);break;case 5:nt=!1;case 1:k=Cr("\r",F[1][1]);break;default:if(k="",u.WTF)throw new Error("Unexpected PtgAttrSpaceType "+F[1][0])}b.push((nt?k:"")+b.pop()+(nt?"":k)),I=-1}}if(1<b.length&&u.WTF)throw new Error("bad formula stack");return b[0]}function Np(a,f,l){var c=a.l+f,u=Oa(a);l.biff==2&&++a.l;var h=function(d){var y;if(qs(d,d.l+6)!==65535)return[Xn(d),"n"];switch(d[d.l]){case 0:return d.l+=8,["String","s"];case 1:return y=d[d.l+2]===1,d.l+=8,[y,"b"];case 2:return y=d[d.l+2],d.l+=8,[y,"e"];case 3:return d.l+=8,["","s"]}return[]}(a),f=a.read_shift(1);return l.biff!=2&&(a.read_shift(1),5<=l.biff&&a.read_shift(4)),l=function(d,y,v){var b,_=d.l+y,T=v.biff==2?1:2,S=d.read_shift(T);if(S==65535)return[[],Fn(d,y-2)];var I=uu(d,S,v);return y!==S+T&&(b=cu(d,y-S-T,I,v)),d.l=_,[I,b]}(a,c-a.l,l),{cell:u,val:h[0],formula:l,shared:f>>3&1,tt:h[1]}}function V5(a,o,l,c,u){o=jo(o,l,u),u=(l=a.v)!=null?Nl(typeof l=="number"?l:0):((l=Ae(8)).write_shift(1,3),l.write_shift(1,0),l.write_shift(2,0),l.write_shift(2,0),l.write_shift(2,65535),l),l=Ae(6),l.write_shift(2,33),l.write_shift(4,0);for(var h=Ae(a.bf.length),f=0;f<a.bf.length;++f)h[f]=a.bf[f];return K([o,u,l,h])}function Ih(a,o,l){var u=a.read_shift(4),c=uu(a,u,l),u=a.read_shift(4);return[c,0<u?cu(a,u,c,l):null]}var U5=Ih,Dh=Ih,B5=Ih,$5=Ih,W5={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},px={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},z5={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function mx(a){return(a=(a=(a=(a=(a=a.slice(0,3)=="of:"?a.slice(3):a).charCodeAt(0)==61&&(a=a.slice(1)).charCodeAt(0)==61?a.slice(1):a).replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(o,l){return l.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function Ip(a){return a=a.split(":"),[a[0].split(".")[0],a[0].split(".")[1]+(1<a.length?":"+(a[1].split(".")[1]||a[1].split(".")[0]):"")]}var fu={},Ll={},hu=typeof Map<"u";function Dp(a,o,l){var c=0,u=a.length;if(l){if(hu?l.has(o):Object.prototype.hasOwnProperty.call(l,o)){for(var h=hu?l.get(o):l[o];c<h.length;++c)if(a[h[c]].t===o)return a.Count++,h[c]}}else for(;c<u;++c)if(a[c].t===o)return a.Count++,c;return a[u]={t:o},a.Count++,a.Unique++,l&&(hu?(l.has(o)||l.set(o,[]),l.get(o).push(u)):(Object.prototype.hasOwnProperty.call(l,o)||(l[o]=[]),l[o].push(u))),u}function Rh(c,o){var l={min:c+1,max:c+1},c=-1;return o.MDW&&(Zn=o.MDW),o.width!=null?l.customWidth=1:o.wpx!=null?c=su(o.wpx):o.wch!=null&&(c=o.wch),-1<c?(l.width=kh(c),l.customWidth=1):o.width!=null&&(l.width=o.width),o.hidden&&(l.hidden=!0),o.level!=null&&(l.outlineLevel=l.level=o.level),l}function Lo(a,o){a&&(o=o=="xlml"?[1,1,1,1,.5,.5]:[.7,.7,.75,.75,.3,.3],a.left==null&&(a.left=o[0]),a.right==null&&(a.right=o[1]),a.top==null&&(a.top=o[2]),a.bottom==null&&(a.bottom=o[3]),a.header==null&&(a.header=o[4]),a.footer==null&&(a.footer=o[5]))}function $i(a,o,l){if(iu!==void 0){if(/^\d+$/.exec(o.s)||o.s&&o.s==+o.s)return o.s;var c=o.s||{};return o.z&&(c.numFmt=o.z),iu.addStyle(c)}var u=l.revssf[o.z!=null?o.z:"General"],h=60,f=a.length;if(u==null&&l.ssf){for(;h<392;++h)if(l.ssf[h]==null){Vr(o.z,h),l.ssf[h]=o.z,l.revssf[o.z]=u=h;break}}for(h=0;h!=f;++h)if(a[h].numFmtId===u)return h;return a[f]={numFmtId:u,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},f}function gx(a,o,l,c,u,h){try{c.cellNF&&(a.z=de[o])}catch(d){if(c.WTF)throw d}if(a.t!=="z"||c.cellStyles){if(a.t==="d"&&typeof a.v=="string"&&(a.v=Ur(a.v)),(!c||c.cellText!==!1)&&a.t!=="z")try{if(de[o]==null&&Vr(Wf[o]||"General",o),a.t==="e")a.w=a.w||si[a.v];else if(o===0)if(a.t==="n")(0|a.v)===a.v?a.w=a.v.toString(10):a.w=Rr(a.v);else if(a.t==="d"){var f=qr(a.v);a.w=(0|f)===f?f.toString(10):Rr(f)}else{if(a.v===void 0)return;a.w=er(a.v,Ll)}else a.t==="d"?a.w=Rt(o,qr(a.v),Ll):a.w=Rt(o,a.v,Ll)}catch(d){if(c.WTF)throw d}if(c.cellStyles&&l!=null)try{a.s=h.Fills[l],a.s.fgColor&&a.s.fgColor.theme&&!a.s.fgColor.rgb&&(a.s.fgColor.rgb=Ch(u.themeElements.clrScheme[a.s.fgColor.theme].rgb,a.s.fgColor.tint||0),c.WTF&&(a.s.fgColor.raw_rgb=u.themeElements.clrScheme[a.s.fgColor.theme].rgb)),a.s.bgColor&&a.s.bgColor.theme&&(a.s.bgColor.rgb=Ch(u.themeElements.clrScheme[a.s.bgColor.theme].rgb,a.s.bgColor.tint||0),c.WTF&&(a.s.bgColor.raw_rgb=u.themeElements.clrScheme[a.s.bgColor.theme].rgb))}catch(d){if(c.WTF&&h.Fills)throw d}}}var H5=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,G5=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,q5=/<(?:\w:)?hyperlink [^>]*>/gm,K5=/"(\w*:\w*)"/,Y5=/<(?:\w:)?col\b[^>]*[\/]?>/g,Q5=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,X5=/<(?:\w:)?pageMargins[^>]*\/>/g,yx=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,J5=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Z5=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function eS(a,o,l,c,u,h,f){if(!a)return a;c=c||{"!id":{}};var d=o.dense?[]:{},y={s:{r:2e6,c:2e6},e:{r:0,c:0}},v="",he="",b=a.match(G5);b?(v=a.slice(0,b.index),he=a.slice(b.index+b[0].length)):v=he=a;var _=v.match(yx);_?Rp(_[0],0,u,l):(_=v.match(J5))&&(a=_[0],_[1],_=d,T=u,S=l,Rp(a.slice(0,a.indexOf(">")),0,T,S));var T,S,I=(v.match(/<(?:\w*:)?dimension/)||{index:-1}).index;0<I&&(T=v.slice(I,I+50).match(K5))&&(S=d,(M=nr(M=T[1])).s.r<=M.e.r&&M.s.c<=M.e.c&&0<=M.s.r&&0<=M.s.c&&(S["!ref"]=Bt(M)));var k,M=v.match(Z5);M&&M[1]&&(F=M[1],(k=u).Views||(k.Views=[{}]),(F.match(nS)||[]).forEach(function(le,ve){le=Lt(le),k.Views[ve]||(k.Views[ve]={}),+le.zoomScale&&(k.Views[ve].zoom=+le.zoomScale),$r(le.rightToLeft)&&(k.Views[ve].RTL=!0)}));var D,F=[];o.cellStyles&&(D=v.match(Y5))&&function(le,ve){for(var Ie=!1,De=0;De!=ve.length;++De){var _e=Lt(ve[De],!0);_e.hidden&&(_e.hidden=$r(_e.hidden));var Ue=parseInt(_e.min,10)-1,it=parseInt(_e.max,10)-1;for(_e.outlineLevel&&(_e.level=+_e.outlineLevel||0),delete _e.min,delete _e.max,_e.width=+_e.width,!Ie&&_e.width&&(Ie=!0,Ep(_e.width)),Ui(_e);Ue<=it;)le[Ue++]=Tr(_e)}}(F,D),b&&sS(b[1],d,o,y,h,f),f=he.match(Q5),f&&(d["!autofilter"]={ref:(f[0].match(/ref="([^"]*)"/)||[])[1]});var j=[],B=he.match(H5);if(B)for(I=0;I!=B.length;++I)j[I]=nr(B[I].slice(B[I].indexOf('"')+1));f=he.match(q5),f&&function(le,ve,Ie){for(var De=Array.isArray(le),_e=0;_e!=ve.length;++_e){var Ue=Lt(kr(ve[_e]),!0);if(!Ue.ref)return;var it=((Ie||{})["!id"]||[])[Ue.id];it?(Ue.Target=it.Target,Ue.location&&(Ue.Target+="#"+qt(Ue.location))):(Ue.Target="#"+qt(Ue.location),it={Target:Ue.Target,TargetMode:"Internal"}),Ue.Rel=it,Ue.tooltip&&(Ue.Tooltip=Ue.tooltip,delete Ue.tooltip);for(var nt=nr(Ue.ref),Ye=nt.s.r;Ye<=nt.e.r;++Ye)for(var Je=nt.s.c;Je<=nt.e.c;++Je){var Ge=Pt({c:Je,r:Ye});De?(le[Ye]||(le[Ye]=[]),le[Ye][Je]||(le[Ye][Je]={t:"z",v:void 0}),le[Ye][Je].l=Ue):(le[Ge]||(le[Ge]={t:"z",v:void 0}),le[Ge].l=Ue)}}}(d,f,c);var z,ae,he=he.match(X5);return he&&(d["!margins"]=(z=Lt(he[0]),ae={},["left","right","top","bottom","header","footer"].forEach(function(le){z[le]&&(ae[le]=parseFloat(z[le]))}),ae)),!d["!ref"]&&y.e.c>=y.s.c&&y.e.r>=y.s.r&&(d["!ref"]=Bt(y)),0<o.sheetRows&&d["!ref"]&&(he=nr(d["!ref"]),o.sheetRows<=+he.e.r&&(he.e.r=o.sheetRows-1,he.e.r>y.e.r&&(he.e.r=y.e.r),he.e.r<he.s.r&&(he.s.r=he.e.r),he.e.c>y.e.c&&(he.e.c=y.e.c),he.e.c<he.s.c&&(he.s.c=he.e.c),d["!fullref"]=d["!ref"],d["!ref"]=Bt(he))),0<F.length&&(d["!cols"]=F),0<j.length&&(d["!merges"]=j),d}function Rp(a,o,l,c){a=Lt(a),l.Sheets[c]||(l.Sheets[c]={}),a.codeName&&(l.Sheets[c].CodeName=qt(kr(a.codeName)))}var tS=["objects","scenarios","selectLockedCells","selectUnlockedCells"],rS=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"],nS=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/,vx,xx,bx,wx,_x,Tx,Ex,sS=(vx=/<(?:\w+:)?c[ \/>]/,xx=/<\/(?:\w+:)?row>/,bx=/r=["']([^"']*)["']/,wx=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,_x=/ref=["']([^"']*)["']/,Tx=Hs("v"),Ex=Hs("f"),function(a,o,l,c,u,h){for(var f,d,y,v,b,_,T=0,S="",I=[],k=[],M=0,D=0,F="",j=0,B=0,z=0,ae=0,he=Array.isArray(h.CellXf),le=[],ve=[],Ie=Array.isArray(o),De=[],_e={},Ue=!1,it=!!l.sheetStubs,nt=a.split(xx),Ye=0,Je=nt.length;Ye!=Je;++Ye){var Ge=(S=nt[Ye].trim()).length;if(Ge!==0){var je=0;e:for(T=0;T<Ge;++T)switch(S[T]){case">":if(S[T-1]!="/"){++T;break e}if(l&&l.cellStyles){if(j=(y=Lt(S.slice(je,T),!0)).r!=null?parseInt(y.r,10):j+1,B=-1,l.sheetRows&&l.sheetRows<j)continue;Ue=!(_e={}),y.ht&&(Ue=!0,_e.hpt=parseFloat(y.ht),_e.hpx=Ol(_e.hpt)),y.hidden=="1"&&(Ue=!0,_e.hidden=!0),y.outlineLevel!=null&&(Ue=!0,_e.level=+y.outlineLevel),Ue&&(De[j-1]=_e)}break;case"<":je=T}if(T<=je)break;if(j=(y=Lt(S.slice(je,T),!0)).r!=null?parseInt(y.r,10):j+1,B=-1,!(l.sheetRows&&l.sheetRows<j)){c.s.r>j-1&&(c.s.r=j-1),c.e.r<j-1&&(c.e.r=j-1),l&&l.cellStyles&&(Ue=!(_e={}),y.ht&&(Ue=!0,_e.hpt=parseFloat(y.ht),_e.hpx=Ol(_e.hpt)),y.hidden=="1"&&(Ue=!0,_e.hidden=!0),y.outlineLevel!=null&&(Ue=!0,_e.level=+y.outlineLevel),Ue&&(De[j-1]=_e)),I=S.slice(T).split(vx);for(var ht,xt=0;xt!=I.length&&I[xt].trim().charAt(0)=="<";++xt);for(I=I.slice(xt),T=0;T!=I.length;++T)if((S=I[T].trim()).length!==0){if(k=S.match(bx),M=T,D=0,S="<c "+(S.slice(0,1)=="<"?">":"")+S,k!=null&&k.length===2){for(M=0,F=k[1],D=0;D!=F.length&&!((f=F.charCodeAt(D)-64)<1||26<f);++D)M=26*M+f;B=--M}else++B;for(D=0;D!=S.length&&S.charCodeAt(D)!==62;++D);if(++D,(y=Lt(S.slice(0,D),!0)).r||(y.r=Pt({r:j-1,c:B})),d={t:""},(k=(F=S.slice(D)).match(Tx))!=null&&k[1]!==""&&(d.v=qt(k[1])),l.cellFormula){(k=F.match(Ex))!=null&&k[1]!==""?(d.f=qt(kr(k[1])).replace(/\r\n/g,`
`),l.xlfn||(d.f=sx(d.f)),-1<k[0].indexOf('t="array"')?(d.F=(F.match(_x)||[])[1],-1<d.F.indexOf(":")&&le.push([nr(d.F),d.F])):-1<k[0].indexOf('t="shared"')&&(b=Lt(k[0]),ht=qt(kr(k[1])),l.xlfn||(ht=sx(ht)),ve[parseInt(b.si,10)]=[b,ht,y.r])):(k=F.match(/<f[^>]*\/>/))&&ve[(b=Lt(k[0])).si]&&(d.f=(_=ve[b.si][1],lt=ve[b.si][2],ht=y.r,lt=Wr(lt).s,ht=rr(ht),nx(_,{r:ht.r-lt.r,c:ht.c-lt.c})));for(var Nt=rr(y.r),D=0;D<le.length;++D)Nt.r>=le[D][0].s.r&&Nt.r<=le[D][0].e.r&&Nt.c>=le[D][0].s.c&&Nt.c<=le[D][0].e.c&&(d.F=le[D][1])}if(y.t==null&&d.v===void 0)if(d.f||d.F)d.v=0,d.t="n";else{if(!it)continue;d.t="z"}else d.t=y.t||"n";switch(c.s.c>B&&(c.s.c=B),c.e.c<B&&(c.e.c=B),d.t){case"n":if(d.v==""||d.v==null){if(!it)continue;d.t="z"}else d.v=parseFloat(d.v);break;case"s":if(d.v===void 0){if(!it)continue;d.t="z"}else v=fu[parseInt(d.v,10)],d.v=v.t,d.r=v.r,l.cellHTML&&(d.h=v.h);break;case"str":d.t="s",d.v=d.v!=null?kr(d.v):"",l.cellHTML&&(d.h=Xa(d.v));break;case"inlineStr":k=F.match(wx),d.t="s",k!=null&&(v=bp(k[1]))?(d.v=v.t,l.cellHTML&&(d.h=v.h)):d.v="";break;case"b":d.v=$r(d.v);break;case"d":l.cellDates?d.v=Ur(d.v,1):(d.v=qr(Ur(d.v,1)),d.t="n");break;case"e":l&&l.cellText===!1||(d.w=d.v),d.v=hy[d.v]}var Jt,z=ae=0,lt=null;he&&y.s!==void 0&&(lt=h.CellXf[y.s])!=null&&(lt.numFmtId!=null&&(z=lt.numFmtId),l.cellStyles&&lt.fillId!=null&&(ae=lt.fillId)),gx(d,z,ae,l,u,h),l.cellDates&&he&&d.t=="n"&&Is(de[z])&&(d.t="d",d.v=ha(d.v)),y.cm&&l.xlmeta&&(Jt=(l.xlmeta.Cell||[])[+y.cm-1])&&Jt.type=="XLDAPR"&&(d.D=!0),Ie?(o[(Jt=rr(y.r)).r]||(o[Jt.r]=[]),o[Jt.r][Jt.c]=d):o[y.r]=d}}}}0<De.length&&(o["!rows"]=De)});function aS(a,o){for(var l,c,u,h,f=[],d=[],y=nr(a["!ref"]),v=[],b=0,k=0,_=a["!rows"],T=Array.isArray(a),S={r:""},I=-1,k=y.s.c;k<=y.e.c;++k)v[k]=Yt(k);for(b=y.s.r;b<=y.e.r;++b){for(d=[],u=tr(b),k=y.s.c;k<=y.e.c;++k){c=v[k]+u;var M=T?(a[b]||[])[k]:a[c];M!==void 0&&(l=function(D,F,j,B){if(D.c&&j["!comments"].push([F,D.c]),D.v===void 0&&typeof D.f!="string"||D.t==="z"&&!D.f)return"";var z="",ae=D.t,he=D.v;if(D.t!=="z")switch(D.t){case"b":z=D.v?"1":"0";break;case"n":z=""+D.v;break;case"e":z=si[D.v];break;case"d":z=B&&B.cellDates?Ur(D.v,-1).toISOString():((D=Tr(D)).t="n",""+(D.v=qr(Ur(D.v)))),D.z===void 0&&(D.z=de[14]);break;default:z=D.v}var le=cn("v",Er(z)),ve={r:F},Ie=$i(B.cellXfs,D,B);switch(Ie!==0&&(ve.s=Ie),D.t){case"n":break;case"d":ve.t="d";break;case"b":ve.t="b";break;case"e":ve.t="e";break;case"z":break;default:if(D.v==null){delete D.t;break}if(32767<D.v.length)throw new Error("Text length must not exceed 32767 characters");if(B&&B.bookSST){le=cn("v",""+Dp(B.Strings,D.v,B.revStrings)),ve.t="s";break}ve.t="str"}return D.t!=ae&&(D.t=ae,D.v=he),typeof D.f=="string"&&D.f&&(he=D.F&&D.F.slice(0,F.length)==F?{t:"array",ref:D.F}:null,le=Ze("f",Er(D.f),he)+(D.v!=null?le:"")),D.l&&j["!links"].push([F,D.l]),D.D&&(ve.cm=1),Ze("c",le,ve)}(M,c,a,o))!=null&&d.push(l)}(0<d.length||_&&_[b])&&(S={r:u},_&&_[b]&&((h=_[b]).hidden&&(S.hidden=1),I=-1,h.hpx?I=au(h.hpx):h.hpt&&(I=h.hpt),-1<I&&(S.ht=I,S.customHeight=1),h.level&&(S.outlineLevel=h.level)),f[f.length]=Ze("row",d.join(""),S))}if(_)for(;b<_.length;++b)_&&_[b]&&(S={r:b+1},(h=_[b]).hidden&&(S.hidden=1),I=-1,h.hpx?I=au(h.hpx):h.hpt&&(I=h.hpt),-1<I&&(S.ht=I,S.customHeight=1),h.level&&(S.outlineLevel=h.level),f[f.length]=Ze("row","",S));return f.join("")}function Sx(a,o,l,c){var u,h,f=[Zr,Ze("worksheet",null,{xmlns:Dr[0],"xmlns:r":rn.r})],d=l.SheetNames[a],y=l.Sheets[d],v=(y=y??{})["!ref"]||"A1",b=nr(v);if(16383<b.e.c||1048575<b.e.r){if(o.WTF)throw new Error("Range "+v+" exceeds format limit A1:XFD1048576");b.e.c=Math.min(b.e.c,16383),b.e.r=Math.min(b.e.c,1048575),v=Bt(b)}c=c||{},y["!comments"]=[];var _,T,S=[];(function(D,F,j,B,z){var ae=!1,he={},le=null;if(B.bookType!=="xlsx"&&F.vbaraw){var ve=F.SheetNames[j];try{F.Workbook&&(ve=F.Workbook.Sheets[j].CodeName||ve)}catch{}ae=!0,he.codeName=Os(Er(ve))}D&&D["!outline"]&&(B={summaryBelow:1,summaryRight:1},D["!outline"].above&&(B.summaryBelow=0),D["!outline"].left&&(B.summaryRight=0),le=(le||"")+Ze("outlinePr",null,B)),(ae||le)&&(z[z.length]=Ze("sheetPr",le,he))})(y,l,a,o,f),f[f.length]=Ze("dimension",null,{ref:v}),f[f.length]=(d={workbookViewId:"0"},((((b=l)||{}).Workbook||{}).Views||[])[0]&&(d.rightToLeft=b.Workbook.Views[0].RTL?"1":"0"),Ze("sheetViews",Ze("sheetView",null,d),{})),o.sheetFormat&&(f[f.length]=Ze("sheetFormatPr",null,{defaultRowHeight:o.sheetFormat.defaultRowHeight||"16",baseColWidth:o.sheetFormat.baseColWidth||"10",outlineLevelRow:o.sheetFormat.outlineLevelRow||"7"})),y["!cols"]!=null&&0<y["!cols"].length&&(f[f.length]=function(D){for(var F,j=["<cols>"],B=0;B!=D.length;++B)(F=D[B])&&(j[j.length]=Ze("col",null,Rh(B,F)));return j[j.length]="</cols>",j.join("")}(y["!cols"])),f[u=f.length]="<sheetData/>",y["!links"]=[],y["!ref"]!=null&&0<(h=aS(y,o)).length&&(f[f.length]=h),f.length>u+1&&(f[f.length]="</sheetData>",f[u]=f[u].replace("/>",">")),y["!protect"]&&(f[f.length]=(_=y["!protect"],T={sheet:1},tS.forEach(function(D){_[D]!=null&&_[D]&&(T[D]="1")}),rS.forEach(function(D){_[D]==null||_[D]||(T[D]="0")}),_.password&&(T.password=wp(_.password).toString(16).toUpperCase()),Ze("sheetProtection",null,T))),y["!autofilter"]!=null&&(f[f.length]=function(D,F,j,B){var z=typeof D.ref=="string"?D.ref:Bt(D.ref);j.Workbook||(j.Workbook={Sheets:[]}),j.Workbook.Names||(j.Workbook.Names=[]);var ae=j.Workbook.Names;(D=Wr(z)).s.r==D.e.r&&(D.e.r=Wr(F["!ref"]).e.r,z=Bt(D));for(var he=0;he<ae.length;++he){var le=ae[he];if(le.Name=="_xlnm._FilterDatabase"&&le.Sheet==B){le.Ref="'"+j.SheetNames[B]+"'!"+z;break}}return he==ae.length&&ae.push({Name:"_xlnm._FilterDatabase",Sheet:B,Ref:"'"+j.SheetNames[B]+"'!"+z}),Ze("autoFilter",null,{ref:z})}(y["!autofilter"],y,l,a)),y["!merges"]!=null&&0<y["!merges"].length&&(f[f.length]=function(D){if(D.length===0)return"";for(var F='<mergeCells count="'+D.length+'">',j=0;j!=D.length;++j)F+='<mergeCell ref="'+Bt(D[j])+'"/>';return F+"</mergeCells>"}(y["!merges"]));var I,k,M=-1;return 0<y["!links"].length&&(f[f.length]="<hyperlinks>",y["!links"].forEach(function(D){D[1].Target&&(k={ref:D[0]},D[1].Target.charAt(0)!="#"&&(M=jr(c,-1,Er(D[1].Target).replace(/#.*$/,""),Xt.HLINK),k["r:id"]="rId"+M),-1<(I=D[1].Target.indexOf("#"))&&(k.location=Er(D[1].Target.slice(I+1))),D[1].Tooltip&&(k.tooltip=Er(D[1].Tooltip)),f[f.length]=Ze("hyperlink",null,k))}),f[f.length]="</hyperlinks>"),delete y["!links"],y["!margins"]!=null&&(f[f.length]=(Lo(l=y["!margins"]),Ze("pageMargins",null,l))),o&&!o.ignoreEC&&o.ignoreEC!=null||(f[f.length]=cn("ignoredErrors",Ze("ignoredError",null,{numberStoredAsText:1,sqref:v}))),0<S.length&&(M=jr(c,-1,"../drawings/drawing"+(a+1)+".xml",Xt.DRAW),f[f.length]=Ze("drawing",null,{"r:id":"rId"+M}),y["!drawing"]=S),0<y["!comments"].length&&(M=jr(c,-1,"../drawings/vmlDrawing"+(a+1)+".vml",Xt.VML),f[f.length]=Ze("legacyDrawing",null,{"r:id":"rId"+M}),y["!legacy"]=M),1<f.length&&(f[f.length]="</worksheet>",f[1]=f[1].replace("/>",">")),f.join("")}function iS(a,o,l,c){l=function(u,h,f){var d=Ae(145),y=(f["!rows"]||[])[u]||{};d.write_shift(4,u),d.write_shift(4,0);var b=320;y.hpx?b=20*au(y.hpx):y.hpt&&(b=20*y.hpt),d.write_shift(2,b),d.write_shift(1,0),b=0,y.level&&(b|=y.level),y.hidden&&(b|=16),(y.hpx||y.hpt)&&(b|=32),d.write_shift(1,b),d.write_shift(1,0);var v=0,b=d.l;d.l+=4;for(var _={r:u,c:0},T=0;T<16;++T)if(!(h.s.c>T+1<<10||h.e.c<T<<10)){for(var S=-1,I=-1,k=T<<10;k<T+1<<10;++k)_.c=k,(Array.isArray(f)?(f[_.r]||[])[_.c]:f[Pt(_)])&&(S<0&&(S=k),I=k);S<0||(++v,d.write_shift(4,S),d.write_shift(4,I))}return u=d.l,d.l=b,d.write_shift(4,v),d.l=u,d.length>d.l?d.slice(0,d.l):d}(c,l,o),(17<l.length||(o["!rows"]||[])[c])&&C(a,0,l)}var Ph=Do,oS=Fl;function Ax(a){return[No(a),Xn(a),"n"]}var Vl=Do,lS=Fl,Cx=["left","right","top","bottom","header","footer"];function cS(a,o,l,c,u,h,f){if(o.v===void 0)return!1;var d="";switch(o.t){case"b":d=o.v?"1":"0";break;case"d":(o=Tr(o)).z=o.z||de[14],o.v=qr(Ur(o.v)),o.t="n";break;case"n":case"e":d=""+o.v;break;default:d=o.v}var y,v,b,_,T,S,I,k,M,D,F,j,B,z,ae,he,le,ve,Ie,De,_e={r:l,c};switch(_e.s=$i(u.cellXfs,o,u),o.l&&h["!links"].push([Pt(_e),o.l]),o.c&&h["!comments"].push([Pt(_e),o.c]),o.t){case"s":case"str":return u.bookSST?(d=Dp(u.Strings,o.v,u.revStrings),_e.t="s",_e.v=d,f?C(a,18,(Io(le=_e,ve=ve??Ae(8)),ve.write_shift(4,le.v),ve)):C(a,7,(Fo(le=_e,he=he??Ae(12)),he.write_shift(4,le.v),he))):(_e.t="str",f?C(a,17,(z=o,Io(_e,ae=ae??Ae(8+4*z.v.length)),Pn(z.v,ae),ae.length>ae.l?ae.slice(0,ae.l):ae)):C(a,6,(z=o,Fo(_e,B=B??Ae(12+4*z.v.length)),Pn(z.v,B),B.length>B.l?B.slice(0,B.l):B))),!0;case"n":return o.v==(0|o.v)&&-1e3<o.v&&o.v<1e3?f?C(a,13,(F=o,Io(_e,j=j??Ae(8)),iy(F.v,j),j)):C(a,2,(F=o,Fo(_e,D=D??Ae(12)),iy(F.v,D),D)):f?C(a,16,(k=o,Io(_e,M=M??Ae(12)),Nl(k.v,M),M)):C(a,5,(k=o,Fo(_e,I=I??Ae(16)),Nl(k.v,I),I)),!0;case"b":return _e.t="b",f?C(a,15,(T=o,Io(_e,S=S??Ae(5)),S.write_shift(1,T.v?1:0),S)):C(a,4,(T=o,Fo(_e,_=_??Ae(9)),_.write_shift(1,T.v?1:0),_)),!0;case"e":return _e.t="e",f?C(a,14,(v=o,Io(_e,b=b??Ae(8)),b.write_shift(1,v.v),b.write_shift(2,0),b.write_shift(1,0),b)):C(a,3,(v=o,Fo(_e,y=y??Ae(9)),y.write_shift(1,v.v),y)),!0}return f?C(a,12,Io(_e,De=De??Ae(4))):C(a,1,Fo(_e,Ie=Ie??Ae(8))),!0}function uS(a,o){var l,c;o&&o["!merges"]&&(C(a,177,(l=o["!merges"].length,(c=c??Ae(4)).write_shift(4,l),c)),o["!merges"].forEach(function(u){C(a,176,lS(u))}),C(a,178))}function fS(a,o){o&&o["!cols"]&&(C(a,390),o["!cols"].forEach(function(l,c){l&&C(a,60,function(u,h,f){f==null&&(f=Ae(18));var d=Rh(u,h);return f.write_shift(-4,u),f.write_shift(-4,u),f.write_shift(4,256*(d.width||10)),f.write_shift(4,0),u=0,h.hidden&&(u|=1),typeof d.width=="number"&&(u|=2),h.level&&(u|=h.level<<8),f.write_shift(2,u),f}(c,l))}),C(a,391))}function hS(a,o){var l;o&&o["!ref"]&&(C(a,648),C(a,649,(l=nr(o["!ref"]),(o=Ae(24)).write_shift(4,4),o.write_shift(4,1),Fl(l,o),o)),C(a,650))}function dS(a,o,l){o["!links"].forEach(function(c){var u,h;c[1].Target&&(u=jr(l,-1,c[1].Target.replace(/#.*$/,""),Xt.HLINK),C(a,494,(h=u,c=Ae(50+4*((u=c)[1].Target.length+(u[1].Tooltip||"").length)),Fl({s:rr(u[0]),e:rr(u[0])},c),rp("rId"+h,c),Pn(((h=u[1].Target.indexOf("#"))==-1?"":u[1].Target.slice(h+1))||"",c),Pn(u[1].Tooltip||"",c),Pn("",c),c.slice(0,c.l))))}),delete o["!links"]}function pS(a,o,l){C(a,133),C(a,137,function(c,u){u==null&&(u=Ae(30));var h=924;return(((c||{}).Views||[])[0]||{}).RTL&&(h|=32),u.write_shift(2,h),u.write_shift(4,0),u.write_shift(4,0),u.write_shift(4,0),u.write_shift(1,0),u.write_shift(1,0),u.write_shift(2,0),u.write_shift(2,100),u.write_shift(2,0),u.write_shift(2,0),u.write_shift(2,0),u.write_shift(4,0),u}(l)),C(a,138),C(a,134)}function mS(a,o){var l,c;o["!protect"]&&C(a,535,(l=o["!protect"],(c=c??Ae(66)).write_shift(2,l.password?wp(l.password):0),c.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(u){u[1]?c.write_shift(4,l[u[0]]==null||l[u[0]]?0:1):c.write_shift(4,l[u[0]]!=null&&l[u[0]]?0:1)}),c))}function gS(a,o,l,c){var u=A(),v=l.SheetNames[a],h=l.Sheets[v]||{},f=v;try{l&&l.Workbook&&(f=l.Workbook.Sheets[a].CodeName||f)}catch{}var d,y,v=nr(h["!ref"]||"A1");if(16383<v.e.c||1048575<v.e.r){if(o.WTF)throw new Error("Range "+(h["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");v.e.c=Math.min(v.e.c,16383),v.e.r=Math.min(v.e.c,1048575)}return h["!links"]=[],h["!comments"]=[],C(u,129),(l.vbaraw||h["!outline"])&&C(u,147,function(b,_,T){T==null&&(T=Ae(84+4*b.length));var S=192;_&&(_.above&&(S&=-65),_.left&&(S&=-129)),T.write_shift(1,S);for(var I=1;I<3;++I)T.write_shift(1,0);return hh({auto:1},T),T.write_shift(-4,-1),T.write_shift(-4,-1),ay(b,T),T.slice(0,T.l)}(f,h["!outline"])),C(u,148,oS(v)),pS(u,0,l.Workbook),fS(u,h),function(b,_,T){var S,I=nr(_["!ref"]||"A1"),k=[];C(b,145);var M=Array.isArray(_),D=I.e.r;_["!rows"]&&(D=Math.max(I.e.r,_["!rows"].length-1));for(var F=I.s.r;F<=D;++F){S=tr(F),iS(b,_,I,F);var j=!1;if(F<=I.e.r)for(var B=I.s.c;B<=I.e.c;++B){F===I.s.r&&(k[B]=Yt(B)),z=k[B]+S;var z=M?(_[F]||[])[B]:_[z];z?j=cS(b,z,F,B,T,_,j):j=!1}}C(b,146)}(u,h,o),mS(u,h),function(b,_,T,S){if(_["!autofilter"]){var M=_["!autofilter"],I=typeof M.ref=="string"?M.ref:Bt(M.ref);T.Workbook||(T.Workbook={Sheets:[]}),T.Workbook.Names||(T.Workbook.Names=[]);var k=T.Workbook.Names,M=Wr(I);M.s.r==M.e.r&&(M.e.r=Wr(_["!ref"]).e.r,I=Bt(M));for(var D=0;D<k.length;++D){var F=k[D];if(F.Name=="_xlnm._FilterDatabase"&&F.Sheet==S){F.Ref="'"+T.SheetNames[S]+"'!"+I;break}}D==k.length&&k.push({Name:"_xlnm._FilterDatabase",Sheet:S,Ref:"'"+T.SheetNames[S]+"'!"+I}),C(b,161,Fl(nr(I))),C(b,162)}}(u,h,l,a),uS(u,h),dS(u,h,c),h["!margins"]&&C(u,476,(d=h["!margins"],y==null&&(y=Ae(48)),Lo(d),Cx.forEach(function(b){Nl(d[b],y)}),y)),o&&!o.ignoreEC&&o.ignoreEC!=null||hS(u,h),v=u,o=a,c=c,0<(h=h)["!comments"].length&&(o=jr(c,-1,"../drawings/vmlDrawing"+(o+1)+".vml",Xt.VML),C(v,551,rp("rId"+o)),h["!legacy"]=o),C(u,130),u.end()}function yS(a,o,l,c,u,h){var f=h||{"!type":"chart"};if(!a)return h;var d,y=0,v=0,b={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(a.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(_){var T=function(S){var I,k=[],M=S.match(/^<c:numCache>/);(S.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(F){F=F.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/),F&&(k[+F[1]]=M?+F[2]:F[2])});var D=qt((S.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(S.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(F){I=F.replace(/<.*?>/g,"")}),[k,D,I]}(_);b.s.r=b.s.c=0,b.e.c=y,d=Yt(y),T[0].forEach(function(S,I){f[d+tr(I)]={t:"n",v:S,z:T[1]},v=I}),b.e.r<v&&(b.e.r=v),++y}),0<y&&(f["!ref"]=Bt(b)),f}var Pp=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],vS=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],xS=[],bS=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function kx(a,o){for(var l=0;l!=a.length;++l)for(var c=a[l],u=0;u!=o.length;++u){var h=o[u];if(c[h[0]]==null)c[h[0]]=h[1];else switch(h[2]){case"bool":typeof c[h[0]]=="string"&&(c[h[0]]=$r(c[h[0]]));break;case"int":typeof c[h[0]]=="string"&&(c[h[0]]=parseInt(c[h[0]],10))}}}function Fx(a,o){for(var l=0;l!=o.length;++l){var c=o[l];if(a[c[0]]==null)a[c[0]]=c[1];else switch(c[2]){case"bool":typeof a[c[0]]=="string"&&(a[c[0]]=$r(a[c[0]]));break;case"int":typeof a[c[0]]=="string"&&(a[c[0]]=parseInt(a[c[0]],10))}}}function Nx(a){Fx(a.WBProps,Pp),Fx(a.CalcPr,bS),kx(a.WBView,vS),kx(a.Sheets,xS),Ll.date1904=$r(a.WBProps.date1904)}var wS="][*?/\\".split("");function Ix(a,o){if(31<a.length)throw new Error("Sheet names cannot exceed 31 chars");var l=!0;return wS.forEach(function(c){if(a.indexOf(c)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),l}function Dx(a){if(!a||!a.SheetNames||!a.Sheets)throw new Error("Invalid Workbook");if(!a.SheetNames.length)throw new Error("Workbook is empty");var o,l,c,u=a.Workbook&&a.Workbook.Sheets||[];o=a.SheetNames,l=u,c=!!a.vbaraw,o.forEach(function(f,d){Ix(f);for(var y=0;y<d;++y)if(f==o[y])throw new Error("Duplicate Sheet Name: "+f);if(c){var v=l&&l[d]&&l[d].CodeName||f;if(v.charCodeAt(0)==95&&22<v.length)throw new Error("Bad Code Name: Worksheet"+v)}});for(var h=0;h<a.SheetNames.length;++h)(function(f,d){if(f&&f["!ref"]){var y=nr(f["!ref"]);if(y.e.c<y.s.c||y.e.r<y.s.r)throw new Error("Bad range ("+d+"): "+f["!ref"])}})(a.Sheets[a.SheetNames[h]],(a.SheetNames[h],h))}var _S=/<\w+:workbook/;function Rx(a){var o=[Zr];o[o.length]=Ze("workbook",null,{xmlns:Dr[0],"xmlns:r":rn.r});var l=a.Workbook&&0<(a.Workbook.Names||[]).length,c={codeName:"ThisWorkbook"};a.Workbook&&a.Workbook.WBProps&&(Pp.forEach(function(d){a.Workbook.WBProps[d[0]]!=null&&a.Workbook.WBProps[d[0]]!=d[1]&&(c[d[0]]=a.Workbook.WBProps[d[0]])}),a.Workbook.WBProps.CodeName&&(c.codeName=a.Workbook.WBProps.CodeName,delete c.CodeName)),o[o.length]=Ze("workbookPr",null,c);var u=a.Workbook&&a.Workbook.Sheets||[],h=0;if(u&&u[0]&&u[0].Hidden){for(o[o.length]="<bookViews>",h=0;h!=a.SheetNames.length&&u[h]&&u[h].Hidden;++h);h==a.SheetNames.length&&(h=0),o[o.length]='<workbookView firstSheet="'+h+'" activeTab="'+h+'"/>',o[o.length]="</bookViews>"}for(o[o.length]="<sheets>",h=0;h!=a.SheetNames.length;++h){var f={name:Er(a.SheetNames[h].slice(0,31))};if(f.sheetId=""+(h+1),f["r:id"]="rId"+(h+1),u[h])switch(u[h].Hidden){case 1:f.state="hidden";break;case 2:f.state="veryHidden"}o[o.length]=Ze("sheet",null,f)}return o[o.length]="</sheets>",l&&(o[o.length]="<definedNames>",a.Workbook&&a.Workbook.Names&&a.Workbook.Names.forEach(function(d){var y={name:d.Name};d.Comment&&(y.comment=d.Comment),d.Sheet!=null&&(y.localSheetId=""+d.Sheet),d.Hidden&&(y.hidden="1"),d.Ref&&(o[o.length]=Ze("definedName",Er(d.Ref),y))}),o[o.length]="</definedNames>"),2<o.length&&(o[o.length]="</workbook>",o[1]=o[1].replace("/>",">")),o.join("")}function TS(a,o){var l={};return a.read_shift(4),l.ArchID=a.read_shift(4),a.l+=o-8,l}function ES(a,o){C(a,143);for(var l,c=0;c!=o.SheetNames.length;++c){var u={Hidden:o.Workbook&&o.Workbook.Sheets&&o.Workbook.Sheets[c]&&o.Workbook.Sheets[c].Hidden||0,iTabID:c+1,strRelID:"rId"+(c+1),name:o.SheetNames[c]};C(a,156,(l=u,(u=(u=void 0)||Ae(127)).write_shift(4,l.Hidden),u.write_shift(4,l.iTabID),rp(l.strRelID,u),Pn(l.name.slice(0,31),u),u.length>u.l?u.slice(0,u.l):u))}C(a,144)}function SS(a,o){if(o.Workbook&&o.Workbook.Sheets){for(var l,c=o.Workbook.Sheets,u=0,h=-1,f=-1;u<c.length;++u)!c[u]||!c[u].Hidden&&h==-1?h=u:c[u].Hidden==1&&f==-1&&(f=u);h<f||(C(a,135),C(a,158,(o=h,(l=l||Ae(29)).write_shift(-4,0),l.write_shift(-4,460),l.write_shift(4,28800),l.write_shift(4,17600),l.write_shift(4,500),l.write_shift(4,o),l.write_shift(4,o),l.write_shift(1,120),l.length>l.l?l.slice(0,l.l):l)),C(a,136))}}function AS(a,o){var l=A();return C(l,131),C(l,128,function(c){c=c||Ae(127);for(var u=0;u!=4;++u)c.write_shift(4,0);return Pn("SheetJS",c),Pn(n.version,c),Pn(n.version,c),Pn("7262",c),c.length>c.l?c.slice(0,c.l):c}()),C(l,153,function(c,u){u=u||Ae(72);var h=0;return c&&c.filterPrivacy&&(h|=8),u.write_shift(4,h),u.write_shift(4,0),ay(c&&c.CodeName||"ThisWorkbook",u),u.slice(0,u.l)}(a.Workbook&&a.Workbook.WBProps||null)),SS(l,a),ES(l,a),C(l,132),l.end()}function CS(a,o,l){return(o.slice(-4)===".bin"?function(c,u){var h={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},f=[],d=!1;(u=u||{}).biff=12;var y=[],v=[[]];return v.SheetNames=[],v.XTI=[],mu[16]={n:"BrtFRTArchID$",f:TS},g(c,function(b,_,T){switch(T){case 156:v.SheetNames.push(b.name),h.Sheets.push(b);break;case 153:h.WBProps=b;break;case 39:b.Sheet!=null&&(u.SID=b.Sheet),b.Ref=ds(b.Ptg,0,null,v,u),delete u.SID,delete b.Ptg,y.push(b);break;case 1036:break;case 357:case 358:case 355:case 667:v[0].length?v.push([T,b]):v[0]=[T,b],v[v.length-1].XTI=[];break;case 362:v.length===0&&(v[0]=[],v[0].XTI=[]),v[v.length-1].XTI=v[v.length-1].XTI.concat(b),v.XTI=v.XTI.concat(b);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:f.push(T),d=!0;break;case 36:f.pop(),d=!1;break;case 37:f.push(T),d=!0;break;case 38:f.pop(),d=!1;break;case 16:break;default:if(!_.T&&(!d||u.WTF&&f[f.length-1]!=37&&f[f.length-1]!=35))throw new Error("Unexpected record 0x"+T.toString(16))}},u),Nx(h),h.Names=y,h.supbooks=v,h}:function(c,u){if(!c)throw new Error("Could not find file");var h={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},f=!1,d="xmlns",y={},v=0;if(c.replace(vn,function(b,_){var T=Lt(b);switch(zs(T[0])){case"<?xml":break;case"<workbook":b.match(_S)&&(d="xmlns"+b.match(/<(\w+):/)[1]),h.xmlns=T[d];break;case"</workbook>":break;case"<fileVersion":delete T[0],h.AppVersion=T;break;case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Pp.forEach(function(S){if(T[S[0]]!=null)switch(S[2]){case"bool":h.WBProps[S[0]]=$r(T[S[0]]);break;case"int":h.WBProps[S[0]]=parseInt(T[S[0]],10);break;default:h.WBProps[S[0]]=T[S[0]]}}),T.codeName&&(h.WBProps.CodeName=kr(T.codeName));break;case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete T[0],h.WBView.push(T);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(T.state){case"hidden":T.Hidden=1;break;case"veryHidden":T.Hidden=2;break;default:T.Hidden=0}delete T.state,T.name=qt(kr(T.name)),delete T[0],h.Sheets.push(T);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":break;case"<definedNames>":case"<definedNames":f=!0;break;case"</definedNames>":f=!1;break;case"<definedName":(y={}).Name=kr(T.name),T.comment&&(y.Comment=T.comment),T.localSheetId&&(y.Sheet=+T.localSheetId),$r(T.hidden||"0")&&(y.Hidden=!0),v=_+b.length;break;case"</definedName>":y.Ref=qt(kr(c.slice(v,_))),h.Names.push(y);break;case"<definedName/>":break;case"<calcPr":case"<calcPr/>":delete T[0],h.CalcPr=T;break;case"</calcPr>":case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":f=!0;break;case"</ext>":f=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":f=!0;break;case"</AlternateContent>":f=!1;break;case"<revisionPtr":break;default:if(!f&&u.WTF)throw new Error("unrecognized "+T[0]+" in workbook")}return b}),Dr.indexOf(h.xmlns)===-1)throw new Error("Unknown Namespace: "+h.xmlns);return Nx(h),h})(a,l)}function kS(a,o,l,c,u,h,f,d){return(o.slice(-4)===".bin"?function(y,v,b,_,T,S,I){if(!y)return y;var k=v||{};_=_||{"!id":{}};var M,D,F,j,B,z,ae,he,le,ve,Ie=k.dense?[]:{},De={s:{r:2e6,c:2e6},e:{r:0,c:0}},_e=!1,Ue=!1,it=[];k.biff=12;var nt=k["!row"]=0,Ye=!1,Je=[],Ge={},je=k.supbooks||T.supbooks||[[]];if(je.sharedf=Ge,je.arrayf=Je,je.SheetNames=T.SheetNames||T.Sheets.map(function(Le){return Le.name}),!k.supbooks&&(k.supbooks=je,T.Names))for(var ht=0;ht<T.Names.length;++ht)je[0][ht+1]=T.Names[ht];var xt,Nt=[],Jt=[],lt=!1;return mu[16]={n:"BrtShortReal",f:Ax},g(y,function(Le,Ut,pr){if(!Ue)switch(pr){case 148:M=Le;break;case 0:D=Le,k.sheetRows&&k.sheetRows<=D.r&&(Ue=!0),le=tr(B=D.r),k["!row"]=D.r,(Le.hidden||Le.hpt||Le.level!=null)&&(Le.hpt&&(Le.hpx=Ol(Le.hpt)),Jt[Le.r]=Le);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(F={t:Le[2]},Le[2]){case"n":F.v=Le[1];break;case"s":he=fu[Le[1]],F.v=he.t,F.r=he.r;break;case"b":F.v=!!Le[1];break;case"e":F.v=Le[1],k.cellText!==!1&&(F.w=si[F.v]);break;case"str":F.t="s",F.v=Le[1];break;case"is":F.t="s",F.v=Le[1].t}if((j=I.CellXf[Le[0].iStyleRef])&&gx(F,j.numFmtId,null,k,S,I),z=Le[0].c==-1?z+1:Le[0].c,k.dense?(Ie[B]||(Ie[B]=[]),Ie[B][z]=F):Ie[Yt(z)+le]=F,k.cellFormula){for(Ye=!1,nt=0;nt<Je.length;++nt){var ar=Je[nt];D.r>=ar[0].s.r&&D.r<=ar[0].e.r&&z>=ar[0].s.c&&z<=ar[0].e.c&&(F.F=Bt(ar[0]),Ye=!0)}!Ye&&3<Le.length&&(F.f=Le[3])}De.s.r>D.r&&(De.s.r=D.r),De.s.c>z&&(De.s.c=z),De.e.r<D.r&&(De.e.r=D.r),De.e.c<z&&(De.e.c=z),k.cellDates&&j&&F.t=="n"&&Is(de[j.numFmtId])&&(Nr=Xe(F.v))&&(F.t="d",F.v=new Date(Nr.y,Nr.m-1,Nr.d,Nr.H,Nr.M,Nr.S,Nr.u)),xt&&(xt.type=="XLDAPR"&&(F.D=!0),xt=void 0);break;case 1:case 12:if(!k.sheetStubs||_e)break;F={t:"z",v:void 0},z=Le[0].c==-1?z+1:Le[0].c,k.dense?(Ie[B]||(Ie[B]=[]),Ie[B][z]=F):Ie[Yt(z)+le]=F,De.s.r>D.r&&(De.s.r=D.r),De.s.c>z&&(De.s.c=z),De.e.r<D.r&&(De.e.r=D.r),De.e.c<z&&(De.e.c=z),xt&&(xt.type=="XLDAPR"&&(F.D=!0),xt=void 0);break;case 176:it.push(Le);break;case 49:xt=((k.xlmeta||{}).Cell||[])[Le-1];break;case 494:var Nr=_["!id"][Le.relId];for(Nr?(Le.Target=Nr.Target,Le.loc&&(Le.Target+="#"+Le.loc),Le.Rel=Nr):Le.relId==""&&(Le.Target="#"+Le.loc),B=Le.rfx.s.r;B<=Le.rfx.e.r;++B)for(z=Le.rfx.s.c;z<=Le.rfx.e.c;++z)k.dense?(Ie[B]||(Ie[B]=[]),Ie[B][z]||(Ie[B][z]={t:"z",v:void 0}),Ie[B][z].l=Le):(ae=Pt({c:z,r:B}),Ie[ae]||(Ie[ae]={t:"z",v:void 0}),Ie[ae].l=Le);break;case 426:if(!k.cellFormula)break;Je.push(Le),(ve=k.dense?Ie[B][z]:Ie[Yt(z)+le]).f=ds(Le[1],0,{r:D.r,c:z},je,k),ve.F=Bt(Le[0]);break;case 427:if(!k.cellFormula)break;Ge[Pt(Le[0].s)]=Le[1],(ve=k.dense?Ie[B][z]:Ie[Yt(z)+le]).f=ds(Le[1],0,{r:D.r,c:z},je,k);break;case 60:if(!k.cellStyles)break;for(;Le.e>=Le.s;)Nt[Le.e--]={width:Le.w/256,hidden:!!(1&Le.flags),level:Le.level},lt||(lt=!0,Ep(Le.w/256)),Ui(Nt[Le.e+1]);break;case 161:Ie["!autofilter"]={ref:Bt(Le)};break;case 476:Ie["!margins"]=Le;break;case 147:T.Sheets[b]||(T.Sheets[b]={}),Le.name&&(T.Sheets[b].CodeName=Le.name),(Le.above||Le.left)&&(Ie["!outline"]={above:Le.above,left:Le.left});break;case 137:T.Views||(T.Views=[{}]),T.Views[0]||(T.Views[0]={}),Le.RTL&&(T.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:_e=!0;break;case 36:_e=!1;break;case 37:_e=!0;break;case 38:_e=!1;break;default:if(!Ut.T&&(!_e||k.WTF))throw new Error("Unexpected record 0x"+pr.toString(16))}},k),delete k.supbooks,delete k["!row"],!Ie["!ref"]&&(De.s.r<2e6||M&&(0<M.e.r||0<M.e.c||0<M.s.r||0<M.s.c))&&(Ie["!ref"]=Bt(M||De)),k.sheetRows&&Ie["!ref"]&&(y=nr(Ie["!ref"]),k.sheetRows<=+y.e.r&&(y.e.r=k.sheetRows-1,y.e.r>De.e.r&&(y.e.r=De.e.r),y.e.r<y.s.r&&(y.s.r=y.e.r),y.e.c>De.e.c&&(y.e.c=De.e.c),y.e.c<y.s.c&&(y.s.c=y.e.c),Ie["!fullref"]=Ie["!ref"],Ie["!ref"]=Bt(y))),0<it.length&&(Ie["!merges"]=it),0<Nt.length&&(Ie["!cols"]=Nt),0<Jt.length&&(Ie["!rows"]=Jt),Ie}:eS)(a,c,l,u,h,f,d)}function FS(a,o,l,c,u,h){return o.slice(-4)===".bin"?function(f,d,y,v,b){if(!f)return f;v=v||{"!id":{}};var _={"!type":"chart","!drawel":null,"!rel":""},T=!1;return g(f,function(S,I,k){switch(k){case 550:_["!rel"]=S;break;case 651:b.Sheets[y]||(b.Sheets[y]={}),S.name&&(b.Sheets[y].CodeName=S.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:T=!0;break;case 36:T=!1;break;case 37:break;case 38:break;default:if(!(0<I.T)){if(!(I.T<0)){if(!T||d.WTF)throw new Error("Unexpected record 0x"+k.toString(16))}}}},d),v["!id"][_["!rel"]]&&(_["!drawel"]=v["!id"][_["!rel"]]),_}(a,c,l,u,h):function(f,d,y,v){if(!f)return f;y=y||{"!id":{}};var b={"!type":"chart","!drawel":null,"!rel":""},_=f.match(yx);return _&&Rp(_[0],0,v,d),(f=f.match(/drawing r:id="(.*?)"/))&&(b["!rel"]=f[1]),y["!id"][b["!rel"]]&&(b["!drawel"]=y["!id"][b["!rel"]]),b}(a,l,u,h)}function NS(a,o,l,c){return(o.slice(-4)===".bin"?function(u,h,f){var d,y={NumberFmt:[]};for(d in de)y.NumberFmt[d]=de[d];y.CellXf=[],y.Fonts=[];var v=[],b=!1;return g(u,function(_,T,S){switch(S){case 44:y.NumberFmt[_[0]]=_[1],Vr(_[1],_[0]);break;case 43:y.Fonts.push(_),_.color.theme!=null&&h&&h.themeElements&&h.themeElements.clrScheme&&(_.color.rgb=Ch(h.themeElements.clrScheme[_.color.theme].rgb,_.color.tint||0));break;case 1025:case 45:case 46:break;case 47:v[v.length-1]==617&&y.CellXf.push(_);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:b=!0;break;case 36:b=!1;break;case 37:v.push(S),b=!0;break;case 38:v.pop(),b=!1;break;default:if(0<T.T)v.push(S);else if(T.T<0)v.pop();else if(!b||f.WTF&&v[v.length-1]!=37)throw new Error("Unexpected record 0x"+S.toString(16))}}),y}:c5)(a,l,c)}function IS(a,o,l){return o.slice(-4)===".bin"?(c=l,h=!(u=[]),g(a,function(f,d,y){switch(y){case 159:u.Count=f[0],u.Unique=f[1];break;case 19:u.push(f);break;case 160:return 1;case 35:h=!0;break;case 36:h=!1;break;default:if(d.T,!h||c.WTF)throw new Error("Unexpected record 0x"+y.toString(16))}}),u):function(f,d){var y=[],v="";if(!f)return y;if(f=f.match(Y6)){v=f[2].replace(Q6,"").split(X6);for(var b=0;b!=v.length;++b){var _=bp(v[b].trim(),d);_!=null&&(y[y.length]=_)}f=Lt(f[1]),y.Count=f.count,y.Unique=f.uniqueCount}return y}(a,l);var c,u,h}function DS(a,o,l){return o.slice(-4)===".bin"?(c=l,u=[],h=[],d=!(f={}),g(a,function(y,v,b){switch(b){case 632:h.push(y);break;case 635:f=y;break;case 637:f.t=y.t,f.h=y.h,f.r=y.r;break;case 636:if(f.author=h[f.iauthor],delete f.iauthor,c.sheetRows&&f.rfx&&c.sheetRows<=f.rfx.r)break;f.t||(f.t=""),delete f.rfx,u.push(f);break;case 3072:break;case 35:d=!0;break;case 36:d=!1;break;case 37:case 38:break;default:if(!v.T&&(!d||c.WTF))throw new Error("Unexpected record 0x"+b.toString(16))}}),u):function(y,v){if(y.match(/<(?:\w+:)?comments *\/>/))return[];var b=[],_=[],T=y.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);return T&&T[1]&&T[1].split(/<\/\w*:?author>/).forEach(function(S){S===""||S.trim()===""||(S=S.match(/<(?:\w+:)?author[^>]*>(.*)/))&&b.push(S[1])}),(y=y.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/))&&y[1]&&y[1].split(/<\/\w*:?comment>/).forEach(function(S){var I,k;S===""||S.trim()===""||(I=S.match(/<(?:\w+:)?comment[^>]*>/))&&(I={author:(k=Lt(I[0])).authorId&&b[k.authorId]||"sheetjsghost",ref:k.ref,guid:k.guid},k=rr(k.ref),v.sheetRows&&v.sheetRows<=k.r||(S=!!(S=S.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/))&&!!S[1]&&bp(S[1])||{r:"",t:"",h:""},I.r=S.r,S.r=="<t></t>"&&(S.t=S.h=""),I.t=(S.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),v.cellHTML&&(I.h=S.h),_.push(I)))}),_}(a,l);var c,u,h,f,d}function RS(a,o){return o.slice(-4)===".bin"?(l=[],g(a,function(c,u,h){if(h===63)l.push(c);else if(!u.T)throw new Error("Unexpected record 0x"+h.toString(16))}),l):function(c){var u=[];if(!c)return u;var h=1;return(c.match(vn)||[]).forEach(function(f){var d=Lt(f);switch(d[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete d[0],d.i?h=d.i:d.i=h,u.push(d)}}),u}(a);var l}function PS(a,o,l,c){if(l.slice(-4)===".bin")return function(u,h){if(!u)return u;var f=h||{},d=!1;g(u,function(y,v,b){switch(b){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:d=!0;break;case 36:d=!1;break;default:if(!v.T&&(!d||f.WTF))throw new Error("Unexpected record 0x"+b.toString(16))}},f)}(a,c)}function OS(a,o,l){return o.slice(-4)===".bin"?(c={Types:[],Cell:[],Value:[]},u=l||{},f=!(h=[]),d=2,g(a,function(y,v,b){switch(b){case 335:c.Types.push({name:y.name});break;case 51:y.forEach(function(_){d==1?c.Cell.push({type:c.Types[_[0]-1].name,index:_[1]}):d==0&&c.Value.push({type:c.Types[_[0]-1].name,index:_[1]})});break;case 337:d=y?1:0;break;case 338:d=2;break;case 35:h.push(b),f=!0;break;case 36:h.pop(),f=!1;break;default:if(!v.T&&(!f||u.WTF&&h[h.length-1]!=35))throw new Error("Unexpected record 0x"+b.toString(16))}}),c):function(y,v){var b={Types:[],Cell:[],Value:[]};if(!y)return b;var _,T=!1,S=2;return y.replace(vn,function(I){var k=Lt(I);switch(zs(k[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":b.Types.push({name:k.name});break;case"</metadataType>":break;case"<futureMetadata":for(var M=0;M<b.Types.length;++M)b.Types[M].name==k.name&&(_=b.Types[M]);break;case"</futureMetadata>":case"<bk>":case"</bk>":break;case"<rc":S==1?b.Cell.push({type:b.Types[k.t-1].name,index:+k.v}):S==0&&b.Value.push({type:b.Types[k.t-1].name,index:+k.v});break;case"</rc>":break;case"<cellMetadata":S=1;break;case"</cellMetadata>":S=2;break;case"<valueMetadata":S=0;break;case"</valueMetadata>":S=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":T=!0;break;case"</ext>":T=!1;break;case"<rvb":if(!_)break;_.offsets||(_.offsets=[]),_.offsets.push(+k.i);break;default:if(!T&&v.WTF)throw new Error("unrecognized "+k[0]+" in metadata")}return I}),b}(a,l);var c,u,h,f,d}var du,Px=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Ox=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ga(a,o){var l=a.split(/\s+/),c=[];if(c[0]=l[0],l.length===1)return c;var u,h,f,d=a.match(Px);if(d)for(f=0;f!=d.length;++f)(h=(u=d[f].match(Ox))[1].indexOf(":"))===-1?c[u[1]]=u[2].slice(1,u[2].length-1):c[u[1].slice(0,6)==="xmlns:"?"xmlns"+u[1].slice(6):u[1].slice(h+1)]=u[2].slice(1,u[2].length-1);return c}function jS(a,o,l){if(a.t!=="z"){if(!l||l.cellText!==!1)try{a.t==="e"?a.w=a.w||si[a.v]:o==="General"?a.t==="n"?(0|a.v)===a.v?a.w=a.v.toString(10):a.w=Rr(a.v):a.w=er(a.v):a.w=(c=o||"General",u=a.v,(c=du[c]||qt(c))==="General"?er(u):Rt(c,u))}catch(f){if(l.WTF)throw f}var c,u;try{var h=du[o]||o||"General";l.cellNF&&(a.z=h),l.cellDates&&a.t=="n"&&Is(h)&&(h=Xe(a.v))&&(a.t="d",a.v=new Date(h.y,h.m-1,h.d,h.H,h.M,h.S,h.u))}catch(f){if(l.WTF)throw f}}}function Op(a,o){var l=o||{};Rs();var c,u=ne(ei(a)),h=(u=l.type=="binary"||l.type=="array"||l.type=="base64"?e!==void 0?e.utils.decode(65001,q(u)):kr(u):u).slice(0,1024).toLowerCase(),f=!1;if((1023&(h=h.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&h.indexOf(","),1023&h.indexOf(";"))){var d=Tr(l);return d.type="string",Dl.to_workbook(u,d)}if(h.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(re){0<=h.indexOf("<"+re)&&(f=!0)}),f)return function(re,Me){if(re=re.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi),!re||re.length==0)throw new Error("Invalid HTML: could not find <table>");if(re.length==1)return Li(Lx(re[0],Me),Me);var be=Yp();return re.forEach(function(Se,ge){Qp(be,Lx(Se,Me),"Sheet"+(ge+1))}),be}(u,l);du={"General Number":"General","General Date":de[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":de[15],"Short Date":de[14],"Long Time":de[19],"Medium Time":de[18],"Short Time":de[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:de[2],Standard:de[4],Percent:de[10],Scientific:de[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var y,v=[],b,_={},T=[],S=l.dense?[]:{},I="",k={},M={},D=ga('<Data ss:Type="String">'),F=0,j=0,B=0,z={s:{r:2e6,c:2e6},e:{r:0,c:0}},ae={},he={},le="",ve=0,Ie=[],De={},_e={},Ue=0,it=[],nt=[],Ye={},Je=[],Ge=!1,je=[],ht=[],xt={},Nt=0,Jt=0,lt={Sheets:[],WBProps:{date1904:!1}},Le={};Ri.lastIndex=0,u=u.replace(/<!--([\s\S]*?)-->/gm,"");for(var Ut,pr,ar,Nr,un="";c=Ri.exec(u);)switch(c[3]=(un=c[3]).toLowerCase()){case"data":if(un=="data"){if(c[1]==="/"){if((y=v.pop())[0]!==c[3])throw new Error("Bad state: "+y.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&v.push([c[3],!0]);break}if(v[v.length-1][1])break;c[1]==="/"?function(re,Me,be,Se,ge,ke,We,_t,ut,st){var gt="General",St=Se.StyleID,At={};st=st||{};var et=[],ze=0;for((St=St===void 0&&_t?_t.StyleID:St)===void 0&&We&&(St=We.StyleID);ke[St]!==void 0&&(ke[St].nf&&(gt=ke[St].nf),ke[St].Interior&&et.push(ke[St].Interior),ke[St].Parent);)St=ke[St].Parent;switch(be.Type){case"Boolean":Se.t="b",Se.v=$r(re);break;case"String":Se.t="s",Se.r=Zf(qt(re)),Se.v=-1<re.indexOf("<")?qt(Me||re).replace(/<.*?>/g,""):Se.r;break;case"DateTime":re.slice(-1)!="Z"&&(re+="Z"),Se.v=(Ur(re)-new Date(Date.UTC(1899,11,30)))/864e5,Se.v!=Se.v?Se.v=qt(re):Se.v<60&&(Se.v=Se.v-1),gt&&gt!="General"||(gt="yyyy-mm-dd");case"Number":Se.v===void 0&&(Se.v=+re),Se.t||(Se.t="n");break;case"Error":Se.t="e",Se.v=hy[re],st.cellText!==!1&&(Se.w=re);break;default:re==""&&Me==""?Se.t="z":(Se.t="s",Se.v=Zf(Me||re))}if(jS(Se,gt,st),st.cellFormula!==!1)if(Se.Formula)be=qt(Se.Formula),be.charCodeAt(0)==61&&(be=be.slice(1)),Se.f=Ml(be,ge),delete Se.Formula,Se.ArrayRange=="RC"?Se.F=Ml("RC:RC",ge):Se.ArrayRange&&(Se.F=Ml(Se.ArrayRange,ge),ut.push([nr(Se.F),Se.F]));else for(ze=0;ze<ut.length;++ze)ge.r>=ut[ze][0].s.r&&ge.r<=ut[ze][0].e.r&&ge.c>=ut[ze][0].s.c&&ge.c<=ut[ze][0].e.c&&(Se.F=ut[ze][1]);st.cellStyles&&(et.forEach(function(kt){!At.patternType&&kt.patternType&&(At.patternType=kt.patternType)}),Se.s=At),Se.StyleID!==void 0&&(Se.ixfe=Se.StyleID)}(u.slice(F,c.index),le,D,v[v.length-1][0]=="comment"?Ye:k,{c:j,r:B},ae,Je[j],M,je,l):(le="",D=ga(c[0]),F=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(0<nt.length&&(k.c=nt),(!l.sheetRows||l.sheetRows>B)&&k.v!==void 0&&(l.dense?(S[B]||(S[B]=[]),S[B][j]=k):S[Yt(j)+tr(B)]=k),k.HRef&&(k.l={Target:qt(k.HRef)},k.HRefScreenTip&&(k.l.Tooltip=k.HRefScreenTip),delete k.HRef,delete k.HRefScreenTip),(k.MergeAcross||k.MergeDown)&&(Nt=j+(0|parseInt(k.MergeAcross,10)),Jt=B+(0|parseInt(k.MergeDown,10)),Ie.push({s:{c:j,r:B},e:{c:Nt,r:Jt}})),l.sheetStubs)if(k.MergeAcross||k.MergeDown){for(var ie=j;ie<=Nt;++ie)for(var Ir=B;Ir<=Jt;++Ir)(j<ie||B<Ir)&&(l.dense?(S[Ir]||(S[Ir]=[]),S[Ir][ie]={t:"z"}):S[Yt(ie)+tr(Ir)]={t:"z"});j=Nt+1}else++j;else k.MergeAcross?j=Nt+1:++j;else(j=(k=function(re){var Me={};if(re.split(/\s+/).length===1)return Me;var be,Se,ge,ke=re.match(Px);if(ke)for(ge=0;ge!=ke.length;++ge)(Se=(be=ke[ge].match(Ox))[1].indexOf(":"))===-1?Me[be[1]]=be[2].slice(1,be[2].length-1):Me[be[1].slice(0,6)==="xmlns:"?"xmlns"+be[1].slice(6):be[1].slice(Se+1)]=be[2].slice(1,be[2].length-1);return Me}(c[0])).Index?+k.Index-1:j)<z.s.c&&(z.s.c=j),j>z.e.c&&(z.e.c=j),c[0].slice(-2)==="/>"&&++j,nt=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(B<z.s.r&&(z.s.r=B),B>z.e.r&&(z.e.r=B),c[0].slice(-2)==="/>"&&(M=ga(c[0])).Index&&(B=+M.Index-1),j=0,++B):((M=ga(c[0])).Index&&(B=+M.Index-1),xt={},M.AutoFitHeight!="0"&&!M.Height||(xt.hpx=parseInt(M.Height,10),xt.hpt=au(xt.hpx),ht[B]=xt),M.Hidden=="1"&&(xt.hidden=!0,ht[B]=xt));break;case"worksheet":if(c[1]==="/"){if((y=v.pop())[0]!==c[3])throw new Error("Bad state: "+y.join("|"));T.push(I),z.s.r<=z.e.r&&z.s.c<=z.e.c&&(S["!ref"]=Bt(z),l.sheetRows&&l.sheetRows<=z.e.r&&(S["!fullref"]=S["!ref"],z.e.r=l.sheetRows-1,S["!ref"]=Bt(z))),Ie.length&&(S["!merges"]=Ie),0<Je.length&&(S["!cols"]=Je),0<ht.length&&(S["!rows"]=ht),_[I]=S}else z={s:{r:2e6,c:2e6},e:{r:0,c:0}},B=j=0,v.push([c[3],!1]),y=ga(c[0]),I=qt(y.Name),S=l.dense?[]:{},Ie=[],je=[],ht=[],Le={name:I,Hidden:0},lt.Sheets.push(Le);break;case"table":if(c[1]==="/"){if((y=v.pop())[0]!==c[3])throw new Error("Bad state: "+y.join("|"))}else{if(c[0].slice(-2)=="/>")break;v.push([c[3],!1]),Ge=!(Je=[])}break;case"style":c[1]==="/"?(pr=ae,ar=he,(Nr=l).cellStyles&&(!ar.Interior||(Nr=ar.Interior).Pattern&&(Nr.patternType=l5[Nr.Pattern]||Nr.Pattern)),pr[ar.ID]=ar):he=ga(c[0]);break;case"numberformat":he.nf=qt(ga(c[0]).Format||"General"),du[he.nf]&&(he.nf=du[he.nf]);for(var Sr=0;Sr!=392&&de[Sr]!=he.nf;++Sr);if(Sr==392){for(Sr=57;Sr!=392;++Sr)if(de[Sr]==null){Vr(he.nf,Sr);break}}break;case"column":if(v[v.length-1][0]!=="table")break;if((b=ga(c[0])).Hidden&&(b.hidden=!0,delete b.Hidden),b.Width&&(b.wpx=parseInt(b.Width,10)),!Ge&&10<b.wpx){Ge=!0,Zn=Vv;for(var Nn=0;Nn<Je.length;++Nn)Je[Nn]&&Ui(Je[Nn])}Ge&&Ui(b),Je[b.Index-1||Je.length]=b;for(var ea=0;ea<+b.Span;++ea)Je[Je.length]=Tr(b);break;case"namedrange":if(c[1]==="/")break;lt.Names||(lt.Names=[]);var Q=Lt(c[0]),Te={Name:Q.Name,Ref:Ml(Q.RefersTo.slice(1),{r:0,c:0})};0<lt.Sheets.length&&(Te.Sheet=lt.Sheets.length-1),lt.Names.push(Te);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?le+=u.slice(ve,c.index):ve=c.index+c[0].length;break;case"interior":if(!l.cellStyles)break;he.Interior=ga(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?(ar=De,Q=un,Te=u.slice(Ue,c.index),ar[Q=(_y=_y||wo(up))[Q]||Q]=Te):Ue=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((y=v.pop())[0]!==c[3])throw new Error("Bad state: "+y.join("|"))}else v.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((y=v.pop())[0]!==c[3])throw new Error("Bad state: "+y.join("|"));(Ut=Ye).t=Ut.v||"",Ut.t=Ut.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),Ut.v=Ut.w=Ut.ixfe=void 0,nt.push(Ye)}else v.push([c[3],!1]),Ye={a:(y=ga(c[0])).Author};break;case"autofilter":if(c[1]==="/"){if((y=v.pop())[0]!==c[3])throw new Error("Bad state: "+y.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&(Ut=ga(c[0]),S["!autofilter"]={ref:Ml(Ut.Range).replace(/\$/g,"")},v.push([c[3],!0]));break;case"name":break;case"datavalidation":if(c[1]==="/"){if((y=v.pop())[0]!==c[3])throw new Error("Bad state: "+y.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&v.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((y=v.pop())[0]!==c[3])throw new Error("Bad state: "+y.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&v.push([c[3],!0]);break;case"null":break;default:if(v.length==0&&c[3]=="document"||v.length==0&&c[3]=="uof")return Qx(u,l);var se=!0;switch(v[v.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:se=!1}break;case"componentoptions":switch(c[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:se=!1}break;case"excelworkbook":switch(c[3]){case"date1904":lt.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:se=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":case"height":case"width":break;default:se=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(u.slice(Ue,c.index)){case"SheetHidden":Le.Hidden=1;break;case"SheetVeryHidden":Le.Hidden=2}else Ue=c.index+c[0].length;break;case"header":S["!margins"]||Lo(S["!margins"]={},"xlml"),isNaN(+Lt(c[0]).Margin)||(S["!margins"].header=+Lt(c[0]).Margin);break;case"footer":S["!margins"]||Lo(S["!margins"]={},"xlml"),isNaN(+Lt(c[0]).Margin)||(S["!margins"].footer=+Lt(c[0]).Margin);break;case"pagemargins":var xe=Lt(c[0]);S["!margins"]||Lo(S["!margins"]={},"xlml"),isNaN(+xe.Top)||(S["!margins"].top=+xe.Top),isNaN(+xe.Left)||(S["!margins"].left=+xe.Left),isNaN(+xe.Right)||(S["!margins"].right=+xe.Right),isNaN(+xe.Bottom)||(S["!margins"].bottom=+xe.Bottom);break;case"displayrighttoleft":lt.Views||(lt.Views=[]),lt.Views[0]||(lt.Views[0]={}),lt.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":break;case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":break;case"nosummaryrowsbelowdetail":S["!outline"]||(S["!outline"]={}),S["!outline"].above=!0;break;case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":S["!outline"]||(S["!outline"]={}),S["!outline"].left=!0;break;case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;default:se=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:se=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:se=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:se=!1}break;case"querytable":switch(c[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:se=!1}break;case"datavalidation":switch(c[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:se=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:se=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:se=!1}break;case"smarttags":break;default:se=!1}if(se||c[3].match(/!\[CDATA/))break;if(!v[v.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+v.join("|");if(v[v.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?function(re,Me,be,Se){var ge=Se;switch((be[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":ge=$r(Se);break;case"i2":case"int":ge=parseInt(Se,10);break;case"r4":case"float":ge=parseFloat(Se);break;case"date":case"dateTime.tz":ge=Ur(Se);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+be[0])}re[qt(Me)]=ge}(_e,un,it,u.slice(Ue,c.index)):Ue=(it=c).index+c[0].length;break}if(l.WTF)throw"Unrecognized tag: "+c[3]+"|"+v.join("|")}return d={},l.bookSheets||l.bookProps||(d.Sheets=_),d.SheetNames=T,d.Workbook=lt,d.SSF=Tr(de),d.Props=De,d.Custprops=_e,d}function jp(a,o){switch($p(o=o||{}),o.type||"base64"){case"base64":return Op(ee(a),o);case"binary":case"buffer":case"file":return Op(a,o);case"array":return Op(J(a),o)}}function MS(a,o){var l,c,u,h,f,d,y,v=[];return a.Props&&v.push((l=a.Props,c=o,u=[],Gr(up).map(function(b){for(var _=0;_<Ys.length;++_)if(Ys[_][1]==b)return Ys[_];for(_=0;_<Ro.length;++_)if(Ro[_][1]==b)return Ro[_];throw b}).forEach(function(b){var _;l[b[1]]!=null&&(_=(c&&c.Props&&c.Props[b[1]]!=null?c.Props:l)[b[1]],typeof(_=b[2]==="date"?new Date(_).toISOString().replace(/\.\d*Z/,"Z"):_)=="number"?_=String(_):_===!0||_===!1?_=_?"1":"0":_ instanceof Date&&(_=new Date(_).toISOString().replace(/\.\d*Z/,"")),u.push(cn(up[b[1]]||b[1],_)))}),Ze("DocumentProperties",u.join(""),{xmlns:fs.o}))),a.Custprops&&v.push((h=a.Props,f=a.Custprops,d=["Worksheets","SheetNames"],a="CustomDocumentProperties",y=[],h&&Gr(h).forEach(function(b){if(Object.prototype.hasOwnProperty.call(h,b)){for(var _=0;_<Ys.length;++_)if(b==Ys[_][1])return;for(_=0;_<Ro.length;++_)if(b==Ro[_][1])return;for(_=0;_<d.length;++_)if(b==d[_])return;var T="string",S=typeof(S=h[b])=="number"?(T="float",String(S)):S===!0||S===!1?(T="boolean",S?"1":"0"):String(S);y.push(Ze(Br(b),S,{"dt:dt":T}))}}),f&&Gr(f).forEach(function(b){var _,T;Object.prototype.hasOwnProperty.call(f,b)&&(h&&Object.prototype.hasOwnProperty.call(h,b)||(_="string",T=typeof(T=f[b])=="number"?(_="float",String(T)):T===!0||T===!1?(_="boolean",T?"1":"0"):T instanceof Date?(_="dateTime.tz",T.toISOString()):String(T),y.push(Ze(Br(b),T,{"dt:dt":_}))))}),"<"+a+' xmlns="'+fs.o+'">'+y.join("")+"</"+a+">")),v.join("")}function jx(a){return Ze("NamedRange",null,{"ss:Name":a.Name,"ss:RefersTo":"="+kp(a.Ref,{r:0,c:0})})}function LS(a,o,l,c,u,h,f){if(!a||a.v==null&&a.f==null)return"";var d={};if(a.f&&(d["ss:Formula"]="="+Er(kp(a.f,f))),a.F&&a.F.slice(0,o.length)==o&&(o=rr(a.F.slice(o.length+1)),d["ss:ArrayRange"]="RC:R"+(o.r==f.r?"":"["+(o.r-f.r)+"]")+"C"+(o.c==f.c?"":"["+(o.c-f.c)+"]")),a.l&&a.l.Target&&(d["ss:HRef"]=Er(a.l.Target),a.l.Tooltip&&(d["x:HRefScreenTip"]=Er(a.l.Tooltip))),l["!merges"])for(var y=l["!merges"],v=0;v!=y.length;++v)y[v].s.c==f.c&&y[v].s.r==f.r&&(y[v].e.c>y[v].s.c&&(d["ss:MergeAcross"]=y[v].e.c-y[v].s.c),y[v].e.r>y[v].s.r&&(d["ss:MergeDown"]=y[v].e.r-y[v].s.r));var b="",_="";switch(a.t){case"z":if(!c.sheetStubs)return"";break;case"n":b="Number",_=String(a.v);break;case"b":b="Boolean",_=a.v?"1":"0";break;case"e":b="Error",_=si[a.v];break;case"d":b="DateTime",_=new Date(a.v).toISOString(),a.z==null&&(a.z=a.z||de[14]);break;case"s":b="String",_=((a.v||"")+"").replace(Ii,function(T){return pa[T]}).replace(To,function(T){return"&#x"+T.charCodeAt(0).toString(16).toUpperCase()+";"})}return l=$i(c.cellXfs,a,c),d["ss:StyleID"]="s"+(21+l),d["ss:Index"]=f.c+1,l=a.v!=null?_:"",l=a.t=="z"?"":'<Data ss:Type="'+b+'">'+l+"</Data>",0<(a.c||[]).length&&(l+=a.c.map(function(T){var S=Ze("ss:Data",(T.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return Ze("Comment",S,{"ss:Author":T.a})}).join("")),Ze("Cell",l,d)}function VS(a,o){if(!a["!ref"])return"";var l=nr(a["!ref"]),c=a["!merges"]||[],u=0,h=[];a["!cols"]&&a["!cols"].forEach(function(M,B){Ui(M);var F=!!M.width,j=Rh(B,M),B={"ss:Index":B+1};F&&(B["ss:Width"]=nu(j.width)),M.hidden&&(B["ss:Hidden"]="1"),h.push(Ze("Column",null,B))});for(var f,d,y=Array.isArray(a),v=l.s.r;v<=l.e.r;++v){for(var b=[(f=v,d=(a["!rows"]||[])[v],f='<Row ss:Index="'+(f+1)+'"',d&&(d.hpt&&!d.hpx&&(d.hpx=Ol(d.hpt)),d.hpx&&(f+=' ss:AutoFitHeight="0" ss:Height="'+d.hpx+'"'),d.hidden&&(f+=' ss:Hidden="1"')),f+">")],_=l.s.c;_<=l.e.c;++_){for(var T,S,I,k=!1,u=0;u!=c.length;++u)if(!(c[u].s.c>_||c[u].s.r>v||c[u].e.c<_||c[u].e.r<v)){c[u].s.c==_&&c[u].s.r==v||(k=!0);break}k||(S=Pt(T={r:v,c:_}),I=y?(a[v]||[])[_]:a[S],b.push(LS(I,S,a,o,0,0,T)))}b.push("</Row>"),2<b.length&&h.push(b.join(""))}return h.join("")}function US(a,o,l){var c=[],h=l.SheetNames[a],u=l.Sheets[h],h=u?function(f,d,y){if(!f||!((y||{}).Workbook||{}).Names)return"";for(var v=y.Workbook.Names,b=[],_=0;_<v.length;++_){var T=v[_];T.Sheet==d&&(T.Name.match(/^_xlfn\./)||b.push(jx(T)))}return b.join("")}(u,a,l):"";return 0<h.length&&c.push("<Names>"+h+"</Names>"),0<(h=u?VS(u,o):"").length&&c.push("<Table>"+h+"</Table>"),c.push(function(f,d,y){if(!f)return"";var v=[];if(f["!margins"]&&(v.push("<PageSetup>"),f["!margins"].header&&v.push(Ze("Header",null,{"x:Margin":f["!margins"].header})),f["!margins"].footer&&v.push(Ze("Footer",null,{"x:Margin":f["!margins"].footer})),v.push(Ze("PageMargins",null,{"x:Bottom":f["!margins"].bottom||"0.75","x:Left":f["!margins"].left||"0.7","x:Right":f["!margins"].right||"0.7","x:Top":f["!margins"].top||"0.75"})),v.push("</PageSetup>")),y&&y.Workbook&&y.Workbook.Sheets&&y.Workbook.Sheets[d])if(y.Workbook.Sheets[d].Hidden)v.push(Ze("Visible",y.Workbook.Sheets[d].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var b=0;b<d&&(!y.Workbook.Sheets[b]||y.Workbook.Sheets[b].Hidden);++b);b==d&&v.push("<Selected/>")}return((((y||{}).Workbook||{}).Views||[])[0]||{}).RTL&&v.push("<DisplayRightToLeft/>"),f["!protect"]&&(v.push(cn("ProtectContents","True")),f["!protect"].objects&&v.push(cn("ProtectObjects","True")),f["!protect"].scenarios&&v.push(cn("ProtectScenarios","True")),f["!protect"].selectLockedCells==null||f["!protect"].selectLockedCells?f["!protect"].selectUnlockedCells==null||f["!protect"].selectUnlockedCells||v.push(cn("EnableSelection","UnlockedCells")):v.push(cn("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(_){f["!protect"][_[0]]&&v.push("<"+_[1]+"/>")})),v.length==0?"":Ze("WorksheetOptions",v.join(""),{xmlns:fs.x})}(u,a,l)),c.join("")}function BS(a,o){o=o||{},a.SSF||(a.SSF=Tr(de)),a.SSF&&(Rs(),Ds(a.SSF),o.revssf=yn(a.SSF),o.revssf[a.SSF[65535]]=0,o.ssf=a.SSF,o.cellXfs=[],$i(o.cellXfs,{},{revssf:{General:0}}));var l=[];l.push(MS(a,o)),l.push(""),l.push(""),l.push("");for(var c,u=0;u<a.SheetNames.length;++u)l.push(Ze("Worksheet",US(u,o,a),{"ss:Name":Er(a.SheetNames[u])}));return l[2]=(c=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'],o.cellXfs.forEach(function(h,f){var d=[];d.push(Ze("NumberFormat",null,{"ss:Format":Er(de[h.numFmtId])})),f={"ss:ID":"s"+(21+f)},c.push(Ze("Style",d.join(""),f))}),Ze("Styles",c.join(""))),l[3]=function(h){if(!((h||{}).Workbook||{}).Names)return"";for(var f=h.Workbook.Names,d=[],y=0;y<f.length;++y){var v=f[y];v.Sheet==null&&(v.Name.match(/^_xlfn\./)||d.push(jx(v)))}return Ze("Names",d.join(""))}(a),Zr+Ze("Workbook",l.join(""),{xmlns:fs.ss,"xmlns:o":fs.o,"xmlns:x":fs.x,"xmlns:ss":fs.ss,"xmlns:dt":fs.dt,"xmlns:html":fs.html})}function $S(a){var o={},l=a.content;return l.l=28,o.AnsiUserType=l.read_shift(0,"lpstr-ansi"),o.AnsiClipboardFormat=ly(l,1),l.length-l.l<=4?o:(a=l.read_shift(4),a==0||40<a?o:(l.l-=4,o.Reserved1=l.read_shift(0,"lpstr-ansi"),l.length-l.l<=4||(a=l.read_shift(4))!==1907505652?o:(o.UnicodeClipboardFormat=ly(l,2),(a=l.read_shift(4))==0||40<a?o:(l.l-=4,void(o.Reserved2=l.read_shift(0,"lpwstr"))))))}var WS=[60,1084,2066,2165,2175];function Ma(a,o,l){if(a.t!=="z"&&a.XF){var c,u=0;try{u=a.z||a.XF.numFmtId||0,o.cellNF&&(a.z=de[u])}catch(h){if(o.WTF)throw h}if(!o||o.cellText!==!1)try{a.t==="e"?a.w=a.w||si[a.v]:u===0||u=="General"?a.t==="n"?(0|a.v)===a.v?a.w=a.v.toString(10):a.w=Rr(a.v):a.w=er(a.v):a.w=Rt(u,a.v,{date1904:!!l,dateNF:o&&o.dateNF})}catch(h){if(o.WTF)throw h}o.cellDates&&u&&a.t=="n"&&Is(de[u]||String(u))&&(c=Xe(a.v))&&(a.t="d",a.v=new Date(c.y,c.m-1,c.d,c.H,c.M,c.S,c.u))}}function Oh(a,o,l){return{v:a,ixfe:o,t:l}}function zS(a,o){var l={opts:{}},c={};function u(ge){return!(ge<8)&&ge<64&&ae[ge-8]||Qc[ge]}function h(ge,ke,We){if(!(1<Ge||We.sheetRows&&ge.r>=We.sheetRows)){var _t,ut,st;if(We.cellStyles&&ke.XF&&ke.XF.data&&(ut=We,(st=(_t=ke).XF.data)&&st.patternType&&ut&&ut.cellStyles&&(_t.s={},_t.s.patternType=st.patternType,(ut=ru(u(st.icvFore)))&&(_t.s.fgColor={rgb:ut}),(ut=ru(u(st.icvBack)))&&(_t.s.bgColor={rgb:ut}))),delete ke.ixfe,delete ke.XF,F=Pt(f=ge),S&&S.s&&S.e||(S={s:{r:0,c:0},e:{r:0,c:0}}),ge.r<S.s.r&&(S.s.r=ge.r),ge.c<S.s.c&&(S.s.c=ge.c),ge.r+1>S.e.r&&(S.e.r=ge.r+1),ge.c+1>S.e.c&&(S.e.c=ge.c+1),We.cellFormula&&ke.f){for(var gt=0;gt<B.length;++gt)if(!(B[gt][0].s.c>ge.c||B[gt][0].s.r>ge.r||B[gt][0].e.c<ge.c||B[gt][0].e.r<ge.r)){ke.F=Bt(B[gt][0]),B[gt][0].s.c==ge.c&&B[gt][0].s.r==ge.r||delete ke.f,ke.f&&(ke.f=""+ds(B[gt][1],0,ge,nt,ve));break}}We.dense?(_[ge.r]||(_[ge.r]=[]),_[ge.r][ge.c]=ke):_[F]=ke}}var f,d,y,v,b,_=o.dense?[]:{},T={},S={},I=null,k=[],M="",D={},F="",j={},B=[],z=[],ae=[],he={Sheets:[],WBProps:{date1904:!1},Views:[{}]},le={},ve={enc:!1,sbcch:0,snames:[],sharedf:j,arrayf:B,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!o&&!!o.cellStyles,WTF:!!o&&!!o.wtf};o.password&&(ve.password=o.password);var Ie=[],De=[],_e=[],Ue=[],it=!1,nt=[];nt.SheetNames=ve.snames,nt.sharedf=ve.sharedf,nt.arrayf=ve.arrayf,nt.names=[],nt.XTI=[];var Ye,Je=0,Ge=0,je=0,ht=[],xt=[];ve.codepage=1200,P(1200);for(var Nt=!1;a.l<a.length-1;){var Jt=a.l,lt=a.read_shift(2);if(lt===0&&Je===10)break;var Le=a.l===a.length?0:a.read_shift(2),Ut=Mp[lt];if(Ut&&Ut.f){if(o.bookSheets&&Je===133&&lt!==133)break;if(Je=lt,Ut.r===2||Ut.r==12){var pr=a.read_shift(2);if(Le-=2,!ve.enc&&pr!==lt&&((255&pr)<<8|pr>>8)!==lt)throw new Error("rt mismatch: "+pr+"!="+lt);Ut.r==12&&(a.l+=10,Le-=10)}var ar,Nr,un,ie={},ie=lt===10?Ut.f(a,Le,ve):function(ge,ke,We,_t,ut){var st=_t,gt=[],St=We.slice(We.l,We.l+st);if(ut&&ut.enc&&ut.enc.insitu&&0<St.length)switch(ge){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:ut.enc.insitu(St)}gt.push(St),We.l+=st;for(var At=qs(We,We.l),et=Mp[At],ze=0;et!=null&&-1<WS.indexOf(At);)st=qs(We,We.l+2),ze=We.l+4,At==2066?ze+=4:At!=2165&&At!=2175||(ze+=12),St=We.slice(ze,We.l+4+st),gt.push(St),We.l+=4+st,et=Mp[At=qs(We,We.l)];var kt=K(gt);xn(kt,0);var ct=0;kt.lens=[];for(var Qe=0;Qe<gt.length;++Qe)kt.lens.push(ct),ct+=gt[Qe].length;if(kt.length<_t)throw"XLS Record 0x"+ge.toString(16)+" Truncated: "+kt.length+" < "+_t;return ke.f(kt,kt.length,ut)}(lt,Ut,a,Le,ve);if(Ge!=0||[9,521,1033,2057].indexOf(Je)!==-1)switch(lt){case 34:l.opts.Date1904=he.WBProps.date1904=ie;break;case 134:l.opts.WriteProtect=!0;break;case 47:if(ve.enc||(a.l=0),ve.enc=ie,!o.password)throw new Error("File is password-protected");if(ie.valid==null)throw new Error("Encryption scheme unsupported");if(!ie.valid)throw new Error("Password is incorrect");break;case 92:ve.lastuser=ie;break;case 66:var Ir=Number(ie);switch(Ir){case 21010:Ir=1200;break;case 32768:Ir=1e4;break;case 32769:Ir=1252}P(ve.codepage=Ir),Nt=!0;break;case 317:ve.rrtabid=ie;break;case 25:ve.winlocked=ie;break;case 439:l.opts.RefreshAll=ie;break;case 12:l.opts.CalcCount=ie;break;case 16:l.opts.CalcDelta=ie;break;case 17:l.opts.CalcIter=ie;break;case 13:l.opts.CalcMode=ie;break;case 14:l.opts.CalcPrecision=ie;break;case 95:l.opts.CalcSaveRecalc=ie;break;case 15:ve.CalcRefMode=ie;break;case 2211:l.opts.FullCalc=ie;break;case 129:ie.fDialog&&(_["!type"]="dialog"),ie.fBelow||((_["!outline"]||(_["!outline"]={})).above=!0),ie.fRight||((_["!outline"]||(_["!outline"]={})).left=!0);break;case 224:z.push(ie);break;case 430:nt.push([ie]),nt[nt.length-1].XTI=[];break;case 35:case 547:nt[nt.length-1].push(ie);break;case 24:case 536:Ye={Name:ie.Name,Ref:ds(ie.rgce,0,null,nt,ve)},0<ie.itab&&(Ye.Sheet=ie.itab-1),nt.names.push(Ye),nt[0]||(nt[0]=[],nt[0].XTI=[]),nt[nt.length-1].push(ie),ie.Name=="_xlnm._FilterDatabase"&&0<ie.itab&&ie.rgce&&ie.rgce[0]&&ie.rgce[0][0]&&ie.rgce[0][0][0]=="PtgArea3d"&&(xt[ie.itab-1]={ref:Bt(ie.rgce[0][0][1][2])});break;case 22:ve.ExternCount=ie;break;case 23:nt.length==0&&(nt[0]=[],nt[0].XTI=[]),nt[nt.length-1].XTI=nt[nt.length-1].XTI.concat(ie),nt.XTI=nt.XTI.concat(ie);break;case 2196:if(ve.biff<8)break;Ye!=null&&(Ye.Comment=ie[1]);break;case 18:_["!protect"]=ie;break;case 19:ie!==0&&ve.WTF&&console.error("Password verifier: "+ie);break;case 133:T[ie.pos]=ie,ve.snames.push(ie.name);break;case 10:if(--Ge)break;S.e&&(0<S.e.r&&0<S.e.c&&(S.e.r--,S.e.c--,_["!ref"]=Bt(S),o.sheetRows&&o.sheetRows<=S.e.r&&(Sr=S.e.r,S.e.r=o.sheetRows-1,_["!fullref"]=_["!ref"],_["!ref"]=Bt(S),S.e.r=Sr),S.e.r++,S.e.c++),0<Ie.length&&(_["!merges"]=Ie),0<De.length&&(_["!objects"]=De),0<_e.length&&(_["!cols"]=_e),0<Ue.length&&(_["!rows"]=Ue),he.Sheets.push(le)),M===""?D=_:c[M]=_,_=o.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(ve.biff===8&&(ve.biff={9:2,521:3,1033:4}[lt]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[ie.BIFFVer]||8),ve.biffguess=ie.BIFFVer==0,ie.BIFFVer==0&&ie.dt==4096&&(ve.biff=5,Nt=!0,P(ve.codepage=28591)),ve.biff==8&&ie.BIFFVer==0&&ie.dt==16&&(ve.biff=2),Ge++)break;var Sr,_=o.dense?[]:{};ve.biff<8&&!Nt&&(Nt=!0,P(ve.codepage=o.codepage||1252)),ve.biff<5||ie.BIFFVer==0&&ie.dt==4096?(M===""&&(M="Sheet1"),S={s:{r:0,c:0},e:{r:0,c:0}},Sr={pos:a.l-Le,name:M},T[Sr.pos]=Sr,ve.snames.push(M)):M=(T[Jt]||{name:""}).name,ie.dt==32&&(_["!type"]="chart"),ie.dt==64&&(_["!type"]="macro"),Ie=[],De=[],ve.arrayf=B=[],_e=[],it=!(Ue=[]),le={Hidden:(T[Jt]||{hs:0}).hs,name:M};break;case 515:case 3:case 2:_["!type"]=="chart"&&(o.dense?(_[ie.r]||[])[ie.c]:_[Pt({c:ie.c,r:ie.r})])&&++ie.c,Q={ixfe:ie.ixfe,XF:z[ie.ixfe]||{},v:ie.val,t:"n"},0<je&&(Q.z=ht[Q.ixfe>>8&63]),Ma(Q,o,l.opts.Date1904),h({c:ie.c,r:ie.r},Q,o);break;case 5:case 517:Q={ixfe:ie.ixfe,XF:z[ie.ixfe],v:ie.val,t:ie.t},0<je&&(Q.z=ht[Q.ixfe>>8&63]),Ma(Q,o,l.opts.Date1904),h({c:ie.c,r:ie.r},Q,o);break;case 638:Q={ixfe:ie.ixfe,XF:z[ie.ixfe],v:ie.rknum,t:"n"},0<je&&(Q.z=ht[Q.ixfe>>8&63]),Ma(Q,o,l.opts.Date1904),h({c:ie.c,r:ie.r},Q,o);break;case 189:for(var Nn=ie.c;Nn<=ie.C;++Nn){var ea=ie.rkrec[Nn-ie.c][0],Q={ixfe:ea,XF:z[ea],v:ie.rkrec[Nn-ie.c][1],t:"n"};0<je&&(Q.z=ht[Q.ixfe>>8&63]),Ma(Q,o,l.opts.Date1904),h({c:Nn,r:ie.r},Q,o)}break;case 6:case 518:case 1030:if(ie.val=="String"){I=ie;break}(Q=Oh(ie.val,ie.cell.ixfe,ie.tt)).XF=z[Q.ixfe],o.cellFormula&&(!((Te=ie.formula)&&Te[0]&&Te[0][0]&&Te[0][0][0]=="PtgExp")||j[un=Pt({r:ar=Te[0][0][1][0],c:Nr=Te[0][0][1][1]})]?Q.f=""+ds(ie.formula,0,ie.cell,nt,ve):Q.F=((o.dense?(_[ar]||[])[Nr]:_[un])||{}).F),0<je&&(Q.z=ht[Q.ixfe>>8&63]),Ma(Q,o,l.opts.Date1904),h(ie.cell,Q,o),I=ie;break;case 7:case 519:if(!I)throw new Error("String record expects Formula");(Q=Oh(I.val=ie,I.cell.ixfe,"s")).XF=z[Q.ixfe],o.cellFormula&&(Q.f=""+ds(I.formula,0,I.cell,nt,ve)),0<je&&(Q.z=ht[Q.ixfe>>8&63]),Ma(Q,o,l.opts.Date1904),h(I.cell,Q,o),I=null;break;case 33:case 545:B.push(ie);var Te=Pt(ie[0].s),se=o.dense?(_[ie[0].s.r]||[])[ie[0].s.c]:_[Te];if(o.cellFormula&&se){if(!I||!Te||!se)break;se.f=""+ds(ie[1],0,ie[0],nt,ve),se.F=Bt(ie[0])}break;case 1212:if(!o.cellFormula)break;if(F){if(!I)break;j[Pt(I.cell)]=ie[0],((se=o.dense?(_[I.cell.r]||[])[I.cell.c]:_[Pt(I.cell)])||{}).f=""+ds(ie[0],0,f,nt,ve)}break;case 253:Q=Oh(k[ie.isst].t,ie.ixfe,"s"),k[ie.isst].h&&(Q.h=k[ie.isst].h),Q.XF=z[Q.ixfe],0<je&&(Q.z=ht[Q.ixfe>>8&63]),Ma(Q,o,l.opts.Date1904),h({c:ie.c,r:ie.r},Q,o);break;case 513:o.sheetStubs&&(Q={ixfe:ie.ixfe,XF:z[ie.ixfe],t:"z"},0<je&&(Q.z=ht[Q.ixfe>>8&63]),Ma(Q,o,l.opts.Date1904),h({c:ie.c,r:ie.r},Q,o));break;case 190:if(o.sheetStubs)for(var xe=ie.c;xe<=ie.C;++xe){var re=ie.ixfe[xe-ie.c];Q={ixfe:re,XF:z[re],t:"z"},0<je&&(Q.z=ht[Q.ixfe>>8&63]),Ma(Q,o,l.opts.Date1904),h({c:xe,r:ie.r},Q,o)}break;case 214:case 516:case 4:(Q=Oh(ie.val,ie.ixfe,"s")).XF=z[Q.ixfe],0<je&&(Q.z=ht[Q.ixfe>>8&63]),Ma(Q,o,l.opts.Date1904),h({c:ie.c,r:ie.r},Q,o);break;case 0:case 512:Ge===1&&(S=ie);break;case 252:k=ie;break;case 1054:if(ve.biff==4){ht[je++]=ie[1];for(var Me=0;Me<je+163&&de[Me]!=ie[1];++Me);163<=Me&&Vr(ie[1],je+163)}else Vr(ie[1],ie[0]);break;case 30:ht[je++]=ie;for(var be=0;be<je+163&&de[be]!=ie;++be);163<=be&&Vr(ie,je+163);break;case 229:Ie=Ie.concat(ie);break;case 93:De[ie.cmo[0]]=ve.lastobj=ie;break;case 438:ve.lastobj.TxO=ie;break;case 127:ve.lastobj.ImData=ie;break;case 440:for(y=ie[0].s.r;y<=ie[0].e.r;++y)for(d=ie[0].s.c;d<=ie[0].e.c;++d)(se=o.dense?(_[y]||[])[d]:_[Pt({c:d,r:y})])&&(se.l=ie[1]);break;case 2048:for(y=ie[0].s.r;y<=ie[0].e.r;++y)for(d=ie[0].s.c;d<=ie[0].e.c;++d)(se=o.dense?(_[y]||[])[d]:_[Pt({c:d,r:y})])&&se.l&&(se.l.Tooltip=ie[1]);break;case 28:if(ve.biff<=5&&2<=ve.biff)break;se=o.dense?(_[ie[0].r]||[])[ie[0].c]:_[Pt(ie[0])];var Se=De[ie[2]];se||(se=o.dense?(_[ie[0].r]||(_[ie[0].r]=[]),_[ie[0].r][ie[0].c]={t:"z"}):_[Pt(ie[0])]={t:"z"},S.e.r=Math.max(S.e.r,ie[0].r),S.s.r=Math.min(S.s.r,ie[0].r),S.e.c=Math.max(S.e.c,ie[0].c),S.s.c=Math.min(S.s.c,ie[0].c)),se.c||(se.c=[]),Se={a:ie[1],t:Se.TxO.t},se.c.push(Se);break;case 2173:z[ie.ixfe],ie.ext.forEach(function(ke){ke[0]});break;case 125:if(!ve.cellStyles)break;for(;ie.e>=ie.s;)_e[ie.e--]={width:ie.w/256,level:ie.level||0,hidden:!!(1&ie.flags)},it||(it=!0,Ep(ie.w/256)),Ui(_e[ie.e+1]);break;case 520:Se={},ie.level!=null&&((Ue[ie.r]=Se).level=ie.level),ie.hidden&&((Ue[ie.r]=Se).hidden=!0),ie.hpt&&((Ue[ie.r]=Se).hpt=ie.hpt,Se.hpx=Ol(ie.hpt));break;case 38:case 39:case 40:case 41:_["!margins"]||Lo(_["!margins"]={}),_["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[lt]]=ie;break;case 161:_["!margins"]||Lo(_["!margins"]={}),_["!margins"].header=ie.header,_["!margins"].footer=ie.footer;break;case 574:ie.RTL&&(he.Views[0].RTL=!0);break;case 146:ae=ie;break;case 2198:b=ie;break;case 140:v=ie;break;case 442:M?le.CodeName=ie||le.name:he.WBProps.CodeName=ie||"ThisWorkbook"}}else Ut||console.error("Missing Info for XLS Record 0x"+lt.toString(16)),a.l+=Le}return l.SheetNames=Gr(T).sort(function(ge,ke){return Number(ge)-Number(ke)}).map(function(ge){return T[ge].name}),o.bookSheets||(l.Sheets=c),!l.SheetNames.length&&D["!ref"]?(l.SheetNames.push("Sheet1"),l.Sheets&&(l.Sheets.Sheet1=D)):l.Preamble=D,l.Sheets&&xt.forEach(function(ge,ke){l.Sheets[l.SheetNames[ke]]["!autofilter"]=ge}),l.Strings=k,l.SSF=Tr(de),ve.enc&&(l.Encryption=ve.enc),b&&(l.Themes=b),l.Metadata={},v!==void 0&&(l.Metadata.Country=v),0<nt.names.length&&(he.Names=nt.names),l.Workbook=he,l}var pu={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function jh(a,o){var l,c,u,h,f;if($p(o=o||{}),R(),o.codepage&&N(o.codepage),a.FullPaths){if(wt.find(a,"/encryption"))throw new Error("File is password-protected");l=wt.find(a,"!CompObj"),u=wt.find(a,"/Workbook")||wt.find(a,"/Book")}else{switch(o.type){case"base64":a=V(ee(a));break;case"binary":a=V(a);break;case"buffer":break;case"array":Array.isArray(a)||(a=Array.prototype.slice.call(a))}xn(a,0),u={content:a}}if(l&&$S(l),o.bookProps&&!o.bookSheets)c={};else{var d=te?"buffer":"array";if(u&&u.content)c=zS(u.content,o);else if((u=wt.find(a,"PerfectOffice_MAIN"))&&u.content)c=Mo.to_workbook(u.content,(o.type=d,o));else{if(!(u=wt.find(a,"NativeContent_MAIN"))||!u.content)throw(u=wt.find(a,"MN0"))&&u.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");c=Mo.to_workbook(u.content,(o.type=d,o))}o.bookVBA&&a.FullPaths&&wt.find(a,"/_VBA_PROJECT_CUR/VBA/dir")&&(c.vbaraw=(h=a,f=wt.utils.cfb_new({root:"R"}),h.FullPaths.forEach(function(y,v){y.slice(-1)!=="/"&&y.match(/_VBA_PROJECT_CUR/)&&(y=y.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,""),wt.utils.cfb_add(f,y,h.FileIndex[v].content))}),wt.write(f)))}return d={},a.FullPaths&&function(y,v,b){var _=wt.find(y,"/!DocumentSummaryInformation");if(_&&0<_.size)try{var T,S=Ry(_,ap,pu.DSI);for(T in S)v[T]=S[T]}catch(D){if(b.WTF)throw D}var I=wt.find(y,"/!SummaryInformation");if(I&&0<I.size)try{var k,M=Ry(I,ip,pu.SI);for(k in M)v[k]==null&&(v[k]=M[k])}catch(D){if(b.WTF)throw D}v.HeadingPairs&&v.TitlesOfParts&&(xy(v.HeadingPairs,v.TitlesOfParts,v,b),delete v.HeadingPairs,delete v.TitlesOfParts)}(a,d,o),c.Props=c.Custprops=d,o.bookFiles&&(c.cfb=a),c}function HS(a,h){var l,c,u=h||{},h=wt.utils.cfb_new({root:"R"}),f="/Workbook";switch(u.bookType||"xls"){case"xls":u.bookType="biff8";case"xla":u.bookType||(u.bookType="xla");case"biff8":f="/Workbook",u.biff=8;break;case"biff5":f="/Book",u.biff=5;break;default:throw new Error("invalid type "+u.bookType+" for XLS CFB")}return wt.utils.cfb_add(h,f,Mx(a,u)),u.biff==8&&(a.Props||a.Custprops)&&function(d,y){var v,b=[],_=[],T=[],S=0,I=Fi(ap,"n"),k=Fi(ip,"n");if(d.Props)for(v=Gr(d.Props),S=0;S<v.length;++S)(Object.prototype.hasOwnProperty.call(I,v[S])?b:Object.prototype.hasOwnProperty.call(k,v[S])?_:T).push([v[S],d.Props[v[S]]]);if(d.Custprops)for(v=Gr(d.Custprops),S=0;S<v.length;++S)Object.prototype.hasOwnProperty.call(d.Props||{},v[S])||(Object.prototype.hasOwnProperty.call(I,v[S])?b:Object.prototype.hasOwnProperty.call(k,v[S])?_:T).push([v[S],d.Custprops[v[S]]]);for(var M=[],S=0;S<T.length;++S)-1<Iy.indexOf(T[S][0])||-1<vy.indexOf(T[S][0])||T[S][1]!=null&&M.push(T[S]);_.length&&wt.utils.cfb_add(y,"/SummaryInformation",Py(_,pu.SI,k,ip)),(b.length||M.length)&&wt.utils.cfb_add(y,"/DocumentSummaryInformation",Py(b,pu.DSI,I,ap,M.length?M:null,pu.UDI))}(a,h),u.biff==8&&a.vbaraw&&(l=h,(c=wt.read(a.vbaraw,{type:typeof a.vbaraw=="string"?"binary":"buffer"})).FullPaths.forEach(function(d,y){y==0||(d=d.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/")).slice(-1)!=="/"&&wt.utils.cfb_add(l,d,c.FileIndex[y].content)})),h}var mu={0:{f:function(a,o){var l={},c=a.l+o;l.r=a.read_shift(4),a.l+=4;var u=a.read_shift(2);return a.l+=1,o=a.read_shift(1),a.l=c,7&o&&(l.level=7&o),16&o&&(l.hidden=!0),32&o&&(l.hpt=u/20),l}},1:{f:function(a){return[Ks(a)]}},2:{f:function(a){return[Ks(a),np(a),"n"]}},3:{f:function(a){return[Ks(a),a.read_shift(1),"e"]}},4:{f:function(a){return[Ks(a),a.read_shift(1),"b"]}},5:{f:function(a){return[Ks(a),Xn(a),"n"]}},6:{f:function(a){return[Ks(a),Qn(a),"str"]}},7:{f:function(a){return[Ks(a),a.read_shift(4),"s"]}},8:{f:function(a,o,l){var c=a.l+o,u=Ks(a);u.r=l["!row"];var h=[u,Qn(a),"str"];return l.cellFormula?(a.l+=2,o=Dh(a,c-a.l,l),h[3]=ds(o,0,u,l.supbooks,l)):a.l=c,h}},9:{f:function(a,o,l){var c=a.l+o,u=Ks(a);u.r=l["!row"];var h=[u,Xn(a),"n"];return l.cellFormula?(a.l+=2,o=Dh(a,c-a.l,l),h[3]=ds(o,0,u,l.supbooks,l)):a.l=c,h}},10:{f:function(a,o,l){var c=a.l+o,u=Ks(a);u.r=l["!row"];var h=[u,a.read_shift(1),"b"];return l.cellFormula?(a.l+=2,o=Dh(a,c-a.l,l),h[3]=ds(o,0,u,l.supbooks,l)):a.l=c,h}},11:{f:function(a,o,l){var c=a.l+o,u=Ks(a);u.r=l["!row"];var h=[u,a.read_shift(1),"e"];return l.cellFormula?(a.l+=2,o=Dh(a,c-a.l,l),h[3]=ds(o,0,u,l.supbooks,l)):a.l=c,h}},12:{f:function(a){return[No(a)]}},13:{f:function(a){return[No(a),np(a),"n"]}},14:{f:function(a){return[No(a),a.read_shift(1),"e"]}},15:{f:function(a){return[No(a),a.read_shift(1),"b"]}},16:{f:Ax},17:{f:function(a){return[No(a),Qn(a),"str"]}},18:{f:function(a){return[No(a),a.read_shift(4),"s"]}},19:{f:Z0},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(a,f,d){var c=a.l+f;a.l+=4,a.l+=1;var u=a.read_shift(4),h=T6(a),f=B5(a,0,d),d=ep(a);return a.l=c,f={Name:h,Ptg:f},u<268435455&&(f.Sheet=u),d&&(f.Comment=d),f}},40:{},42:{},43:{f:function(a,o,l){var c={};c.sz=a.read_shift(2)/20;var u,h=(h=(u=a).read_shift(1),u.l++,{fBold:1&h,fItalic:2&h,fUnderline:4&h,fStrikeout:8&h,fOutline:16&h,fShadow:32&h,fCondense:64&h,fExtend:128&h});switch(h.fItalic&&(c.italic=1),h.fCondense&&(c.condense=1),h.fExtend&&(c.extend=1),h.fShadow&&(c.shadow=1),h.fOutline&&(c.outline=1),h.fStrikeout&&(c.strike=1),a.read_shift(2)===700&&(c.bold=1),a.read_shift(2)){case 1:c.vertAlign="superscript";break;case 2:c.vertAlign="subscript"}switch((h=a.read_shift(1))!=0&&(c.underline=h),0<(h=a.read_shift(1))&&(c.family=h),0<(h=a.read_shift(1))&&(c.charset=h),a.l++,c.color=function(f){var d={},y=f.read_shift(1)>>>1,v=f.read_shift(1),b=f.read_shift(2,"i"),_=f.read_shift(1),T=f.read_shift(1),S=f.read_shift(1);switch(f.l++,y){case 0:d.auto=1;break;case 1:d.index=v;var I=Qc[v];I&&(d.rgb=ru(I));break;case 2:d.rgb=ru([_,T,S]);break;case 3:d.theme=v}return b!=0&&(d.tint=0<b?b/32767:b/32768),d}(a),a.read_shift(1)){case 1:c.scheme="major";break;case 2:c.scheme="minor"}return c.name=Qn(a),c}},44:{f:function(a,o){return[a.read_shift(2),Qn(a)]}},45:{f:h5},46:{f:Ca},47:{f:function(a,u){var l=a.l+u,c=a.read_shift(2),u=a.read_shift(2);return a.l=l,{ixfe:c,numFmtId:u}}},48:{},49:{f:function(a){return a.read_shift(4,"i")}},50:{},51:{f:function(a){for(var o=[],l=a.read_shift(4);0<l--;)o.push([a.read_shift(4),a.read_shift(4)]);return o}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:ev},62:{f:function(a){return[Ks(a),Z0(a),"is"]}},63:{f:function(a){var o={};o.i=a.read_shift(4);var l={};return l.r=a.read_shift(4),l.c=a.read_shift(4),o.r=Pt(l),2&(a=a.read_shift(1))&&(o.l="1"),8&a&&(o.a="1"),o}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Fn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(a){var o=a.read_shift(2);return a.l+=28,{RTL:32&o}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(a,o){var l={},c=a[a.l];return++a.l,l.above=!(64&c),l.left=!(128&c),a.l+=18,l.name=_6(a),l}},148:{f:Ph,p:16},151:{f:function(){}},152:{},153:{f:function(a,o){var l={},c=a.read_shift(4);return l.defaultThemeVersion=a.read_shift(4),0<(a=8<o?Qn(a):"").length&&(l.CodeName=a),l.autoCompressPictures=!!(65536&c),l.backupFile=!!(64&c),l.checkCompatibility=!!(4096&c),l.date1904=!!(1&c),l.filterPrivacy=!!(8&c),l.hidePivotFieldList=!!(1024&c),l.promptedSolutions=!!(16&c),l.publishItems=!!(2048&c),l.refreshAllConnections=!!(262144&c),l.saveExternalLinkValues=!!(128&c),l.showBorderUnselectedTables=!!(4&c),l.showInkAnnotation=!!(32&c),l.showObjects=["all","placeholders","none"][c>>13&3],l.showPivotChartFilter=!!(32768&c),l.updateLinks=["userSet","never","always"][c>>8&3],l}},154:{},155:{},156:{f:function(a,o){var l={};return l.Hidden=a.read_shift(4),l.iTabID=a.read_shift(4),l.strRelID=tp(a),l.name=Qn(a),l}},157:{},158:{},159:{T:1,f:function(a){return[a.read_shift(4),a.read_shift(4)]}},160:{T:-1},161:{T:1,f:Do},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Vl},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(a,o){return{flags:a.read_shift(4),version:a.read_shift(4),name:Qn(a)}}},336:{T:-1},337:{f:function(a){return a.l+=4,a.read_shift(4)!=0},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:tp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Jy},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(a,h,l){var c=a.l+h,u=oy(a),h=a.read_shift(1);return(u=[u])[2]=h,l.cellFormula?(l=U5(a,c-a.l,l),u[1]=l):a.l=c,u}},427:{f:function(a,u,l){var c=a.l+u,u=[Do(a)];return l.cellFormula&&(l=$5(a,c-a.l,l),u[1]=l),a.l=c,u}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(a){var o={};return Cx.forEach(function(l){o[l]=Xn(a)}),o}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(a,d){var l=a.l+d,c=Do(a),u=ep(a),h=Qn(a),f=Qn(a),d=Qn(a);return a.l=l,d={rfx:c,relId:u,loc:h,display:d},f&&(d.Tooltip=f),d}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:tp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:xl},633:{T:1},634:{T:-1},635:{T:1,f:function(a){var o={};o.iauthor=a.read_shift(4);var l=Do(a);return o.rfx=l.s,o.ref=Pt(l.s),a.l+=16,o}},636:{T:-1},637:{f:b6},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(a,o){return a.l+=10,{name:Qn(a)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Mp={6:{f:Np},10:{f:Vi},12:{f:bn},13:{f:bn},14:{f:pn},15:{f:pn},16:{f:Xn},17:{f:pn},18:{f:pn},19:{f:bn},20:{f:Yy},21:{f:Yy},23:{f:Jy},24:{f:Xy},25:{f:pn},26:{},27:{},28:{f:function(a,o,l){return function(c,u){if(!(u.biff<8)){var h=c.read_shift(2),f=c.read_shift(2),d=c.read_shift(2),y=c.read_shift(2),v=Oo(c,0,u);return u.biff<8&&c.read_shift(1),[{r:h,c:f},v,y,d]}}(a,l)}},29:{},34:{f:pn},35:{f:Qy},38:{f:Xn},39:{f:Xn},40:{f:Xn},41:{f:Xn},42:{f:pn},43:{f:pn},47:{f:function(a,o,l){var c={Type:8<=l.biff?a.read_shift(2):0};return c.Type?a5(a,o-2,c):(o=a,l.biff,a=l,l=c,o={key:bn(o),verificationBytes:bn(o)},a.password&&(o.verifier=wp(a.password)),l.valid=o.verificationBytes===o.verifier,l.valid&&(l.insitu=s5(a.password))),c}},49:{f:function(a,o,l){var c={dyHeight:a.read_shift(2),fl:a.read_shift(2)};switch(l&&l.biff||8){case 2:break;case 3:case 4:a.l+=2;break;default:a.l+=10}return c.name=Zc(a,0,l),c}},51:{f:bn},60:{},61:{f:function(a){return{Pos:[a.read_shift(2),a.read_shift(2)],Dim:[a.read_shift(2),a.read_shift(2)],Flags:a.read_shift(2),CurTab:a.read_shift(2),FirstTab:a.read_shift(2),Selected:a.read_shift(2),TabRatio:a.read_shift(2)}}},64:{f:pn},65:{f:function(){}},66:{f:bn},77:{},80:{},81:{},82:{},85:{f:bn},89:{},90:{},91:{},92:{f:function(a,o,u){if(u.enc)return a.l+=o,"";var c=a.l,u=Oo(a,0,u);return a.read_shift(o+c-a.l),u}},93:{f:function(a,o,l){return l&&l.biff<8?function(c,u,h){c.l+=4;var f=c.read_shift(2),d=c.read_shift(2),y=c.read_shift(2);c.l+=2,c.l+=2,c.l+=2,c.l+=2,c.l+=2,c.l+=2,c.l+=2,c.l+=2,c.l+=2,c.l+=6,u-=36;var v=[];return v.push((O6[f]||Fn)(c,u,h)),{cmo:[d,f,y],ft:v}}(a,o,l):{cmo:l=zy(a),ft:function(c,u){for(var h=c.l+u,f=[];c.l<h;){var d=c.read_shift(2);c.l-=2;try{f.push(D6[d](c,h-c.l))}catch{return c.l=h,f}}return c.l!=h&&(c.l=h),f}(a,o-22,l[1])}}},94:{},95:{f:pn},96:{},97:{},99:{f:pn},125:{f:ev},128:{f:function(a){if(a.l+=4,(a=[a.read_shift(2),a.read_shift(2)])[0]!==0&&a[0]--,a[1]!==0&&a[1]--,7<a[0]||7<a[1])throw new Error("Bad Gutters: "+a.join("|"));return a}},129:{f:function(a,o,l){return{fDialog:16&(o=l&&l.biff==8||o==2?a.read_shift(2):(a.l+=o,0)),fBelow:64&o,fRight:128&o}}},130:{f:bn},131:{f:pn},132:{f:pn},133:{f:function(a,o,l){var c=a.read_shift(4),u=3&a.read_shift(1),h=a.read_shift(1);switch(h){case 0:h="Worksheet";break;case 1:h="Macrosheet";break;case 2:h="Chartsheet";break;case 6:h="VBAModule"}return l=Zc(a,0,l),{pos:c,hs:u,dt:h,name:l=l.length===0?"Sheet1":l}}},134:{},140:{f:function(a){var o=[0,0],l=a.read_shift(2);return o[0]=fy[l]||l,l=a.read_shift(2),o[1]=fy[l]||l,o}},141:{f:bn},144:{},146:{f:function(a){for(var o=a.read_shift(2),l=[];0<o--;)l.push(Uy(a));return l}},151:{},152:{},153:{},154:{},155:{},156:{f:bn},157:{},158:{},160:{f:L6},161:{f:function(a,o){var l={};return o<32||(a.l+=16,l.header=Xn(a),l.footer=Xn(a),a.l+=2),l}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(a,o){for(var l=a.l+o-2,c=a.read_shift(2),u=a.read_shift(2),h=[];a.l<l;)h.push(By(a));if(a.l!==l)throw new Error("MulRK read error");if(o=a.read_shift(2),h.length!=o-u+1)throw new Error("MulRK length mismatch");return{r:c,c:u,C:o,rkrec:h}}},190:{f:function(a,o){for(var l=a.l+o-2,c=a.read_shift(2),u=a.read_shift(2),h=[];a.l<l;)h.push(a.read_shift(2));if(a.l!==l)throw new Error("MulBlank read error");if(o=a.read_shift(2),h.length!=o-u+1)throw new Error("MulBlank length mismatch");return{r:c,c:u,C:o,ixfe:h}}},193:{f:Vi},197:{},198:{},199:{},200:{},201:{},202:{f:pn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:bn},220:{},221:{f:pn},222:{},224:{f:function(a,o,l){var c,u,h,f={};return f.ifnt=a.read_shift(2),f.numFmtId=a.read_shift(2),f.flags=a.read_shift(2),f.fStyle=f.flags>>2&1,o-=6,f.data=(c=a,f.fStyle,u=l,h={},o=c.read_shift(4),a=c.read_shift(4),l=c.read_shift(4),c=c.read_shift(2),h.patternType=S6[l>>26],u.cellStyles&&(h.alc=7&o,h.fWrap=o>>3&1,h.alcV=o>>4&7,h.fJustLast=o>>7&1,h.trot=o>>8&255,h.cIndent=o>>16&15,h.fShrinkToFit=o>>20&1,h.iReadOrder=o>>22&2,h.fAtrNum=o>>26&1,h.fAtrFnt=o>>27&1,h.fAtrAlc=o>>28&1,h.fAtrBdr=o>>29&1,h.fAtrPat=o>>30&1,h.fAtrProt=o>>31&1,h.dgLeft=15&a,h.dgRight=a>>4&15,h.dgTop=a>>8&15,h.dgBottom=a>>12&15,h.icvLeft=a>>16&127,h.icvRight=a>>23&127,h.grbitDiag=a>>30&3,h.icvTop=127&l,h.icvBottom=l>>7&127,h.icvDiag=l>>14&127,h.dgDiag=l>>21&15,h.icvFore=127&c,h.icvBack=c>>7&127,h.fsxButton=c>>14&1),h),f}},225:{f:function(a,o){return o===0||a.read_shift(2),1200}},226:{f:Vi},227:{},229:{f:function(a,o){for(var l=[],c=a.read_shift(2);c--;)l.push(gh(a));return l}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(a,o){for(var l=a.l+o,o=a.read_shift(4),c=a.read_shift(4),u=[],h=0;h!=c&&a.l<l;++h)u.push(function(d){var y=p;p=1200;var v,b=d.read_shift(2),_=4&(k=d.read_shift(1)),T=8&k,S=1+(1&k),I=0,k={};return T&&(I=d.read_shift(2)),_&&(v=d.read_shift(4)),S=S==2?"dbcs-cont":"sbcs-cont",S=b===0?"":d.read_shift(b,S),T&&(d.l+=4*I),_&&(d.l+=v),k.t=S,T||(k.raw="<t>"+k.t+"</t>",k.r=k.t),p=y,k}(a));return u.Count=o,u.Unique=c,u}},253:{f:function(a){var o=Oa(a);return o.isst=a.read_shift(4),o}},255:{f:function(a,o){var l={};return l.dsst=a.read_shift(2),a.l+=o-2,l}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Oy},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:pn},353:{f:Vi},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(a,h,l){var c=a.l+h,u=a.read_shift(2),h=a.read_shift(2);if((l.sbcch=h)==1025||h==14849)return[h,u];if(h<1||255<h)throw new Error("Unexpected SupBook type: "+h);for(var l=Po(a,h),f=[];c>a.l;)f.push(eu(a));return[h,u,l,f]}},431:{f:pn},432:{},433:{},434:{},437:{},438:{f:function(a,o,l){var c=a.l,u="";try{a.l+=4;var h=(l.lastobj||{cmo:[0,0]}).cmo[1];[0,5,7,11,12,14].indexOf(h)==-1?a.l+=6:function(v){var b=v.read_shift(1);v.l++;var _=v.read_shift(2);v.l+=2}(a);var f=a.read_shift(2);a.read_shift(2),bn(a),h=a.read_shift(2),a.l+=h;for(var d=1;d<a.lens.length-1;++d){if(a.l-c!=a.lens[d])throw new Error("TxO: bad continue record");var y=a[a.l];if((u+=Po(a,a.lens[d+1]-a.lens[d]-1)).length>=(y?f:2*f))break}if(u.length!==f&&u.length!==2*f)throw new Error("cchText: "+f+" != "+u.length);return a.l=c+o,{t:u}}catch{return a.l=c+o,{t:u}}}},439:{f:pn},440:{f:function(a,o){var l=gh(a);return a.l+=16,[l,function(c,u){var h=c.l+u;if((_=c.read_shift(4))!==2)throw new Error("Unrecognized streamVersion: "+_);u=c.read_shift(2),c.l+=2;var f,d,y,v,b,_="";16&u&&(f=mh(c,c.l)),128&u&&(d=mh(c,c.l)),(257&u)==257&&(y=mh(c,c.l)),(257&u)==1&&(T=N6(c,c.l)),8&u&&(_=mh(c,c.l)),32&u&&(v=c.read_shift(16)),64&u&&(b=fp(c)),c.l=h;var T=d||y||T||"";return T&&_&&(T+="#"+_),T=T||"#"+_,T={Target:T=2&u&&T.charAt(0)=="/"&&T.charAt(1)!="/"?"file://"+T:T},v&&(T.guid=v),b&&(T.time=b),f&&(T.Tooltip=f),T}(a,o-24)]}},441:{},442:{f:eu},443:{},444:{f:bn},445:{},446:{},448:{f:Vi},449:{f:function(a){return a.read_shift(2),a.read_shift(4)},r:2},450:{f:Vi},512:{f:Gy},513:{f:M6},515:{f:function(a,o,l){return l.biffguess&&l.biff==2&&(l.biff=5),l=Oa(a),a=Xn(a),l.val=a,l}},516:{f:function(a,o,l){return l.biffguess&&l.biff==2&&(l.biff=5),a.l,o=Oa(a),l.biff==2&&a.l++,l=eu(a,a.l,l),o.val=l,o}},517:{f:Ky},519:{f:Xp},520:{f:function(a){var o={};o.r=a.read_shift(2),o.c=a.read_shift(2),o.cnt=a.read_shift(2)-o.c;var l=a.read_shift(2);a.l+=4;var c=a.read_shift(1);return a.l+=3,7&c&&(o.level=7&c),32&c&&(o.hidden=!0),64&c&&(o.hpt=l/20),o}},523:{},545:{f:Zy},549:{f:Hy},566:{},574:{f:function(a,o,l){return l&&2<=l.biff&&l.biff<5?{}:{RTL:64&a.read_shift(2)}}},638:{f:function(c){var o=c.read_shift(2),l=c.read_shift(2),c=By(c);return{r:o,c:l,ixfe:c[0],rknum:c[1]}}},659:{},1048:{},1054:{f:function(a,o,l){return[a.read_shift(2),Oo(a,0,l)]}},1084:{},1212:{f:function(a,o,l){var c=Wy(a);a.l++;var u=a.read_shift(1);return[function(h,f,d){var y,v=h.l+f,b=h.read_shift(2),_=uu(h,b,d);return b==65535?[[],Fn(h,f-2)]:(f!==b+2&&(y=cu(h,v-b-2,_,d)),[_,y])}(a,o-=8,l),u,c]}},2048:{f:function(a,o){return a.read_shift(2),[gh(a),a.read_shift((o-10)/2,"dbcs-cont").replace(me,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:yh},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Vi},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(a){a.l+=2;var o={cxfs:0,crc:0};return o.cxfs=a.read_shift(2),o.crc=a.read_shift(4),o},r:12},2173:{f:function(a,o){a.l,a.l+=2,o=a.read_shift(2),a.l+=2;for(var l=a.read_shift(2),c=[];0<l--;)c.push(C5(a,a.l));return{ixfe:o,ext:c}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:pn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(a,o,l){if(!(l.biff<8)){var c=a.read_shift(2),u=a.read_shift(2);return[Po(a,c,l),Po(a,u,l)]}a.l+=o},r:12},2197:{},2198:{f:function(a,o,l){var c=a.l+o;if(a.read_shift(4)!==124226)if(l.cellStyles){var u,h=a.slice(a.l);a.l=c;try{u=Lc(h,{type:"array"})}catch{return}if(o=kn(u,"theme/theme/theme1.xml",!0),o)return Qv(o,l)}else a.l=c},r:12},2199:{},2200:{},2201:{},2202:{f:function(a){return[a.read_shift(4)!==0,a.read_shift(4)!==0,a.read_shift(4)]},r:12},2203:{f:Vi},2204:{},2205:{},2206:{},2207:{},2211:{f:function(a){var o,l,c=(l=(o=a).read_shift(2),c=o.read_shift(2),o.l+=8,{type:l});if(c.type!=2211)throw new Error("Invalid Future Record "+c.type);return a.read_shift(4)!==0}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:bn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(a,o,l){var c={area:!1};return l.biff!=5?a.l+=o:(o=a.read_shift(1),a.l+=3,16&o&&(c.area=!0)),c}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(a){for(var o=a.read_shift(2),l=[];0<o--;)l.push(Uy(a));return l}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Gy},1:{},2:{f:function(a){var o=Oa(a);return++a.l,a=a.read_shift(2),o.t="n",o.val=a,o}},3:{f:function(a){var o=Oa(a);return++a.l,a=Xn(a),o.t="n",o.val=a,o}},4:{f:function(a,o,l){l.biffguess&&l.biff==5&&(l.biff=2);var c=Oa(a);return++a.l,l=Oo(a,0,l),c.t="str",c.val=l,c}},5:{f:Ky},7:{f:function(a){var o=a.read_shift(1);return o===0?(a.l++,""):a.read_shift(o,"sbcs-cont")}},8:{},9:{f:yh},11:{},22:{f:bn},30:{f:Ul},31:{},32:{},33:{f:Zy},36:{},37:{f:Hy},50:{f:function(a,o){a.l+=6,a.l+=2,a.l+=1,a.l+=3,a.l+=1,a.l+=o-13}},62:{},52:{},67:{},68:{f:bn},69:{},86:{},126:{},127:{f:function(a){var o=a.read_shift(2),c=a.read_shift(2),l=a.read_shift(4),c={fmt:o,env:c,len:l,data:a.slice(a.l,a.l+l)};return a.l+=l,c}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(a,h,f){var c=a.l+h,u=Oa(a),h=a.read_shift(2),f=Po(a,h,f);return a.l=c,u.t="str",u.val=f,u}},223:{},234:{},354:{},421:{},518:{f:Np},521:{f:yh},536:{f:Xy},547:{f:Qy},561:{},579:{},1030:{f:Np},1033:{f:yh},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function rt(a,o,l,c){var u=o;isNaN(u)||(o=c||(l||[]).length||0,(c=a.next(4)).write_shift(2,u),c.write_shift(2,o),0<o&&ko(l)&&a.push(l))}function gu(a,o,l){return(a=a||Ae(7)).write_shift(2,o),a.write_shift(2,l),a.write_shift(2,0),a.write_shift(1,0),a}function GS(a,o,l,c){if(o.v!=null)switch(o.t){case"d":case"n":var u=o.t=="d"?qr(Ur(o.v)):o.v;return void(u==(0|u)&&0<=u&&u<65536?rt(a,2,(b=l,_=c,T=u,gu(S=Ae(9),b,_),S.write_shift(2,T),S)):rt(a,3,(T=l,S=c,u=u,gu(v=Ae(15),T,S),v.write_shift(8,u,"f"),v)));case"b":case"e":return void rt(a,5,(v=l,h=c,f=o.v,d=o.t,gu(y=Ae(9),v,h),jy(f,d||"b",y),y));case"s":case"str":return void rt(a,4,(h=l,f=c,d=(o.v||"").slice(0,255),gu(y=Ae(8+2*d.length),h,f),y.write_shift(1,d.length),y.write_shift(d.length,d,"sbcs"),y.l<y.length?y.slice(0,y.l):y))}var h,f,d,y,v,b,_,T,S;rt(a,1,gu(null,l,c))}function qS(a,o){for(var l=o||{},o=A(),c=0,u=0;u<a.SheetNames.length;++u)a.SheetNames[u]==l.sheet&&(c=u);if(c==0&&l.sheet&&a.SheetNames[0]!=l.sheet)throw new Error("Sheet not found: "+l.sheet);return rt(o,l.biff==4?1033:l.biff==3?521:9,hp(0,16,l)),function(h,f,d){var y,v,b=Array.isArray(f),_=nr(f["!ref"]||"A1"),T=[];if(255<_.e.c||16383<_.e.r){if(d.WTF)throw new Error("Range "+(f["!ref"]||"A1")+" exceeds format limit A1:IV16384");_.e.c=Math.min(_.e.c,255),_.e.r=Math.min(_.e.c,16383),y=Bt(_)}for(var S=_.s.r;S<=_.e.r;++S){v=tr(S);for(var I=_.s.c;I<=_.e.c;++I){S===_.s.r&&(T[I]=Yt(I)),y=T[I]+v;var k=b?(f[S]||[])[I]:f[y];k&&GS(h,k,S,I)}}}(o,a.Sheets[a.SheetNames[c]],l),rt(o,10),o.end()}function KS(a,o,l){var c,u;rt(a,49,(u=(c={sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"}).name||"Arial",(a=Ae((l=(a=l)&&a.biff==5)?15+u.length:16+2*u.length)).write_shift(2,20*(c.sz||12)),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,u.length),l||a.write_shift(1,1),a.write_shift((l?1:2)*u.length,u,l?"sbcs":"utf16le"),a))}function YS(a,o,l){o&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(c){for(var u,h,f,d,y=c[0];y<=c[1];++y)o[y]!=null&&rt(a,1054,(u=y,h=o[y],d=void 0,f=(f=l)&&f.biff==5,(d=d||Ae(f?3+h.length:5+2*h.length)).write_shift(2,u),d.write_shift(f?1:2,h.length),f||d.write_shift(1,1),d.write_shift((f?1:2)*h.length,h,f?"sbcs":"utf16le"),(d=d.length>d.l?d.slice(0,d.l):d).l==null&&(d.l=d.length),d))})}function QS(a,o){for(var l=0;l<o["!links"].length;++l){var c=o["!links"][l];rt(a,440,j6(c)),c[1].Tooltip&&rt(a,2048,function(u){var h=u[1].Tooltip,f=Ae(10+2*(h.length+1));f.write_shift(2,2048),u=rr(u[0]),f.write_shift(2,u.r),f.write_shift(2,u.r),f.write_shift(2,u.c),f.write_shift(2,u.c);for(var d=0;d<h.length;++d)f.write_shift(2,h.charCodeAt(d));return f.write_shift(2,0),f}(c))}delete o["!links"]}function XS(a,o){var l;o&&(l=0,o.forEach(function(c,u){var h;++l<=256&&c&&rt(a,125,(h=Rh(u,c),c=u,(u=Ae(12)).write_shift(2,c),u.write_shift(2,c),u.write_shift(2,256*h.width),u.write_shift(2,0),c=0,h.hidden&&(c|=1),u.write_shift(1,c),c=h.level||0,u.write_shift(1,c),u.write_shift(2,0),u))}))}function JS(a,o,l,c,u){var h,f,d,y,v,b,_,T,S,I,k,M=16+$i(u.cellXfs,o,u);if(o.v!=null||o.bf)if(o.bf)rt(a,6,V5(o,l,c,0,M));else switch(o.t){case"d":case"n":var D=o.t=="d"?qr(Ur(o.v)):o.v;rt(a,515,(b=l,_=c,T=D,S=M,I=Ae(14),jo(b,_,S,I),Nl(T,I),I));break;case"b":case"e":rt(a,517,(D=l,b=c,_=o.v,S=M,T=o.t,I=Ae(8),jo(D,b,S,I),jy(_,T,I),I));break;case"s":case"str":u.bookSST?(k=Dp(u.Strings,o.v,u.revStrings),rt(a,253,(h=l,f=c,d=k,y=M,v=Ae(10),jo(h,f,y,v),v.write_shift(4,d),v))):rt(a,516,(k=l,h=c,f=(o.v||"").slice(0,255),y=M,d=Ae(+(v=!(d=u)||d.biff==8)+8+(1+v)*f.length),jo(k,h,y,d),d.write_shift(2,f.length),v&&d.write_shift(1,1),d.write_shift((1+v)*f.length,f,v?"utf16le":"sbcs"),d));break;default:rt(a,513,jo(l,c,M))}else rt(a,513,jo(l,c,M))}function ZS(a,o,l){var c,u,h=A(),j=l.SheetNames[a],f=l.Sheets[j]||{},d=(l||{}).Workbook||{},y=(d.Sheets||[])[a]||{},v=Array.isArray(f),b=o.biff==8,_=[],T=nr(f["!ref"]||"A1"),S=b?65536:16384;if(255<T.e.c||T.e.r>=S){if(o.WTF)throw new Error("Range "+(f["!ref"]||"A1")+" exceeds format limit A1:IV16384");T.e.c=Math.min(T.e.c,255),T.e.r=Math.min(T.e.c,S-1)}rt(h,2057,hp(0,16,o)),rt(h,13,Qs(1)),rt(h,12,Qs(100)),rt(h,15,hs(!0)),rt(h,17,hs(!1)),rt(h,16,Nl(.001)),rt(h,95,hs(!0)),rt(h,42,hs(!1)),rt(h,43,hs(!1)),rt(h,130,Qs(1)),rt(h,128,(l=[0,0],(a=Ae(8)).write_shift(4,0),a.write_shift(2,l[0]?l[0]+1:0),a.write_shift(2,l[1]?l[1]+1:0),a)),rt(h,131,hs(!1)),rt(h,132,hs(!1)),b&&XS(h,f["!cols"]),rt(h,512,(S=T,(l=Ae(2*(a=(l=o).biff!=8&&l.biff?2:4)+6)).write_shift(a,S.s.r),l.write_shift(a,S.e.r+1),l.write_shift(2,S.s.c),l.write_shift(2,S.e.c+1),l.write_shift(2,0),l)),b&&(f["!links"]=[]);for(var I=T.s.r;I<=T.e.r;++I){u=tr(I);for(var k=T.s.c;k<=T.e.c;++k){I===T.s.r&&(_[k]=Yt(k)),c=_[k]+u;var M=v?(f[I]||[])[k]:f[c];M&&(JS(h,M,I,k,o),b&&M.l&&f["!links"].push([c,M.l]))}}var D,F,j=y.CodeName||y.name||j;return b&&rt(h,574,(d=(d.Views||[])[0],F=Ae(18),D=1718,d&&d.RTL&&(D|=64),F.write_shift(2,D),F.write_shift(4,0),F.write_shift(4,64),F.write_shift(4,0),F.write_shift(4,0),F)),b&&(f["!merges"]||[]).length&&rt(h,229,function(B){var z=Ae(2+8*B.length);z.write_shift(2,B.length);for(var ae=0;ae<B.length;++ae)$y(B[ae],z);return z}(f["!merges"])),b&&QS(h,f),rt(h,442,My(j)),b&&(D=h,F=f,(j=Ae(19)).write_shift(4,2151),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(2,3),j.write_shift(1,1),j.write_shift(4,0),rt(D,2151,j),(j=Ae(39)).write_shift(4,2152),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(2,3),j.write_shift(1,0),j.write_shift(4,0),j.write_shift(2,1),j.write_shift(4,4),j.write_shift(2,0),$y(nr(F["!ref"]||"A1"),j),j.write_shift(4,4),rt(D,2152,j)),rt(h,10),h.end()}function eA(a,o,l){var c=A(),d=(a||{}).Workbook||{},u=d.Sheets||[],h=d.WBProps||{},f=l.biff==8,d=l.biff==5;rt(c,2057,hp(0,5,l)),l.bookType=="xla"&&rt(c,135),rt(c,225,f?Qs(1200):null),rt(c,193,function(D,F){F=F||Ae(D);for(var j=0;j<D;++j)F.write_shift(1,0);return F}(2)),d&&rt(c,191),d&&rt(c,192),rt(c,226),rt(c,92,function(D){var F=!D||D.biff==8,j=Ae(F?112:54);for(j.write_shift(D.biff==8?2:1,7),F&&j.write_shift(1,0),j.write_shift(4,859007059),j.write_shift(4,5458548|(F?0:536870912));j.l<j.length;)j.write_shift(1,F?0:32);return j}(l)),rt(c,66,Qs(f?1200:1252)),f&&rt(c,353,Qs(0)),f&&rt(c,448),rt(c,317,function(D){for(var F=Ae(2*D),j=0;j<D;++j)F.write_shift(2,j+1);return F}(a.SheetNames.length)),f&&a.vbaraw&&rt(c,211),f&&a.vbaraw&&rt(c,442,My(h.CodeName||"ThisWorkbook")),rt(c,156,Qs(17)),rt(c,25,hs(!1)),rt(c,18,hs(!1)),rt(c,19,Qs(0)),f&&rt(c,431,hs(!1)),f&&rt(c,444,Qs(0)),rt(c,61,((d=Ae(18)).write_shift(2,0),d.write_shift(2,0),d.write_shift(2,29280),d.write_shift(2,17600),d.write_shift(2,56),d.write_shift(2,0),d.write_shift(2,0),d.write_shift(2,1),d.write_shift(2,500),d)),rt(c,64,hs(!1)),rt(c,141,Qs(0)),rt(c,34,hs(((h=a).Workbook&&h.Workbook.WBProps&&$r(h.Workbook.WBProps.date1904)?"true":"false")=="true")),rt(c,14,hs(!0)),f&&rt(c,439,hs(!1)),rt(c,218,Qs(0)),KS(c,0,l),YS(c,a.SSF,l),function(D,F){for(var j=0;j<16;++j)rt(D,224,qy({numFmtId:0,style:!0},0,F));F.cellXfs.forEach(function(B){rt(D,224,qy(B,0,F))})}(c,l),f&&rt(c,352,hs(!1)),d=c.end(),h=A(),f&&rt(h,140,((M=M||Ae(4)).write_shift(2,1),M.write_shift(2,1),M)),f&&l.Strings&&function(D,F,j){var B=(j||[]).length||0;if(B<=8224)return rt(D,F,j,B);if(!isNaN(F)){for(var z=j.parts||[],ae=0,he=0,le=0;le+(z[ae]||8224)<=8224;)le+=z[ae]||8224,ae++;var ve=D.next(4);for(ve.write_shift(2,F),ve.write_shift(2,le),D.push(j.slice(he,he+le)),he+=le;he<B;){for((ve=D.next(4)).write_shift(2,60),le=0;le+(z[ae]||8224)<=8224;)le+=z[ae]||8224,ae++;ve.write_shift(2,le),D.push(j.slice(he,he+le)),he+=le}}}(h,252,R6(l.Strings)),rt(h,10);for(var c=h.end(),y=A(),v=0,b=0,b=0;b<a.SheetNames.length;++b)v+=(f?12:11)+(f?2:1)*a.SheetNames[b].length;var _,T,S,I,k=d.length+v+c.length;for(b=0;b<a.SheetNames.length;++b)rt(y,133,(_={pos:k,hs:(u[b]||{}).Hidden||0,dt:0,name:a.SheetNames[b]},I=S=void 0,S=!(T=l)||8<=T.biff?2:1,(I=Ae(8+S*_.name.length)).write_shift(4,_.pos),I.write_shift(1,_.hs||0),I.write_shift(1,_.dt),I.write_shift(1,_.name.length),8<=T.biff&&I.write_shift(1,1),I.write_shift(S*_.name.length,_.name,T.biff<8?"sbcs":"utf16le"),(T=I.slice(0,I.l)).l=I.l,T)),k+=o[b].length;var M=y.end();if(v!=M.length)throw new Error("BS8 "+v+" != "+M.length);return h=[],d.length&&h.push(d),M.length&&h.push(M),c.length&&h.push(c),K(h)}function Mx(a,o){for(var l=0;l<=a.SheetNames.length;++l){var c=a.Sheets[a.SheetNames[l]];c&&c["!ref"]&&255<Wr(c["!ref"]).e.c&&typeof console<"u"&&console.error&&console.error("Worksheet '"+a.SheetNames[l]+"' extends beyond column IV (255).  Data may be lost.")}var u=o||{};switch(u.biff||2){case 8:case 5:return function(h,f){var d=f||{},y=[];h&&!h.SSF&&(h.SSF=Tr(de)),h&&h.SSF&&(Rs(),Ds(h.SSF),d.revssf=yn(h.SSF),d.revssf[h.SSF[65535]]=0,d.ssf=h.SSF),d.Strings=[],d.Strings.Count=0,d.Strings.Unique=0,Wp(d),d.cellXfs=[],$i(d.cellXfs,{},{revssf:{General:0}}),h.Props||(h.Props={});for(var v=0;v<h.SheetNames.length;++v)y[y.length]=ZS(v,d,h);return y.unshift(eA(h,y,d)),K(y)}(a,o);case 4:case 3:case 2:return qS(a,o)}throw new Error("invalid type "+u.bookType+" for BIFF")}function Lx(a,o){var l=o||{},c=l.dense?[]:{},u=(a=a.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!u)throw new Error("Invalid HTML: could not find <table>");for(var h,o=a.match(/<\/table/i),T=u.index,f=o&&o.index||a.length,d=Kf(a.slice(T,f),/(:?<tr[^>]*>)/i,"<tr>"),y=-1,v=0,b={s:{r:1e7,c:1e7},e:{r:0,c:0}},_=[],T=0;T<d.length;++T){var S=d[T].trim(),I=S.slice(0,3).toLowerCase();if(I!="<tr"){if(I=="<td"||I=="<th")for(var k=S.split(/<\/t[dh]>/i),f=0;f<k.length;++f){var M=k[f].trim();if(M.match(/<t[dh]/i)){for(var D=M,F=0;D.charAt(0)=="<"&&-1<(F=D.indexOf(">"));)D=D.slice(F+1);for(var j=0;j<_.length;++j){var B=_[j];B.s.c==v&&B.s.r<y&&y<=B.e.r&&(v=B.e.c+1,j=-1)}var z=Lt(M.slice(0,M.indexOf(">"))),ae=z.colspan?+z.colspan:1;(1<(h=+z.rowspan)||1<ae)&&_.push({s:{r:y,c:v},e:{r:y+(h||1)-1,c:v+ae-1}}),M=z.t||z["data-t"]||"",D.length&&(D=nh(D),b.s.r>y&&(b.s.r=y),b.e.r<y&&(b.e.r=y),b.s.c>v&&(b.s.c=v),b.e.c<v&&(b.e.c=v),D.length&&(z={t:"s",v:D},l.raw||!D.trim().length||M=="s"||(D==="TRUE"?z={t:"b",v:!0}:D==="FALSE"?z={t:"b",v:!1}:isNaN(_s(D))?isNaN(ka(D).getDate())||(z={t:"d",v:Ur(D)},(z=l.cellDates?z:{t:"n",v:qr(z.v)}).z=l.dateNF||de[14]):z={t:"n",v:_s(D)}),l.dense?(c[y]||(c[y]=[]),c[y][v]=z):c[Pt({r:y,c:v})]=z)),v+=ae}}}else{if(++y,l.sheetRows&&l.sheetRows<=y){--y;break}v=0}}return c["!ref"]=Bt(b),_.length&&(c["!merges"]=_),c}function Vx(a,o,l,c){for(var u=a["!merges"]||[],h=[],f=o.s.c;f<=o.e.c;++f){for(var d,y,v,b,_=0,T=0,S=0;S<u.length;++S)if(!(u[S].s.r>l||u[S].s.c>f||u[S].e.r<l||u[S].e.c<f)){if(u[S].s.r<l||u[S].s.c<f){_=-1;break}_=u[S].e.r-u[S].s.r+1,T=u[S].e.c-u[S].s.c+1;break}_<0||(d=Pt({r:l,c:f}),v=(y=c.dense?(a[l]||[])[f]:a[d])&&y.v!=null&&(y.h||Xa(y.w||(Pa(y),y.w)||""))||"",b={},1<_&&(b.rowspan=_),1<T&&(b.colspan=T),c.editable?v='<span contenteditable="true">'+v+"</span>":y&&(b["data-t"]=y&&y.t||"z",y.v!=null&&(b["data-v"]=y.v),y.z!=null&&(b["data-z"]=y.z),y.l&&(y.l.Target||"#").charAt(0)!="#"&&(v='<a href="'+y.l.Target+'">'+v+"</a>")),b.id=(c.id||"sjs")+"-"+d,h.push(Ze("td",v,b)))}return"<tr>"+h.join("")+"</tr>"}var Ux='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Bx="</body></html>";function $x(a,o,l){return[].join("")+"<table"+(l&&l.id?' id="'+l.id+'"':"")+">"}function Wx(a,u){var l=u||{},c=l.header!=null?l.header:Ux,u=l.footer!=null?l.footer:Bx,h=[c],f=Wr(a["!ref"]);l.dense=Array.isArray(a),h.push($x(0,0,l));for(var d=f.s.r;d<=f.e.r;++d)h.push(Vx(a,f,d,l));return h.push("</table>"+u),h.join("")}function zx(a,o,l){var c=l||{},u=0,h=0;c.origin!=null&&(typeof c.origin=="number"?u=c.origin:(u=(l=typeof c.origin=="string"?rr(c.origin):c.origin).r,h=l.c));var f=o.getElementsByTagName("tr"),d=Math.min(c.sheetRows||1e7,f.length),y={s:{r:0,c:0},e:{r:u,c:h}};a["!ref"]&&(o=Wr(a["!ref"]),y.s.r=Math.min(y.s.r,o.s.r),y.s.c=Math.min(y.s.c,o.s.c),y.e.r=Math.max(y.e.r,o.e.r),y.e.c=Math.max(y.e.c,o.e.c),u==-1&&(y.e.r=u=o.e.r+1));var v,b,_=[],T=0,S=a["!rows"]||(a["!rows"]=[]),I=0,k=0,M=0,D=0;for(a["!cols"]||(a["!cols"]=[]);I<f.length&&k<d;++I){var F=f[I];if(Gx(F)){if(c.display)continue;S[k]={hidden:!0}}for(var j=F.children,M=D=0;M<j.length;++M){var B=j[M];if(!c.display||!Gx(B)){for(var z=B.hasAttribute("data-v")?B.getAttribute("data-v"):B.hasAttribute("v")?B.getAttribute("v"):nh(B.innerHTML),ae=B.getAttribute("data-z")||B.getAttribute("z"),T=0;T<_.length;++T){var he=_[T];he.s.c==D+h&&he.s.r<k+u&&k+u<=he.e.r&&(D=he.e.c+1-h,T=-1)}b=+B.getAttribute("colspan")||1,(1<(v=+B.getAttribute("rowspan")||1)||1<b)&&_.push({s:{r:k+u,c:D+h},e:{r:k+u+(v||1)-1,c:D+h+(b||1)-1}});var le={t:"s",v:z},ve=B.getAttribute("data-t")||B.getAttribute("t")||"";z!=null&&(z.length==0?le.t=ve||"z":c.raw||z.trim().length==0||ve=="s"||(z==="TRUE"?le={t:"b",v:!0}:z==="FALSE"?le={t:"b",v:!1}:isNaN(_s(z))?isNaN(ka(z).getDate())||(le={t:"d",v:Ur(z)},(le=c.cellDates?le:{t:"n",v:qr(le.v)}).z=c.dateNF||de[14]):le={t:"n",v:_s(z)})),le.z===void 0&&ae!=null&&(le.z=ae);var Ie="",De=B.getElementsByTagName("A");if(De&&De.length)for(var _e=0;_e<De.length&&(!De[_e].hasAttribute("href")||(Ie=De[_e].getAttribute("href")).charAt(0)=="#");++_e);Ie&&Ie.charAt(0)!="#"&&(le.l={Target:Ie}),c.dense?(a[k+u]||(a[k+u]=[]),a[k+u][D+h]=le):a[Pt({c:D+h,r:k+u})]=le,y.e.c<D+h&&(y.e.c=D+h),D+=b}}++k}return _.length&&(a["!merges"]=(a["!merges"]||[]).concat(_)),y.e.r=Math.max(y.e.r,k-1+u),a["!ref"]=Bt(y),d<=k&&(a["!fullref"]=Bt((y.e.r=f.length-I+k-1+u,y))),a}function Hx(a,o){return zx((o||{}).dense?[]:{},a,o)}function Gx(a){var l,o="",l=(l=a).ownerDocument.defaultView&&typeof l.ownerDocument.defaultView.getComputedStyle=="function"?l.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null;return(o=(o=l?l(a).getPropertyValue("display"):o)||a.style&&a.style.display)==="none"}var qx={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Kx(a,o){var l=o||{},c,u,h,f,d,y=ei(a),v=[],b={name:""},_="",T=0,S={},I=[],k=l.dense?[]:{},M={value:""},D="",F=0,j=[],B=-1,z=-1,ae={s:{r:1e6,c:1e7},e:{r:0,c:0}},he=0,le={},ve=[],Ie={},De=[],_e=1,Ue=1,it=[],nt={Names:[]},Ye={},Je=["",""],Ge=[],je={},ht="",xt=0,Nt=!1,Jt=!1,lt=0;for(Ri.lastIndex=0,y=y.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");f=Ri.exec(y);)switch(f[3]=f[3].replace(/_.*$/,"")){case"table":case"":f[1]==="/"?(ae.e.c>=ae.s.c&&ae.e.r>=ae.s.r?k["!ref"]=Bt(ae):k["!ref"]="A1:A1",0<l.sheetRows&&l.sheetRows<=ae.e.r&&(k["!fullref"]=k["!ref"],ae.e.r=l.sheetRows-1,k["!ref"]=Bt(ae)),ve.length&&(k["!merges"]=ve),De.length&&(k["!rows"]=De),h.name=h.||h.name,typeof JSON<"u"&&JSON.stringify(h),I.push(h.name),S[h.name]=k,Jt=!1):f[0].charAt(f[0].length-2)!=="/"&&(h=Lt(f[0],!1),B=z=-1,ae.s.r=ae.s.c=1e7,ae.e.r=ae.e.c=0,k=l.dense?[]:{},ve=[],De=[],Jt=!0);break;case"table-row-group":f[1]==="/"?--he:++he;break;case"table-row":case"":if(f[1]==="/"){B+=_e,_e=1;break}if((Le=Lt(f[0],!1)).?B=Le.-1:B==-1&&(B=0),(_e=+Le["number-rows-repeated"]||1)<10)for(lt=0;lt<_e;++lt)0<he&&(De[B+lt]={level:he});z=-1;break;case"covered-table-cell":f[1]!=="/"&&++z,l.sheetStubs&&(l.dense?(k[B]||(k[B]=[]),k[B][z]={t:"z"}):k[Pt({r:B,c:z})]={t:"z"}),D="",j=[];break;case"table-cell":case"":if(f[0].charAt(f[0].length-2)==="/")++z,M=Lt(f[0],!1),Ue=parseInt(M["number-columns-repeated"]||"1",10),d={t:"z",v:null},M.formula&&l.cellFormula!=0&&(d.f=mx(qt(M.formula))),(M.||M["value-type"])=="string"&&(d.t="s",d.v=qt(M["string-value"]||""),l.dense?(k[B]||(k[B]=[]),k[B][z]=d):k[Pt({r:B,c:z})]=d),z+=Ue-1;else if(f[1]!=="/"){D="",F=0,j=[],Ue=1;var Le=_e?B+_e-1:B;if(++z>ae.e.c&&(ae.e.c=z),z<ae.s.c&&(ae.s.c=z),B<ae.s.r&&(ae.s.r=B),Le>ae.e.r&&(ae.e.r=Le),Ge=[],je={},d={t:(M=Lt(f[0],!1)).||M["value-type"],v:null},l.cellFormula)if(M.formula&&(M.formula=qt(M.formula)),M["number-matrix-columns-spanned"]&&M["number-matrix-rows-spanned"]&&(Ie={s:{r:B,c:z},e:{r:B+(parseInt(M["number-matrix-rows-spanned"],10)||0)-1,c:z+(parseInt(M["number-matrix-columns-spanned"],10)||0)-1}},d.F=Bt(Ie),it.push([Ie,d.F])),M.formula)d.f=mx(M.formula);else for(lt=0;lt<it.length;++lt)B>=it[lt][0].s.r&&B<=it[lt][0].e.r&&z>=it[lt][0].s.c&&z<=it[lt][0].e.c&&(d.F=it[lt][1]);switch((M["number-columns-spanned"]||M["number-rows-spanned"])&&(Ie={s:{r:B,c:z},e:{r:B+(parseInt(M["number-rows-spanned"],10)||0)-1,c:z+(parseInt(M["number-columns-spanned"],10)||0)-1}},ve.push(Ie)),M["number-columns-repeated"]&&(Ue=parseInt(M["number-columns-repeated"],10)),d.t){case"boolean":d.t="b",d.v=$r(M["boolean-value"]);break;case"float":case"percentage":case"currency":d.t="n",d.v=parseFloat(M.value);break;case"date":d.t="d",d.v=Ur(M["date-value"]),l.cellDates||(d.t="n",d.v=qr(d.v)),d.z="m/d/yy";break;case"time":d.t="n",d.v=function(ar){var Nr=0,un=0,ie=!1,Ir=ar.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!Ir)throw new Error("|"+ar+"| is not an ISO8601 Duration");for(var Sr=1;Sr!=Ir.length;++Sr)if(Ir[Sr]){switch(un=1,3<Sr&&(ie=!0),Ir[Sr].slice(Ir[Sr].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+Ir[Sr].slice(Ir[Sr].length-1));case"D":un*=24;case"H":un*=60;case"M":if(!ie)throw new Error("Unsupported ISO Duration Field: M");un*=60}Nr+=un*parseInt(Ir[Sr],10)}return Nr}(M["time-value"])/86400,l.cellDates&&(d.t="d",d.v=ha(d.v)),d.z="HH:MM:SS";break;case"number":d.t="n",d.v=parseFloat(M.);break;default:if(d.t!=="string"&&d.t!=="text"&&d.t)throw new Error("Unsupported value type "+d.t);d.t="s",M["string-value"]!=null&&(D=qt(M["string-value"]),j=[])}}else{if(Nt=!1,d.t==="s"&&(d.v=D||"",j.length&&(d.R=j),Nt=F==0),Ye.Target&&(d.l=Ye),0<Ge.length&&(d.c=Ge,Ge=[]),D&&l.cellText!==!1&&(d.w=D),Nt&&(d.t="z",delete d.v),(!Nt||l.sheetStubs)&&!(l.sheetRows&&l.sheetRows<=B))for(var Ut=0;Ut<_e;++Ut){if(Ue=parseInt(M["number-columns-repeated"]||"1",10),l.dense)for(k[B+Ut]||(k[B+Ut]=[]),k[B+Ut][z]=Ut==0?d:Tr(d);0<--Ue;)k[B+Ut][z+Ue]=Tr(d);else for(k[Pt({r:B+Ut,c:z})]=d;0<--Ue;)k[Pt({r:B+Ut,c:z+Ue})]=Tr(d);ae.e.c<=z&&(ae.e.c=z)}z+=(Ue=parseInt(M["number-columns-repeated"]||"1",10))-1,Ue=0,d={},D="",j=[]}Ye={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(f[1]==="/"){if((c=v.pop())[0]!==f[3])throw"Bad state: "+c}else f[0].charAt(f[0].length-2)!=="/"&&v.push([f[3],!0]);break;case"annotation":if(f[1]==="/"){if((c=v.pop())[0]!==f[3])throw"Bad state: "+c;je.t=D,j.length&&(je.R=j),je.a=ht,Ge.push(je)}else f[0].charAt(f[0].length-2)!=="/"&&v.push([f[3],!1]);D=ht="",F=xt=0,j=[];break;case"creator":f[1]==="/"?ht=y.slice(xt,f.index):xt=f.index+f[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(f[1]==="/"){if((c=v.pop())[0]!==f[3])throw"Bad state: "+c}else f[0].charAt(f[0].length-2)!=="/"&&v.push([f[3],!1]);D="",F=0,j=[];break;case"scientific-number":case"currency-symbol":case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(f[1]==="/"){if(le[b.name]=_,(c=v.pop())[0]!==f[3])throw"Bad state: "+c}else f[0].charAt(f[0].length-2)!=="/"&&(_="",b=Lt(f[0],!1),v.push([f[3],!0]));break;case"script":case"libraries":case"automatic-styles":break;case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":break;case"number":switch(v[v.length-1][0]){case"time-style":case"date-style":u=Lt(f[0],!1),_+=qx[f[3]][u.style==="long"?1:0]}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(v[v.length-1][0]){case"time-style":case"date-style":u=Lt(f[0],!1),_+=qx[f[3]][u.style==="long"?1:0]}break;case"boolean-style":case"boolean":case"text-style":break;case"text":if(f[0].slice(-2)==="/>")break;if(f[1]==="/")switch(v[v.length-1][0]){case"number-style":case"date-style":case"time-style":_+=y.slice(T,f.index)}else T=f.index+f[0].length;break;case"named-range":Je=Ip((u=Lt(f[0],!1))["cell-range-address"]);var pr={Name:u.name,Ref:Je[0]+"!"+Je[1]};Jt&&(pr.Sheet=I.length),nt.Names.push(pr);break;case"text-content":case"text-properties":case"embedded-text":break;case"body":case"":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":break;case"p":case"":if(-1<["master-styles"].indexOf(v[v.length-1][0]))break;f[1]!=="/"||M&&M["string-value"]?(Lt(f[0],!1),F=f.index+f[0].length):(pr=(pr=y.slice(F,f.index)).replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(ar,Nr){return Array(parseInt(Nr,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),pr=[qt(pr.replace(/<[^>]*>/g,""))],D=(0<D.length?D+`
`:"")+pr[0]);break;case"s":break;case"database-range":if(f[1]==="/")break;try{S[(Je=Ip(Lt(f[0])["target-range-address"]))[0]]["!autofilter"]={ref:Je[1]}}catch{}break;case"date":case"object":break;case"title":case"":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":break;case"a":if(f[1]!=="/"){if(!(Ye=Lt(f[0],!1)).href)break;Ye.Target=qt(Ye.href),delete Ye.href,Ye.Target.charAt(0)=="#"&&-1<Ye.Target.indexOf(".")?(Je=Ip(Ye.Target.slice(1)),Ye.Target="#"+Je[0]+"!"+Je[1]):Ye.Target.match(/^\.\.[\\\/]/)&&(Ye.Target=Ye.Target.slice(3))}break;case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;default:switch(f[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(l.WTF)throw new Error(f)}}return a={Sheets:S,SheetNames:I,Workbook:nt},l.bookSheets&&delete a.Sheets,a}function Yx(a,o){o=o||{},Un(a,"META-INF/manifest.xml")&&function(c,u){for(var h,f,d=ei(c);h=Ri.exec(d);)switch(h[3]){case"manifest":break;case"file-entry":if((f=Lt(h[0],!1)).path=="/"&&f.type!==A6)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(u&&u.WTF)throw h}}(Jr(a,"META-INF/manifest.xml"),o);var l=kn(a,"content.xml");if(!l)throw new Error("Missing content.xml in ODS / UOF file");return o=Kx(kr(l),o),Un(a,"meta.xml")&&(o.Props=gy(Jr(a,"meta.xml"))),o}function Qx(a,o){return Kx(a,o)}var tA=function(){var a=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),o="<office:document-styles "+Ia({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+a+"</office:document-styles>";return function(){return Zr+o}}(),Xx=function(){function a(l,c,u){var h=[];h.push('      <table:table table:name="'+Er(c.SheetNames[u])+`" table:style-name="ta1">
`);var f=0,d=0,y=Wr(l["!ref"]||"A1"),v=l["!merges"]||[],b=0,_=Array.isArray(l);if(l["!cols"])for(d=0;d<=y.e.c;++d)h.push("        <table:table-column"+(l["!cols"][d]?' table:style-name="co'+l["!cols"][d].ods+'"':"")+`></table:table-column>
`);for(var T="",S=l["!rows"]||[],f=0;f<y.s.r;++f)T=S[f]?' table:style-name="ro'+S[f].ods+'"':"",h.push("        <table:table-row"+T+`></table:table-row>
`);for(;f<=y.e.r;++f){for(T=S[f]?' table:style-name="ro'+S[f].ods+'"':"",h.push("        <table:table-row"+T+`>
`),d=0;d<y.s.c;++d)h.push(o);for(;d<=y.e.c;++d){for(var I=!1,k={},M="",b=0;b!=v.length;++b)if(!(v[b].s.c>d||v[b].s.r>f||v[b].e.c<d||v[b].e.r<f)){v[b].s.c==d&&v[b].s.r==f||(I=!0),k["table:number-columns-spanned"]=v[b].e.c-v[b].s.c+1,k["table:number-rows-spanned"]=v[b].e.r-v[b].s.r+1;break}if(I)h.push(`          <table:covered-table-cell/>
`);else{var D=Pt({r:f,c:d}),F=_?(l[f]||[])[d]:l[D];if(F&&F.f&&(k["table:formula"]=Er(("of:="+F.f.replace(Cp,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")),F.F&&F.F.slice(0,D.length)==D&&(j=Wr(F.F),k["table:number-matrix-columns-spanned"]=j.e.c-j.s.c+1,k["table:number-matrix-rows-spanned"]=j.e.r-j.s.r+1)),F){switch(F.t){case"b":M=F.v?"TRUE":"FALSE",k["office:value-type"]="boolean",k["office:boolean-value"]=F.v?"true":"false";break;case"n":M=F.w||String(F.v||0),k["office:value-type"]="float",k["office:value"]=F.v||0;break;case"s":case"str":M=F.v==null?"":F.v,k["office:value-type"]="string";break;case"d":M=F.w||Ur(F.v).toISOString(),k["office:value-type"]="date",k["office:date-value"]=Ur(F.v).toISOString(),k["table:style-name"]="ce1";break;default:h.push(o);continue}var j,D=Er(M).replace(/  +/g,function(z){return'<text:s text:c="'+z.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>");F.l&&F.l.Target&&(D=Ze("text:a",D,{"xlink:href":(j=(j=(j=F.l.Target).charAt(0)=="#"?"#"+j.slice(1).replace(/\./,"!"):j).charAt(0)!="#"&&!j.match(/^\w+:/)?"../"+j:j).replace(/&/g,"&amp;")})),h.push("          "+Ze("table:table-cell",Ze("text:p",D,{}),k)+`
`)}else h.push(o)}}h.push(`        </table:table-row>
`)}return h.push(`      </table:table>
`),h.join("")}var o=`          <table:table-cell />
`;return function(l,c){var u=[Zr],h=Ia({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=Ia({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(u.push("<office:document"+h+f+`>
`),u.push(my().replace(/office:document-meta/g,"office:meta"))):u.push("<office:document-content"+h+`>
`),function(y,v){y.push(` <office:automatic-styles>
`),y.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),y.push(`   <number:month number:style="long"/>
`),y.push(`   <number:text>/</number:text>
`),y.push(`   <number:day number:style="long"/>
`),y.push(`   <number:text>/</number:text>
`),y.push(`   <number:year/>
`),y.push(`  </number:date-style>
`);var b=0;v.SheetNames.map(function(T){return v.Sheets[T]}).forEach(function(T){if(T&&T["!cols"]){for(var S=0;S<T["!cols"].length;++S)if(T["!cols"][S]){var I=T["!cols"][S];if(I.width==null&&I.wpx==null&&I.wch==null)continue;Ui(I),I.ods=b,I=T["!cols"][S].wpx+"px",y.push('  <style:style style:name="co'+b+`" style:family="table-column">
`),y.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+I+`"/>
`),y.push(`  </style:style>
`),++b}}});var _=0;v.SheetNames.map(function(T){return v.Sheets[T]}).forEach(function(T){if(T&&T["!rows"])for(var S,I=0;I<T["!rows"].length;++I)T["!rows"][I]&&(T["!rows"][I].ods=_,S=T["!rows"][I].hpx+"px",y.push('  <style:style style:name="ro'+_+`" style:family="table-row">
`),y.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+S+`"/>
`),y.push(`  </style:style>
`),++_)}),y.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),y.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),y.push(`  </style:style>
`),y.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),y.push(` </office:automatic-styles>
`)}(u,l),u.push(`  <office:body>
`),u.push(`    <office:spreadsheet>
`);for(var d=0;d!=l.SheetNames.length;++d)u.push(a(l.Sheets[l.SheetNames[d]],l,d));return u.push(`    </office:spreadsheet>
`),u.push(`  </office:body>
`),c.bookType=="fods"?u.push("</office:document>"):u.push("</office:document-content>"),u.join("")}}();function Jx(a,o){if(o.bookType=="fods")return Xx(a,o);var l=Mc(),c=[],u=[];return Wt(l,"mimetype","application/vnd.oasis.opendocument.spreadsheet"),Wt(l,"content.xml",Xx(a,o)),c.push(["content.xml","text/xml"]),u.push(["content.xml","ContentFile"]),Wt(l,"styles.xml",tA(a,o)),c.push(["styles.xml","text/xml"]),u.push(["styles.xml","StylesFile"]),Wt(l,"meta.xml",Zr+my()),c.push(["meta.xml","text/xml"]),u.push(["meta.xml","MetadataFile"]),Wt(l,"manifest.rdf",function(h){var f=[Zr];f.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var d=0;d!=h.length;++d)f.push(py(h[d][0],h[d][1])),f.push([`  <rdf:Description rdf:about="">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+h[d][0]+`"/>
`,`  </rdf:Description>
`].join(""));return f.push(py("","Document","pkg")),f.push("</rdf:RDF>"),f.join("")}(u)),c.push(["manifest.rdf","application/rdf+xml"]),Wt(l,"META-INF/manifest.xml",function(h){var f=[Zr];f.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),f.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var d=0;d<h.length;++d)f.push('  <manifest:file-entry manifest:full-path="'+h[d][0]+'" manifest:media-type="'+h[d][1]+`"/>
`);return f.push("</manifest:manifest>"),f.join("")}(c)),l}function ii(a){return new DataView(a.buffer,a.byteOffset,a.byteLength)}function Lp(a){return typeof TextDecoder<"u"?new TextDecoder().decode(a):kr(J(a))}function Zx(a){return typeof TextEncoder<"u"?new TextEncoder().encode(a):V(Os(a))}function Wi(a){var o=a.reduce(function(u,h){return u+h.length},0),l=new Uint8Array(o),c=0;return a.forEach(function(u){l.set(u,c),c+=u.length}),l}function eb(a){return 16843009*((a=(858993459&(a-=a>>1&1431655765))+(a>>2&858993459))+(a>>4)&252645135)>>>24}function yu(a,o){var l=o?o[0]:0,c=127&a[l];return 128<=a[l++]&&(c|=(127&a[l])<<7,a[l++]<128||(c|=(127&a[l])<<14,a[l++]<128||(c|=(127&a[l])<<21,a[l++]<128||(c+=(127&a[l])*Math.pow(2,28),++l,a[l++]<128||(c+=(127&a[l])*Math.pow(2,35),++l,a[l++]<128||(c+=(127&a[l])*Math.pow(2,42),++l,a[l++])))))),o&&(o[0]=l),c}function vr(a){var o=new Uint8Array(7);o[0]=127&a;var l=1;return 127<a&&(o[l-1]|=128,o[l]=a>>7&127,++l,a<=16383||(o[l-1]|=128,o[l]=a>>14&127,++l,a<=2097151||(o[l-1]|=128,o[l]=a>>21&127,++l,a<=268435455||(o[l-1]|=128,o[l]=a/256>>>21&127,++l,a<=34359738367||(o[l-1]|=128,o[l]=a/65536>>>21&127,++l,a<=4398046511103||(o[l-1]|=128,o[l]=a/16777216>>>21&127,++l)))))),o.slice(0,l)}function en(a){var o=0,l=127&a[0];return 128<=a[o++]&&(l|=(127&a[1])<<7,a[o++]<128||(l|=(127&a[2])<<14,a[o++]<128||(l|=(127&a[3])<<21,a[+o]<128||(l|=(127&a[4])<<28)))),l}function dr(a){for(var o=[],l=[0];l[0]<a.length;){var c,u=l[0],h=yu(a,l),f=7&h,d=0;if((h=Math.floor(h/8))==0)break;switch(f){case 0:for(var y=l[0];128<=a[l[0]++];);c=a.slice(y,l[0]);break;case 5:d=4,c=a.slice(l[0],l[0]+d),l[0]+=d;break;case 1:d=8,c=a.slice(l[0],l[0]+d),l[0]+=d;break;case 2:d=yu(a,l),c=a.slice(l[0],l[0]+d),l[0]+=d;break;case 3:case 4:default:throw new Error("PB Type ".concat(f," for Field ").concat(h," at offset ").concat(u))}var v={data:c,type:f};o[h]==null?o[h]=[v]:o[h].push(v)}return o}function nn(a){var o=[];return a.forEach(function(l,c){c!=0&&l.forEach(function(u){u.data&&(o.push(vr(8*c+u.type)),u.type==2&&o.push(vr(u.data.length)),o.push(u.data))})}),Wi(o)}function Vp(a,o){return(a==null?void 0:a.map(function(l){return o(l.data)}))||[]}function Xs(a){for(var o=[],l=[0];l[0]<a.length;){var c=yu(a,l),u=dr(a.slice(l[0],l[0]+c));l[0]+=c;var h={id:en(u[1][0].data),messages:[]};u[2].forEach(function(y){var d=dr(y.data),y=en(d[3][0].data);h.messages.push({meta:d,data:a.slice(l[0],l[0]+y)}),l[0]+=y}),(c=u[3])!=null&&c[0]&&(h.merge=0<en(u[3][0].data)>>>0),o.push(h)}return o}function Vo(a){var o=[];return a.forEach(function(l){var c=[[],[{data:vr(l.id),type:0}],[]];l.merge!=null&&(c[3]=[{data:vr(+!!l.merge),type:0}]);var u=[];l.messages.forEach(function(h){u.push(h.data),h.meta[3]=[{type:0,data:vr(h.data.length)}],c[2].push({data:nn(h.meta),type:2})}),l=nn(c),o.push(vr(l.length)),o.push(l),u.forEach(function(h){return o.push(h)})}),Wi(o)}function Js(a){for(var o=[],l=0;l<a.length;){var c=a[l++],u=a[l]|a[l+1]<<8|a[l+2]<<16;l+=3,o.push(function(h,f){if(h!=0)throw new Error("Unexpected Snappy chunk type ".concat(h));for(var d=[0],y=yu(f,d),v=[];d[0]<f.length;){var b=3&f[d[0]];if(b!=0){var _=0,T=0;if(b==1?(T=4+(f[d[0]]>>2&7),_=(224&f[d[0]++])<<3,_|=f[d[0]++]):(T=1+(f[d[0]++]>>2),b==2?(_=f[d[0]]|f[d[0]+1]<<8,d[0]+=2):(_=(f[d[0]]|f[d[0]+1]<<8|f[d[0]+2]<<16|f[d[0]+3]<<24)>>>0,d[0]+=4)),v=[Wi(v)],_==0)throw new Error("Invalid offset 0");if(_>v[0].length)throw new Error("Invalid offset beyond length");if(_<=T)for(v.push(v[0].slice(-_)),T-=_;T>=v[v.length-1].length;)v.push(v[v.length-1]),T-=v[v.length-1].length;v.push(v[0].slice(-_,-_+T))}else b=f[d[0]++]>>2,b<60?++b:(_=b-59,b=f[d[0]],1<_&&(b|=f[d[0]+1]<<8),2<_&&(b|=f[d[0]+2]<<16),3<_&&(b|=f[d[0]+3]<<24),b>>>=0,b++,d[0]+=_),v.push(f.slice(d[0],d[0]+b)),d[0]+=b}if((h=Wi(v)).length!=y)throw new Error("Unexpected length: ".concat(h.length," != ").concat(y));return h}(c,a.slice(l,l+u))),l+=u}if(l!==a.length)throw new Error("data is not a valid framed stream!");return Wi(o)}function Uo(a){for(var o=[],l=0;l<a.length;){var c=Math.min(a.length-l,268435455),u=new Uint8Array(4);o.push(u);var h=vr(c),f=h.length;o.push(h),c<=60?(f++,o.push(new Uint8Array([c-1<<2]))):c<=256?(f+=2,o.push(new Uint8Array([240,c-1&255]))):c<=65536?(f+=3,o.push(new Uint8Array([244,c-1&255,c-1>>8&255]))):c<=16777216?(f+=4,o.push(new Uint8Array([248,c-1&255,c-1>>8&255,c-1>>16&255]))):c<=4294967296&&(f+=5,o.push(new Uint8Array([252,c-1&255,c-1>>8&255,c-1>>16&255,c-1>>>24&255]))),o.push(a.slice(l,l+c)),f+=c,u[0]=0,u[1]=255&f,u[2]=f>>8&255,u[3]=f>>16&255,l+=c}return Wi(o)}function rA(a,o,l){var c,u=ii(a),h=u.getUint32(8,!0),f=12,d=-1,y=-1,v=NaN,b=NaN,_=new Date(2001,0,1);switch(1&h&&(v=function(T,S){for(var I=(127&T[S+15])<<7|T[S+14]>>1,k=1&T[S+14],M=S+13;S<=M;--M)k=256*k+T[M];return(128&T[S+15]?-k:k)*Math.pow(10,I-6176)}(a,f),f+=16),2&h&&(b=u.getFloat64(f,!0),f+=8),4&h&&(_.setTime(_.getTime()+1e3*u.getFloat64(f,!0)),f+=8),8&h&&(y=u.getUint32(f,!0),f+=4),16&h&&(d=u.getUint32(f,!0),f+=4),a[1]){case 0:break;case 2:c={t:"n",v};break;case 3:c={t:"s",v:o[y]};break;case 5:c={t:"d",v:_};break;case 6:c={t:"b",v:0<b};break;case 7:c={t:"n",v:b/86400};break;case 8:c={t:"e",v:0};break;case 9:if(!(-1<d))throw new Error("Unsupported cell type ".concat(a[1]," : ").concat(31&h," : ").concat(a.slice(0,4)));c={t:"s",v:l[d]};break;case 10:c={t:"n",v};break;default:throw new Error("Unsupported cell type ".concat(a[1]," : ").concat(31&h," : ").concat(a.slice(0,4)))}return c}function Up(a,o){var l=new Uint8Array(32),c=ii(l),u=12,h=0;switch(l[0]=5,a.t){case"n":l[1]=2,function(f,d,y){var v=Math.floor(y==0?0:Math.LOG10E*Math.log(Math.abs(y)))+6176-16,b=y/Math.pow(10,v-6176);f[d+15]|=v>>7,f[d+14]|=(127&v)<<1;for(var _=0;1<=b;++_,b/=256)f[d+_]=255&b;f[d+15]|=0<=y?0:128}(l,u,a.v),h|=1,u+=16;break;case"b":l[1]=6,c.setFloat64(u,a.v?1:0,!0),h|=2,u+=8;break;case"s":if(o.indexOf(a.v)==-1)throw new Error("Value ".concat(a.v," missing from SST!"));l[1]=3,c.setUint32(u,o.indexOf(a.v),!0),h|=8,u+=4;break;default:throw"unsupported cell type "+a.t}return c.setUint32(8,h,!0),l.slice(0,u)}function Bp(a,o){var l=new Uint8Array(32),c=ii(l),u=12,h=0;switch(l[0]=3,a.t){case"n":l[2]=2,c.setFloat64(u,a.v,!0),h|=32,u+=8;break;case"b":l[2]=6,c.setFloat64(u,a.v?1:0,!0),h|=32,u+=8;break;case"s":if(o.indexOf(a.v)==-1)throw new Error("Value ".concat(a.v," missing from SST!"));l[2]=3,c.setUint32(u,o.indexOf(a.v),!0),h|=16,u+=4;break;default:throw"unsupported cell type "+a.t}return c.setUint32(4,h,!0),l.slice(0,u)}function nA(a,o,l){switch(a[0]){case 0:case 1:case 2:case 3:return function(c,u,h,f){var d,y=ii(c),v=y.getUint32(4,!0),b=(1<f?12:8)+4*eb(v&(1<f?3470:398)),_=-1,T=-1,S=NaN,I=new Date(2001,0,1);switch(512&v&&(_=y.getUint32(b,!0),b+=4),b+=4*eb(v&(1<f?12288:4096)),16&v&&(T=y.getUint32(b,!0),b+=4),32&v&&(S=y.getFloat64(b,!0),b+=8),64&v&&(I.setTime(I.getTime()+1e3*y.getFloat64(b,!0)),b+=8),c[2]){case 0:break;case 2:d={t:"n",v:S};break;case 3:d={t:"s",v:u[T]};break;case 5:d={t:"d",v:I};break;case 6:d={t:"b",v:0<S};break;case 7:d={t:"n",v:S/86400};break;case 8:d={t:"e",v:0};break;case 9:if(-1<_)d={t:"s",v:h[_]};else if(-1<T)d={t:"s",v:u[T]};else{if(isNaN(S))throw new Error("Unsupported cell type ".concat(c.slice(0,4)));d={t:"n",v:S}}break;default:throw new Error("Unsupported cell type ".concat(c.slice(0,4)))}return d}(a,o,l,a[0]);case 5:return rA(a,o,l);default:throw new Error("Unsupported payload version ".concat(a[0]))}}function Bn(a){return yu(dr(a)[1][0].data)}function tb(a,c){var c=dr(c.data),l=en(c[1][0].data),c=c[3],u=[];return(c||[]).forEach(function(h){var f=dr(h.data),d=en(f[1][0].data)>>>0;switch(l){case 1:u[d]=Lp(f[3][0].data);break;case 8:var v=dr(a[Bn(f[9][0].data)][0].data),y=a[Bn(v[1][0].data)][0],v=en(y.meta[1][0].data);if(v!=2001)throw new Error("2000 unexpected reference to ".concat(v));y=dr(y.data),u[d]=y[3].map(function(b){return Lp(b.data)}).join("")}}),u}function sA(a,u){var l=dr(u.data),c=(u=l==null?void 0:l[7])!=null&&u[0]?0<en(l[7][0].data)>>>0?1:0:-1,u=Vp(l[5],function(h){return function(f,d){var y,v,b,_=dr(f),T=en(_[1][0].data)>>>0,S=en(_[2][0].data)>>>0,I=((f=(I=_[8])==null?void 0:I[0])==null?void 0:f.data)&&0<en(_[8][0].data)||!1;if((f=(f=_[7])==null?void 0:f[0])!=null&&f.data&&d!=0)v=(y=(y=_[7])==null?void 0:y[0])==null?void 0:y.data,b=(y=(y=_[6])==null?void 0:y[0])==null?void 0:y.data;else{if((y=(y=_[4])==null?void 0:y[0])==null||!y.data||d==1)throw"NUMBERS Tile missing ".concat(d," cell storage");v=(d=(d=_[4])==null?void 0:d[0])==null?void 0:d.data,b=(_=(_=_[3])==null?void 0:_[0])==null?void 0:_.data}for(var k=I?4:1,M=ii(v),D=[],F=0;F<v.length/2;++F){var j=M.getUint16(2*F,!0);j<65535&&D.push([F,j])}if(D.length!=S)throw"Expected ".concat(S," cells, found ").concat(D.length);for(var B=[],F=0;F<D.length-1;++F)B[D[F][0]]=b.subarray(D[F][1]*k,D[F+1][1]*k);return 1<=D.length&&(B[D[D.length-1][0]]=b.subarray(D[D.length-1][1]*k)),{R:T,cells:B}}(h,c)});return{nrows:en(l[4][0].data)>>>0,data:u.reduce(function(h,f){return h[f.R]||(h[f.R]=[]),f.cells.forEach(function(d,y){if(h[f.R][y])throw new Error("Duplicate cell r=".concat(f.R," c=").concat(y));h[f.R][y]=d}),h},[])}}function aA(a,u){var l={"!ref":"A1"},c=a[Bn(dr(u.data)[2][0].data)],u=en(c[0].meta[1][0].data);if(u!=6001)throw new Error("6000 unexpected reference to ".concat(u));return function(h,y,d){var _=dr(y.data);if((y={s:{r:0,c:0},e:{r:0,c:0}}).e.r=(en(_[6][0].data)>>>0)-1,y.e.r<0)throw new Error("Invalid row varint ".concat(_[6][0].data));if(y.e.c=(en(_[7][0].data)>>>0)-1,y.e.c<0)throw new Error("Invalid col varint ".concat(_[7][0].data));d["!ref"]=Bt(y);var y=dr(_[4][0].data),v=tb(h,h[Bn(y[4][0].data)][0]),b=(_=y[17])!=null&&_[0]?tb(h,h[Bn(y[17][0].data)][0]):[],_=dr(y[3][0].data),T=0;if(_[1].forEach(function(I){var k=dr(I.data),I=h[Bn(k[2][0].data)][0],k=en(I.meta[1][0].data);if(k!=6002)throw new Error("6001 unexpected reference to ".concat(k));I=sA(0,I),I.data.forEach(function(M,D){M.forEach(function(F,j){j=Pt({r:T+D,c:j}),F=nA(F,v,b),F&&(d[j]=F)})}),T+=I.nrows}),(_=y[13])!=null&&_[0]){if(_=h[Bn(y[13][0].data)][0],y=en(_.meta[1][0].data),y!=6144)throw new Error("Expected merge type 6144, found ".concat(y));d["!merges"]=(_=dr(_.data))==null?void 0:_[1].map(function(I){var k=dr(I.data),I=ii(dr(k[1][0].data)[1][0].data),k=ii(dr(k[2][0].data)[1][0].data);return{s:{r:I.getUint16(0,!0),c:I.getUint16(2,!0)},e:{r:I.getUint16(0,!0)+k.getUint16(0,!0)-1,c:I.getUint16(2,!0)+k.getUint16(2,!0)-1}}})}}(a,c[0],l),l}function iA(a,o){var l=Yp(),c=dr(o.data);if((o=c[2])!=null&&o[0])throw new Error("Keynote presentations are not supported");if(Vp(c[1],Bn).forEach(function(u){a[u].forEach(function(h){var f,d,y,v;en(h.meta[1][0].data)==2&&(d=a,h=dr((y=h).data),v={name:(y=h[1])!=null&&y[0]?Lp(h[1][0].data):"",sheets:[]},Vp(h[2],Bn).forEach(function(b){d[b].forEach(function(_){en(_.meta[1][0].data)==6e3&&v.sheets.push(aA(d,_))})}),(f=v).sheets.forEach(function(b,_){Qp(l,b,_==0?f.name:f.name+"_"+_,!0)}))})}),l.SheetNames.length==0)throw new Error("Empty NUMBERS file");return l}function rb(a){var o={},l=[];if(a.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),a.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var h,f;try{h=Js(u.content)}catch(d){return console.log("?? "+u.content.length+" "+(d.message||d))}try{f=Xs(h)}catch(d){return console.log("## "+(d.message||d))}f.forEach(function(d){o[d.id]=d.messages,l.push(d.id)})}}),!l.length)throw new Error("File has no messages");if((a=(a=(a=(a=o==null?void 0:o[1])==null?void 0:a[0])==null?void 0:a.meta)==null?void 0:a[1])!=null&&a[0].data&&en(o[1][0].meta[1][0].data)==1e4)throw new Error("Pages documents are not supported");var c=((a=(a=(a=(a=o==null?void 0:o[1])==null?void 0:a[0])==null?void 0:a.meta)==null?void 0:a[1])==null?void 0:a[0].data)&&en(o[1][0].meta[1][0].data)==1&&o[1][0];if(c||l.forEach(function(u){o[u].forEach(function(h){if(en(h.meta[1][0].data)>>>0==1){if(c)throw new Error("Document has multiple roots");c=h}})}),!c)throw new Error("Cannot find Document root");return iA(o,c)}function oA(a,o){if(!o||!o.numbers)throw new Error("Must pass a `numbers` option -- check the README");var l=a.Sheets[a.SheetNames[0]];1<a.SheetNames.length&&console.error("The Numbers writer currently writes only the first table");var c=Wr(l["!ref"]);c.s.r=c.s.c=0;var u=!1;9<c.e.c&&(u=!0,c.e.c=9),49<c.e.r&&(u=!0,c.e.r=49),u&&console.error("The Numbers writer is currently limited to ".concat(Bt(c)));var h=Uh(l,{range:c,header:1}),f=["~Sh33tJ5~"];h.forEach(function(Ye){return Ye.forEach(function(Je){typeof Je=="string"&&f.push(Je)})});var d={},y=[],v=wt.read(o.numbers,{type:"base64"});v.FileIndex.map(function(Ye,Je){return[Ye,v.FullPaths[Je]]}).forEach(function(Ye){var Je=Ye[0],Ge=Ye[1];Je.type==2&&Je.name.match(/\.iwa/)&&Xs(Js(Je.content)).forEach(function(je){y.push(je.id),d[je.id]={deps:[],location:Ge,type:en(je.messages[0].meta[1][0].data)}})}),y.sort(function(Ye,Je){return Ye-Je});var b=y.filter(function(Ye){return 1<Ye}).map(function(Ye){return[Ye,vr(Ye)]});v.FileIndex.map(function(Ye,Je){return[Ye,v.FullPaths[Je]]}).forEach(function(Ye){var Je=Ye[0];Ye[1],Je.name.match(/\.iwa/)&&Xs(Js(Je.content)).forEach(function(Ge){Ge.messages.forEach(function(je){b.forEach(function(ht){Ge.messages.some(function(xt){return en(xt.meta[1][0].data)!=11006&&function(Nt,Jt){e:for(var lt=0;lt<=Nt.length-Jt.length;++lt){for(var Le=0;Le<Jt.length;++Le)if(Nt[lt+Le]!=Jt[Le])continue e;return!0}return!1}(xt.data,ht[1])})&&d[ht[0]].deps.push(Ge.id)})})})});for(var _,T=wt.find(v,d[1].location),S=Xs(Js(T.content)),I=0;I<S.length;++I){var k=S[I];k.id==1&&(_=k)}for(var M=Bn(dr(_.messages[0].data)[1][0].data),S=Xs(Js((T=wt.find(v,d[M].location)).content)),I=0;I<S.length;++I)(k=S[I]).id==M&&(_=k);var Ie=dr(_.messages[0].data);for(Ie[1]=[{type:2,data:Zx(a.SheetNames[0])}],_.messages[0].data=nn(Ie),T.content=Uo(Vo(S)),T.size=T.content.length,M=Bn(Ie[2][0].data),S=Xs(Js((T=wt.find(v,d[M].location)).content)),I=0;I<S.length;++I)(k=S[I]).id==M&&(_=k);for(M=Bn(dr(_.messages[0].data)[2][0].data),S=Xs(Js((T=wt.find(v,d[M].location)).content)),I=0;I<S.length;++I)(k=S[I]).id==M&&(_=k);u=dr(_.messages[0].data),u[6][0].data=vr(c.e.r+1),u[7][0].data=vr(c.e.c+1);for(var D=Bn(u[46][0].data),o=wt.find(v,d[D].location),F=Xs(Js(o.content)),j=0;j<F.length&&F[j].id!=D;++j);if(F[j].id!=D)throw"Bad ColumnRowUIDMapArchive";var B=dr(F[j].messages[0].data);B[1]=[],B[2]=[],B[3]=[];for(var z=0;z<=c.e.c;++z)B[1].push({type:2,data:nn([[],[{type:0,data:vr(z+420690)}],[{type:0,data:vr(z+420690)}]])}),B[2].push({type:0,data:vr(z)}),B[3].push({type:0,data:vr(z)});B[4]=[],B[5]=[],B[6]=[];for(var ae=0;ae<=c.e.r;++ae)B[4].push({type:2,data:nn([[],[{type:0,data:vr(ae+726270)}],[{type:0,data:vr(ae+726270)}]])}),B[5].push({type:0,data:vr(ae)}),B[6].push({type:0,data:vr(ae)});if(F[j].messages[0].data=nn(B),o.content=Uo(Vo(F)),o.size=o.content.length,delete u[46],a=dr(u[4][0].data),a[7][0].data=vr(c.e.r+1),Ie=Bn(dr(a[1][0].data)[2][0].data),(F=Xs(Js((o=wt.find(v,d[Ie].location)).content)))[0].id!=Ie)throw"Bad HeaderStorageBucket";for(var he=dr(F[0].messages[0].data),ae=0;ae<h.length;++ae){var le=dr(he[2][0].data);le[1][0].data=vr(ae),le[4][0].data=vr(h[ae].length),he[2][ae]={type:he[2][0].type,data:nn(le)}}F[0].messages[0].data=nn(he),o.content=Uo(Vo(F)),o.size=o.content.length;var ve,Ie=Bn(a[2][0].data);if((F=Xs(Js((o=wt.find(v,d[Ie].location)).content)))[0].id!=Ie)throw"Bad HeaderStorageBucket";for(he=dr(F[0].messages[0].data),z=0;z<=c.e.c;++z)(le=dr(he[2][0].data))[1][0].data=vr(z),le[4][0].data=vr(c.e.r+1),he[2][z]={type:he[2][0].type,data:nn(le)};F[0].messages[0].data=nn(he),o.content=Uo(Vo(F)),o.size=o.content.length,l["!merges"]&&(it=function(Ye){for(var Je=927262;Je<2e6;++Je)if(!d[Je])return d[Je]=Ye,Je;throw new Error("Too many messages")}({type:6144,deps:[M],location:d[M].location}),ve=[[],[]],l["!merges"].forEach(function(Ye){ve[1].push({type:2,data:nn([[],[{type:2,data:nn([[],[{type:5,data:new Uint8Array(new Uint16Array([Ye.s.r,Ye.s.c]).buffer)}]])}],[{type:2,data:nn([[],[{type:5,data:new Uint8Array(new Uint16Array([Ye.e.r-Ye.s.r+1,Ye.e.c-Ye.s.c+1]).buffer)}]])}]])})}),a[13]=[{type:2,data:nn([[],[{type:0,data:vr(it)}]])}],S.push({id:it,messages:[(Ue=6144,it=nn(ve),{meta:[[],[{type:0,data:vr(Ue)}]],data:it})]}));var De=Bn(a[4][0].data);(function(){for(var Ye,Je=wt.find(v,d[De].location),Ge=Xs(Js(Je.content)),je=0;je<Ge.length;++je){var ht=Ge[je];ht.id==De&&(Ye=ht)}var xt=dr(Ye.messages[0].data);xt[3]=[],f.forEach(function(Nt,Jt){xt[3].push({type:2,data:nn([[],[{type:0,data:vr(Jt)}],[{type:0,data:vr(1)}],[{type:2,data:Zx(Nt)}]])})}),Ye.messages[0].data=nn(xt),Je.content=Uo(Vo(Ge)),Je.size=Je.content.length})();var _e=dr(a[3][0].data),Ue=_e[1][0];delete _e[2];var Ue,it,it=dr(Ue.data),nt=Bn(it[2][0].data);return function(){for(var Ye,Je=wt.find(v,d[nt].location),Ge=Xs(Js(Je.content)),je=0;je<Ge.length;++je){var ht=Ge[je];ht.id==nt&&(Ye=ht)}var xt=dr(Ye.messages[0].data);delete xt[6],delete _e[7];var Nt=new Uint8Array(xt[5][0].data);xt[5]=[];for(var Jt=0,lt=0;lt<=c.e.r;++lt){var Le=dr(Nt);Jt+=function(Ut,pr,ar){var Nr,un;if((Nr=Ut[6])==null||!Nr[0]||(un=Ut[7])==null||!un[0])throw"Mutation only works on post-BNC storages!";if((un=(un=Ut[8])==null?void 0:un[0])!=null&&un.data&&0<en(Ut[8][0].data))throw"Math only works with normal offsets";for(var ie,Ir,Sr=0,Nn=ii(Ut[7][0].data),ea=0,Q=[],Te=ii(Ut[4][0].data),se=0,xe=[],re=0;re<pr.length;++re)if(pr[re]!=null){switch(Nn.setUint16(2*re,ea,!0),Te.setUint16(2*re,se,!0),typeof pr[re]){case"string":ie=Up({t:"s",v:pr[re]},ar),Ir=Bp({t:"s",v:pr[re]},ar);break;case"number":ie=Up({t:"n",v:pr[re]},ar),Ir=Bp({t:"n",v:pr[re]},ar);break;case"boolean":ie=Up({t:"b",v:pr[re]},ar),Ir=Bp({t:"b",v:pr[re]},ar);break;default:throw new Error("Unsupported value "+pr[re])}Q.push(ie),ea+=ie.length,xe.push(Ir),se+=Ir.length,++Sr}else Nn.setUint16(2*re,65535,!0),Te.setUint16(2*re,65535);for(Ut[2][0].data=vr(Sr);re<Ut[7][0].data.length/2;++re)Nn.setUint16(2*re,65535,!0),Te.setUint16(2*re,65535,!0);return Ut[6][0].data=Wi(Q),Ut[3][0].data=Wi(xe),Sr}(Le,h[lt],f),Le[1][0].data=vr(lt),xt[5].push({data:nn(Le),type:2})}xt[1]=[{type:0,data:vr(c.e.c+1)}],xt[2]=[{type:0,data:vr(c.e.r+1)}],xt[3]=[{type:0,data:vr(Jt)}],xt[4]=[{type:0,data:vr(c.e.r+1)}],Ye.messages[0].data=nn(xt),Je.content=Uo(Vo(Ge)),Je.size=Je.content.length}(),Ue.data=nn(it),a[3][0].data=nn(_e),u[4][0].data=nn(a),_.messages[0].data=nn(u),T.content=Uo(Vo(S)),T.size=T.content.length,v}function nb(a){return function(o){for(var l=0;l!=a.length;++l){var c=a[l];o[c[0]]===void 0&&(o[c[0]]=c[1]),c[2]==="n"&&(o[c[0]]=Number(o[c[0]]))}}}function $p(a){nb([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(a)}function Wp(a){nb([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(a)}function lA(a,o){if(!a)return 0;try{a=o.map(function(l){return l.id||(l.id=l.strRelID),[l.name,a["!id"][l.id].Target,(l=a["!id"][l.id].Type,-1<Xt.WS.indexOf(l)?"sheet":Xt.CS&&l==Xt.CS?"chart":Xt.DS&&l==Xt.DS?"dialog":Xt.MS&&l==Xt.MS?"macro":l&&l.length?l:"sheet")]})}catch{return null}return a&&a.length!==0?a:null}function cA(a,o,l,c,u,h,f,d,y,v,b,_){try{h[c]=Jc(kn(a,l,!0),o);var T=Jr(a,o);switch(d){case"sheet":k=kS(T,o,u,y,h[c],v,b,_);break;case"chart":if(!(k=FS(T,o,u,y,h[c],v))||!k["!drawel"])break;var I=Ni(k["!drawel"].Target,o),S=Xc(I),F=Ni((F=kn(a,I,!0),S=Jc(kn(a,S,!0),I),F?(F=(F.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1],S["!id"][F].Target):"??"),I),I=Xc(F),k=yS(kn(a,F,!0),0,0,Jc(kn(a,I,!0),F),0,k);break;case"macro":D=o,h[c],D.slice(-4),k={"!type":"macro"};break;case"dialog":D=o,h[c],D.slice(-4),k={"!type":"dialog"};break;default:throw new Error("Unrecognized sheet type "+d)}f[c]=k;var M=[];h&&h[c]&&Gr(h[c]).forEach(function(j){var B,z,ae,he,le,ve,Ie="";if(h[c][j].Type==Xt.CMNT){Ie=Ni(h[c][j].Target,o);var De=DS(Jr(a,Ie,!0),Ie,y);if(!De||!De.length)return;Zv(k,De,!1)}h[c][j].Type==Xt.TCMNT&&(Ie=Ni(h[c][j].Target,o),M=M.concat((B=Jr(a,Ie,!0),z=y,he=!(ae=[]),le={},ve=0,B.replace(vn,function(_e,Ue){var it=Lt(_e);switch(zs(it[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":break;case"<threadedComment":le={author:it.personId,guid:it.id,ref:it.ref,T:1};break;case"</threadedComment>":le.t!=null&&ae.push(le);break;case"<text>":case"<text":ve=Ue+_e.length;break;case"</text>":le.t=B.slice(ve,Ue).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":he=!0;break;case"</mentions>":he=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":he=!0;break;case"</ext>":he=!1;break;default:if(!he&&z.WTF)throw new Error("unrecognized "+it[0]+" in threaded comments")}return _e}),ae)))}),M&&M.length&&Zv(k,M,!0,y.people||[])}catch(j){if(y.WTF)throw j}var D,F}function Zs(a){return a.charAt(0)=="/"?a.slice(1):a}function sb(a,o){if(Rs(),$p(o=o||{}),Un(a,"META-INF/manifest.xml")||Un(a,"objectdata.xml"))return Yx(a,o);if(Un(a,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(a.FileIndex)return rb(a);var l=wt.utils.cfb_new();return Fa(a).forEach(function(Ge){Wt(l,Ge,function(ht,xt,Nt){return Yf(_l(ht,xt))}(a,Ge))}),rb(l)}if(!Un(a,"[Content_Types].xml"))throw Un(a,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Un(a,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var c,u,h=Fa(a),f=function(Ge){var je=lp();if(!Ge||!Ge.match)return je;var ht={};if((Ge.match(vn)||[]).forEach(function(xt){var Nt=Lt(xt);switch(Nt[0].replace(Qf,"<")){case"<?xml":break;case"<Types":je.xmlns=Nt["xmlns"+(Nt[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":ht[Nt.Extension]=Nt.ContentType;break;case"<Override":je[op[Nt.ContentType]]!==void 0&&je[op[Nt.ContentType]].push(Nt.PartName)}}),je.xmlns!==rn.CT)throw new Error("Unknown Namespace: "+je.xmlns);return je.calcchain=0<je.calcchains.length?je.calcchains[0]:"",je.sst=0<je.strs.length?je.strs[0]:"",je.style=0<je.styles.length?je.styles[0]:"",je.defaults=ht,delete je.calcchains,je}(kn(a,"[Content_Types].xml")),le=!1;if(f.workbooks.length===0&&Jr(a,u="xl/workbook.xml",!0)&&f.workbooks.push(u),f.workbooks.length===0){if(!Jr(a,u="xl/workbook.bin",!0))throw new Error("Could not find workbook");f.workbooks.push(u),le=!0}f.workbooks[0].slice(-3)=="bin"&&(le=!0);var d={},y={};if(!o.bookSheets&&!o.bookProps){if(fu=[],f.sst)try{fu=IS(Jr(a,Zs(f.sst)),f.sst,o)}catch(Ge){if(o.WTF)throw Ge}o.cellStyles&&f.themes.length&&(I=kn(a,f.themes[0].replace(/^\//,""),!0)||"",f.themes[0],d=Qv(I,o)),f.style&&(y=NS(Jr(a,Zs(f.style)),f.style,d,o))}f.links.map(function(Ge){try{return Jc(kn(a,Xc(Zs(Ge))),Ge),PS(Jr(a,Zs(Ge)),0,Ge,o)}catch{}});var v,b,_,T=CS(Jr(a,Zs(f.workbooks[0])),f.workbooks[0],o),S={},I="";f.coreprops.length&&((I=Jr(a,Zs(f.coreprops[0]),!0))&&(S=gy(I)),f.extprops.length!==0&&(I=Jr(a,Zs(f.extprops[0]),!0))&&(k=o,_={},b=(b=S)||{},v=kr(v=I),Ro.forEach(function(Ge){var je=(v.match(Hs(Ge[0]))||[])[1];switch(Ge[2]){case"string":je&&(b[Ge[1]]=qt(je));break;case"bool":b[Ge[1]]=je==="true";break;case"raw":var ht=v.match(new RegExp("<"+Ge[0]+"[^>]*>([\\s\\S]*?)</"+Ge[0]+">"));ht&&0<ht.length&&(_[Ge[1]]=ht[1])}}),_.HeadingPairs&&_.TitlesOfParts&&xy(_.HeadingPairs,_.TitlesOfParts,b,k)));var k={};o.bookSheets&&!o.bookProps||f.custprops.length!==0&&(I=kn(a,Zs(f.custprops[0]),!0))&&(k=function(Ge,je){var ht={},xt="",Nt=Ge.match(k6);if(Nt)for(var Jt=0;Jt!=Nt.length;++Jt){var lt=Nt[Jt],Le=Lt(lt);switch(Le[0]){case"<?xml":case"<Properties":break;case"<property":xt=qt(Le.name);break;case"</property>":xt=null;break;default:if(lt.indexOf("<vt:")===0){var Ut=lt.split(">"),pr=Ut[0].slice(4),ar=Ut[1];switch(pr){case"lpstr":case"bstr":case"lpwstr":ht[xt]=qt(ar);break;case"bool":ht[xt]=$r(ar);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":ht[xt]=parseInt(ar,10);break;case"r4":case"r8":case"decimal":ht[xt]=parseFloat(ar);break;case"filetime":case"date":ht[xt]=Ur(ar);break;case"cy":case"error":ht[xt]=qt(ar);break;default:if(pr.slice(-1)=="/")break;je.WTF&&typeof console<"u"&&console.warn("Unexpected",lt,pr,Ut)}}else if(lt.slice(0,2)!=="</"&&je.WTF)throw new Error(lt)}}return ht}(I,o));var M={};if((o.bookSheets||o.bookProps)&&(T.Sheets?c=T.Sheets.map(function(Ge){return Ge.name}):S.Worksheets&&0<S.SheetNames.length&&(c=S.SheetNames),o.bookProps&&(M.Props=S,M.Custprops=k),o.bookSheets&&c!==void 0&&(M.SheetNames=c),o.bookSheets?M.SheetNames:o.bookProps))return M;c={},I={},o.bookDeps&&f.calcchain&&(I=RS(Jr(a,Zs(f.calcchain)),f.calcchain));var D,F,j=0,B={},z=T.Sheets;S.Worksheets=z.length,S.SheetNames=[];for(var ae=0;ae!=z.length;++ae)S.SheetNames[ae]=z[ae].name;var he=le?"bin":"xml",le=f.workbooks[0].lastIndexOf("/"),ve=(f.workbooks[0].slice(0,le+1)+"_rels/"+f.workbooks[0].slice(le+1)+".rels").replace(/^\//,"");Un(a,ve)||(ve="xl/_rels/workbook."+he+".rels");var Ie,De,_e,Ue=Jc(kn(a,ve,!0),ve.replace(/_rels.*/,"s5s"));1<=(f.metadata||[]).length&&(o.xlmeta=OS(Jr(a,Zs(f.metadata[0])),f.metadata[0],o)),1<=(f.people||[]).length&&(o.people=(le=Jr(a,Zs(f.people[0])),Ie=o,_e=!(De=[]),le.replace(vn,function(Ge){var je=Lt(Ge);switch(zs(je[0])){case"<?xml":case"<personList":case"</personList>":break;case"<person":De.push({name:je.displayname,id:je.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":_e=!0;break;case"</ext>":_e=!1;break;default:if(!_e&&Ie.WTF)throw new Error("unrecognized "+je[0]+" in threaded comments")}return Ge}),De)),Ue=Ue&&lA(Ue,T.Sheets);var it=Jr(a,"xl/worksheets/sheet.xml",!0)?1:0;e:for(j=0;j!=S.Worksheets;++j){var nt="sheet";if(Ue&&Ue[j]?(D="xl/"+Ue[j][1].replace(/[\/]?xl\//,""),Un(a,D)||(D=Ue[j][1]),Un(a,D)||(D=ve.replace(/_rels\/.*$/,"")+Ue[j][1]),nt=Ue[j][2]):D=(D="xl/worksheets/sheet"+(j+1-it)+"."+he).replace(/sheet0\./,"sheet."),F=D.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),o&&o.sheets!=null)switch(typeof o.sheets){case"number":if(j!=o.sheets)continue e;break;case"string":if(S.SheetNames[j].toLowerCase()!=o.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(o.sheets)){for(var Ye=!1,Je=0;Je!=o.sheets.length;++Je)typeof o.sheets[Je]=="number"&&o.sheets[Je]==j&&(Ye=1),typeof o.sheets[Je]=="string"&&o.sheets[Je].toLowerCase()==S.SheetNames[j].toLowerCase()&&(Ye=1);if(!Ye)continue e}}cA(a,D,F,S.SheetNames[j],j,B,c,nt,o,T,d,y)}return M={Directory:f,Workbook:T,Props:S,Custprops:k,Deps:I,Sheets:c,SheetNames:S.SheetNames,Strings:fu,Styles:y,Themes:d,SSF:Tr(de)},o&&o.bookFiles&&(a.files?(M.keys=h,M.files=a.files):(M.keys=[],M.files={},a.FullPaths.forEach(function(Ge,je){Ge=Ge.replace(/^Root Entry[\/]/,""),M.keys.push(Ge),M.files[Ge]=a.FileIndex[je]}))),o&&o.bookVBA&&(0<f.vba.length?M.vbaraw=Jr(a,Zs(f.vba[0]),!0):f.defaults&&f.defaults.bin===N5&&(M.vbaraw=Jr(a,"xl/vbaProject.bin",!0))),M}function uA(a,o){var l,c=o||{},u="Workbook",h=wt.find(a,u);try{if(u="/!DataSpaces/Version",!(h=wt.find(a,u))||!h.content)throw new Error("ECMA-376 Encrypted file missing "+u);if(f=h.content,(l={}).id=f.read_shift(0,"lpp4"),l.R=ai(f,4),l.U=ai(f,4),l.W=ai(f,4),u="/!DataSpaces/DataSpaceMap",!(h=wt.find(a,u))||!h.content)throw new Error("ECMA-376 Encrypted file missing "+u);var f=t5(h.content);if(f.length!==1||f[0].comps.length!==1||f[0].comps[0].t!==0||f[0].name!=="StrongEncryptionDataSpace"||f[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+u);if(u="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(h=wt.find(a,u))||!h.content)throw new Error("ECMA-376 Encrypted file missing "+u);if(f=function(d){var y=[];d.l+=4;for(var v=d.read_shift(4);0<v--;)y.push(d.read_shift(0,"lpp4"));return y}(h.content),f.length!=1||f[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+u);if(u="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(h=wt.find(a,u))||!h.content)throw new Error("ECMA-376 Encrypted file missing "+u);r5(h.content)}catch{}if(u="/EncryptionInfo",!(h=wt.find(a,u))||!h.content)throw new Error("ECMA-376 Encrypted file missing "+u);if(o=n5(h.content),u="/EncryptedPackage",!(h=wt.find(a,u))||!h.content)throw new Error("ECMA-376 Encrypted file missing "+u);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],h.content,c.password||"",c);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],h.content,c.password||"",c);throw new Error("File is password-protected")}function fA(a,o){return(o.bookType=="ods"?Jx:o.bookType=="numbers"?oA:o.bookType=="xlsb"?function(l,c){jl=1024,l&&!l.SSF&&(l.SSF=Tr(de)),l&&l.SSF&&(Rs(),Ds(l.SSF),c.revssf=yn(l.SSF),c.revssf[l.SSF[65535]]=0,c.ssf=l.SSF),c.rels={},c.wbrels={},c.Strings=[],c.Strings.Count=0,c.Strings.Unique=0,hu?c.revStrings=new Map:(c.revStrings={},c.revStrings.foo=[],delete c.revStrings.foo);var u=c.bookType=="xlsb"?"bin":"xml",h=-1<tx.indexOf(c.bookType),f=lp();Wp(c=c||{});var d=Mc(),y="",v=0;if(c.cellXfs=[],$i(c.cellXfs,{},{revssf:{General:0}}),l.Props||(l.Props={}),Wt(d,y="docProps/core.xml",yy(l.Props,c)),f.coreprops.push(y),jr(c.rels,2,y,Xt.CORE_PROPS),y="docProps/app.xml",!l.Props||!l.Props.SheetNames)if(l.Workbook&&l.Workbook.Sheets){for(var b=[],_=0;_<l.SheetNames.length;++_)(l.Workbook.Sheets[_]||{}).Hidden!=2&&b.push(l.SheetNames[_]);l.Props.SheetNames=b}else l.Props.SheetNames=l.SheetNames;for(l.Props.Worksheets=l.Props.SheetNames.length,Wt(d,y,by(l.Props)),f.extprops.push(y),jr(c.rels,3,y,Xt.EXT_PROPS),l.Custprops!==l.Props&&0<Gr(l.Custprops||{}).length&&(Wt(d,y="docProps/custom.xml",wy(l.Custprops)),f.custprops.push(y),jr(c.rels,4,y,Xt.CUST_PROPS)),v=1;v<=l.SheetNames.length;++v){var T,S,I,k={"!id":{}},M=l.Sheets[l.SheetNames[v-1]];Wt(d,y="xl/worksheets/sheet"+v+"."+u,function(D,F,j,B,z){return(F.slice(-4)===".bin"?gS:Sx)(D,j,B,z)}(v-1,y,c,l,k)),f.sheets.push(y),jr(c.wbrels,-1,"worksheets/sheet"+v+"."+u,Xt.WS[0]),M&&(T=M["!comments"],S=!1,I="",T&&0<T.length&&(Wt(d,I="xl/comments"+v+"."+u,function(D,F,j){return(F.slice(-4)===".bin"?F5:ex)(D)}(T,I)),f.comments.push(I),jr(k,-1,"../comments"+v+"."+u,Xt.CMNT),S=!0),M["!legacy"]&&S&&Wt(d,"xl/drawings/vmlDrawing"+v+".vml",Jv(v,M["!comments"])),delete M["!comments"],delete M["!legacy"]),k["!id"].rId1&&Wt(d,Xc(y),Il(k))}return c.Strings!=null&&0<c.Strings.length&&(Wt(d,y="xl/sharedStrings."+u,function(D,F,j){return(F.slice(-4)===".bin"?e5:Nv)(D,j)}(c.Strings,y,c)),f.strs.push(y),jr(c.wbrels,-1,"sharedStrings."+u,Xt.SST)),Wt(d,y="xl/workbook."+u,function(D,F,j){return(F.slice(-4)===".bin"?AS:Rx)(D)}(l,y)),f.workbooks.push(y),jr(c.rels,1,y,Xt.WB),Wt(d,y="xl/theme/theme1.xml",Sp(l.Themes,c)),f.themes.push(y),jr(c.wbrels,-1,"theme/theme1.xml",Xt.THEME),Wt(d,y="xl/styles."+u,function(D,F,j){return(F.slice(-4)===".bin"?y5:Gv)(D,j)}(l,y,c)),f.styles.push(y),jr(c.wbrels,-1,"styles."+u,Xt.STY),l.vbaraw&&h&&(Wt(d,y="xl/vbaProject.bin",l.vbaraw),f.vba.push(y),jr(c.wbrels,-1,"vbaProject.bin",Xt.VBA)),Wt(d,y="xl/metadata."+u,function(D){return(D.slice(-4)===".bin"?k5:Xv)()}(y)),f.metadata.push(y),jr(c.wbrels,-1,"metadata."+u,Xt.XLMETA),Wt(d,"[Content_Types].xml",dy(f,c)),Wt(d,"_rels/.rels",Il(c.rels)),Wt(d,"xl/_rels/workbook."+u+".rels",Il(c.wbrels)),delete c.revssf,delete c.ssf,d}:ab)(a,o)}function ab(a,o){jl=1024,a&&!a.SSF&&(a.SSF=Tr(de)),a&&a.SSF&&(Rs(),Ds(a.SSF),o.revssf=yn(a.SSF),o.revssf[a.SSF[65535]]=0,o.ssf=a.SSF),o.rels={},o.wbrels={},o.Strings=[],o.Strings.Count=0,o.Strings.Unique=0,hu?o.revStrings=new Map:(o.revStrings={},o.revStrings.foo=[],delete o.revStrings.foo);var l="xml",c=-1<tx.indexOf(o.bookType),u=lp();Wp(o=o||{});var h=Mc(),f="",d=0;if(o.cellXfs=[],$i(o.cellXfs,{},{revssf:{General:0}}),a.Props||(a.Props={}),f="docProps/core.xml",Wt(h,f,yy(a.Props,o)),u.coreprops.push(f),jr(o.rels,2,f,Xt.CORE_PROPS),f="docProps/app.xml",!a.Props||!a.Props.SheetNames)if(a.Workbook&&a.Workbook.Sheets){for(var y=[],v=0;v<a.SheetNames.length;++v)(a.Workbook.Sheets[v]||{}).Hidden!=2&&y.push(a.SheetNames[v]);a.Props.SheetNames=y}else a.Props.SheetNames=a.SheetNames;a.Props.Worksheets=a.Props.SheetNames.length,Wt(h,f,by(a.Props)),u.extprops.push(f),jr(o.rels,3,f,Xt.EXT_PROPS),a.Custprops!==a.Props&&0<Gr(a.Custprops||{}).length&&(Wt(h,f="docProps/custom.xml",wy(a.Custprops)),u.custprops.push(f),jr(o.rels,4,f,Xt.CUST_PROPS));var b,_=["SheetJ5"];for(o.tcid=0,d=1;d<=a.SheetNames.length;++d){var T,S,I,k,M={"!id":{}},D=a.Sheets[a.SheetNames[d-1]];Wt(h,f="xl/worksheets/sheet"+d+"."+l,Sx(d-1,o,a,M)),u.sheets.push(f),jr(o.wbrels,-1,"worksheets/sheet"+d+"."+l,Xt.WS[0]),D&&(S=!1,I="",(T=D["!comments"])&&0<T.length&&(k=!1,T.forEach(function(F){F[1].forEach(function(j){j.T==1&&(k=!0)})}),k&&(Wt(h,I="xl/threadedComments/threadedComment"+d+"."+l,function(F,j,B){var z=[Zr,Ze("ThreadedComments",null,{xmlns:rn.TCMNT}).replace(/[\/]>/,">")];return F.forEach(function(ae){var he="";(ae[1]||[]).forEach(function(le,ve){var Ie;le.T?(le.a&&j.indexOf(le.a)==-1&&j.push(le.a),Ie={ref:ae[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+B.tcid++).slice(-12)+"}"},ve==0?he=Ie.id:Ie.parentId=he,le.ID=Ie.id,le.a&&(Ie.personId="{54EE7950-7262-4200-6969-"+("000000000000"+j.indexOf(le.a)).slice(-12)+"}"),z.push(Ze("threadedComment",cn("text",le.t||""),Ie))):delete le.ID})}),z.push("</ThreadedComments>"),z.join("")}(T,_,o)),u.threadedcomments.push(I),jr(M,-1,"../threadedComments/threadedComment"+d+"."+l,Xt.TCMNT)),Wt(h,I="xl/comments"+d+"."+l,ex(T)),u.comments.push(I),jr(M,-1,"../comments"+d+"."+l,Xt.CMNT),S=!0),D["!legacy"]&&S&&Wt(h,"xl/drawings/vmlDrawing"+d+".vml",Jv(d,D["!comments"])),delete D["!comments"],delete D["!legacy"]),M["!id"].rId1&&Wt(h,Xc(f),Il(M))}return o.Strings!=null&&0<o.Strings.length&&(Wt(h,f="xl/sharedStrings.xml",Nv(o.Strings,o)),u.strs.push(f),jr(o.wbrels,-1,"sharedStrings.xml",Xt.SST)),Wt(h,f="xl/workbook.xml",Rx(a)),u.workbooks.push(f),jr(o.rels,1,f,Xt.WB),Wt(h,f="xl/theme/theme1.xml",Sp(a.Themes,o)),u.themes.push(f),jr(o.wbrels,-1,"theme/theme1.xml",Xt.THEME),Wt(h,f="xl/styles.xml",Gv(a,o)),u.styles.push(f),jr(o.wbrels,-1,"styles.xml",Xt.STY),a.vbaraw&&c&&(Wt(h,f="xl/vbaProject.bin",a.vbaraw),u.vba.push(f),jr(o.wbrels,-1,"vbaProject.bin",Xt.VBA)),Wt(h,f="xl/metadata.xml",Xv()),u.metadata.push(f),jr(o.wbrels,-1,"metadata.xml",Xt.XLMETA),1<_.length&&(Wt(h,f="xl/persons/person.xml",(c=_,b=[Zr,Ze("personList",null,{xmlns:rn.TCMNT,"xmlns:x":Dr[0]}).replace(/[\/]>/,">")],c.forEach(function(F,j){b.push(Ze("person",null,{displayName:F,id:"{54EE7950-7262-4200-6969-"+("000000000000"+j).slice(-12)+"}",userId:F,providerId:"None"}))}),b.push("</personList>"),b.join(""))),u.people.push(f),jr(o.wbrels,-1,"persons/person.xml",Xt.PEOPLE)),Wt(h,"[Content_Types].xml",dy(u,o)),Wt(h,"_rels/.rels",Il(o.rels)),Wt(h,"xl/_rels/workbook.xml.rels",Il(o.wbrels)),delete o.revssf,delete o.ssf,h}function zp(a,o){var l="";switch((o||{}).type||"base64"){case"buffer":return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7]];case"base64":l=ee(a.slice(0,12));break;case"binary":l=a;break;case"array":return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7]];default:throw new Error("Unrecognized type "+(o&&o.type||"undefined"))}return[l.charCodeAt(0),l.charCodeAt(1),l.charCodeAt(2),l.charCodeAt(3),l.charCodeAt(4),l.charCodeAt(5),l.charCodeAt(6),l.charCodeAt(7)]}function ib(a,o){var l=0;e:for(;l<a.length;)switch(a.charCodeAt(l)){case 10:case 13:case 32:++l;break;case 60:return jp(a.slice(l),o);default:break e}return Dl.to_workbook(a,o)}function Hp(a,o,l,c){return c?(l.type="string",Dl.to_workbook(a,l)):Dl.to_workbook(o,l)}function Mh(a,o){R();var l=o||{};if(typeof ArrayBuffer<"u"&&a instanceof ArrayBuffer)return Mh(new Uint8Array(a),((l=Tr(l)).type="array",l));typeof Uint8Array<"u"&&a instanceof Uint8Array&&!l.type&&(l.type=typeof Deno<"u"?"buffer":"array");var c,u,h,f,d,y=a,v=!1;if(l.cellStyles&&(l.cellNF=!0,l.sheetStubs=!0),Ll={},l.dateNF&&(Ll.dateNF=l.dateNF),l.type||(l.type=te&&Buffer.isBuffer(a)?"buffer":"base64"),l.type=="file"&&(l.type=te?"buffer":"binary",y=function(_){if(Ws!==void 0)return Ws.readFileSync(_);if(typeof Deno<"u")return Deno.readFileSync(_);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var T=File(_);T.open("r"),T.encoding="binary";var S=T.read();return T.close(),S}catch(I){if(!I.message||!I.message.match(/onstruct/))throw I}throw new Error("Cannot access file "+_)}(a),typeof Uint8Array>"u"||te||(l.type="array")),l.type=="string"&&(v=!0,l.type="binary",l.codepage=65001,y=(b=a).match(/[^\x00-\x7F]/)?Os(b):b),l.type=="array"&&typeof Uint8Array<"u"&&a instanceof Uint8Array&&typeof ArrayBuffer<"u"){var b=new ArrayBuffer(3),b=new Uint8Array(b);if(b.foo="bar",!b.foo)return(l=Tr(l)).type="array",Mh(X(y),l)}switch((c=zp(y,l))[0]){case 208:if(c[1]===207&&c[2]===17&&c[3]===224&&c[4]===161&&c[5]===177&&c[6]===26&&c[7]===225)return f=wt.read(y,l),d=l,(wt.find(f,"EncryptedPackage")?uA:jh)(f,d);break;case 9:if(c[1]<=8)return jh(y,l);break;case 60:return jp(y,l);case 73:if(c[1]===73&&c[2]===42&&c[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(c[1]===68)return function(_,T){var S=T||{},I=!!S.WTF;S.WTF=!0;try{var k=ov.to_workbook(_,S);return S.WTF=I,k}catch(M){if(S.WTF=I,!M.message.match(/SYLK bad record ID/)&&I)throw M;return Dl.to_workbook(_,T)}}(y,l);break;case 84:if(c[1]===65&&c[2]===66&&c[3]===76)return cv.to_workbook(y,l);break;case 80:return c[1]===75&&c[2]<9&&c[3]<9?(h=d=y,(u=(u=l)||{}).type||(u.type=te&&Buffer.isBuffer(d)?"buffer":"base64"),sb(Lc(h,u),u)):Hp(a,y,l,v);case 239:return c[3]===60?jp(y,l):Hp(a,y,l,v);case 255:if(c[1]===254)return h=y,(u=l).type=="base64"&&(h=ee(h)),h=e.utils.decode(1200,h.slice(2),"str"),u.type="binary",ib(h,u);if(c[1]===0&&c[2]===2&&c[3]===0)return Mo.to_workbook(y,l);break;case 0:if(c[1]===0&&(2<=c[2]&&c[3]===0||c[2]===0&&(c[3]===8||c[3]===9)))return Mo.to_workbook(y,l);break;case 3:case 131:case 139:case 140:return dp.to_workbook(y,l);case 123:if(c[1]===92&&c[2]===114&&c[3]===116)return Mv.to_workbook(y,l);break;case 10:case 13:case 32:return function(_,T){var S="",I=zp(_,T);switch(T.type){case"base64":S=ee(_);break;case"binary":S=_;break;case"buffer":S=_.toString("binary");break;case"array":S=da(_);break;default:throw new Error("Unrecognized type "+T.type)}return I[0]==239&&I[1]==187&&I[2]==191&&(S=kr(S)),T.type="binary",ib(S,T)}(y,l);case 137:if(c[1]===80&&c[2]===78&&c[3]===71)throw new Error("PNG Image File is not a spreadsheet")}return-1<V6.indexOf(c[0])&&c[2]<=12&&c[3]<=31?dp.to_workbook(y,l):Hp(a,y,l,v)}function ob(a,o){return o=o||{},o.type="file",Mh(a,o)}function lb(a,o){switch(o.type){case"base64":case"binary":break;case"buffer":case"array":o.type="";break;case"file":return Aa(o.file,wt.write(a,{type:te?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+o.bookType+"' files");default:throw new Error("Unrecognized type "+o.type)}return wt.write(a,o)}function cb(a,o){var l={},c=te?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(o.compression&&(l.compression="DEFLATE"),o.password)l.type=c;else switch(o.type){case"base64":l.type="base64";break;case"binary":l.type="string";break;case"string":throw new Error("'string' output type invalid for '"+o.bookType+"' files");case"buffer":case"file":l.type=c;break;default:throw new Error("Unrecognized type "+o.type)}if(a=a.FullPaths?wt.write(a,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[l.type]||l.type,compression:!!o.compression}):a.generate(l),typeof Deno<"u"&&typeof a=="string"){if(o.type=="binary"||o.type=="base64")return a;a=new Uint8Array(W(a))}return o.password&&typeof encrypt_agile<"u"?lb(encrypt_agile(a,o.password),o):o.type==="file"?Aa(o.file,a):o.type=="string"?kr(a):a}function La(a,o,l){var c=(l=l||"")+a;switch(o.type){case"base64":return H(Os(c));case"binary":return Os(c);case"string":return a;case"file":return Aa(o.file,c,"utf8");case"buffer":return te?ue(c,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(c):La(c,{type:"binary"}).split("").map(function(u){return u.charCodeAt(0)})}throw new Error("Unrecognized type "+o.type)}function Lh(a,o){switch(o.type){case"string":case"base64":case"binary":for(var l="",c=0;c<a.length;++c)l+=String.fromCharCode(a[c]);return o.type=="base64"?H(l):o.type=="string"?kr(l):l;case"file":return Aa(o.file,a);case"buffer":return a;default:throw new Error("Unrecognized type "+o.type)}}function Gp(a,o){R(),Dx(a);var l,c=Tr(o||{});return c.cellStyles&&(c.cellNF=!0,c.sheetStubs=!0),c.type!="array"?(l=a,o=Tr((o=c)||{}),cb(ab(l,o),o)):(c.type="binary",a=Gp(a,c),c.type="array",W(a))}function Vh(a,o){R(),Dx(a);var l=Tr(o||{});if(l.cellStyles&&(l.cellNF=!0,l.sheetStubs=!0),l.type=="array")return l.type="binary",o=Vh(a,l),l.type="array",W(o);var c,u,h,f=0;if(l.sheet&&(f=typeof l.sheet=="number"?l.sheet:a.SheetNames.indexOf(l.sheet),!a.SheetNames[f]))throw new Error("Sheet not found: "+l.sheet+" : "+typeof l.sheet);switch(l.bookType||"xlsb"){case"xml":case"xlml":return La(BS(a,l),l);case"slk":case"sylk":return La(ov.from_sheet(a.Sheets[a.SheetNames[f]],l),l);case"htm":case"html":return La(Wx(a.Sheets[a.SheetNames[f]],l),l);case"txt":return function(d,y){switch(y.type){case"base64":return H(d);case"binary":case"string":return d;case"file":return Aa(y.file,d,"binary");case"buffer":return te?ue(d,"binary"):d.split("").map(function(v){return v.charCodeAt(0)})}throw new Error("Unrecognized type "+y.type)}(pb(a.Sheets[a.SheetNames[f]],l),l);case"csv":return La(Kp(a.Sheets[a.SheetNames[f]],l),l,"\uFEFF");case"dif":return La(cv.from_sheet(a.Sheets[a.SheetNames[f]],l),l);case"dbf":return Lh(dp.from_sheet(a.Sheets[a.SheetNames[f]],l),l);case"prn":return La(Dl.from_sheet(a.Sheets[a.SheetNames[f]],l),l);case"rtf":return La(Mv.from_sheet(a.Sheets[a.SheetNames[f]],l),l);case"eth":return La(pv.from_sheet(a.Sheets[a.SheetNames[f]],l),l);case"fods":return La(Jx(a,l),l);case"wk1":return Lh(Mo.sheet_to_wk1(a.Sheets[a.SheetNames[f]],l),l);case"wk3":return Lh(Mo.book_to_wk3(a,l),l);case"biff2":l.biff||(l.biff=2);case"biff3":l.biff||(l.biff=3);case"biff4":return l.biff||(l.biff=4),Lh(Mx(a,l),l);case"biff5":l.biff||(l.biff=5);case"biff8":case"xla":case"xls":return l.biff||(l.biff=8),lb(HS(a,h=(h=l)||{}),h);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return c=a,h=Tr((u=l)||{}),iu=new hA(u),cb(fA(c,h),h);default:throw new Error("Unrecognized bookType |"+l.bookType+"|")}}function qp(a){var o;a.bookType||((o=a.file.slice(a.file.lastIndexOf(".")).toLowerCase()).match(/^\.[a-z]+$/)&&(a.bookType=o.slice(1)),a.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[a.bookType]||a.bookType)}function ub(a,o,l){return l=l||{},l.type="file",l.file=o,qp(l),Vh(a,l)}function fb(a,o,l,c,u,h,f,d){var y=tr(l),v=d.defval,b=d.raw||!Object.prototype.hasOwnProperty.call(d,"raw"),_=!0,T=u===1?[]:{};if(u!==1)if(Object.defineProperty)try{Object.defineProperty(T,"__rowNum__",{value:l,enumerable:!1})}catch{T.__rowNum__=l}else T.__rowNum__=l;if(!f||a[l])for(var S=o.s.c;S<=o.e.c;++S){var I=f?a[l][S]:a[c[S]+y];if(I!==void 0&&I.t!==void 0){var k=I.v;switch(I.t){case"z":if(k==null)break;continue;case"e":k=k==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+I.t)}if(h[S]!=null){if(k==null)if(I.t=="e"&&k===null)T[h[S]]=null;else if(v!==void 0)T[h[S]]=v;else{if(!b||k!==null)continue;T[h[S]]=null}else T[h[S]]=b&&(I.t!=="n"||I.t==="n"&&d.rawNumbers!==!1)?k:Pa(I,k,d);k!=null&&(_=!1)}}else v!==void 0&&h[S]!=null&&(T[h[S]]=v)}return{row:T,isempty:_}}function Uh(a,o){if(a==null||a["!ref"]==null)return[];var l,c={t:"n",v:0},u=0,h=1,f=[],d="",y={s:{r:0,c:0},e:{r:0,c:0}},v=o||{},b=v.range!=null?v.range:a["!ref"];switch(v.header===1?u=1:v.header==="A"?u=2:Array.isArray(v.header)?u=3:v.header==null&&(u=0),typeof b){case"string":y=nr(b);break;case"number":(y=nr(a["!ref"])).s.r=b;break;default:y=b}0<u&&(h=0);var _=tr(y.s.r),T=[],S=[],I=0,k=0,M=Array.isArray(a),D=y.s.r,F=0,j={};M&&!a[D]&&(a[D]=[]);for(var B,z=v.skipHidden&&a["!cols"]||[],ae=v.skipHidden&&a["!rows"]||[],F=y.s.c;F<=y.e.c;++F)if(!(z[F]||{}).hidden)switch(T[F]=Yt(F),c=M?a[D][F]:a[T[F]+_],u){case 1:f[F]=F-y.s.c;break;case 2:f[F]=T[F];break;case 3:f[F]=v.header[F-y.s.c];break;default:if(d=l=Pa(c=c??{w:"__EMPTY",t:"s"},null,v),k=j[l]||0){for(;d=l+"_"+k++,j[d];);j[l]=k,j[d]=1}else j[l]=1;f[F]=d}for(D=y.s.r+h;D<=y.e.r;++D)(ae[D]||{}).hidden||(B=fb(a,y,D,T,u,f,M,v)).isempty!==!1&&(u===1?v.blankrows===!1:!v.blankrows)||(S[I++]=B.row);return S.length=I,S}var hb=/"/g;function db(a,o,l,c,u,h,f,d){for(var y=!0,v=[],b="",_=tr(l),T=o.s.c;T<=o.e.c;++T)if(c[T]){var S=d.dense?(a[l]||[])[T]:a[c[T]+_];if(S==null)b="";else if(S.v!=null){y=!1,b=""+(d.rawNumbers&&S.t=="n"?S.v:Pa(S,null,d));for(var I,k=0;k!==b.length;++k)if((I=b.charCodeAt(k))===u||I===h||I===34||d.forceQuotes){b='"'+b.replace(hb,'""')+'"';break}b=="ID"&&(b='"ID"')}else S.f==null||S.F?b="":(y=!1,0<=(b="="+S.f).indexOf(",")&&(b='"'+b.replace(hb,'""')+'"'));v.push(b)}return d.blankrows===!1&&y?null:v.join(f)}function Kp(a,o){var l=[],c=o??{};if(a==null||a["!ref"]==null)return"";var u=nr(a["!ref"]),h=c.FS!==void 0?c.FS:",",f=h.charCodeAt(0),d=c.RS!==void 0?c.RS:`
`,y=d.charCodeAt(0),v=new RegExp((h=="|"?"\\|":h)+"+$"),b="",_=[];c.dense=Array.isArray(a);for(var T=c.skipHidden&&a["!cols"]||[],S=c.skipHidden&&a["!rows"]||[],I=u.s.c;I<=u.e.c;++I)(T[I]||{}).hidden||(_[I]=Yt(I));for(var k=0,M=u.s.r;M<=u.e.r;++M)(S[M]||{}).hidden||(b=db(a,u,M,_,f,y,h,c))!=null&&(!(b=c.strip?b.replace(v,""):b)&&c.blankrows===!1||l.push((k++?d:"")+b));return delete c.dense,l.join("")}function pb(a,o){return(o=o||{}).FS="	",o.RS=`
`,a=Kp(a,o),e===void 0||o.type=="string"?a:(a=e.utils.encode(1200,a,"str"),""+a)}function mb(b,o,l){var c,u=l||{},h=+!u.skipHeader,f=b||{},d=0,y=0;f&&u.origin!=null&&(typeof u.origin=="number"?d=u.origin:(v=typeof u.origin=="string"?rr(u.origin):u.origin,d=v.r,y=v.c));var v,b={s:{c:0,r:0},e:{c:y,r:d+o.length-1+h}};f["!ref"]?(v=nr(f["!ref"]),b.e.c=Math.max(b.e.c,v.e.c),b.e.r=Math.max(b.e.r,v.e.r),d==-1&&(d=v.e.r+1,b.e.r=d+o.length-1+h)):d==-1&&(d=0,b.e.r=o.length-1+h);var _=u.header||[],T=0;o.forEach(function(I,k){Gr(I).forEach(function(B){(T=_.indexOf(B))==-1&&(_[T=_.length]=B);var D=I[B],F="z",j="",B=Pt({c:y+T,r:d+k+h});c=Bh(f,B),!D||typeof D!="object"||D instanceof Date?(typeof D=="number"?F="n":typeof D=="boolean"?F="b":typeof D=="string"?F="s":D instanceof Date?(F="d",u.cellDates||(F="n",D=qr(D)),j=u.dateNF||de[14]):D===null&&u.nullError&&(F="e",D=0),c?(c.t=F,c.v=D,delete c.w,delete c.R,j&&(c.z=j)):f[B]=c={t:F,v:D},j&&(c.z=j)):f[B]=D})}),b.e.c=Math.max(b.e.c,y+_.length-1);var S=tr(d);if(h)for(T=0;T<_.length;++T)f[Yt(T+y)+S]={t:"s",v:_[T]};return f["!ref"]=Bt(b),f}function Bh(a,o,l){return typeof o!="string"?Bh(a,Pt(typeof o!="number"?o:{r:o,c:l||0})):Array.isArray(a)?(l=rr(o),a[l.r]||(a[l.r]=[]),a[l.r][l.c]||(a[l.r][l.c]={t:"z"})):a[o]||(a[o]={t:"z"})}function Yp(){return{SheetNames:[],Sheets:{}}}function Qp(a,o,l,c){var u=1;if(!l)for(;u<=65535&&a.SheetNames.indexOf(l="Sheet"+u)!=-1;++u,l=void 0);if(!l||65535<=a.SheetNames.length)throw new Error("Too many worksheets");if(c&&0<=a.SheetNames.indexOf(l)){var c=l.match(/(^.*?)(\d+)$/),u=c&&+c[2]||0,h=c&&c[1]||l;for(++u;u<=65535&&a.SheetNames.indexOf(l=h+u)!=-1;++u);}if(Ix(l),0<=a.SheetNames.indexOf(l))throw new Error("Worksheet with name |"+l+"| already exists!");return a.SheetNames.push(l),a.Sheets[l]=o,l}function gb(a,o,l){return o?(a.l={Target:o},l&&(a.l.Tooltip=l)):delete a.l,a}var $h,Xp={encode_col:Yt,encode_row:tr,encode_cell:Pt,encode_range:Bt,decode_col:hr,decode_row:Fr,split_cell:function(a){return a.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:rr,decode_range:Wr,format_cell:Pa,sheet_add_aoa:sy,sheet_add_json:mb,sheet_add_dom:zx,aoa_to_sheet:kl,json_to_sheet:function(a,o){return mb(null,a,o)},table_to_sheet:Hx,table_to_book:function(a,o){return Li(Hx(a,o),o)},sheet_to_csv:Kp,sheet_to_txt:pb,sheet_to_json:Uh,sheet_to_html:Wx,sheet_to_formulae:function(a){var o,l="",c="";if(a==null||a["!ref"]==null)return[];for(var u,h=nr(a["!ref"]),f=[],d=[],y=Array.isArray(a),v=h.s.c;v<=h.e.c;++v)f[v]=Yt(v);for(var b=h.s.r;b<=h.e.r;++b)for(u=tr(b),v=h.s.c;v<=h.e.c;++v)if(l=f[v]+u,c="",(o=y?(a[b]||[])[v]:a[l])!==void 0){if(o.F!=null){if(l=o.F,!o.f)continue;c=o.f,l.indexOf(":")==-1&&(l=l+":"+l)}if(o.f!=null)c=o.f;else{if(o.t=="z")continue;if(o.t=="n"&&o.v!=null)c=""+o.v;else if(o.t=="b")c=o.v?"TRUE":"FALSE";else if(o.w!==void 0)c="'"+o.w;else{if(o.v===void 0)continue;c=o.t=="s"?"'"+o.v:""+o.v}}d[d.length]=l+"="+c}return d},sheet_to_row_object_array:Uh,sheet_get_cell:Bh,book_new:Yp,book_append_sheet:Qp,book_set_sheet_visibility:function(a,o,l){switch(a.Workbook||(a.Workbook={}),a.Workbook.Sheets||(a.Workbook.Sheets=[]),o=function(c,u){if(typeof u=="number"){if(0<=u&&c.SheetNames.length>u)return u;throw new Error("Cannot find sheet # "+u)}if(typeof u!="string")throw new Error("Cannot find sheet |"+u+"|");if(-1<(c=c.SheetNames.indexOf(u)))return c;throw new Error("Cannot find sheet name |"+u+"|")}(a,o),a.Workbook.Sheets[o]||(a.Workbook.Sheets[o]={}),l){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+l)}a.Workbook.Sheets[o].Hidden=l},cell_set_number_format:function(a,o){return a.z=o,a},cell_set_hyperlink:gb,cell_set_internal_link:function(a,o,l){return gb(a,"#"+o,l)},cell_add_comment:function(a,o,l){a.c||(a.c=[]),a.c.push({t:o,a:l||"SheetJS"})},sheet_set_array_formula:function(a,o,l,c){for(var u=typeof o!="string"?o:nr(o),h=typeof o=="string"?o:Bt(o),f=u.s.r;f<=u.e.r;++f)for(var d=u.s.c;d<=u.e.c;++d){var y=Bh(a,f,d);y.t="n",y.F=h,delete y.v,f==u.s.r&&d==u.s.c&&(y.f=l,c&&(y.D=!0))}return a},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function yb(a){$h=a}var Ul={to_json:function(a,o){var l=$h({objectMode:!0});if(a==null||a["!ref"]==null)return l.push(null),l;var c,u={t:"n",v:0},h=0,f=1,d=[],y="",v={s:{r:0,c:0},e:{r:0,c:0}},b=o||{},_=b.range!=null?b.range:a["!ref"];switch(b.header===1?h=1:b.header==="A"?h=2:Array.isArray(b.header)&&(h=3),typeof _){case"string":v=nr(_);break;case"number":(v=nr(a["!ref"])).s.r=_;break;default:v=_}0<h&&(f=0);var T=tr(v.s.r),S=[],I=0,k=Array.isArray(a),M=v.s.r,D=0,F={};k&&!a[M]&&(a[M]=[]);for(var j=b.skipHidden&&a["!cols"]||[],B=b.skipHidden&&a["!rows"]||[],D=v.s.c;D<=v.e.c;++D)if(!(j[D]||{}).hidden)switch(S[D]=Yt(D),u=k?a[M][D]:a[S[D]+T],h){case 1:d[D]=D-v.s.c;break;case 2:d[D]=S[D];break;case 3:d[D]=b.header[D-v.s.c];break;default:if(y=c=Pa(u=u??{w:"__EMPTY",t:"s"},null,b),I=F[c]||0){for(;y=c+"_"+I++,F[y];);F[c]=I,F[y]=1}else F[c]=1;d[D]=y}return M=v.s.r+f,l._read=function(){for(;M<=v.e.r;)if(!(B[M-1]||{}).hidden){var z=fb(a,v,M,S,h,d,k,b);if(++M,z.isempty===!1||(h===1?b.blankrows!==!1:b.blankrows))return void l.push(z.row)}return l.push(null)},l},to_html:function(a,u){var l=$h(),c=u||{},u=c.header!=null?c.header:Ux,h=c.footer!=null?c.footer:Bx;l.push(u);var f=Wr(a["!ref"]);c.dense=Array.isArray(a),l.push($x(0,0,c));var d=f.s.r,y=!1;return l._read=function(){if(d>f.e.r)return y||(y=!0,l.push("</table>"+h)),l.push(null);for(;d<=f.e.r;){l.push(Vx(a,f,d,c)),++d;break}},l},to_csv:function(a,o){var l=$h(),c=o??{};if(a==null||a["!ref"]==null)return l.push(null),l;var u=nr(a["!ref"]),h=c.FS!==void 0?c.FS:",",f=h.charCodeAt(0),d=c.RS!==void 0?c.RS:`
`,y=d.charCodeAt(0),v=new RegExp((h=="|"?"\\|":h)+"+$"),b="",_=[];c.dense=Array.isArray(a);for(var T=c.skipHidden&&a["!cols"]||[],S=c.skipHidden&&a["!rows"]||[],I=u.s.c;I<=u.e.c;++I)(T[I]||{}).hidden||(_[I]=Yt(I));var k=u.s.r,M=!1,D=0;return l._read=function(){if(!M)return M=!0,l.push("\uFEFF");for(;k<=u.e.r;)if(++k,!(S[k-1]||{}).hidden&&(b=db(a,u,k-1,_,f,y,h,c),b!=null&&((b=c.strip?b.replace(v,""):b)||c.blankrows!==!1)))return l.push((D++?d:"")+b);return l.push(null)},l},set_readable:yb},gr=function(){function a(o,l,c){return this instanceof a?(this.tagName=o,this._attributes=l||{},this._children=c||[],this._prefix="",this):new a(o,l,c)}return a.prototype.createElement=function(){return new a(arguments)},a.prototype.children=function(){return this._children},a.prototype.append=function(o){return this._children.push(o),this},a.prototype.prefix=function(o){return arguments.length==0?this._prefix:(this._prefix=o,this)},a.prototype.attr=function(o,l){if(l==null)return delete this._attributes[o],this;if(arguments.length==0)return this._attributes;if(typeof o=="string"&&arguments.length==1)return this._attributes.attr[o];if(typeof o=="object"&&arguments.length==1)for(var c in o)this._attributes[c]=o[c];else arguments.length==2&&typeof o=="string"&&(this._attributes[o]=l);return this},a.prototype.escapeAttributeValue=function(o){return'"'+o.replace(/\"/g,"&quot;")+'"'},a.prototype.toXml=function(o){var l=(o=o||this)._prefix;if(l+="<"+o.tagName,o._attributes)for(var c in o._attributes)l+=" "+c+"="+this.escapeAttributeValue(""+o._attributes[c]);if(o._children&&0<o._children.length){l+=">";for(var u=0;u<o._children.length;u++)l+=this.toXml(o._children[u]);l+="</"+o.tagName+">"}else l+="/>";return l},a}(),hA=function(a){var o,l=164,c={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},u={};for(o in c)u[c[o]]=o;var h={};return{initialize:function(f){this.$fonts=gr("fonts").attr("count",0).attr("x14ac:knownFonts","1"),this.$fills=gr("fills").attr("count",0),this.$borders=gr("borders").attr("count",0),this.$numFmts=gr("numFmts").attr("count",0),this.$cellStyleXfs=gr("cellStyleXfs"),this.$xf=gr("xf").attr("numFmtId",0).attr("fontId",0).attr("fillId",0).attr("borderId",0),this.$cellXfs=gr("cellXfs").attr("count",0),this.$cellStyles=gr("cellStyles").append(gr("cellStyle").attr("name","Normal").attr("xfId",0).attr("builtinId",0)),this.$dxfs=gr("dxfs").attr("count","0"),this.$tableStyles=gr("tableStyles").attr("count","0").attr("defaultTableStyle","TableStyleMedium9").attr("defaultPivotStyle","PivotStyleMedium4"),this.$styles=gr("styleSheet").attr("xmlns:mc","http://schemas.openxmlformats.org/markup-compatibility/2006").attr("xmlns:x14ac","http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac").attr("xmlns","http://schemas.openxmlformats.org/spreadsheetml/2006/main").attr("mc:Ignorable","x14ac").prefix('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>').append(this.$numFmts).append(this.$fonts).append(this.$fills).append(this.$borders).append(this.$cellStyleXfs.append(this.$xf)).append(this.$cellXfs).append(this.$cellStyles).append(this.$dxfs).append(this.$tableStyles);var d=f.defaultCellStyle||{};return d.font||(d.font={name:"Calibri",sz:"11"}),d.font.name||(d.font.name="Calibri"),d.font.sz||(d.font.sz=11),d.fill||(d.fill={patternType:"none",fgColor:{}}),d.border||(d.border={}),d.numFmt||(d.numFmt=0),this.defaultStyle=d,f=JSON.parse(JSON.stringify(d)),f.fill={patternType:"gray125",fgColor:{}},this.addStyles([d,f]),this},addStyle:function(f){var d=JSON.stringify(f),y=h[d];return y==null?(y=this._addXf(f),h[d]=y):y=h[d],y},addStyles:function(f){var d=this;return f.map(function(y){return d.addStyle(y)})},_duckTypeStyle:function(f){return typeof f=="object"&&(f.patternFill||f.fgColor)?{fill:f}:f.font||f.numFmt||f.border||f.fill?f:this._getStyleCSS(f)},_getStyleCSS:function(f){return f},_addXf:function(f){var d=this._addFont(f.font),y=this._addFill(f.fill),v=this._addBorder(f.border),b=this._addNumFmt(f.numFmt),_=gr("xf").attr("numFmtId",b).attr("fontId",d).attr("fillId",y).attr("borderId",v).attr("xfId","0");return 0<d&&_.attr("applyFont","1"),0<y&&_.attr("applyFill","1"),0<v&&_.attr("applyBorder","1"),0<b&&_.attr("applyNumberFormat","1"),f.alignment&&(b=gr("alignment"),f.alignment.horizontal&&b.attr("horizontal",f.alignment.horizontal),f.alignment.vertical&&b.attr("vertical",f.alignment.vertical),f.alignment.indent&&b.attr("indent",f.alignment.indent),f.alignment.readingOrder&&b.attr("readingOrder",f.alignment.readingOrder),f.alignment.wrapText&&b.attr("wrapText",f.alignment.wrapText),f.alignment.textRotation!=null&&b.attr("textRotation",f.alignment.textRotation),_.append(b).attr("applyAlignment",1)),this.$cellXfs.append(_),_=+this.$cellXfs.children().length,this.$cellXfs.attr("count",_),_-1},_addFont:function(f){if(!f)return 0;var d=gr("font").append(gr("sz").attr("val",f.sz||this.defaultStyle.font.sz)).append(gr("name").attr("val",f.name||this.defaultStyle.font.name));return f.bold&&d.append(gr("b")),f.underline&&d.append(gr("u")),f.italic&&d.append(gr("i")),f.strike&&d.append(gr("strike")),f.outline&&d.append(gr("outline")),f.shadow&&d.append(gr("shadow")),f.vertAlign&&d.append(gr("vertAlign").attr("val",f.vertAlign)),f.color&&(f.color.theme?(d.append(gr("color").attr("theme",f.color.theme)),f.color.tint&&d.append(gr("tint").attr("theme",f.color.tint))):f.color.rgb&&d.append(gr("color").attr("rgb",f.color.rgb))),this.$fonts.append(d),d=this.$fonts.children().length,this.$fonts.attr("count",d),d-1},_addNumFmt:function(f){if(!f)return 0;if(typeof f=="string"){var d=u[f];if(0<=d)return d}return/^[0-9]+$/.exec(f)?f:(f=f.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),f=gr("numFmt").attr("numFmtId",++l).attr("formatCode",f),this.$numFmts.append(f),f=this.$numFmts.children().length,this.$numFmts.attr("count",f),l)},_addFill:function(f){if(!f)return 0;var d,y=gr("patternFill").attr("patternType",f.patternType||"solid");return f.fgColor&&(d=gr("fgColor"),f.fgColor.rgb?(f.fgColor.rgb.length==6&&(f.fgColor.rgb="FF"+f.fgColor.rgb),d.attr("rgb",f.fgColor.rgb),y.append(d)):f.fgColor.theme&&(d.attr("theme",f.fgColor.theme),f.fgColor.tint&&d.attr("tint",f.fgColor.tint),y.append(d)),f.bgColor||(f.bgColor={indexed:"64"})),f.bgColor&&(f=gr("bgColor").attr(f.bgColor),y.append(f)),y=gr("fill").append(y),this.$fills.append(y),y=this.$fills.children().length,this.$fills.attr("count",y),y-1},_getSubBorder:function(f,d){var y=gr(f);return d&&(y.attr("style",d.style||"medium"),d.color&&(f=gr("color"),d.color.auto?f.attr("auto",d.color.auto):d.color.rgb?f.attr("rgb",d.color.rgb):(d.color.theme||d.color.tint)&&(f.attr("theme",d.color.theme||"1"),f.attr("tint",d.color.tint||"0")),y.append(f))),y},_addBorder:function(f){if(!f)return 0;var d=this,y=gr("border").attr("diagonalUp",f.diagonalUp).attr("diagonalDown",f.diagonalDown);["left","right","top","bottom","diagonal"].forEach(function(b){y.append(d._getSubBorder(b,f[b]))}),this.$borders.append(y);var v=this.$borders.children().length;return this.$borders.attr("count",v),v-1},toXml:function(){return this.$styles.toXml()}}.initialize(a||{})};jh!==void 0&&(n.parse_xlscfb=jh),n.parse_zip=sb,n.read=Mh,n.readFile=ob,n.readFileSync=ob,n.write=Vh,n.writeFile=ub,n.writeFileSync=ub,n.writeFileAsync=function(a,o,l,c){var u=l||{};return u.type="file",u.file=a,qp(u),u.type="buffer",c instanceof Function||(c=l),Ws.writeFile(a,Vh(o,u),c)},n.utils=Xp,n.writeXLSX=Gp,n.writeFileXLSX=function(a,o,l){return(l=l||{}).type="file",l.file=o,qp(l),Gp(a,l)},n.SSF=Qa,Ul!==void 0&&(n.stream=Ul),wt!==void 0&&(n.CFB=wt),typeof Fd>"u"||((Ul=W1)||{}).Readable&&yb(Ul.Readable)}if(i(t),typeof window<"u"&&!window.XLSX)try{window.XLSX=s}catch{}})(hg,hg.exports);var Ba=hg.exports;function w7(r,t){const s=[],i=new Date(r);for(;i<=t;){const n=i.getFullYear(),e=String(i.getMonth()+1).padStart(2,"0"),p=String(i.getDate()).padStart(2,"0");s.push(`${n}-${e}-${p}`),i.setDate(i.getDate()+1)}return s}function fc(r){const[t,s,i]=r.split("-").map(Number);return new Date(t,s-1,i).getDay()}function Vw(r){const[t,s,i]=r.split("-").map(Number),n=new Date(t,s-1,i),e=n.getDay(),p=e===0?6:e-1;n.setDate(n.getDate()-p);const x=n.getFullYear(),w=String(n.getMonth()+1).padStart(2,"0"),E=String(n.getDate()).padStart(2,"0");return`${x}-${w}-${E}`}function _7(r,t){if(!r)return null;switch(fc(t)){case 1:return r.ptMonday??null;case 2:return r.ptTuesday??null;case 3:return r.ptWednesday??null;case 4:return r.ptThursday??null;case 5:return r.ptFriday??null;default:return null}}function T7(r,t){return r&&fc(t)===4?r.labThursday??null:null}function E7(r,t,s){return!r||s!=="MS3"?null:fc(t)===2?r.tacticsTuesday??null:null}function S7(r,t,s,i){const n=Ba.utils.aoa_to_sheet(r);n["!cols"]=[{wch:20},...s.map(()=>({wch:12})),{wch:15},{wch:15},{wch:15}];const e=Ba.utils.decode_range(n["!ref"]||"A1");for(let x=0;x<=e.e.c;x++){const w=Ba.utils.encode_cell({r:0,c:x});n[w]&&(n[w].s={fill:{fgColor:{rgb:"FFD3D3D3"}},font:{bold:!0,sz:12,color:{rgb:"FF000000"}},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"FF000000"}},bottom:{style:"thin",color:{rgb:"FF000000"}},left:{style:"thin",color:{rgb:"FF000000"}},right:{style:"thin",color:{rgb:"FF000000"}}}})}const p=new Map;for(let x=1;x<r.length;x++){const w=r[x];if(!w||i.includes(w[0])||w[0]===""||!w[0])continue;const E=w[0].split(", ");if(E.length===2){for(const[N,P]of t)if(P.cadet.lastName===E[0]&&P.cadet.firstName===E[1]){p.set(x,P.dates);break}}}for(let x=1;x<=e.e.r;x++){const w=r[x];if(!w)continue;if(i.includes(w[0])){const P=Ba.utils.encode_cell({r:x,c:0});n[P]&&(n[P].s={fill:{fgColor:{rgb:"FFD3D3D3"}},font:{bold:!0,sz:12,color:{rgb:"FF000000"}},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"FF000000"}},bottom:{style:"thin",color:{rgb:"FF000000"}},left:{style:"thin",color:{rgb:"FF000000"}},right:{style:"thin",color:{rgb:"FF000000"}}}});continue}if(w[0]===""||!w[0])continue;const E=p.get(x);for(let P=1;P<=s.length;P++){const R=Ba.utils.encode_cell({r:x,c:P});if(!n[R])continue;const q=s[P-1],Z=E==null?void 0:E.get(q);Z==="present"?n[R].s={fill:{fgColor:{rgb:"FF90EE90"}},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"FF000000"}},bottom:{style:"thin",color:{rgb:"FF000000"}},left:{style:"thin",color:{rgb:"FF000000"}},right:{style:"thin",color:{rgb:"FF000000"}}}}:Z==="excused"?n[R].s={fill:{fgColor:{rgb:"FFFFFF00"}},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"FF000000"}},bottom:{style:"thin",color:{rgb:"FF000000"}},left:{style:"thin",color:{rgb:"FF000000"}},right:{style:"thin",color:{rgb:"FF000000"}}}}:Z==="unexcused"?n[R].s={fill:{fgColor:{rgb:"FFFF6B6B"}},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"FF000000"}},bottom:{style:"thin",color:{rgb:"FF000000"}},left:{style:"thin",color:{rgb:"FF000000"}},right:{style:"thin",color:{rgb:"FF000000"}}}}:n[R].s={fill:{fgColor:{rgb:"FFFFFFFF"}},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"FF000000"}},bottom:{style:"thin",color:{rgb:"FF000000"}},left:{style:"thin",color:{rgb:"FF000000"}},right:{style:"thin",color:{rgb:"FF000000"}}}}}const N=Ba.utils.encode_cell({r:x,c:0});n[N]&&(n[N].s={alignment:{horizontal:"left",vertical:"center"},border:{top:{style:"thin",color:{rgb:"FF000000"}},bottom:{style:"thin",color:{rgb:"FF000000"}},left:{style:"thin",color:{rgb:"FF000000"}},right:{style:"thin",color:{rgb:"FF000000"}}}});for(let P=s.length+1;P<=e.e.c;P++){const R=Ba.utils.encode_cell({r:x,c:P});n[R]&&(n[R].s={alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"FF000000"}},bottom:{style:"thin",color:{rgb:"FF000000"}},left:{style:"thin",color:{rgb:"FF000000"}},right:{style:"thin",color:{rgb:"FF000000"}}}})}}return n}async function A7(){const r=new Date("2026-01-20"),t=new Date("2026-04-23"),s=w7(r,t),i=["MS1","MS2","MS3","MS4","MS5"],n=new Map;for(const q of i){const Z=await l6(q);Z.length>0&&n.set(q,Z)}const e=new Set;for(const q of s)e.add(Vw(q));const p=new Map;for(const q of e){const Z=await J2(q);p.set(q,Z)}const x=Ba.utils.book_new(),w=s.filter(q=>{const Z=fc(q);return Z===2||Z===3||Z===4}),E=s.filter(q=>fc(q)===4),N=s.filter(q=>fc(q)===2),P=[{type:"PT",name:"PT",dates:w},{type:"Lab",name:"Lab",dates:E},{type:"Tactics",name:"Tactics",dates:N}];for(const{type:q,name:Z,dates:ne}of P){const fe=["Name",...ne.map(ee=>{const[te,ue,L]=ee.split("-");return`${ue}/${L}/${te}`}),"Total Present","Total Excused","Total Unexcused"],G=new Map;for(const[ee,te]of n)for(const ue of te){if(q==="Tactics"&&ue.militaryScienceLevel!=="MS3")continue;const L=new Map;let O=0,V=0,W=0;for(const J of ne){const X=Vw(J),K=p.get(X),me=(K==null?void 0:K.get(ue.id))??null;let He=null;q==="PT"?He=_7(me,J):q==="Lab"?He=T7(me,J):q==="Tactics"&&(He=E7(me,J,ue.militaryScienceLevel)),L.set(J,He),He==="present"?O++:He==="excused"?V++:He==="unexcused"&&W++}G.set(ue.id,{cadet:ue,dates:L,totalPresent:O,totalExcused:V,totalUnexcused:W})}const U=[];U.push(fe);for(const ee of i){const te=n.get(ee);if(!te||te.length===0)continue;const ue=q==="Tactics"?te.filter(O=>O.militaryScienceLevel==="MS3"):te;if(ue.length===0)continue;const L=new Array(fe.length).fill("");L[0]=ee,U.push(L);for(const O of ue){const V=G.get(O.id);if(!V)continue;const W=[`${O.lastName}, ${O.firstName}`,...ne.map(J=>""),V.totalPresent,V.totalExcused,V.totalUnexcused];U.push(W)}}const H=S7(U,G,ne,i);Ba.utils.book_append_sheet(x,H,Z)}const R=`attendance_export_${r.toISOString().split("T")[0]}_to_${t.toISOString().split("T")[0]}.xlsx`;Ba.writeFile(x,R)}const ry="bulldog_auth_session",dg="bulldog_saved_credentials",C7="admin",k7="wKsZ!S144";function Uw(){const r=F7();return(r==null?void 0:r.isAuthenticated)===!0}function F7(){try{const r=localStorage.getItem(ry);return r?JSON.parse(r):null}catch(r){return console.error("Error reading session:",r),null}}function N7(r,t){if(r===C7&&t===k7){const s={isAuthenticated:!0,username:r,loginTime:Date.now()};return localStorage.setItem(ry,JSON.stringify(s)),!0}return!1}function I7(){localStorage.removeItem(ry)}function D7(r,t,s){s?localStorage.setItem(dg,JSON.stringify({username:r,password:t})):localStorage.removeItem(dg)}function R7(){try{const r=localStorage.getItem(dg);return r?JSON.parse(r):null}catch(r){return console.error("Error reading saved credentials:",r),null}}function P7({onBack:r}){const[t,s]=we.useState(!1),[i,n]=we.useState(""),[e,p]=we.useState(!1),[x,w]=we.useState(!1),[E,N]=we.useState("default"),[P,R]=we.useState(!1),[q,Z]=we.useState(!1),[ne,fe]=we.useState(!1),G=we.useRef(null);we.useEffect(()=>{w(ey()),N(ty())},[]);async function U(){if(window.confirm("Are you sure you want to clear all attendance data? This will reset all attendance records to blank (). This action cannot be undone.")){s(!0);try{await e7(),alert("All attendance data has been cleared successfully.")}catch(W){console.error("Error clearing database:",W),alert(`Error clearing database: ${W instanceof Error?W.message:"Unknown error"}`)}finally{s(!1)}}}async function H(){if(!i.trim()){alert("Please enter a message to send.");return}p(!0);try{if(E!=="granted"&&x)try{await Z2(),N("granted")}catch(V){console.warn("Could not request notification permission:",V)}await f7(i.trim()),alert("Notification sent successfully!"),n("")}catch(V){console.error("Error sending notification:",V),alert(`Error sending notification: ${V instanceof Error?V.message:"Unknown error"}`)}finally{p(!1)}}async function ee(){R(!0);try{const V=await p7(),W=new Date().toISOString().replace(/[:.]/g,"-").split("T")[0];m7(V,`bulldog-co-manager-backup-${W}.json`),alert("Database exported successfully! The backup file has been downloaded.")}catch(V){console.error("Error exporting database:",V),alert(`Error exporting database: ${V instanceof Error?V.message:"Unknown error"}`)}finally{R(!1)}}async function te(){var J;if(!G.current)return;const V=(J=G.current.files)==null?void 0:J[0];if(!V){alert("Please select a backup file to import.");return}if(!window.confirm("WARNING: This will replace all existing data with the backup data. This action cannot be undone. Are you sure you want to continue?")){G.current&&(G.current.value="");return}Z(!0);try{const X=await y7(V);await g7(X,!0),alert("Database imported successfully! The page will now reload to show the restored data."),window.location.reload()}catch(X){console.error("Error importing database:",X),alert(`Error importing database: ${X instanceof Error?X.message:"Unknown error"}`)}finally{Z(!1),G.current&&(G.current.value="")}}function ue(){var V;(V=G.current)==null||V.click()}async function L(){fe(!0);try{await A7(),alert("Attendance exported successfully! The Excel file has been downloaded.")}catch(V){console.error("Error exporting attendance:",V),alert(`Error exporting attendance: ${V instanceof Error?V.message:"Unknown error"}`)}finally{fe(!1)}}function O(){window.confirm("Are you sure you want to log out?")&&(I7(),window.location.reload())}return m.jsxs("div",{className:"min-h-screen bg-gray-50 pb-safe-area-inset-bottom",children:[m.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-10 safe-area-inset-top",children:m.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[m.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Settings"}),m.jsx("button",{onClick:r,className:"text-sm text-blue-600 font-medium touch-manipulation min-h-[44px] min-w-[44px]",children:"Home"})]})}),m.jsxs("main",{className:"px-4 py-4 space-y-4",children:[m.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[m.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Database Management"}),m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Export attendance data to an Excel spreadsheet. Includes all cadets grouped by MS level with dates from January 20, 2026 to April 23, 2026."}),m.jsx("button",{onClick:L,disabled:ne,className:`w-full py-3 px-4 rounded-lg font-semibold text-white touch-manipulation min-h-[44px] ${ne?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 active:bg-green-800"}`,children:ne?"Exporting...":"Export Attendance"})]}),m.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[m.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Export all database data to a JSON backup file. This includes cadets, attendance records, PT plans, training events, and notifications."}),m.jsx("button",{onClick:ee,disabled:P,className:`w-full py-3 px-4 rounded-lg font-semibold text-white touch-manipulation min-h-[44px] ${P?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 active:bg-blue-800"}`,children:P?"Exporting...":"Export Database"})]}),m.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[m.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Import a backup file to restore the database. This will replace all existing data with the backup data."}),m.jsx("input",{ref:G,type:"file",accept:".json",onChange:te,className:"hidden","aria-label":"Import database backup file",title:"Import database backup file"}),m.jsx("button",{onClick:ue,disabled:q,className:`w-full py-3 px-4 rounded-lg font-semibold text-white touch-manipulation min-h-[44px] ${q?"bg-gray-400 cursor-not-allowed":"bg-orange-600 hover:bg-orange-700 active:bg-orange-800"}`,children:q?"Importing...":"Import Database"}),m.jsx("p",{className:"text-xs text-red-600 mt-2",children:" Warning: Importing will replace all existing data. Make sure to export a backup first if you want to keep current data."})]}),m.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[m.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Clear all attendance data. This will reset all attendance records to blank () for all cadets and all weeks."}),m.jsx("button",{onClick:U,disabled:t,className:`w-full py-3 px-4 rounded-lg font-semibold text-white touch-manipulation min-h-[44px] ${t?"bg-gray-400 cursor-not-allowed":"bg-red-600 hover:bg-red-700 active:bg-red-800"}`,children:t?"Clearing...":"Clear Attendance Data"})]})]})]}),m.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[m.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Send Notification"}),m.jsxs("div",{className:"space-y-4",children:[!x&&m.jsx("p",{className:"text-sm text-yellow-600 bg-yellow-50 p-3 rounded-md",children:"Push notifications are not supported in this browser."}),x&&E==="denied"&&m.jsx("p",{className:"text-sm text-red-600 bg-red-50 p-3 rounded-md",children:"Notification permission has been denied. Please enable notifications in your browser settings."}),m.jsxs("div",{children:[m.jsx("label",{htmlFor:"notificationMessage",className:"block text-sm font-medium text-gray-700 mb-2",children:"Message"}),m.jsx("textarea",{id:"notificationMessage",value:i,onChange:V=>n(V.target.value),placeholder:"Enter your notification message here...",rows:4,className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm resize-none",disabled:e})]}),m.jsx("button",{onClick:H,disabled:e||!i.trim(),className:`w-full py-3 px-4 rounded-lg font-semibold text-white touch-manipulation min-h-[44px] ${e||!i.trim()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 active:bg-blue-800"}`,children:e?"Sending...":"Send Notification"}),m.jsx("p",{className:"text-xs text-gray-500",children:"This will send a push notification to all users who have enabled notifications."})]})]}),m.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[m.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Account"}),m.jsxs("div",{className:"space-y-4",children:[m.jsx("button",{onClick:O,className:"w-full py-3 px-4 rounded-lg font-semibold text-white bg-red-600 hover:bg-red-700 active:bg-red-800 touch-manipulation min-h-[44px]",children:"Log Out"}),m.jsx("p",{className:"text-xs text-gray-500",children:"Log out of your account. You will need to sign in again to access the application."})]})]})]})]})}function O7({onBack:r}){const[t,s]=we.useState([]),[i,n]=we.useState(!0),e=Ta(),p=Pc(e);we.useEffect(()=>{x()},[]);async function x(){n(!0);try{const w=await di("Master"),E=await J2(e),N=[];w.forEach(P=>{const R=E.get(P.id),q={tuesday:p.tuesday,wednesday:p.wednesday,thursday:p.thursday};((R==null?void 0:R.ptTuesday)===null||(R==null?void 0:R.ptTuesday)===void 0)&&N.push({cadetName:`${P.firstName} ${P.lastName}`,day:"tuesday",date:q.tuesday,attendanceType:"PT"}),((R==null?void 0:R.ptWednesday)===null||(R==null?void 0:R.ptWednesday)===void 0)&&N.push({cadetName:`${P.firstName} ${P.lastName}`,day:"wednesday",date:q.wednesday,attendanceType:"PT"}),((R==null?void 0:R.ptThursday)===null||(R==null?void 0:R.ptThursday)===void 0)&&N.push({cadetName:`${P.firstName} ${P.lastName}`,day:"thursday",date:q.thursday,attendanceType:"PT"}),((R==null?void 0:R.labThursday)===null||(R==null?void 0:R.labThursday)===void 0)&&N.push({cadetName:`${P.firstName} ${P.lastName}`,day:"thursday",date:q.thursday,attendanceType:"Lab"})}),N.sort((P,R)=>{const q=P.cadetName.localeCompare(R.cadetName);if(q!==0)return q;const Z={tuesday:1,wednesday:2,thursday:3};return Z[P.day]-Z[R.day]}),s(N)}catch(w){console.error("Error loading issues:",w),alert(`Error loading issues: ${w instanceof Error?w.message:"Unknown error"}`)}finally{n(!1)}}return m.jsxs("div",{className:"min-h-screen bg-gray-50 pb-safe-area-inset-bottom",children:[m.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-10 safe-area-inset-top",children:m.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[m.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Issues"}),m.jsx("button",{onClick:r,className:"text-sm text-blue-600 font-medium touch-manipulation",style:{minHeight:"44px",minWidth:"44px"},children:"Home"})]})}),m.jsx("main",{className:"px-4 py-4",children:i?m.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading..."}):m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[m.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Attendance"}),t.length===0?m.jsx("div",{className:"text-center py-8 text-gray-500",children:"No missing attendance data for the current week."}):m.jsx("div",{className:"space-y-2",children:t.map((w,E)=>{const N=Y0(w.date);return m.jsxs("div",{className:"text-red-600 text-sm py-2 border-b border-gray-100 last:border-b-0",children:[w.cadetName," is missing ",w.attendanceType," attendance for ",N]},`${w.cadetName}-${w.day}-${w.attendanceType}-${E}`)})})]}),m.jsx("button",{onClick:x,className:"w-full py-3 px-4 rounded-lg font-semibold bg-blue-600 text-white hover:bg-blue-700 active:bg-blue-800 touch-manipulation min-h-[44px]",children:"Refresh"})]})})]})}const Bw=["Alpha","Bravo","Charlie","Ranger"];function j7({onSelectCadet:r,onBack:t,onAddCadet:s}){const[i,n]=we.useState([]),[e,p]=we.useState(!0),[x,w]=we.useState(""),[E,N]=we.useState(!1),[P,R]=we.useState(new Set(Bw)),[q,Z]=we.useState(!0),[ne,fe]=we.useState(!0);we.useEffect(()=>{G()},[]);async function G(){p(!0);try{const L=await di("Master");n(L)}catch(L){console.error("Error loading cadets:",L),alert(`Error loading cadets: ${L instanceof Error?L.message:"Unknown error"}`)}finally{p(!1)}}const U=L=>{R(O=>{const V=new Set(O);return V.has(L)?V.delete(L):V.add(L),V})},H=i.filter(L=>{if(!P.has(L.company))return!1;if(!x.trim())return!0;const O=x.toLowerCase().trim(),V=`${L.firstName} ${L.lastName}`.toLowerCase(),W=`${L.lastName}, ${L.firstName}`.toLowerCase();return L.firstName.toLowerCase().includes(O)||L.lastName.toLowerCase().includes(O)||V.includes(O)||W.includes(O)}),ee=H.filter(L=>{const O=L.contracted==="Y";return!(O&&!q||!O&&!ne)}),te=new Map;ee.forEach(L=>{const O=L.militaryScienceLevel||"Unknown";te.has(O)||te.set(O,[]),te.get(O).push(L)}),te.forEach((L,O)=>{L.sort((V,W)=>{const J=V.lastName.localeCompare(W.lastName);return J!==0?J:V.firstName.localeCompare(W.firstName)})});const ue=Array.from(te.keys()).sort((L,O)=>{if(L==="Unknown")return 1;if(O==="Unknown")return-1;const V=parseInt(L.replace("MS","")),W=parseInt(O.replace("MS",""));return V-W});return m.jsxs("div",{className:"min-h-screen bg-gray-50 pb-safe-area-inset-bottom",children:[m.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-10 safe-area-inset-top",children:m.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[m.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Cadets"}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("button",{onClick:()=>N(!E),className:"text-sm text-blue-600 font-medium touch-manipulation px-3 py-2 rounded-lg hover:bg-blue-50 active:bg-blue-100 transition-colors",style:{minHeight:"44px",minWidth:"44px"},children:"Filter"}),m.jsx("button",{onClick:t,className:"text-sm text-blue-600 font-medium touch-manipulation",style:{minHeight:"44px",minWidth:"44px"},children:"Home"})]})]})}),m.jsx("main",{className:"px-4 py-4",children:e?m.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading..."}):m.jsxs(m.Fragment,{children:[E&&m.jsxs("div",{className:"mb-4 bg-white rounded-lg border border-gray-200 p-4",children:[m.jsxs("div",{className:"flex items-center justify-between mb-4",children:[m.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Filters"}),m.jsx("button",{onClick:()=>N(!1),className:"text-gray-500 hover:text-gray-700 touch-manipulation",style:{minHeight:"44px",minWidth:"44px"},children:""})]}),m.jsxs("div",{className:"mb-4",children:[m.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Filter by Company"}),m.jsx("div",{className:"space-y-2",children:Bw.map(L=>m.jsxs("label",{className:"flex items-center cursor-pointer touch-manipulation py-2",children:[m.jsx("input",{type:"checkbox",checked:P.has(L),onChange:()=>U(L),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500 focus:ring-2 cursor-pointer"}),m.jsx("span",{className:"ml-3 text-sm text-gray-900",children:L})]},L))})]}),m.jsxs("div",{children:[m.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Filter by Contracted Status"}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("label",{className:"flex items-center cursor-pointer touch-manipulation py-2",children:[m.jsx("input",{type:"checkbox",checked:q,onChange:L=>Z(L.target.checked),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500 focus:ring-2 cursor-pointer"}),m.jsx("span",{className:"ml-3 text-sm text-gray-900",children:"Contracted"})]}),m.jsxs("label",{className:"flex items-center cursor-pointer touch-manipulation py-2",children:[m.jsx("input",{type:"checkbox",checked:ne,onChange:L=>fe(L.target.checked),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500 focus:ring-2 cursor-pointer"}),m.jsx("span",{className:"ml-3 text-sm text-gray-900",children:"Uncontracted"})]})]})]})]}),m.jsxs("div",{className:"mb-4",children:[m.jsxs("div",{className:"mb-3",children:[m.jsx("label",{htmlFor:"cadet-search",className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Cadets"}),m.jsx("input",{id:"cadet-search",type:"text",placeholder:"Type a name to search...",value:x,onChange:L=>w(L.target.value),className:"w-full py-3 px-4 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900 placeholder-gray-500 bg-white"})]}),m.jsx("button",{onClick:()=>s==null?void 0:s(),className:"w-full py-3 px-4 rounded-lg font-semibold bg-blue-600 text-white hover:bg-blue-700 active:bg-blue-800 touch-manipulation min-h-[44px]",children:"Add Cadet"})]}),m.jsx("div",{className:"space-y-4",children:ue.length>0?ue.map(L=>{const O=te.get(L);return O.length===0?null:m.jsxs("div",{children:[m.jsx("div",{className:"bg-gray-100 border-b-2 border-gray-300 px-4 py-2 mb-2 rounded-t-lg",children:m.jsx("h3",{className:"font-bold text-gray-900 text-sm",children:L})}),m.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:O.map(V=>m.jsx("button",{onClick:()=>r(V.id),className:"w-full px-4 py-3 text-left hover:bg-gray-50 active:bg-gray-100 transition-colors touch-manipulation border-b border-gray-100 last:border-b-0",children:m.jsxs("span",{className:"font-medium text-gray-900",children:[V.lastName,", ",V.firstName]})},V.id))})]},L)}):m.jsx("div",{className:"text-center py-8 text-gray-500",children:x.trim()?"No cadets found matching your search.":"No cadets found."})}),m.jsxs("div",{className:"mt-6 bg-white rounded-lg border border-gray-200 p-4",children:[m.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Summary"}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsx("span",{className:"text-sm font-medium text-gray-700",children:x.trim()?"Matching Cadets:":"Total Cadets:"}),m.jsx("span",{className:"text-sm font-semibold text-gray-900",children:ee.length})]}),!x.trim()&&m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Total Contracted:"}),m.jsx("span",{className:"text-sm font-semibold text-gray-900",children:H.filter(L=>L.contracted==="Y").length})]}),m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Total Uncontracted:"}),m.jsx("span",{className:"text-sm font-semibold text-gray-900",children:H.filter(L=>L.contracted!=="Y").length})]})]})]})]})]})})]})}const M7=["MS1","MS2","MS3","MS4","MS5"],L7=["Alpha","Bravo","Charlie","Ranger"],ud="https://t3.ftcdn.net/jpg/00/57/04/58/360_F_57045887_HHJml6DJVxNBMqMeDqVJ0ZQDnotp5rGD.jpg";function V7({cadetId:r,onBack:t,onDelete:s,onCompanyChange:i}){const[n,e]=we.useState(null),[p,x]=we.useState(0),[w,E]=we.useState(0),[N,P]=we.useState(0),[R,q]=we.useState(!0),[Z,ne]=we.useState(!1),[fe,G]=we.useState(!1),[U,H]=we.useState({}),[ee,te]=we.useState(null),[ue,L]=we.useState([]),O=we.useRef(null),V=we.useRef(null),W=we.useRef(null);we.useEffect(()=>{J()},[r]),we.useEffect(()=>{function me(He){ee&&O.current&&!O.current.contains(He.target)&&V.current&&!V.current.contains(He.target)&&W.current&&!W.current.contains(He.target)&&!He.target.closest(".absolute.z-50")&&(te(null),L([]))}if(ee)return document.addEventListener("mousedown",me),()=>{document.removeEventListener("mousedown",me)}},[ee]);async function J(){q(!0);try{const me=await K9(r);if(me){e(me),H({firstName:me.firstName||"",lastName:me.lastName||"",age:me.age||0,dateOfBirth:me.dateOfBirth||"",shirtSize:me.shirtSize||"",position:me.position||"",company:me.company,militaryScienceLevel:me.militaryScienceLevel||"MS1",phoneNumber:me.phoneNumber||"",email:me.email||"",contracted:me.contracted||"N",profilePicture:me.profilePicture||""});const[He,fr,at]=await Promise.all([V1(r,"PT"),V1(r,"Lab"),V1(r,"Tactics")]);x(He),E(fr),P(at)}}catch(me){console.error("Error loading cadet:",me),alert(`Error loading cadet: ${me instanceof Error?me.message:"Unknown error"}`)}finally{q(!1)}}async function X(){if(n){ne(!0);try{const me=n.company,He=U.company;await Q9(r,U),me&&He&&me!==He&&i&&i(me,He),await J(),G(!1),alert("Cadet profile updated successfully!")}catch(me){console.error("Error saving cadet:",me),alert(`Error saving cadet: ${me instanceof Error?me.message:"Unknown error"}`)}finally{ne(!1)}}}async function K(){if(!(!n||!window.confirm(`Are you sure you want to delete ${n.firstName} ${n.lastName}? This action cannot be undone.`)))try{await X9(r),alert("Cadet deleted successfully!"),s()}catch(He){console.error("Error deleting cadet:",He),alert(`Error deleting cadet: ${He instanceof Error?He.message:"Unknown error"}`)}}return R?m.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:m.jsx("div",{className:"text-gray-600",children:"Loading..."})}):n?m.jsxs("div",{className:"min-h-screen bg-gray-50 pb-safe-area-inset-bottom",children:[m.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-10 safe-area-inset-top",children:m.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[m.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Cadet Profile"}),m.jsx("button",{onClick:t,className:"text-sm text-blue-600 font-medium touch-manipulation",style:{minHeight:"44px",minWidth:"44px"},children:"Back"})]})}),m.jsx("main",{className:"px-4 py-4",children:m.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 space-y-4",children:[m.jsxs("div",{className:"flex justify-between items-center mb-4",children:[m.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:[n.firstName," ",n.lastName]}),!fe&&m.jsx("button",{onClick:()=>G(!0),className:"text-sm text-blue-600 font-medium touch-manipulation px-3 py-1",children:"Edit"})]}),m.jsx("div",{className:"mb-4",children:fe?m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Profile Picture URL"}),m.jsx("input",{type:"url",value:U.profilePicture||"",onChange:me=>H({...U,profilePicture:me.target.value}),placeholder:"Enter image URL...",className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm"}),m.jsx("div",{className:"flex justify-center",children:m.jsx("img",{src:U.profilePicture||ud,alt:`${n.firstName} ${n.lastName}`,className:"w-32 h-32 rounded-full object-cover border-2 border-gray-200",onError:me=>{me.target.src=ud}})})]}):m.jsx("div",{className:"flex justify-center",children:m.jsx("img",{src:n.profilePicture||ud,alt:`${n.firstName} ${n.lastName}`,className:"w-32 h-32 rounded-full object-cover border-2 border-gray-200",onError:me=>{me.target.src=ud}})})}),m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),fe?m.jsx("input",{type:"text",value:U.firstName||"",onChange:me=>H({...U,firstName:me.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm"}):m.jsx("div",{className:"text-gray-900",children:n.firstName||""})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),fe?m.jsx("input",{type:"text",value:U.lastName||"",onChange:me=>H({...U,lastName:me.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm"}):m.jsx("div",{className:"text-gray-900",children:n.lastName||""})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Age"}),fe?m.jsx("input",{type:"number",value:U.age||"",onChange:me=>H({...U,age:parseInt(me.target.value)||0}),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm"}):m.jsx("div",{className:"text-gray-900",children:n.age||""})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Birth"}),fe?m.jsx("input",{type:"date",value:U.dateOfBirth||"",onChange:me=>H({...U,dateOfBirth:me.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm"}):m.jsx("div",{className:"text-gray-900",children:n.dateOfBirth?new Date(n.dateOfBirth).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):""})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Shirt Size"}),fe?m.jsxs("select",{value:U.shirtSize||"",onChange:me=>H({...U,shirtSize:me.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:[m.jsx("option",{value:"",children:"Select size"}),m.jsx("option",{value:"XS",children:"XS"}),m.jsx("option",{value:"S",children:"S"}),m.jsx("option",{value:"M",children:"M"}),m.jsx("option",{value:"L",children:"L"}),m.jsx("option",{value:"XL",children:"XL"}),m.jsx("option",{value:"XXL",children:"XXL"}),m.jsx("option",{value:"XXXL",children:"XXXL"})]}):m.jsx("div",{className:"text-gray-900",children:n.shirtSize||""})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company"}),fe?m.jsx("select",{value:U.company||"Alpha",onChange:me=>H({...U,company:me.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:L7.map(me=>m.jsx("option",{value:me,children:me},me))}):m.jsx("div",{className:"text-gray-900",children:n.company||""})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Position"}),fe?m.jsx("input",{type:"text",value:U.position||"",onChange:me=>H({...U,position:me.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm"}):m.jsx("div",{className:"text-gray-900",children:n.position||""})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"MS Level"}),fe?m.jsx("select",{value:U.militaryScienceLevel||"MS1",onChange:me=>H({...U,militaryScienceLevel:me.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:M7.map(me=>m.jsx("option",{value:me,children:me},me))}):m.jsx("div",{className:"text-gray-900",children:n.militaryScienceLevel||""})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),fe?m.jsx("input",{type:"tel",value:U.phoneNumber||"",onChange:me=>H({...U,phoneNumber:me.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm"}):n.phoneNumber?m.jsx("a",{href:`tel:${n.phoneNumber.replace(/\s/g,"")}`,onClick:me=>{if(/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)){me.preventDefault();const fr=`BEGIN:VCARD
VERSION:3.0
FN:${n.firstName} ${n.lastName}
N:${n.lastName};${n.firstName};;;
TEL:${n.phoneNumber.replace(/\s/g,"")}
EMAIL:${n.email||""}
END:VCARD`,at=new Blob([fr],{type:"text/vcard"}),$e=URL.createObjectURL(at),Ve=document.createElement("a");Ve.href=$e,Ve.download=`${n.firstName}_${n.lastName}.vcf`,document.body.appendChild(Ve),Ve.click(),document.body.removeChild(Ve),URL.revokeObjectURL($e)}},className:"text-blue-600 hover:text-blue-800 underline cursor-pointer touch-manipulation",children:n.phoneNumber}):m.jsx("div",{className:"text-gray-900",children:""})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),fe?m.jsx("input",{type:"email",value:U.email||"",onChange:me=>H({...U,email:me.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm"}):n.email?m.jsx("a",{href:`mailto:${n.email}`,className:"text-blue-600 hover:text-blue-800 underline cursor-pointer touch-manipulation",children:n.email}):m.jsx("div",{className:"text-gray-900",children:""})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contracted"}),fe?m.jsxs("select",{value:U.contracted||"N",onChange:me=>H({...U,contracted:me.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:[m.jsx("option",{value:"Y",children:"Y"}),m.jsx("option",{value:"N",children:"N"})]}):m.jsx("div",{className:"text-gray-900",children:n.contracted||"N"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unexcused Absences"}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{children:[m.jsx("div",{className:"text-sm text-gray-600",children:"PT (Physical Training):"}),m.jsxs("div",{className:"relative",ref:O,children:[m.jsx("div",{onClick:async()=>{if(p>0)if(ee==="PT")te(null),L([]);else{const me=await U1(r,"PT");L(me),te("PT")}},className:`text-gray-900 font-semibold ${p>0?"cursor-pointer hover:text-blue-600 underline":""}`,children:p}),ee==="PT"&&ue.length>0&&m.jsxs("div",{className:"absolute z-50 bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-56 bg-white text-gray-900 text-xs rounded-lg shadow-lg border border-gray-300 p-3 max-h-64 overflow-y-auto",children:[m.jsx("div",{className:"font-semibold mb-2 text-gray-900",children:"Unexcused PT Dates:"}),m.jsx("div",{className:"space-y-1",children:ue.map((me,He)=>m.jsx("div",{className:"text-gray-700",children:sa(me)},He))}),m.jsx("div",{className:"absolute bottom-0 left-1/2 transform -translate-x-1/2 translate-y-full w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-white"})]})]})]}),m.jsxs("div",{children:[m.jsx("div",{className:"text-sm text-gray-600",children:"Lab:"}),m.jsxs("div",{className:"relative",ref:V,children:[m.jsx("div",{onClick:async()=>{if(w>0)if(ee==="Lab")te(null),L([]);else{const me=await U1(r,"Lab");L(me),te("Lab")}},className:`text-gray-900 font-semibold ${w>0?"cursor-pointer hover:text-blue-600 underline":""}`,children:w}),ee==="Lab"&&ue.length>0&&m.jsxs("div",{className:"absolute z-50 bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-56 bg-white text-gray-900 text-xs rounded-lg shadow-lg border border-gray-300 p-3 max-h-64 overflow-y-auto",children:[m.jsx("div",{className:"font-semibold mb-2 text-gray-900",children:"Unexcused Lab Dates:"}),m.jsx("div",{className:"space-y-1",children:ue.map((me,He)=>m.jsx("div",{className:"text-gray-700",children:sa(me)},He))}),m.jsx("div",{className:"absolute bottom-0 left-1/2 transform -translate-x-1/2 translate-y-full w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-white"})]})]})]}),m.jsxs("div",{children:[m.jsx("div",{className:"text-sm text-gray-600",children:"Tactics:"}),m.jsxs("div",{className:"relative",ref:W,children:[m.jsx("div",{onClick:async()=>{if(N>0)if(ee==="Tactics")te(null),L([]);else{const me=await U1(r,"Tactics");L(me),te("Tactics")}},className:`text-gray-900 font-semibold ${N>0?"cursor-pointer hover:text-blue-600 underline":""}`,children:N}),ee==="Tactics"&&ue.length>0&&m.jsxs("div",{className:"absolute z-50 bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-56 bg-white text-gray-900 text-xs rounded-lg shadow-lg border border-gray-300 p-3 max-h-64 overflow-y-auto",children:[m.jsx("div",{className:"font-semibold mb-2 text-gray-900",children:"Unexcused Tactics Dates:"}),m.jsx("div",{className:"space-y-1",children:ue.map((me,He)=>m.jsx("div",{className:"text-gray-700",children:sa(me)},He))}),m.jsx("div",{className:"absolute bottom-0 left-1/2 transform -translate-x-1/2 translate-y-full w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-white"})]})]})]})]}),m.jsx("div",{className:"text-xs text-gray-500 mt-1",children:p>0||w>0||N>0?"Click on a number to see specific dates":"These are calculated automatically from attendance records"})]})]}),fe&&m.jsxs("div",{className:"flex gap-3 mt-6",children:[m.jsx("button",{onClick:X,disabled:Z,className:`flex-1 py-3 px-4 rounded-lg font-semibold text-white touch-manipulation min-h-[44px] ${Z?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 active:bg-blue-800"}`,children:Z?"Saving...":"Save"}),m.jsx("button",{onClick:()=>{G(!1),J()},className:"flex-1 py-3 px-4 rounded-lg font-semibold text-gray-700 bg-gray-200 hover:bg-gray-300 active:bg-gray-400 touch-manipulation min-h-[44px]",children:"Cancel"})]}),!fe&&m.jsx("button",{onClick:K,className:"w-full mt-4 py-3 px-4 rounded-lg font-semibold text-white bg-red-600 hover:bg-red-700 active:bg-red-800 touch-manipulation min-h-[44px]",children:"Delete Cadet"})]})})]}):m.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:m.jsx("div",{className:"text-gray-600",children:"Cadet not found"})})}const U7=["MS1","MS2","MS3","MS4","MS5"],B7=["Alpha","Bravo","Charlie","Ranger"];function $7({onBack:r,onSuccess:t}){const[s,i]=we.useState({firstName:"",lastName:"",age:"",dateOfBirth:"",shirtSize:"",position:"",company:"Alpha",militaryScienceLevel:"MS1",phoneNumber:"",email:"",contracted:"N"}),[n,e]=we.useState(!1);async function p(x){if(x.preventDefault(),!s.firstName||!s.lastName){alert("Please fill in all required fields.");return}e(!0);try{await Y9({firstName:s.firstName,lastName:s.lastName,age:s.age?parseInt(s.age):void 0,dateOfBirth:s.dateOfBirth||void 0,shirtSize:s.shirtSize||void 0,position:s.position||void 0,company:s.company,militaryScienceLevel:s.militaryScienceLevel,phoneNumber:s.phoneNumber||void 0,email:s.email||void 0,contracted:s.contracted}),alert("Cadet added successfully!"),t()}catch(w){console.error("Error adding cadet:",w),alert(`Error adding cadet: ${w instanceof Error?w.message:"Unknown error"}`)}finally{e(!1)}}return m.jsxs("div",{className:"min-h-screen bg-gray-50 pb-safe-area-inset-bottom",children:[m.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-10 safe-area-inset-top",children:m.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[m.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Add Cadet"}),m.jsx("button",{onClick:r,className:"text-sm text-blue-600 font-medium touch-manipulation min-h-[44px] min-w-[44px]",children:"Back"})]})}),m.jsx("main",{className:"px-4 py-4",children:m.jsxs("form",{onSubmit:p,className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 space-y-4",children:[m.jsxs("div",{children:[m.jsx("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name *"}),m.jsx("input",{id:"firstName",type:"text",required:!0,value:s.firstName,onChange:x=>i({...s,firstName:x.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm"})]}),m.jsxs("div",{children:[m.jsx("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name *"}),m.jsx("input",{id:"lastName",type:"text",required:!0,value:s.lastName,onChange:x=>i({...s,lastName:x.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm"})]}),m.jsxs("div",{children:[m.jsx("label",{htmlFor:"age",className:"block text-sm font-medium text-gray-700 mb-1",children:"Age"}),m.jsx("input",{id:"age",type:"number",value:s.age,onChange:x=>i({...s,age:x.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm"})]}),m.jsxs("div",{children:[m.jsx("label",{htmlFor:"dateOfBirth",className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Birth"}),m.jsx("input",{id:"dateOfBirth",type:"date",value:s.dateOfBirth,onChange:x=>i({...s,dateOfBirth:x.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm"})]}),m.jsxs("div",{children:[m.jsx("label",{htmlFor:"shirtSize",className:"block text-sm font-medium text-gray-700 mb-1",children:"Shirt Size"}),m.jsxs("select",{id:"shirtSize",value:s.shirtSize,onChange:x=>i({...s,shirtSize:x.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:[m.jsx("option",{value:"",children:"Select size"}),m.jsx("option",{value:"XS",children:"XS"}),m.jsx("option",{value:"S",children:"S"}),m.jsx("option",{value:"M",children:"M"}),m.jsx("option",{value:"L",children:"L"}),m.jsx("option",{value:"XL",children:"XL"}),m.jsx("option",{value:"XXL",children:"XXL"}),m.jsx("option",{value:"XXXL",children:"XXXL"})]})]}),m.jsxs("div",{children:[m.jsx("label",{htmlFor:"company",className:"block text-sm font-medium text-gray-700 mb-1",children:"Company *"}),m.jsx("select",{id:"company",required:!0,value:s.company,onChange:x=>i({...s,company:x.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:B7.map(x=>m.jsx("option",{value:x,children:x},x))})]}),m.jsxs("div",{children:[m.jsx("label",{htmlFor:"position",className:"block text-sm font-medium text-gray-700 mb-1",children:"Position"}),m.jsx("input",{id:"position",type:"text",value:s.position,onChange:x=>i({...s,position:x.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm"})]}),m.jsxs("div",{children:[m.jsx("label",{htmlFor:"militaryScienceLevel",className:"block text-sm font-medium text-gray-700 mb-1",children:"MS Level *"}),m.jsx("select",{id:"militaryScienceLevel",required:!0,value:s.militaryScienceLevel,onChange:x=>i({...s,militaryScienceLevel:x.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:U7.map(x=>m.jsx("option",{value:x,children:x},x))})]}),m.jsxs("div",{children:[m.jsx("label",{htmlFor:"phoneNumber",className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),m.jsx("input",{id:"phoneNumber",type:"tel",value:s.phoneNumber,onChange:x=>i({...s,phoneNumber:x.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm"})]}),m.jsxs("div",{children:[m.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),m.jsx("input",{id:"email",type:"email",value:s.email,onChange:x=>i({...s,email:x.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm"})]}),m.jsxs("div",{children:[m.jsx("label",{htmlFor:"contracted",className:"block text-sm font-medium text-gray-700 mb-1",children:"Contracted *"}),m.jsxs("select",{id:"contracted",required:!0,value:s.contracted,onChange:x=>i({...s,contracted:x.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",children:[m.jsx("option",{value:"Y",children:"Y"}),m.jsx("option",{value:"N",children:"N"})]})]}),m.jsxs("div",{className:"flex gap-3 mt-6",children:[m.jsx("button",{type:"submit",disabled:n,className:`flex-1 py-3 px-4 rounded-lg font-semibold text-white touch-manipulation min-h-[44px] ${n?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 active:bg-blue-800"}`,children:n?"Adding...":"Add Cadet"}),m.jsx("button",{type:"button",onClick:r,className:"flex-1 py-3 px-4 rounded-lg font-semibold text-gray-700 bg-gray-200 hover:bg-gray-300 active:bg-gray-400 touch-manipulation min-h-[44px]",children:"Cancel"})]})]})})]})}function W7({onTrainingSchedule:r,onWeatherData:t,onForms:s,onBack:i}){return m.jsxs("div",{className:"min-h-screen bg-gray-50 pb-safe-area-inset-bottom",children:[m.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-10 safe-area-inset-top",children:m.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[m.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Staff"}),m.jsx("button",{onClick:i,className:"text-sm text-blue-600 font-medium touch-manipulation",style:{minHeight:"44px",minWidth:"44px"},children:"Home"})]})}),m.jsxs("main",{className:"px-4 py-4",children:[m.jsx("p",{className:"text-center text-gray-600 mb-6",children:"Select an option"}),m.jsxs("div",{className:"space-y-3",children:[m.jsx("button",{onClick:r,className:"w-full bg-white rounded-lg shadow-sm border border-gray-200 px-6 py-4 text-left hover:bg-gray-50 active:bg-gray-100 transition-colors touch-manipulation",style:{minHeight:"44px"},children:m.jsx("span",{className:"text-lg font-semibold text-gray-900",children:"Training Schedule"})}),m.jsx("button",{onClick:t,className:"w-full bg-white rounded-lg shadow-sm border border-gray-200 px-6 py-4 text-left hover:bg-gray-50 active:bg-gray-100 transition-colors touch-manipulation",style:{minHeight:"44px"},children:m.jsx("span",{className:"text-lg font-semibold text-gray-900",children:"Weather Data"})}),m.jsx("button",{onClick:s,className:"w-full bg-white rounded-lg shadow-sm border border-gray-200 px-6 py-4 text-left hover:bg-gray-50 active:bg-gray-100 transition-colors touch-manipulation",style:{minHeight:"44px"},children:m.jsx("span",{className:"text-lg font-semibold text-gray-900",children:"Forms"})})]})]})]})}const $f="trainingEvents";async function d6(){const r=ua(Cn(sr,$f),hD("date","desc"));return(await us(r)).docs.map(s=>({id:s.id,...s.data()}))}async function z7(r){const t=xs(sr,$f,r),s=await z2(t);return s.exists()?{id:s.id,...s.data()}:null}function p6(r){return Object.fromEntries(Object.entries(r).filter(([t,s])=>s!==void 0))}async function H7(r){const t=p6(r);return(await G0(Cn(sr,$f),t)).id}async function m6(r,t){const s=xs(sr,$f,r),i=p6(t);await jE(s,i)}async function G7(r){const t=xs(sr,$f,r);await Uf(t)}function q7({onSelectEvent:r,onAddEvent:t,onBack:s}){const[i,n]=we.useState([]),[e,p]=we.useState(!0);we.useEffect(()=>{x()},[]);async function x(){p(!0);try{const U=await d6();n(U)}catch(U){console.error("Error loading training events:",U),alert(`Error loading events: ${U instanceof Error?U.message:"Unknown error"}`)}finally{p(!1)}}async function w(U,H){if(confirm(`Are you sure you want to delete "${H}"?`))try{await G7(U),await x()}catch(ee){console.error("Error deleting event:",ee),alert(`Error deleting event: ${ee instanceof Error?ee.message:"Unknown error"}`)}}function E(U){const[H,ee,te]=U.split("-").map(Number);return new Date(H,ee-1,te)}function N(U){const H=new Date(U);return H.setHours(0,0,0,0),H}function P(U){const H=E(U),ee=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],te=["January","February","March","April","May","June","July","August","September","October","November","December"];return`${ee[H.getDay()]}, ${te[H.getMonth()]} ${H.getDate()}, ${H.getFullYear()}`}const R=N(new Date),q=i.filter(U=>N(E(U.date)).getTime()>=R.getTime()),Z=i.filter(U=>N(E(U.date)).getTime()<R.getTime());function ne(U){const H=new Map;return U.forEach(ee=>{const te=ee.date;H.has(te)||H.set(te,[]),H.get(te).push(ee)}),H}function fe(U){switch(U){case"complete":return m.jsx("span",{className:"text-green-600 text-xl font-bold",children:""});case"in-progress":return m.jsx("span",{className:"text-yellow-600 text-xl font-bold",children:""});case"issues":return m.jsx("span",{className:"text-red-600 text-xl font-bold",children:"!"})}}function G(U,H=!1){const ee=ne(U),te=Array.from(ee.keys()).sort((ue,L)=>H?L.localeCompare(ue):ue.localeCompare(L));return te.length===0?m.jsx("div",{className:"text-center py-8 text-gray-500",children:H?"No past events":"No upcoming events"}):m.jsx("div",{className:"space-y-6",children:te.map(ue=>{const L=ee.get(ue),O=P(ue);return m.jsxs("div",{children:[m.jsx("div",{className:"bg-gray-100 border-b-2 border-gray-300 px-4 py-2 mb-2 rounded-t-lg",children:m.jsx("h3",{className:"font-bold text-gray-900 text-sm",children:O})}),m.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:L.map(V=>m.jsxs("div",{className:`flex items-center border-b border-gray-100 last:border-b-0 ${H?"opacity-60":""}`,children:[m.jsx("button",{onClick:()=>r(V.id),className:"flex-1 px-4 py-3 text-left hover:bg-gray-50 active:bg-gray-100 transition-colors touch-manipulation",children:m.jsx("span",{className:"font-medium text-gray-900 block",children:V.name})}),m.jsx("div",{className:"px-4 py-3 flex items-center justify-center min-w-[50px]",children:fe(V.planningStatus)}),m.jsx("button",{onClick:W=>{W.stopPropagation(),w(V.id,V.name)},className:"px-4 py-3 text-red-600 hover:bg-red-50 active:bg-red-100 transition-colors touch-manipulation",style:{minHeight:"44px",minWidth:"44px"},children:""})]},V.id))})]},ue)})})}return m.jsxs("div",{className:"min-h-screen bg-gray-50 pb-safe-area-inset-bottom",children:[m.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-10 safe-area-inset-top",children:m.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[m.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Training Schedule"}),m.jsx("button",{onClick:s,className:"text-sm text-blue-600 font-medium touch-manipulation",style:{minHeight:"44px",minWidth:"44px"},children:"Home"})]})}),m.jsx("main",{className:"px-4 py-4",children:e?m.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading..."}):m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"mb-4",children:m.jsx("button",{onClick:t,className:"w-full py-3 px-4 rounded-lg font-semibold bg-blue-600 text-white hover:bg-blue-700 active:bg-blue-800 touch-manipulation min-h-[44px]",children:"Add Event"})}),q.length>0&&m.jsxs("div",{className:"mb-8",children:[m.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-4",children:"Upcoming Events"}),G(q,!1)]}),Z.length>0&&m.jsxs("div",{children:[m.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-4",children:"Past Events"}),G(Z,!0)]}),q.length===0&&Z.length===0&&m.jsx("div",{className:"text-center py-8 text-gray-500",children:"No training events. Add one to get started!"})]})})]})}function K7({eventId:r,onBack:t,onRefresh:s}){const[i,n]=we.useState(null),[e,p]=we.useState([]),[x,w]=we.useState(!0),[E,N]=we.useState("info"),[P,R]=we.useState(!1),[q,Z]=we.useState({});we.useEffect(()=>{ne()},[r]);async function ne(){w(!0);try{const[H,ee]=await Promise.all([z7(r),di("Master")]);H&&(n(H),Z(H)),p(ee.sort((te,ue)=>{const L=te.lastName.localeCompare(ue.lastName);return L!==0?L:te.firstName.localeCompare(ue.firstName)}))}catch(H){console.error("Error loading event:",H),alert(`Error loading event: ${H instanceof Error?H.message:"Unknown error"}`)}finally{w(!1)}}async function fe(){if(i)try{await m6(r,q),await ne(),R(!1),s()}catch(H){console.error("Error saving event:",H),alert(`Error saving event: ${H instanceof Error?H.message:"Unknown error"}`)}}function G(H){if(!H)return"";const ee=e.find(te=>te.id===H);return ee?`${ee.lastName}, ${ee.firstName}`:""}function U(H){const[ee,te,ue]=H.split("-").map(Number),L=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return`${ue.toString().padStart(2,"0")}${L[te-1]}${ee}`}return x?m.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:m.jsx("div",{className:"text-gray-600",children:"Loading..."})}):i?m.jsxs("div",{className:"min-h-screen bg-gray-50 pb-safe-area-inset-bottom",children:[m.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-10 safe-area-inset-top",children:m.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[m.jsx("h1",{className:"text-xl font-bold text-gray-900",children:i.name}),m.jsx("div",{className:"flex gap-2",children:P?m.jsxs(m.Fragment,{children:[m.jsx("button",{onClick:()=>{R(!1),Z(i)},className:"text-sm text-gray-600 font-medium touch-manipulation",style:{minHeight:"44px",minWidth:"44px"},children:"Cancel"}),m.jsx("button",{onClick:fe,className:"text-sm text-blue-600 font-medium touch-manipulation",style:{minHeight:"44px",minWidth:"44px"},children:"Save"})]}):m.jsxs(m.Fragment,{children:[m.jsx("button",{onClick:()=>R(!0),className:"text-sm text-blue-600 font-medium touch-manipulation",style:{minHeight:"44px",minWidth:"44px"},children:"Edit"}),m.jsx("button",{onClick:t,className:"text-sm text-gray-600 font-medium touch-manipulation",style:{minHeight:"44px",minWidth:"44px"},children:"Back"})]})})]})}),m.jsx("div",{className:"bg-white border-b border-gray-200",children:m.jsxs("div",{className:"flex",children:[m.jsx("button",{onClick:()=>N("info"),className:`flex-1 py-3 text-sm font-medium touch-manipulation ${E==="info"?"text-blue-600 border-b-2 border-blue-600":"text-gray-600"}`,children:"Info"}),m.jsx("button",{onClick:()=>N("conop"),className:`flex-1 py-3 text-sm font-medium touch-manipulation ${E==="conop"?"text-blue-600 border-b-2 border-blue-600":"text-gray-600"}`,children:"CONOP"})]})}),m.jsx("main",{className:"px-4 py-4",children:E==="info"?m.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 space-y-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Event Name"}),P?m.jsx("input",{type:"text",value:q.name||"",onChange:H=>Z({...q,name:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):m.jsx("div",{className:"text-gray-900",children:i.name})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),P?m.jsx("input",{type:"date",value:q.date||"",onChange:H=>Z({...q,date:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):m.jsx("div",{className:"text-gray-900",children:new Date(i.date).toLocaleDateString()})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"OIC"}),P?m.jsxs("select",{value:q.oicId||"",onChange:H=>Z({...q,oicId:H.target.value||void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[m.jsx("option",{value:"",children:"Select OIC"}),e.map(H=>m.jsxs("option",{value:H.id,children:[H.lastName,", ",H.firstName]},H.id))]}):m.jsx("div",{className:"text-gray-900",children:G(i.oicId)||"Not assigned"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"NCOIC"}),P?m.jsxs("select",{value:q.ncoicId||"",onChange:H=>Z({...q,ncoicId:H.target.value||void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[m.jsx("option",{value:"",children:"Select NCOIC"}),e.map(H=>m.jsxs("option",{value:H.id,children:[H.lastName,", ",H.firstName]},H.id))]}):m.jsx("div",{className:"text-gray-900",children:G(i.ncoicId)||"Not assigned"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"AO (Area of Operations)"}),P?m.jsx("input",{type:"text",value:q.ao||"",onChange:H=>Z({...q,ao:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):m.jsx("div",{className:"text-gray-900",children:i.ao||"Not specified"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Uniform"}),P?m.jsx("input",{type:"text",value:q.uniform||"",onChange:H=>Z({...q,uniform:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):m.jsx("div",{className:"text-gray-900",children:i.uniform||"Not specified"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mission"}),P?m.jsx("textarea",{value:q.mission||"",onChange:H=>Z({...q,mission:H.target.value}),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):m.jsx("div",{className:"text-gray-900 whitespace-pre-wrap",children:i.mission||"Not specified"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Planning Status"}),P?m.jsxs("select",{value:q.planningStatus||"in-progress",onChange:H=>Z({...q,planningStatus:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[m.jsx("option",{value:"complete",children:"Complete "}),m.jsx("option",{value:"in-progress",children:"In Progress "}),m.jsx("option",{value:"issues",children:"Issues !"})]}):m.jsxs("div",{className:"text-gray-900",children:[i.planningStatus==="complete"&&" Complete",i.planningStatus==="in-progress"&&" In Progress",i.planningStatus==="issues"&&"! Issues"]})]})]}):m.jsx(Y7,{event:i,editedEvent:q,setEditedEvent:Z,isEditing:P,cadets:e,formatDate:U})})]}):m.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:m.jsx("div",{className:"text-gray-600",children:"Event not found"})})}function Y7({event:r,editedEvent:t,setEditedEvent:s,isEditing:i,cadets:n,formatDate:e}){var U,H,ee,te,ue,L,O,V,W,J,X,K,me,He,fr,at,$e,Ve,ye,oe,Fe,Oe,Re,de,Ce,ce,Et,Xe,zt,or,vt,Ct,pt,Rr,er,Pr,Ke,jt,mt,Vt,Qt,lr,hn,Xr,_r,Or,Vn,Ai,Is,vl,fa,Ci;const p=i?t.conop||{}:r.conop||{};function x(Ne,Rt){s({...t,conop:{...p,[Ne]:Rt}})}function w(Ne,Rt){x("situation",{...p.situation,[Ne]:Rt})}function E(Ne,Rt){x("conceptOfOperation",{...p.conceptOfOperation,[Ne]:Rt})}function N(Ne,Rt){x("conceptOfOperation",{...p.conceptOfOperation,[Ne]:Rt})}function P(Ne,Rt){x("resources",{...p.resources,[Ne]:Rt})}function R(Ne,Rt){x("commsPace",{...p.commsPace,[Ne]:Rt})}function q(Ne,Rt){x("staffDuties",{...p.staffDuties,[Ne]:Rt})}function Z(Ne,Rt){x("attachedAppendices",{...p.attachedAppendices,[Ne]:Rt})}function ne(Ne,Rt){var Vr;x("weeklyTasks",{...p.weeklyTasks,[Ne]:{...(Vr=p.weeklyTasks)==null?void 0:Vr[Ne],status:Rt}})}function fe(Ne,Rt){var Vr;x("weeklyTasks",{...p.weeklyTasks,[Ne]:{...(Vr=p.weeklyTasks)==null?void 0:Vr[Ne],description:Rt}})}function G(Ne){switch(Ne){case"complete":return"bg-green-500";case"in-progress":return"bg-yellow-500";case"issues":return"bg-orange-500";case"not-started":return"bg-red-500";default:return"bg-red-500"}}return m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[m.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:"AREA OF OPERATIONS"}),i?m.jsxs("div",{className:"space-y-2",children:[m.jsx("input",{type:"url",value:p.imageUrl||"",onChange:Ne=>x("imageUrl",Ne.target.value),placeholder:"Enter image URL...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"}),p.imageUrl&&m.jsx("img",{src:p.imageUrl,alt:"Area of Operations",className:"w-full h-auto rounded border border-gray-200 max-h-64 object-cover",onError:Ne=>{Ne.target.style.display="none"}})]}):m.jsx("div",{children:p.imageUrl?m.jsx("img",{src:p.imageUrl,alt:"Area of Operations",className:"w-full h-auto rounded border border-gray-200 max-h-64 object-cover",onError:Ne=>{Ne.target.style.display="none"}}):m.jsx("div",{className:"w-full h-48 bg-gray-100 rounded border border-gray-200 flex items-center justify-center text-gray-400 text-sm",children:"No image provided"})})]}),m.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[m.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:"PURPOSE (WHY?)"}),i?m.jsx("textarea",{value:p.purpose||"",onChange:Ne=>x("purpose",Ne.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter purpose..."}):m.jsx("div",{className:"text-gray-700 min-h-[60px]",children:p.purpose||""})]}),m.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[m.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:"MISSION (WHO, WHAT, WHEN, & WHERE?, AKA MISSION STATEMENT)"}),m.jsx("p",{className:"text-xs text-gray-600 mb-2",children:"Include alt. location & time"}),i?m.jsx("textarea",{value:p.mission||"",onChange:Ne=>x("mission",Ne.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter mission statement..."}):m.jsx("div",{className:"text-gray-700 min-h-[60px]",children:p.mission||""})]}),m.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[m.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:"SITUATION"}),m.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"OIC:"}),i?m.jsxs("select",{value:((U=p.situation)==null?void 0:U.oic)||"",onChange:Ne=>w("oic",Ne.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",children:[m.jsx("option",{value:"",children:"Select"}),n.map(Ne=>m.jsxs("option",{value:`${Ne.lastName}, ${Ne.firstName}`,children:[Ne.lastName,", ",Ne.firstName]},Ne.id))]}):m.jsx("div",{className:"text-sm text-gray-700",children:((H=p.situation)==null?void 0:H.oic)||""})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"NCOIC:"}),i?m.jsxs("select",{value:((ee=p.situation)==null?void 0:ee.ncoic)||"",onChange:Ne=>w("ncoic",Ne.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",children:[m.jsx("option",{value:"",children:"Select"}),n.map(Ne=>m.jsxs("option",{value:`${Ne.lastName}, ${Ne.firstName}`,children:[Ne.lastName,", ",Ne.firstName]},Ne.id))]}):m.jsx("div",{className:"text-sm text-gray-700",children:((te=p.situation)==null?void 0:te.ncoic)||""})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"DATE:"}),i?m.jsx("input",{type:"text",value:((ue=p.situation)==null?void 0:ue.date)||"",onChange:Ne=>w("date",Ne.target.value),placeholder:"e.g., 060023AUG23-070023AUG23",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):m.jsx("div",{className:"text-sm text-gray-700",children:((L=p.situation)==null?void 0:L.date)||""})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"AO:"}),i?m.jsx("input",{type:"text",value:((O=p.situation)==null?void 0:O.ao)||"",onChange:Ne=>w("ao",Ne.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):m.jsx("div",{className:"text-sm text-gray-700",children:((V=p.situation)==null?void 0:V.ao)||""})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"UNIFORM:"}),i?m.jsx("input",{type:"text",value:((W=p.situation)==null?void 0:W.uniform)||"",onChange:Ne=>w("uniform",Ne.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):m.jsx("div",{className:"text-sm text-gray-700",children:((J=p.situation)==null?void 0:J.uniform)||""})]})]})]}),m.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[m.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:"END STATE"}),i?m.jsx("textarea",{value:p.endState||"",onChange:Ne=>x("endState",Ne.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter end state..."}):m.jsx("div",{className:"text-gray-700 min-h-[60px]",children:p.endState||""})]})]}),m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[m.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:"CONCEPT OF THE OPERATION"}),m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{children:[m.jsxs("label",{className:"block text-xs text-gray-600 mb-1",children:["PHASE I ",i?m.jsxs("span",{className:"text-gray-400",children:["(",m.jsx("input",{type:"text",value:((X=p.conceptOfOperation)==null?void 0:X.phase1Label)||"Location Prep",onChange:Ne=>N("phase1Label",Ne.target.value),className:"inline w-32 px-1 py-0 border-b border-gray-300 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 text-xs",placeholder:"Label"}),"):"]}):m.jsxs("span",{children:["(",((K=p.conceptOfOperation)==null?void 0:K.phase1Label)||"Location Prep","):"]})]}),i?m.jsx("input",{type:"text",value:((me=p.conceptOfOperation)==null?void 0:me.phase1)||"",onChange:Ne=>E("phase1",Ne.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):m.jsx("div",{className:"text-sm text-gray-700",children:((He=p.conceptOfOperation)==null?void 0:He.phase1)||""})]}),m.jsxs("div",{children:[m.jsxs("label",{className:"block text-xs text-gray-600 mb-1",children:["PHASE II ",i?m.jsxs("span",{className:"text-gray-400",children:["(",m.jsx("input",{type:"text",value:((fr=p.conceptOfOperation)==null?void 0:fr.phase2Label)||"Arrival",onChange:Ne=>N("phase2Label",Ne.target.value),className:"inline w-32 px-1 py-0 border-b border-gray-300 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 text-xs",placeholder:"Label"}),"):"]}):m.jsxs("span",{children:["(",((at=p.conceptOfOperation)==null?void 0:at.phase2Label)||"Arrival","):"]})]}),i?m.jsx("input",{type:"text",value:(($e=p.conceptOfOperation)==null?void 0:$e.phase2)||"",onChange:Ne=>E("phase2",Ne.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):m.jsx("div",{className:"text-sm text-gray-700",children:((Ve=p.conceptOfOperation)==null?void 0:Ve.phase2)||""})]}),m.jsxs("div",{children:[m.jsxs("label",{className:"block text-xs text-gray-600 mb-1",children:["PHASE III ",i?m.jsxs("span",{className:"text-gray-400",children:["(",m.jsx("input",{type:"text",value:((ye=p.conceptOfOperation)==null?void 0:ye.phase3Label)||"Mentorship",onChange:Ne=>N("phase3Label",Ne.target.value),className:"inline w-32 px-1 py-0 border-b border-gray-300 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 text-xs",placeholder:"Label"}),"):"]}):m.jsxs("span",{children:["(",((oe=p.conceptOfOperation)==null?void 0:oe.phase3Label)||"Mentorship","):"]})]}),i?m.jsx("input",{type:"text",value:((Fe=p.conceptOfOperation)==null?void 0:Fe.phase3)||"",onChange:Ne=>E("phase3",Ne.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):m.jsx("div",{className:"text-sm text-gray-700",children:((Oe=p.conceptOfOperation)==null?void 0:Oe.phase3)||""})]}),m.jsxs("div",{children:[m.jsxs("label",{className:"block text-xs text-gray-600 mb-1",children:["PHASE IV ",i?m.jsxs("span",{className:"text-gray-400",children:["(",m.jsx("input",{type:"text",value:((Re=p.conceptOfOperation)==null?void 0:Re.phase4Label)||"Dismissal",onChange:Ne=>N("phase4Label",Ne.target.value),className:"inline w-32 px-1 py-0 border-b border-gray-300 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 text-xs",placeholder:"Label"}),"):"]}):m.jsxs("span",{children:["(",((de=p.conceptOfOperation)==null?void 0:de.phase4Label)||"Dismissal","):"]})]}),i?m.jsx("input",{type:"text",value:((Ce=p.conceptOfOperation)==null?void 0:Ce.phase4)||"",onChange:Ne=>E("phase4",Ne.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):m.jsx("div",{className:"text-sm text-gray-700",children:((ce=p.conceptOfOperation)==null?void 0:ce.phase4)||""})]})]})]}),m.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[m.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:"RESOURCES & SUPPLY (SUPPLY REQUEST)"}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"CLASS I (Food, Rations, Water):"}),i?m.jsx("input",{type:"text",value:((Et=p.resources)==null?void 0:Et.class1)||"",onChange:Ne=>P("class1",Ne.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):m.jsx("div",{className:"text-sm text-gray-700",children:((Xe=p.resources)==null?void 0:Xe.class1)||""})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"CLASS II (Clothing & Equipment):"}),i?m.jsx("input",{type:"text",value:((zt=p.resources)==null?void 0:zt.class2)||"",onChange:Ne=>P("class2",Ne.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):m.jsx("div",{className:"text-sm text-gray-700",children:((or=p.resources)==null?void 0:or.class2)||""})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"CLASS V (Ammunition):"}),i?m.jsx("input",{type:"text",value:((vt=p.resources)==null?void 0:vt.class5)||"",onChange:Ne=>P("class5",Ne.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):m.jsx("div",{className:"text-sm text-gray-700",children:((Ct=p.resources)==null?void 0:Ct.class5)||""})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"CLASS VI (Personal Demand Items):"}),i?m.jsx("input",{type:"text",value:((pt=p.resources)==null?void 0:pt.class6)||"",onChange:Ne=>P("class6",Ne.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):m.jsx("div",{className:"text-sm text-gray-700",children:((Rr=p.resources)==null?void 0:Rr.class6)||""})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"CLASS VIII (Medical Supplies & Equipment):"}),i?m.jsx("input",{type:"text",value:((er=p.resources)==null?void 0:er.class8)||"",onChange:Ne=>P("class8",Ne.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):m.jsx("div",{className:"text-sm text-gray-700",children:((Pr=p.resources)==null?void 0:Pr.class8)||""})]})]})]}),m.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[m.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:"KEY DATES AND TIMELINE"}),i?m.jsx("textarea",{value:((Ke=p.keyDates)==null?void 0:Ke.join(`
`))||"",onChange:Ne=>x("keyDates",Ne.target.value.split(`
`).filter(Rt=>Rt.trim())),rows:4,className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",placeholder:"One date per line"}):m.jsx("div",{className:"text-sm text-gray-700 space-y-1",children:((jt=p.keyDates)==null?void 0:jt.map((Ne,Rt)=>m.jsx("div",{children:Ne},Rt)))||""})]}),m.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[m.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:"ATTACHED APPENDICIES"}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"APPENDIX 1:"}),i?m.jsx("input",{type:"text",value:((mt=p.attachedAppendices)==null?void 0:mt.appendix1)||"",onChange:Ne=>Z("appendix1",Ne.target.value),placeholder:"e.g., Medivac Plan",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):m.jsx("div",{className:"text-sm text-gray-700",children:((Vt=p.attachedAppendices)==null?void 0:Vt.appendix1)||""})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"APPENDIX 2:"}),i?m.jsx("input",{type:"text",value:((Qt=p.attachedAppendices)==null?void 0:Qt.appendix2)||"",onChange:Ne=>Z("appendix2",Ne.target.value),placeholder:"e.g., Packing List & Add. Items",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):m.jsx("div",{className:"text-sm text-gray-700",children:((lr=p.attachedAppendices)==null?void 0:lr.appendix2)||""})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"APPENDIX 3:"}),i?m.jsx("input",{type:"text",value:((hn=p.attachedAppendices)==null?void 0:hn.appendix3)||"",onChange:Ne=>Z("appendix3",Ne.target.value),placeholder:"e.g., Task Org. (If needed, for larger events like CWST)",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):m.jsx("div",{className:"text-sm text-gray-700",children:((Xr=p.attachedAppendices)==null?void 0:Xr.appendix3)||""})]})]})]}),m.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[m.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:"STAFF SECTION DUTIES & RESPONSIBILITIES"}),m.jsx("div",{className:"space-y-2",children:["s1","s2","s3","s4","s5","s6"].map(Ne=>{var Rt,Vr;return m.jsxs("div",{children:[m.jsxs("label",{className:"block text-xs text-gray-600 mb-1",children:[Ne.toUpperCase(),":"]}),i?m.jsx("input",{type:"text",value:((Rt=p.staffDuties)==null?void 0:Rt[Ne])||"",onChange:Ds=>q(Ne,Ds.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):m.jsx("div",{className:"text-sm text-gray-700",children:((Vr=p.staffDuties)==null?void 0:Vr[Ne])||""})]},Ne)})})]}),m.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[m.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:"COMMS PACE Plan"}),m.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"P:"}),i?m.jsx("input",{type:"text",value:((_r=p.commsPace)==null?void 0:_r.primary)||"",onChange:Ne=>R("primary",Ne.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):m.jsx("div",{className:"text-sm text-gray-700",children:((Or=p.commsPace)==null?void 0:Or.primary)||""})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"A:"}),i?m.jsx("input",{type:"text",value:((Vn=p.commsPace)==null?void 0:Vn.alternate)||"",onChange:Ne=>R("alternate",Ne.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):m.jsx("div",{className:"text-sm text-gray-700",children:((Ai=p.commsPace)==null?void 0:Ai.alternate)||""})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"C:"}),i?m.jsx("input",{type:"text",value:((Is=p.commsPace)==null?void 0:Is.contingency)||"",onChange:Ne=>R("contingency",Ne.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):m.jsx("div",{className:"text-sm text-gray-700",children:((vl=p.commsPace)==null?void 0:vl.contingency)||""})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"E:"}),i?m.jsx("input",{type:"text",value:((fa=p.commsPace)==null?void 0:fa.emergency)||"",onChange:Ne=>R("emergency",Ne.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}):m.jsx("div",{className:"text-sm text-gray-700",children:((Ci=p.commsPace)==null?void 0:Ci.emergency)||""})]})]})]}),m.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[m.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:"TASKS TO SUBS"}),i?m.jsx("textarea",{value:p.tasksToSubs||"",onChange:Ne=>x("tasksToSubs",Ne.target.value),rows:3,className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",placeholder:"E.g. - Pre-/post-lab, ruck WP/SP/Pacers, MSIV instructors for lab, etc."}):m.jsx("div",{className:"text-sm text-gray-700",children:p.tasksToSubs||""})]})]})]}),m.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[m.jsx("h3",{className:"font-bold text-gray-900 mb-4",children:"KEY TASKS FOR EACH WEEK"}),m.jsx("div",{className:"overflow-x-auto",children:m.jsxs("table",{className:"w-full border-collapse",children:[m.jsx("thead",{children:m.jsx("tr",{children:["t6","t5","t4","t3","t2","t1","tWeek"].map(Ne=>m.jsx("th",{className:"border border-gray-300 px-2 py-2 text-center text-xs font-bold bg-gray-100",children:Ne.toUpperCase()},Ne))})}),m.jsx("tbody",{children:m.jsx("tr",{children:["t6","t5","t4","t3","t2","t1","tWeek"].map(Ne=>{var Rs;const Rt=(Rs=p.weeklyTasks)==null?void 0:Rs[Ne],Vr=typeof Rt=="object"&&(Rt!=null&&Rt.status)?Rt.status:"not-started",Ds=typeof Rt=="object"&&(Rt!=null&&Rt.description)?Rt.description:"";return m.jsx("td",{className:"border border-gray-300 px-2 py-2",children:m.jsx("div",{className:"space-y-1",children:i?m.jsxs(m.Fragment,{children:[m.jsxs("select",{value:Vr,onChange:Qa=>ne(Ne,Qa.target.value),className:"w-full px-1 py-1 text-xs border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",children:[m.jsx("option",{value:"complete",children:""}),m.jsx("option",{value:"in-progress",children:""}),m.jsx("option",{value:"issues",children:"!"}),m.jsx("option",{value:"not-started",children:"-"})]}),m.jsx("textarea",{value:Ds,onChange:Qa=>fe(Ne,Qa.target.value),rows:3,className:"w-full px-1 py-1 text-xs border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 resize-none",placeholder:"Task description..."})]}):m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:`h-6 w-full rounded ${G(Vr)} flex items-center justify-center text-white text-xs font-bold`,children:[Vr==="complete"&&"",Vr==="in-progress"&&"",Vr==="issues"&&"!",Vr==="not-started"&&"-"]}),Ds&&m.jsx("div",{className:"text-xs text-gray-700 mt-1 whitespace-pre-wrap",children:Ds})]})})},Ne)})})})]})}),m.jsxs("div",{className:"flex flex-wrap gap-3 text-xs text-gray-600 mt-4",children:[m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("div",{className:"w-4 h-4 rounded bg-green-500"}),m.jsx("span",{className:"font-medium",children:"COMPLETE"})]}),m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("div",{className:"w-4 h-4 rounded bg-yellow-500"}),m.jsx("span",{className:"font-medium",children:"WORKING"})]}),m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("div",{className:"w-4 h-4 rounded bg-orange-500"}),m.jsx("span",{className:"font-medium",children:"ISSUES"})]}),m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("div",{className:"w-4 h-4 rounded bg-red-500"}),m.jsx("span",{className:"font-medium",children:"NOT STARTED"})]})]})]})]})}function Q7({eventId:r,onBack:t,onSuccess:s}){const[i,n]=we.useState(""),[e,p]=we.useState(""),[x,w]=we.useState("in-progress"),[E,N]=we.useState(!!r);we.useEffect(()=>{r&&N(!1)},[r]);async function P(R){if(R.preventDefault(),!i.trim()||!e){alert("Please fill in all required fields");return}try{const q={name:i.trim(),date:e,planningStatus:x};r?await m6(r,q):await H7(q),s()}catch(q){console.error("Error saving event:",q),alert(`Error saving event: ${q instanceof Error?q.message:"Unknown error"}`)}}return E?m.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:m.jsx("div",{className:"text-gray-600",children:"Loading..."})}):m.jsxs("div",{className:"min-h-screen bg-gray-50 pb-safe-area-inset-bottom",children:[m.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-10 safe-area-inset-top",children:m.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[m.jsx("h1",{className:"text-xl font-bold text-gray-900",children:r?"Edit Event":"Add Event"}),m.jsx("button",{onClick:t,className:"text-sm text-gray-600 font-medium touch-manipulation",style:{minHeight:"44px",minWidth:"44px"},children:"Cancel"})]})}),m.jsx("main",{className:"px-4 py-4",children:m.jsxs("form",{onSubmit:P,className:"bg-white rounded-lg border border-gray-200 p-4 space-y-4",children:[m.jsxs("div",{children:[m.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Event Name ",m.jsx("span",{className:"text-red-500",children:"*"})]}),m.jsx("input",{type:"text",value:i,onChange:R=>n(R.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter event name"})]}),m.jsxs("div",{children:[m.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Date ",m.jsx("span",{className:"text-red-500",children:"*"})]}),m.jsx("input",{type:"date",value:e,onChange:R=>p(R.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Planning Status"}),m.jsxs("select",{value:x,onChange:R=>w(R.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[m.jsx("option",{value:"complete",children:"Complete "}),m.jsx("option",{value:"in-progress",children:"In Progress "}),m.jsx("option",{value:"issues",children:"Issues !"})]})]}),m.jsx("div",{className:"pt-4",children:m.jsx("button",{type:"submit",className:"w-full py-3 px-4 rounded-lg font-semibold bg-blue-600 text-white hover:bg-blue-700 active:bg-blue-800 touch-manipulation min-h-[44px]",children:r?"Update Event":"Create Event"})})]})})]})}const X7=["Alpha","Bravo","Charlie","Ranger","Master"];function J7({onBack:r,onSelectCompany:t,onTactics:s,onIssues:i}){return m.jsxs("div",{className:"min-h-screen bg-gray-50 pb-safe-area-inset-bottom",children:[m.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-10 safe-area-inset-top",children:m.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[m.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Attendance"}),m.jsx("button",{onClick:r,className:"text-sm text-blue-600 font-medium touch-manipulation",style:{minHeight:"44px",minWidth:"44px"},children:"Back"})]})}),m.jsxs("main",{className:"px-4 py-4",children:[m.jsx("p",{className:"text-center text-gray-600 mb-6",children:"Select a company to handle attendance"}),m.jsxs("div",{className:"space-y-3",children:[X7.map(n=>m.jsx("button",{onClick:()=>t(n),className:"w-full bg-white rounded-lg shadow-sm border border-gray-200 px-6 py-4 text-left hover:bg-gray-50 active:bg-gray-100 transition-colors touch-manipulation",style:{minHeight:"44px"},children:m.jsx("span",{className:"text-lg font-semibold text-gray-900",children:n==="Master"?"Master List":`${n} Company`})},n)),m.jsx("button",{onClick:s,className:"w-full bg-white rounded-lg shadow-sm border border-gray-200 px-6 py-4 text-left hover:bg-gray-50 active:bg-gray-100 transition-colors touch-manipulation",style:{minHeight:"44px"},children:m.jsx("span",{className:"text-lg font-semibold text-gray-900",children:"Tactics"})}),m.jsx("button",{onClick:i,className:"w-full bg-white rounded-lg shadow-sm border border-gray-200 px-6 py-4 text-left hover:bg-gray-50 active:bg-gray-100 transition-colors touch-manipulation",style:{minHeight:"44px"},children:m.jsx("span",{className:"text-lg font-semibold text-gray-900",children:"Issues"})})]})]})]})}function Z7({onBack:r,onSelectCadet:t}){const[s,i]=we.useState([]),[n,e]=we.useState(new Map),[p,x]=we.useState(new Map),[w,E]=we.useState(!0),[N,P]=we.useState(!1),[R,q]=we.useState(Ta()),[Z,ne]=we.useState(new Map),fe=Pc(R);we.useEffect(()=>{G()},[R]),we.useEffect(()=>{s.length>0&&U()},[s]);async function G(){E(!0);try{const W=await l6("MS3");i(W);const J=new Map;for(const X of W){const K=await J9(X.id,R),me={cadetId:X.id,ptMonday:(K==null?void 0:K.ptMonday)??null,ptTuesday:(K==null?void 0:K.ptTuesday)??null,ptWednesday:(K==null?void 0:K.ptWednesday)??null,ptThursday:(K==null?void 0:K.ptThursday)??null,ptFriday:(K==null?void 0:K.ptFriday)??null,labThursday:(K==null?void 0:K.labThursday)??null,tacticsTuesday:(K==null?void 0:K.tacticsTuesday)??null,weekStartDate:R};J.set(X.id,me)}e(J),x(new Map(J))}catch(W){console.error("Error loading data:",W),alert(`Error loading data: ${W instanceof Error?W.message:"Unknown error"}`)}finally{E(!1)}}async function U(){try{const W=s.map(X=>X.id),J=await cg(W,"Tactics");ne(J)}catch(W){console.error("Error loading unexcused totals:",W)}}function H(W,J){x(X=>{const K=new Map(X),He={...K.get(W)||{cadetId:W,ptMonday:null,ptTuesday:null,ptWednesday:null,ptThursday:null,ptFriday:null,labThursday:null,tacticsTuesday:null,weekStartDate:R},tacticsTuesday:J||null,weekStartDate:R};return K.set(W,He),K})}async function ee(){P(!0);try{const W=[];p.forEach((J,X)=>{const K=n.get(X);J.tacticsTuesday!==((K==null?void 0:K.tacticsTuesday)??null)&&W.push({cadetId:X,record:J})}),n.forEach((J,X)=>{if(!p.has(X)){const K={cadetId:X,weekStartDate:R,ptMonday:null,ptTuesday:null,ptWednesday:null,ptThursday:null,ptFriday:null,labThursday:null,tacticsTuesday:null};W.push({cadetId:X,record:K})}}),await Promise.all(W.map(({record:J})=>u6(J))),e(new Map(p)),await U(),alert("Attendance saved successfully!")}catch(W){console.error("Error saving attendance:",W),alert(`Error saving attendance: ${W instanceof Error?W.message:"Unknown error"}`),await G()}finally{P(!1)}}const te=JSON.stringify(Array.from(n.entries()).sort())!==JSON.stringify(Array.from(p.entries()).sort()),ue=Array.from(p.values());let L=0,O=0,V=0;return ue.forEach(W=>{W.tacticsTuesday==="present"?L++:W.tacticsTuesday==="excused"?O++:W.tacticsTuesday==="unexcused"&&V++}),w?m.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:m.jsx("div",{className:"text-gray-600",children:"Loading..."})}):m.jsxs("div",{className:"min-h-screen bg-gray-50 pb-safe-area-inset-bottom",children:[m.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-10 safe-area-inset-top",children:m.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[m.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Tactics Attendance"}),m.jsx("button",{onClick:r,className:"text-sm text-blue-600 font-medium touch-manipulation",style:{minHeight:"44px",minWidth:"44px"},children:"Back"})]})}),m.jsxs("main",{className:"px-4 py-4",children:[m.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-4",children:m.jsxs("div",{className:"grid gap-2 text-center grid-cols-2",children:[m.jsx("div",{className:"font-semibold text-gray-700",children:"Name"}),m.jsx("div",{className:"font-semibold text-gray-700 text-sm",children:sa(fe.tuesday)})]})}),m.jsx("div",{className:"space-y-2",children:s.map(W=>{const J=p.get(W.id),X=(J==null?void 0:J.tacticsTuesday)??null;return m.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:m.jsxs("div",{className:"grid gap-2 p-3 grid-cols-2",children:[m.jsx("div",{className:"flex items-center",children:m.jsxs("button",{onClick:()=>t==null?void 0:t(W.id),className:"font-medium text-blue-600 hover:text-blue-800 text-sm text-left touch-manipulation",children:[W.lastName,", ",W.firstName]})}),m.jsxs("select",{value:X||"",onChange:K=>{const me=K.target.value;H(W.id,me===""?null:me)},"aria-label":`${W.firstName} ${W.lastName} Tuesday Tactics attendance`,className:`border-2 rounded-md px-2 py-2 text-sm font-medium touch-manipulation min-h-[44px] bg-white ${eR(X)} focus:outline-none focus:ring-2 focus:ring-blue-500`,children:[m.jsx("option",{value:"",children:""}),m.jsx("option",{value:"present",children:"Present"}),m.jsx("option",{value:"excused",children:"Excused"}),m.jsx("option",{value:"unexcused",children:"Unexcused"})]})]})},W.id)})}),s.length===0&&m.jsx("div",{className:"text-center py-8 text-gray-500",children:"No MS3 cadets found"}),s.length>0&&m.jsx("div",{className:"mt-4 mb-4",children:m.jsx("button",{onClick:ee,disabled:!te||N,className:`w-full py-3 px-4 rounded-lg font-semibold text-white touch-manipulation min-h-[44px] ${te&&!N?"bg-blue-600 hover:bg-blue-700 active:bg-blue-800":"bg-gray-400 cursor-not-allowed"}`,children:N?"Saving...":te?"Save Changes":"All Changes Saved"})}),s.length>0&&m.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 mb-4",children:[m.jsx("div",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Statistics"}),m.jsxs("div",{className:"grid grid-cols-3 gap-3 text-center",children:[m.jsxs("div",{children:[m.jsx("div",{className:"text-lg font-bold text-present",children:L}),m.jsx("div",{className:"text-xs text-gray-600",children:"Present"})]}),m.jsxs("div",{children:[m.jsx("div",{className:"text-lg font-bold text-excused",children:O}),m.jsx("div",{className:"text-xs text-gray-600",children:"Excused"})]}),m.jsxs("div",{children:[m.jsx("div",{className:"text-lg font-bold text-unexcused",children:V}),m.jsx("div",{className:"text-xs text-gray-600",children:"Unexcused"})]})]})]}),s.length>0&&m.jsx(tR,{currentWeekStart:R,onWeekChange:q})]})]})}function eR(r){return r==="present"?"border-present text-present":r==="excused"?"border-excused text-excused":r==="unexcused"?"border-unexcused text-unexcused":"border-gray-300 text-gray-600"}function tR({currentWeekStart:r,onWeekChange:t}){const s=Ta();function i(){const x=Ac(r,-1);t(x)}function n(){const x=Ac(r,1);t(x)}function e(){t(s)}const p=r===s;return m.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4 mb-4",children:m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("button",{onClick:i,className:"flex items-center justify-center w-10 h-10 rounded-lg border border-gray-300 hover:bg-gray-50 active:bg-gray-100 touch-manipulation transition-colors","aria-label":"Previous week",children:m.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),m.jsxs("div",{className:"flex-1 text-center px-4",children:[m.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["Week of ",Y0(r)]}),!p&&m.jsx("button",{onClick:e,className:"text-xs text-blue-600 hover:text-blue-700 mt-1 touch-manipulation",children:"Return to Current Week"})]}),m.jsx("button",{onClick:n,className:"flex items-center justify-center w-10 h-10 rounded-lg border border-gray-300 hover:bg-gray-50 active:bg-gray-100 touch-manipulation transition-colors","aria-label":"Next week",children:m.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})})}const fl="ptPlans";function g6(r,t,s){return`${r}_${t}_${s}`}function rR(){return`generic_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}async function nR(r,t){const s=new Map,i=ua(Cn(sr,fl),Ya("company","==",r),Ya("weekStartDate","==",t));return(await us(i)).forEach(e=>{const p={id:e.id,...e.data()};s.set(p.day,p)}),s}async function u0(r){if(r.isGeneric){const t=r.id||rR(),s=xs(sr,fl,t);await ig(s,{isGeneric:!0,title:r.title,firstFormation:r.firstFormation,workouts:r.workouts,location:r.location},{merge:!0})}else{if(!r.company||!r.weekStartDate||!r.day)throw new Error("Company, weekStartDate, and day are required for non-generic plans");const t=g6(r.company,r.weekStartDate,r.day),s=xs(sr,fl,t);await ig(s,{company:r.company,weekStartDate:r.weekStartDate,day:r.day,title:r.title,firstFormation:r.firstFormation,workouts:r.workouts,location:r.location,isGeneric:!1},{merge:!0})}}async function y6(r,t,s){const i=g6(r,t,s),n=xs(sr,fl,i);await Uf(n)}async function ny(){const r=ua(Cn(sr,fl));return(await us(r)).docs.map(s=>({id:s.id,...s.data()}))}async function sR(r){const t=xs(sr,fl,r);await Uf(t)}async function aR(r){const t=xs(sr,fl,r);await Uf(t)}const iR=["Alpha","Bravo","Charlie","Ranger"];function oR(r){return r==="Ranger"?["monday","tuesday","wednesday","thursday","friday"]:["tuesday","wednesday","thursday"]}function lR({onBack:r,onSelectCompany:t,selectedCompany:s}){const[i,n]=we.useState(s||null),[e,p]=we.useState(Ta()),[x,w]=we.useState(new Map),[E,N]=we.useState(!1),[P,R]=we.useState(null),[q,Z]=we.useState(!1),[ne,fe]=we.useState(new Set);we.useEffect(()=>{s&&s!==i&&n(s)},[s]),we.useEffect(()=>{i&&G()},[i,e]);async function G(){if(i){N(!0);try{const O=await nR(i,e);w(O)}catch(O){console.error("Error loading PT plans:",O),alert(`Error loading PT plans: ${O instanceof Error?O.message:"Unknown error"}`)}finally{N(!1)}}}function U(){const O=Ac(e,-1);p(O)}function H(){const O=Ac(e,1);p(O)}function ee(){p(Ta())}if(q)return m.jsx(uR,{onBack:()=>Z(!1)});if(!i)return m.jsxs("div",{className:"min-h-screen bg-gray-50 pb-safe-area-inset-bottom",children:[m.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-10 safe-area-inset-top",children:m.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[m.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"PT Plans"}),m.jsx("button",{onClick:r,className:"text-sm text-blue-600 font-medium touch-manipulation",style:{minHeight:"44px",minWidth:"44px"},children:"Back"})]})}),m.jsxs("main",{className:"px-4 py-4",children:[m.jsx("p",{className:"text-center text-gray-600 mb-6",children:"Select a company to view PT plans"}),m.jsx("div",{className:"space-y-3",children:iR.map(O=>m.jsx("button",{onClick:()=>{n(O),t&&t(O)},className:"w-full bg-white rounded-lg shadow-sm border border-gray-200 px-6 py-4 text-left hover:bg-gray-50 active:bg-gray-100 transition-colors touch-manipulation",style:{minHeight:"44px"},children:m.jsxs("span",{className:"text-lg font-semibold text-gray-900",children:[O," Company"]})},O))}),m.jsx("button",{onClick:()=>Z(!0),className:"w-full bg-white rounded-lg shadow-sm border border-gray-200 px-6 py-4 text-left hover:bg-gray-50 active:bg-gray-100 transition-colors touch-manipulation mt-4",style:{minHeight:"44px"},children:m.jsx("span",{className:"text-lg font-semibold text-gray-900",children:"All Plans"})})]})]});const te=Pc(e),ue=Ta(),L=e===ue;return m.jsxs("div",{className:"min-h-screen bg-gray-50 pb-safe-area-inset-bottom",children:[m.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-10 safe-area-inset-top",children:m.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[m.jsxs("h1",{className:"text-xl font-bold text-gray-900",children:["PT Plans - ",i]}),m.jsx("button",{onClick:()=>n(null),className:"text-sm text-blue-600 font-medium touch-manipulation",style:{minHeight:"44px",minWidth:"44px"},children:"Back"})]})}),m.jsxs("main",{className:"px-4 py-4",children:[m.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4 mb-4",children:m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("button",{onClick:U,className:"flex items-center justify-center w-10 h-10 rounded-lg border border-gray-300 hover:bg-gray-50 active:bg-gray-100 touch-manipulation transition-colors","aria-label":"Previous week",children:m.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),m.jsxs("div",{className:"flex-1 text-center px-4",children:[m.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["Week of ",Y0(e)]}),!L&&m.jsx("button",{onClick:ee,className:"text-xs text-blue-600 hover:text-blue-700 mt-1 touch-manipulation",children:"Return to Current Week"})]}),m.jsx("button",{onClick:H,className:"flex items-center justify-center w-10 h-10 rounded-lg border border-gray-300 hover:bg-gray-50 active:bg-gray-100 touch-manipulation transition-colors","aria-label":"Next week",children:m.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})}),E?m.jsx("div",{className:"text-center py-8 text-gray-600",children:"Loading..."}):m.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:oR(i).map(O=>{const V=x.get(O),W=te[O];return m.jsx(cR,{company:i,weekStartDate:e,day:O,date:W,plan:V,onEdit:()=>R({company:i,weekStartDate:e,day:O}),onSave:async J=>{await u0({company:i,weekStartDate:e,day:O,...J}),await G(),R(null)},onCancel:()=>R(null),onNoPT:async()=>{await u0({company:i,weekStartDate:e,day:O,title:"No PT",firstFormation:"",workouts:"",location:""}),await G()},onDelete:async()=>{if(!V||!confirm("Are you sure you want to delete this plan?"))return;await y6(i,e,O);const J=await ny();if(J.filter(K=>K.id!==V.id&&!K.isGeneric&&K.title===V.title&&K.firstFormation===V.firstFormation&&K.workouts===V.workouts&&K.location===V.location).length===0){const K=J.filter(me=>me.title===V.title&&me.firstFormation===V.firstFormation&&me.workouts===V.workouts&&me.location===V.location);for(const me of K)await aR(me.id)}await G()},isEditing:(P==null?void 0:P.company)===i&&(P==null?void 0:P.weekStartDate)===e&&(P==null?void 0:P.day)===O,isExpanded:ne.has(O),onToggleExpand:()=>{const J=new Set(ne);J.has(O)?J.delete(O):J.add(O),fe(J)}},O)})})]})]})}function cR({day:r,date:t,plan:s,onEdit:i,onSave:n,onCancel:e,onDelete:p,onNoPT:x,isEditing:w,isExpanded:E=!1,onToggleExpand:N}){const[P,R]=we.useState((s==null?void 0:s.title)||""),[q,Z]=we.useState((s==null?void 0:s.firstFormation)||"0600"),[ne,fe]=we.useState((s==null?void 0:s.workouts)||""),[G,U]=we.useState((s==null?void 0:s.location)||""),[H,ee]=we.useState(!1),[te,ue]=we.useState([]),[L,O]=we.useState(!1),[V,W]=we.useState(""),[J,X]=we.useState(null);we.useEffect(()=>{s?(R(s.title),Z(s.firstFormation),fe(s.workouts),U(s.location)):(R(""),Z("0600"),fe(""),U("")),W(""),X(w?{title:(s==null?void 0:s.title)||"",firstFormation:(s==null?void 0:s.firstFormation)||"0600",workouts:(s==null?void 0:s.workouts)||"",location:(s==null?void 0:s.location)||""}:null)},[s,w]),we.useEffect(()=>{w&&te.length===0&&K()},[w]);async function K(){O(!0);try{const at=await ny(),$e=new Map,Ve=[];for(const ye of at)if(ye.title!=="No PT")if(!ye.isGeneric&&ye.company&&ye.weekStartDate&&ye.day){const oe=`${ye.title}|${ye.firstFormation}|${ye.workouts}|${ye.location}`;$e.has(oe)||($e.set(oe,ye),Ve.push(ye))}else Ve.push(ye);Ve.sort((ye,oe)=>{if(ye.isGeneric&&!oe.isGeneric)return 1;if(!ye.isGeneric&&oe.isGeneric)return-1;if(ye.isGeneric&&oe.isGeneric)return ye.title.localeCompare(oe.title);const Fe=(oe.weekStartDate||"").localeCompare(ye.weekStartDate||"");return Fe!==0?Fe:(ye.company||"").localeCompare(oe.company||"")}),ue(Ve)}catch(at){console.error("Error loading plans:",at),alert(`Error loading plans: ${at instanceof Error?at.message:"Unknown error"}`)}finally{O(!1)}}function me(at){if(!at)return;const $e=te.find(Ve=>Ve.id===at);$e&&(R($e.title),Z($e.firstFormation),fe($e.workouts),U($e.location))}async function He(){if(!P.trim()){alert("Please enter a title for the workout");return}if(J&&!(P!==J.title||q!==J.firstFormation||ne!==J.workouts||G!==J.location)){e();return}ee(!0);try{await n({title:P,firstFormation:q,workouts:ne,location:G})}catch(at){console.error("Error saving plan:",at),alert(`Error saving plan: ${at instanceof Error?at.message:"Unknown error"}`)}finally{ee(!1)}}const fr=r.charAt(0).toUpperCase()+r.slice(1);return m.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 flex-1",children:[m.jsxs("div",{className:"flex items-start justify-between mb-3",children:[m.jsxs("div",{className:"flex-1",children:[m.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:fr}),m.jsx("p",{className:"text-sm text-gray-600",children:sa(t)})]}),!w&&N&&m.jsx("button",{onClick:N,className:"flex items-center justify-center w-8 h-8 rounded-md text-gray-600 hover:bg-gray-100 active:bg-gray-200 touch-manipulation ml-2","aria-label":E?"Collapse":"Expand",children:E?m.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})}):m.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]}),w?m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Workout Title *"}),m.jsx("input",{type:"text",value:P,onChange:at=>R(at.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Cardio & Strength"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Formation"}),m.jsx("input",{type:"text",value:q,onChange:at=>Z(at.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0600"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Workouts"}),m.jsx("textarea",{value:ne,onChange:at=>fe(at.target.value),rows:4,className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Describe the workout activities..."})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location"}),m.jsx("input",{type:"text",value:G,onChange:at=>U(at.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Main Field"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Load Plan"}),L?m.jsx("div",{className:"text-sm text-gray-600 py-2",children:"Loading plans..."}):m.jsxs("select",{value:V,onChange:at=>{W(at.target.value),me(at.target.value)},className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",children:[m.jsx("option",{value:"",children:"Select a plan to load..."}),te.filter(at=>!at.isGeneric&&at.company&&at.weekStartDate&&at.day).map(at=>{const Ve=Pc(at.weekStartDate)[at.day];return m.jsxs("option",{value:at.id,children:[at.title," (",at.company,"/",h6(Ve),")"]},at.id)}),te.filter(at=>at.isGeneric).map(at=>m.jsxs("option",{value:at.id,children:[at.title," (Generic Plan)"]},at.id))]})]}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx("button",{onClick:He,disabled:H||!P.trim(),className:`flex-1 py-2 px-4 rounded-md text-sm font-medium text-white touch-manipulation ${H||!P.trim()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 active:bg-blue-800"}`,children:H?"Saving...":"Save"}),m.jsx("button",{onClick:e,className:"flex-1 py-2 px-4 rounded-md text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 active:bg-gray-300 touch-manipulation",children:"Cancel"})]})]}):m.jsxs("div",{children:[s?m.jsx(m.Fragment,{children:E?m.jsxs("div",{className:"space-y-2 pt-3 border-t border-gray-200",children:[m.jsxs("div",{children:[m.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Title: "}),m.jsx("span",{className:"text-sm text-gray-900",children:s.title})]}),m.jsxs("div",{children:[m.jsx("span",{className:"text-sm font-medium text-gray-700",children:"First Formation: "}),m.jsx("span",{className:"text-sm text-gray-900",children:s.firstFormation})]}),s.workouts&&m.jsxs("div",{children:[m.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Workouts: "}),m.jsx("div",{className:"text-sm text-gray-900 whitespace-pre-wrap mt-1",children:s.workouts})]}),s.location&&m.jsxs("div",{children:[m.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Location: "}),m.jsx("span",{className:"text-sm text-gray-900",children:s.location})]})]}):m.jsx("div",{className:"pt-3 border-t border-gray-200",children:m.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.title})})}):m.jsx("div",{className:"text-sm text-gray-500 italic pt-3 border-t border-gray-200",children:"No plan created yet"}),m.jsxs("div",{className:"mt-3 space-y-2",children:[m.jsx("button",{onClick:i,className:"w-full py-2 px-4 rounded-md text-sm font-medium text-blue-600 border border-blue-600 hover:bg-blue-50 active:bg-blue-100 touch-manipulation",children:s?"Edit Plan":"Create Plan"}),m.jsx("button",{onClick:x,className:"w-full py-2 px-4 rounded-md text-sm font-medium text-red-600 border border-red-600 hover:bg-red-50 active:bg-red-100 touch-manipulation",children:"No PT"}),s&&m.jsx("button",{onClick:p,className:"w-full py-2 px-4 rounded-md text-sm font-medium text-red-600 border border-red-600 hover:bg-red-50 active:bg-red-100 touch-manipulation",children:"Delete Plan"})]})]})]})}function uR({onBack:r}){const[t,s]=we.useState([]),[i,n]=we.useState(!1),[e,p]=we.useState(!1),[x,w]=we.useState(null),[E,N]=we.useState(""),[P,R]=we.useState("0600"),[q,Z]=we.useState(""),[ne,fe]=we.useState(""),[G,U]=we.useState(!1),[H,ee]=we.useState(null),[te,ue]=we.useState(new Set);we.useEffect(()=>{L()},[]);async function L(){n(!0);try{const X=await ny(),K=new Map,me=[];for(const He of X)if(He.title!=="No PT")if(!He.isGeneric&&He.company&&He.weekStartDate&&He.day){const fr=`${He.title}|${He.firstFormation}|${He.workouts}|${He.location}`;K.has(fr)||(K.set(fr,He),me.push(He))}else me.push(He);me.sort((He,fr)=>{const at=!He.isGeneric&&He.weekStartDate,$e=!fr.isGeneric&&fr.weekStartDate;if(at&&!$e)return-1;if(!at&&$e)return 1;if(at&&$e){const Ve=(fr.weekStartDate||"").localeCompare(He.weekStartDate||"");return Ve!==0?Ve:(He.company||"").localeCompare(fr.company||"")}return He.title.localeCompare(fr.title)}),s(me)}catch(X){console.error("Error loading plans:",X),alert(`Error loading plans: ${X instanceof Error?X.message:"Unknown error"}`)}finally{n(!1)}}function O(X){w(X),N(X.title),R(X.firstFormation),Z(X.workouts),fe(X.location),p(!0)}function V(){p(!1),w(null),N(""),R("0600"),Z(""),fe("")}async function W(){if(!E.trim()){alert("Please enter a title for the workout");return}U(!0);try{x?await u0({id:x.id,isGeneric:x.isGeneric||!1,company:x.company,weekStartDate:x.weekStartDate,day:x.day,title:E,firstFormation:P,workouts:q,location:ne}):await u0({isGeneric:!0,title:E,firstFormation:P,workouts:q,location:ne}),await L(),V()}catch(X){console.error("Error saving plan:",X),alert(`Error saving plan: ${X instanceof Error?X.message:"Unknown error"}`)}finally{U(!1)}}async function J(X){if(confirm("Are you sure you want to delete this plan?")){ee(X.id);try{if(X.isGeneric)await sR(X.id);else{if(!X.company||!X.weekStartDate||!X.day)throw new Error("Cannot delete plan: missing required fields");await y6(X.company,X.weekStartDate,X.day)}await L()}catch(K){console.error("Error deleting plan:",K),alert(`Error deleting plan: ${K instanceof Error?K.message:"Unknown error"}`)}finally{ee(null)}}}return m.jsxs("div",{className:"min-h-screen bg-gray-50 pb-safe-area-inset-bottom",children:[m.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-10 safe-area-inset-top",children:m.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[m.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"PT Plans"}),m.jsx("button",{onClick:r,className:"text-sm text-blue-600 font-medium touch-manipulation",style:{minHeight:"44px",minWidth:"44px"},children:"Back"})]})}),m.jsx("main",{className:"px-4 py-4",children:e?m.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[m.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:x?"Edit Plan":"Add New Plan"}),m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Workout Title *"}),m.jsx("input",{type:"text",value:E,onChange:X=>N(X.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Field Circuit Training"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Formation"}),m.jsx("input",{type:"text",value:P,onChange:X=>R(X.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0600"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Workouts"}),m.jsx("textarea",{value:q,onChange:X=>Z(X.target.value),rows:4,className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Describe the workout activities..."})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location"}),m.jsx("input",{type:"text",value:ne,onChange:X=>fe(X.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Main Field"})]}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx("button",{onClick:W,disabled:G||!E.trim(),className:`flex-1 py-2 px-4 rounded-md text-sm font-medium text-white touch-manipulation ${G||!E.trim()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 active:bg-blue-800"}`,children:G?"Saving...":"Save"}),m.jsx("button",{onClick:V,className:"flex-1 py-2 px-4 rounded-md text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 active:bg-gray-300 touch-manipulation",children:"Cancel"})]})]})]}):m.jsxs(m.Fragment,{children:[m.jsx("button",{onClick:()=>{w(null),N(""),R("0600"),Z(""),fe(""),p(!0)},className:"w-full mb-4 py-2 px-4 rounded-md text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 active:bg-blue-800 touch-manipulation",style:{minHeight:"44px"},children:"Add New Plan"}),i?m.jsx("div",{className:"text-center py-8 text-gray-600",children:"Loading..."}):t.length===0?m.jsx("div",{className:"text-center py-8 text-gray-500",children:'No plans yet. Click "Add New Plan" to create one.'}):m.jsx("div",{className:"space-y-4",children:t.map(X=>{let K="";if(X.isGeneric)K="Generic Plan";else if(X.company&&X.weekStartDate&&X.day){const fr=Pc(X.weekStartDate)[X.day];K=`${X.company} - ${h6(fr)}`}const me=te.has(X.id);return m.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[m.jsxs("div",{className:"flex items-start justify-between",children:[m.jsxs("div",{className:"flex-1",children:[m.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:X.title}),K&&m.jsx("p",{className:"text-sm text-gray-600 mt-1",children:K})]}),m.jsxs("div",{className:"flex gap-2 items-center",children:[m.jsx("button",{onClick:()=>{const He=new Set(te);me?He.delete(X.id):He.add(X.id),ue(He)},className:"flex items-center justify-center w-8 h-8 rounded-md text-gray-600 hover:bg-gray-100 active:bg-gray-200 touch-manipulation","aria-label":me?"Collapse":"Expand",children:me?m.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})}):m.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),m.jsx("button",{onClick:()=>O(X),className:"text-sm text-blue-600 hover:text-blue-700 touch-manipulation",style:{minHeight:"44px",minWidth:"44px"},children:"Edit"}),m.jsx("button",{onClick:()=>J(X),disabled:H===X.id,className:"text-sm text-red-600 hover:text-red-700 disabled:opacity-50 touch-manipulation",style:{minHeight:"44px",minWidth:"44px"},children:H===X.id?"Deleting...":"Delete"})]})]}),me&&m.jsxs("div",{className:"space-y-2 mt-3 pt-3 border-t border-gray-200",children:[m.jsxs("div",{children:[m.jsx("span",{className:"text-sm font-medium text-gray-700",children:"First Formation: "}),m.jsx("span",{className:"text-sm text-gray-900",children:X.firstFormation})]}),X.workouts&&m.jsxs("div",{children:[m.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Workouts: "}),m.jsx("div",{className:"text-sm text-gray-900 whitespace-pre-wrap mt-1",children:X.workouts})]}),X.location&&m.jsxs("div",{children:[m.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Location: "}),m.jsx("span",{className:"text-sm text-gray-900",children:X.location})]})]})]},X.id)})})]})})]})}const fR="https://api.open-meteo.com/v1/forecast",hR=33.9519,dR=-83.3576;async function pR(r){const t=new Map,s=new Map;if(r.length===0)return{forecasts:t,errors:s};try{const i=[...r].sort(),n=i[0],e=i[i.length-1],p=new URL(fR);p.searchParams.set("latitude",hR.toString()),p.searchParams.set("longitude",dR.toString()),p.searchParams.set("start_date",n),p.searchParams.set("end_date",e),p.searchParams.set("timezone","America/New_York"),p.searchParams.set("temperature_unit","fahrenheit"),p.searchParams.set("windspeed_unit","mph"),p.searchParams.set("precipitation_unit","inch"),p.searchParams.set("daily","temperature_2m_max,temperature_2m_min,windspeed_10m_max,precipitation_probability_max"),p.searchParams.set("hourly","precipitation_probability"),console.log("Fetching weather from Open-Meteo:",p.toString());const x=await fetch(p.toString());if(!x.ok){let E="",N="";try{const R=await x.json();E=JSON.stringify(R),N=`Weather API error: ${x.status} ${x.statusText}`,R.reason&&(N+=` - ${R.reason}`)}catch{E=await x.text(),N=`Weather API error: ${x.status} ${x.statusText}`}const P={message:N,details:E,statusCode:x.status};return r.forEach(R=>{s.set(R,P)}),{forecasts:t,errors:s}}const w=await x.json();if(!w.daily||!w.daily.time||!Array.isArray(w.daily.time)){const E={message:"No daily forecast data in API response",details:`Response structure: ${JSON.stringify(Object.keys(w))}`};return r.forEach(N=>{s.set(N,E)}),{forecasts:t,errors:s}}for(const E of r){const N=w.daily.time.findIndex(P=>P===E);if(N>=0){const P=w.daily.temperature_2m_max[N],R=w.daily.temperature_2m_min[N],q=w.daily.windspeed_10m_max[N],Z=w.daily.precipitation_probability_max[N]||0;let ne=0,fe=0;if(w.hourly&&w.hourly.time&&w.hourly.precipitation_probability){const G=new Date(E+"T00:00:00"),U=new Date(G);U.setDate(U.getDate()+1);const H=[],ee=[];for(let te=0;te<w.hourly.time.length;te++){const ue=new Date(w.hourly.time[te]);if(ue>=G&&ue<U){const L=ue.getHours(),O=w.hourly.precipitation_probability[te]||0;L>=6&&L<18?H.push(O):ee.push(O)}}ne=H.length>0?Math.max(...H):Z,fe=ee.length>0?Math.max(...ee):Z}else ne=Z,fe=Z;t.set(E,{date:E,high:Math.round(P),low:Math.round(R),wind:Math.round(q),precipDay:Math.round(ne),precipNight:Math.round(fe)})}else{const P={message:`No forecast data available for ${E}`,details:"Date is outside the forecast range (up to 16 days)"};s.set(E,P)}}}catch(i){const n={message:i instanceof Error?i.message:"Unknown error",details:i instanceof Error?i.stack:String(i)};r.forEach(e=>{s.set(e,n)})}return{forecasts:t,errors:s}}function mR({onBack:r}){const[t,s]=we.useState([]),[i,n]=we.useState(!0),[e,p]=we.useState(null);we.useEffect(()=>{x()},[]);async function x(){n(!0);try{const E=Ta(),N=t7(E),P=[N.monday,N.tuesday,N.wednesday,N.thursday,N.friday,N.saturday,N.sunday],{forecasts:R,errors:q}=await pR(P);if(q.size>0){const H=[];q.forEach((ee,te)=>{H.push(`${te}: ${ee.message}${ee.details?` - ${ee.details}`:""}${ee.statusCode?` (Status: ${ee.statusCode})`:""}`)}),p(H.join(`
`))}else p(null);const Z=await d6(),ne=new Map;Z.forEach(H=>{ne.set(H.date,H.name)});const fe=localStorage.getItem("weatherEventsImpact"),G=fe?JSON.parse(fe):{},U=P.map(H=>{const ee=R.get(H),te=G[H],ue=ne.get(H),L=(te==null?void 0:te.events)!==void 0?te.events:ue||"";return{date:H,dayLabel:r7(H),high:ee?String(ee.high):"",low:ee?String(ee.low):"",wind:ee?String(ee.wind):"",precipDay:ee?String(ee.precipDay):"",precipNight:ee?String(ee.precipNight):"",events:L,impact:(te==null?void 0:te.impact)||""}});s(U)}catch(E){const N=E instanceof Error?E.message:"Unknown error occurred",P=E instanceof Error?E.stack:String(E);p(`Error loading weather data: ${N}
${P}`),console.error("Error loading weather data:",E)}finally{n(!1)}}function w(E,N,P){const R=[...t];R[E]={...R[E],[N]:P},s(R);const q={};R.forEach(Z=>{q[Z.date]={events:Z.events,impact:Z.impact}}),localStorage.setItem("weatherEventsImpact",JSON.stringify(q))}return m.jsxs("div",{className:"min-h-screen bg-gray-50 pb-safe-area-inset-bottom",children:[m.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-10 safe-area-inset-top",children:m.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[m.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Weather Data"}),m.jsx("button",{onClick:r,className:"text-sm text-blue-600 font-medium touch-manipulation",style:{minHeight:"44px",minWidth:"44px"},children:"Back"})]})}),m.jsx("main",{className:"px-4 py-4",children:i?m.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading weather data..."}):e?m.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[m.jsx("h2",{className:"text-lg font-semibold text-red-900 mb-2",children:"Weather Data Error"}),m.jsx("pre",{className:"text-sm text-red-800 whitespace-pre-wrap break-words",children:e})]}):t.length===0||t.every(E=>!E.high&&!E.low)?m.jsx("div",{className:"text-center py-8 text-gray-500",children:"No weather data available"}):m.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-300 overflow-hidden",children:m.jsx("div",{className:"overflow-x-auto",children:m.jsxs("table",{className:"w-full border-collapse border border-gray-300",children:[m.jsx("thead",{children:m.jsxs("tr",{className:"bg-white border-b border-gray-300",children:[m.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-900 border-r border-gray-300",children:"Day"}),m.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-900 border-r border-gray-300",children:"High (F)"}),m.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-900 border-r border-gray-300",children:"Low (F)"}),m.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-900 border-r border-gray-300",children:"Wind (mph)"}),m.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-900 border-r border-gray-300",children:"Precip. Day"}),m.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-900 border-r border-gray-300",children:"Precip. Night"}),m.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-900 border-r border-gray-300",children:"Events"}),m.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-900",children:"Impact"})]})}),m.jsx("tbody",{children:t.map((E,N)=>m.jsxs("tr",{className:"border-b border-gray-300 last:border-b-0",children:[m.jsx("td",{className:"px-3 py-2 text-sm text-gray-900 border-r border-gray-300 whitespace-nowrap bg-white",children:E.dayLabel}),m.jsx("td",{className:"px-3 py-2 border-r border-gray-300 bg-white",children:m.jsx("div",{className:"px-2 py-1 text-sm text-gray-900",children:E.high||"--"})}),m.jsx("td",{className:"px-3 py-2 border-r border-gray-300 bg-white",children:m.jsx("div",{className:"px-2 py-1 text-sm text-gray-900",children:E.low||"--"})}),m.jsx("td",{className:"px-3 py-2 border-r border-gray-300 bg-white",children:m.jsx("div",{className:"px-2 py-1 text-sm text-gray-900",children:E.wind||"--"})}),m.jsx("td",{className:"px-3 py-2 border-r border-gray-300 bg-white",children:m.jsx("div",{className:"px-2 py-1 text-sm text-gray-900",children:E.precipDay||"--"})}),m.jsx("td",{className:"px-3 py-2 border-r border-gray-300 bg-white",children:m.jsx("div",{className:"px-2 py-1 text-sm text-gray-900",children:E.precipNight||"--"})}),m.jsx("td",{className:"px-3 py-2 border-r border-gray-300 bg-white",children:m.jsx("input",{type:"text",value:E.events,onChange:P=>w(N,"events",P.target.value),className:"w-full px-2 py-1 text-sm border-0 bg-transparent focus:outline-none focus:bg-blue-50",placeholder:"NONE"})}),m.jsx("td",{className:"px-3 py-2 bg-white",children:m.jsx("input",{type:"text",value:E.impact,onChange:P=>w(N,"impact",P.target.value),className:"w-full px-2 py-1 text-sm border-0 bg-transparent focus:outline-none focus:bg-blue-50",placeholder:"NONE"})})]},E.date))})]})})})})]})}function gR({onExpenseRequest:r,onBack:t}){return m.jsxs("div",{className:"min-h-screen bg-gray-50 pb-safe-area-inset-bottom",children:[m.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-10 safe-area-inset-top",children:m.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[m.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Forms"}),m.jsx("button",{onClick:t,className:"text-sm text-blue-600 font-medium touch-manipulation",style:{minHeight:"44px",minWidth:"44px"},children:"Back"})]})}),m.jsxs("main",{className:"px-4 py-4",children:[m.jsx("p",{className:"text-center text-gray-600 mb-6",children:"Select a form"}),m.jsx("div",{className:"space-y-3",children:m.jsx("button",{onClick:r,className:"w-full bg-white rounded-lg shadow-sm border border-gray-200 px-6 py-4 text-left hover:bg-gray-50 active:bg-gray-100 transition-colors touch-manipulation",style:{minHeight:"44px"},children:m.jsx("span",{className:"text-lg font-semibold text-gray-900",children:"Submit An Expense Request"})})})]})]})}const z1="expenseRequestForm",yR=()=>({name:"",dateOfRequest:"",position:"",vendor:"",purposeOfExpense:"",paymentMethod:"",items:[""],totalExpectedExpenses:"",budgetCategory:"",allottedBudget:"",additionalComments:"I, __________, understand and acknowledge that reimbursement for expenses is contingent upon following the established process, including obtaining proper approvals and submitting the necessary documentation. I also accept that failure to comply with these requirements or discrepancies between requested and actual expenses may result in denial of reimbursement or reimbursement limited to the amount requested.",acknowledged:!1});function vR({onBack:r}){const t=we.useRef(null),[s,i]=we.useState(yR()),[n,e]=we.useState(!1);we.useEffect(()=>{localStorage.removeItem(z1)},[]),we.useEffect(()=>()=>{localStorage.removeItem(z1)},[]);function p(R,q){i(Z=>({...Z,[R]:q}))}function x(){i(R=>({...R,items:[...R.items,""]}))}function w(R){i(q=>({...q,items:q.items.filter((Z,ne)=>ne!==R)}))}function E(R,q){i(Z=>({...Z,items:Z.items.map((ne,fe)=>fe===R?q:ne)}))}async function N(){if(t.current){e(!0);try{const R=L=>new Promise((O,V)=>{if(document.querySelector(`script[src="${L}"]`)){O();return}const W=document.createElement("script");W.src=L,W.onload=()=>O(),W.onerror=()=>V(new Error(`Failed to load ${L}`)),document.head.appendChild(W)});await Promise.all([R("https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"),R("https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js")]),await new Promise(L=>setTimeout(L,200));const q=window.html2canvas,{jsPDF:Z}=window.jspdf;window.scrollTo(0,0),t.current.scrollIntoView({behavior:"instant",block:"start"});const ne=await q(t.current,{scale:2,useCORS:!0,logging:!1,backgroundColor:"#ffffff",windowWidth:t.current.scrollWidth,windowHeight:t.current.scrollHeight,allowTaint:!1,removeContainer:!1}),fe=ne.toDataURL("image/png"),G=new Z({orientation:"portrait",unit:"mm",format:"a4"}),U=210,H=297,ee=ne.height*U/ne.width;let te=ee,ue=0;for(G.addImage(fe,"PNG",0,ue,U,ee),te-=H;te>=0;)ue=te-ee,G.addPage(),G.addImage(fe,"PNG",0,ue,U,ee),te-=H;G.save("expense-request-form.pdf")}catch(R){console.error("Error generating PDF:",R),alert("Error generating PDF. Please try again.")}finally{e(!1)}}}function P(){localStorage.removeItem(z1),r()}return m.jsxs("div",{className:"min-h-screen bg-gray-50 pb-safe-area-inset-bottom",children:[m.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-10 safe-area-inset-top",children:m.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[m.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Expense Request Form"}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx("button",{onClick:N,className:"text-sm text-blue-600 font-medium touch-manipulation px-2",style:{minHeight:"44px",minWidth:"44px"},children:"Save"}),m.jsx("button",{onClick:P,className:"text-sm text-blue-600 font-medium touch-manipulation",style:{minHeight:"44px",minWidth:"44px"},children:"Back"})]})]})}),m.jsx("main",{className:"px-4 py-4",children:m.jsxs("div",{ref:t,className:"bg-white p-6 max-w-4xl mx-auto shadow-sm border border-gray-300",style:{fontFamily:"Arial, sans-serif",overflow:"visible"},children:[m.jsx("h1",{className:"text-3xl font-bold text-center mb-2",style:{fontSize:"28px"},children:"Expense Request Form"}),m.jsxs("div",{className:"text-center mb-4",children:[m.jsx("p",{className:"font-bold text-sm mb-1",children:"***DOWNLOAD A COPY TO MAKE EDITS ***"}),m.jsx("p",{className:"font-bold text-sm",children:"*** RECEIPTS MUST BE PROVIDED***"})]}),m.jsx("div",{className:"mb-4",children:m.jsx("table",{className:"w-full border-collapse border border-gray-300",children:m.jsxs("tbody",{children:[m.jsxs("tr",{children:[m.jsx("td",{className:"border border-gray-300 p-2 font-semibold",style:{width:"15%"},children:"Name:"}),m.jsx("td",{className:"border border-gray-300 p-2",style:{width:"35%"},children:m.jsx("input",{type:"text",value:s.name,onChange:R=>p("name",R.target.value),placeholder:"Isabella Navarro",className:"w-full border-0 outline-none bg-transparent placeholder:text-gray-400 text-gray-900"})}),m.jsx("td",{className:"border border-gray-300 p-2 font-semibold",style:{width:"20%"},children:"Date of Request:"}),m.jsx("td",{className:"border border-gray-300 p-2",style:{width:"30%"},children:m.jsx("input",{type:"text",value:s.dateOfRequest,onChange:R=>p("dateOfRequest",R.target.value),placeholder:"12/1/25",className:"w-full border-0 outline-none bg-transparent placeholder:text-gray-400 text-gray-900"})})]}),m.jsxs("tr",{children:[m.jsx("td",{className:"border border-gray-300 p-2 font-semibold",children:"Position:"}),m.jsx("td",{className:"border border-gray-300 p-2",children:m.jsx("input",{type:"text",value:s.position,onChange:R=>p("position",R.target.value),placeholder:"Military Ball OIC",className:"w-full border-0 outline-none bg-transparent placeholder:text-gray-400 text-gray-900"})}),m.jsx("td",{className:"border border-gray-300 p-2 font-semibold",children:"Vendor:"}),m.jsx("td",{className:"border border-gray-300 p-2",children:m.jsx("input",{type:"text",value:s.vendor,onChange:R=>p("vendor",R.target.value),placeholder:"Botanical Gardens",className:"w-full border-0 outline-none bg-transparent placeholder:text-gray-400 text-gray-900"})})]}),m.jsxs("tr",{children:[m.jsx("td",{className:"border border-gray-300 p-2 font-semibold",children:"Purpose of Expense:"}),m.jsx("td",{colSpan:3,className:"border border-gray-300 p-2",children:m.jsx("input",{type:"text",value:s.purposeOfExpense,onChange:R=>p("purposeOfExpense",R.target.value),placeholder:"Venue Rental",className:"w-full border-0 outline-none bg-transparent placeholder:text-gray-400 text-gray-900"})})]})]})})}),m.jsxs("div",{className:"mb-4",children:[m.jsx("p",{className:"font-semibold mb-2",children:"Method of Payment (Check one):"}),m.jsxs("div",{className:"flex gap-4",children:[m.jsxs("label",{className:"flex items-center gap-2",children:[m.jsx("input",{type:"checkbox",checked:s.paymentMethod==="cadet-fund-card",onChange:R=>{R.target.checked?p("paymentMethod","cadet-fund-card"):p("paymentMethod","")},className:"w-4 h-4"}),m.jsx("span",{children:"Cadet Fund Card"})]}),m.jsxs("label",{className:"flex items-center gap-2",children:[m.jsx("input",{type:"checkbox",checked:s.paymentMethod==="reimbursement-check",onChange:R=>{R.target.checked?p("paymentMethod","reimbursement-check"):p("paymentMethod","")},className:"w-4 h-4"}),m.jsx("span",{children:"Reimbursement Check"})]})]})]}),m.jsxs("div",{className:"mb-4",children:[m.jsx("p",{className:"font-semibold mb-2",children:"Itemized List of Expenses:"}),m.jsx("div",{className:"space-y-2",children:s.items.map((R,q)=>m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"text-lg",children:""}),m.jsx("input",{type:"text",value:R,onChange:Z=>E(q,Z.target.value),placeholder:q===0?"Conservatory Great room and Gardenside":"Enter expense item",className:"flex-1 border-0 outline-none bg-transparent placeholder:text-gray-400 text-gray-900"}),!n&&s.items.length>1&&m.jsx("button",{onClick:()=>w(q),className:"text-red-600 font-bold text-lg px-2 touch-manipulation",style:{minHeight:"44px",minWidth:"44px"},children:""}),!n&&q===s.items.length-1&&m.jsx("button",{onClick:x,className:"text-blue-600 font-bold text-lg px-2 touch-manipulation",style:{minHeight:"44px",minWidth:"44px"},children:"+"})]},q))})]}),m.jsx("div",{className:"mb-4",children:m.jsx("table",{className:"w-full border-collapse border border-gray-300",children:m.jsxs("tbody",{children:[m.jsxs("tr",{children:[m.jsx("td",{className:"border border-gray-300 p-2 font-semibold",children:"Total Expected Expenses (Include tax):"}),m.jsx("td",{className:"border border-gray-300 p-2",children:m.jsx("input",{type:"text",value:s.totalExpectedExpenses,onChange:R=>p("totalExpectedExpenses",R.target.value),placeholder:"$2,500",className:"w-full border-0 outline-none bg-transparent placeholder:text-gray-400 text-gray-900"})})]}),m.jsxs("tr",{children:[m.jsx("td",{className:"border border-gray-300 p-2 font-semibold",children:"Budget Category (Review the Budget List in Teams):"}),m.jsx("td",{className:"border border-gray-300 p-2",children:m.jsx("input",{type:"text",value:s.budgetCategory,onChange:R=>p("budgetCategory",R.target.value),placeholder:"Mil Ball",className:"w-full border-0 outline-none bg-transparent placeholder:text-gray-400 text-gray-900"})})]}),m.jsxs("tr",{children:[m.jsx("td",{className:"border border-gray-300 p-2 font-semibold",children:"Allotted Budget:"}),m.jsx("td",{className:"border border-gray-300 p-2",children:m.jsx("input",{type:"text",value:s.allottedBudget,onChange:R=>p("allottedBudget",R.target.value),placeholder:"$10,000",className:"w-full border-0 outline-none bg-transparent placeholder:text-gray-400 text-gray-900"})})]})]})})}),m.jsxs("div",{className:"mb-4",children:[m.jsx("p",{className:"font-semibold mb-2",children:"Additional Comments:"}),m.jsx("textarea",{value:s.additionalComments,onChange:R=>p("additionalComments",R.target.value),className:"w-full border-0 outline-none bg-transparent p-2 min-h-[100px] resize-none text-gray-900",style:{whiteSpace:"pre-wrap",wordWrap:"break-word",overflowWrap:"break-word"},placeholder:"I, __________, understand and acknowledge..."})]}),m.jsx("div",{className:"mb-4",children:m.jsxs("label",{className:"flex items-center gap-2",children:[m.jsx("input",{type:"checkbox",checked:s.acknowledged,onChange:R=>p("acknowledged",R.target.checked),className:"w-4 h-4"}),m.jsx("span",{className:"font-semibold",children:"Check to Acknowledge"})]})}),m.jsxs("div",{className:"space-y-4 mt-6",children:[m.jsxs("div",{children:[m.jsx("div",{className:"border-b-2 border-gray-900 mb-1",style:{minHeight:"50px"}}),m.jsx("p",{className:"text-sm",children:"Battalion Commander Signature"})]}),m.jsxs("div",{children:[m.jsx("div",{className:"border-b-2 border-gray-900 mb-1",style:{minHeight:"50px"}}),m.jsx("p",{className:"text-sm",children:"Battalion S8 Finance Officer Signature"})]})]})]})})]})}function xR(){const[r,t]=we.useState(!1),[s,i]=we.useState(!1),[n,e]=we.useState(!1);we.useEffect(()=>{if(!ey())return;const w=localStorage.getItem("notificationPromptDismissed");if(w&&(Date.now()-parseInt(w))/864e5<7){e(!0);return}if(ty()==="default"&&!n){const N=setTimeout(()=>{t(!0)},2e3);return()=>clearTimeout(N)}},[n]);async function p(){i(!0);try{await Z2(),t(!1),alert("Notifications enabled! You will now receive push notifications.")}catch(w){console.error("Error enabling notifications:",w),alert(`Could not enable notifications: ${w instanceof Error?w.message:"Unknown error"}`)}finally{i(!1)}}function x(){t(!1),e(!0),localStorage.setItem("notificationPromptDismissed",Date.now().toString())}return r?m.jsx("div",{className:"fixed bottom-4 left-4 right-4 md:left-auto md:right-4 md:w-96 z-50 safe-area-inset-bottom",children:m.jsxs("div",{className:"bg-white rounded-lg shadow-lg border border-gray-200 p-4",children:[m.jsxs("div",{className:"flex items-start justify-between mb-3",children:[m.jsxs("div",{className:"flex-1",children:[m.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-1",children:"Enable Notifications"}),m.jsx("p",{className:"text-xs text-gray-600",children:"Get notified about important updates and announcements from Bulldog CO Manager."})]}),m.jsx("button",{onClick:x,className:"text-gray-400 hover:text-gray-600 ml-2","aria-label":"Dismiss",children:m.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx("button",{onClick:p,disabled:s,className:`flex-1 py-2 px-4 rounded-md text-sm font-medium text-white touch-manipulation min-h-[44px] ${s?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 active:bg-blue-800"}`,children:s?"Enabling...":"Enable Notifications"}),m.jsx("button",{onClick:x,className:"py-2 px-4 rounded-md text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 active:bg-gray-300 touch-manipulation min-h-[44px]",children:"Not Now"})]})]})}):null}function bR({onLoginSuccess:r}){const[t,s]=we.useState(""),[i,n]=we.useState(""),[e,p]=we.useState(!1),[x,w]=we.useState(""),[E,N]=we.useState(!1);we.useEffect(()=>{const R=R7();R&&(s(R.username),n(R.password),p(!0))},[]);const P=async R=>{R.preventDefault(),w(""),N(!0),await new Promise(q=>setTimeout(q,300)),N7(t,i)?(D7(t,i,e),r()):(w("Invalid username or password"),N(!1))};return m.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:m.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-8 w-full max-w-md",children:[m.jsxs("div",{className:"text-center mb-8",children:[m.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Bulldog CO Manager"}),m.jsx("p",{className:"text-gray-600",children:"Please sign in to continue"})]}),m.jsxs("form",{onSubmit:P,className:"space-y-6",children:[x&&m.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:x}),m.jsxs("div",{children:[m.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),m.jsx("input",{id:"username",type:"text",value:t,onChange:R=>s(R.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Enter username",required:!0,autoComplete:"username",disabled:E})]}),m.jsxs("div",{children:[m.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),m.jsx("input",{id:"password",type:"password",value:i,onChange:R=>n(R.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Enter password",required:!0,autoComplete:"current-password",disabled:E})]}),m.jsxs("div",{className:"flex items-center",children:[m.jsx("input",{id:"remember",type:"checkbox",checked:e,onChange:R=>p(R.target.checked),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded",disabled:E}),m.jsx("label",{htmlFor:"remember",className:"ml-2 block text-sm text-gray-700",children:"Remember me"})]}),m.jsx("button",{type:"submit",disabled:E,className:"w-full bg-indigo-600 text-white py-2 px-4 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:E?"Signing in...":"Sign In"})]})]})})}function wR(){const[r,t]=we.useState(null),[s,i]=we.useState("companies"),[n,e]=we.useState(null),[p,x]=we.useState(null),[w,E]=we.useState(null),[N,P]=we.useState(null),[R,q]=we.useState(!0),[Z,ne]=we.useState(0),[fe,G]=we.useState(0),[U,H]=we.useState(!1),[ee,te]=we.useState(!1),[ue,L]=we.useState(!0);we.useEffect(()=>{te(Uw()),L(!1),q(!1),Uw()&&V()},[]);const O=()=>{te(!0),V()};async function V(){if(typeof window>"u")return;if(!ey()){console.log("Notifications not supported in this browser");return}if(ty()==="granted")try{await Z2(),console.log("Notification token registered"),h7().then(J=>{var X,K,me;J&&(console.log("Foreground message received:",J),"Notification"in window&&Notification.permission==="granted"&&new Notification(((X=J.notification)==null?void 0:X.title)||"Bulldog CO Manager",{body:((K=J.notification)==null?void 0:K.body)||((me=J.data)==null?void 0:me.message),icon:"/web-app-manifest-192x192.png",tag:"bulldog-notification"}))}).catch(J=>{console.error("Error setting up message listener:",J)})}catch(J){console.error("Error initializing notifications:",J)}}return ue||R?m.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:m.jsx("div",{className:"text-gray-600",children:"Loading..."})}):ee?w&&s==="attendance-company"?m.jsx(Pw,{company:w,onBack:()=>{E(null),i("attendance")},onSelectCadet:W=>{e(W),i("cadet-profile")}},`${w}-${Z}`):r&&s!=="cadet-profile"&&s!=="attendance"&&s!=="pt-plans"&&s!=="attendance-company"?m.jsx(Pw,{company:r,onBack:()=>t(null),onSelectCadet:W=>{e(W),i("cadet-profile")}},`${r}-${Z}`):s==="settings"?m.jsx(P7,{onBack:()=>i("companies")}):s==="issues"?m.jsx(O7,{onBack:()=>i("attendance")}):s==="cadets"?m.jsx(j7,{onSelectCadet:W=>{e(W),i("cadet-profile")},onBack:()=>i("companies"),onAddCadet:()=>i("add-cadet")}):s==="add-cadet"?m.jsx($7,{onBack:()=>i("cadets"),onSuccess:()=>i("cadets")}):s==="training-landing"?m.jsx(W7,{onTrainingSchedule:()=>i("training-schedule"),onWeatherData:()=>i("weather-data"),onForms:()=>i("forms"),onBack:()=>i("companies")}):s==="training-schedule"?m.jsx(q7,{onSelectEvent:W=>{x(W),i("training-event-detail")},onAddEvent:()=>i("add-training-event"),onBack:()=>i("training-landing")},fe):s==="add-training-event"?m.jsx(Q7,{onBack:()=>i("training-schedule"),onSuccess:()=>{G(W=>W+1),i("training-schedule")}}):s==="weather-data"?m.jsx(mR,{onBack:()=>i("training-landing")}):s==="training-event-detail"&&p?m.jsx(K7,{eventId:p,onBack:()=>{x(null),i("training-schedule")},onRefresh:()=>{G(W=>W+1)}}):s==="attendance"?m.jsx(J7,{onBack:()=>i("companies"),onSelectCompany:W=>{E(W),i("attendance-company")},onTactics:()=>i("tactics-attendance"),onIssues:()=>i("issues")}):s==="tactics-attendance"?m.jsx(Z7,{onBack:()=>{H(!1),i("attendance")},onSelectCadet:W=>{e(W),H(!0),i("cadet-profile")}}):s==="pt-plans"?m.jsx(lR,{onBack:()=>{P(null),i("companies")},onSelectCompany:W=>P(W),selectedCompany:N}):s==="forms"?m.jsx(gR,{onExpenseRequest:()=>i("expense-request-form"),onBack:()=>i("training-landing")}):s==="expense-request-form"?m.jsx(vR,{onBack:()=>i("forms")}):s==="cadet-profile"&&n?m.jsx(V7,{cadetId:n,onBack:()=>{w?i("attendance-company"):U?(H(!1),i("tactics-attendance")):i(r?"companies":"cadets")},onDelete:()=>{w?(E(null),i("attendance")):r?(t(null),i("companies")):i("cadets"),e(null)},onCompanyChange:(W,J)=>{(r===W||r===J||w===W||w===J)&&ne(X=>X+1)}}):m.jsxs(m.Fragment,{children:[m.jsx(Gk,{onSelect:W=>{t(W),i("companies")},onSettings:()=>i("settings"),onCadets:()=>i("cadets"),onTrainingSchedule:()=>i("training-landing"),onAttendance:()=>i("attendance"),onPT:()=>i("pt-plans")}),m.jsx(xR,{})]}):m.jsx(bR,{onLoginSuccess:O})}class _R extends we.Component{constructor(){super(...arguments);vb(this,"state",{hasError:!1,error:null})}static getDerivedStateFromError(s){return{hasError:!0,error:s}}componentDidCatch(s,i){console.error("Uncaught error:",s,i)}render(){var s,i;return this.state.hasError?m.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center px-4",children:m.jsxs("div",{className:"text-center",children:[m.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Something went wrong"}),m.jsx("p",{className:"text-gray-600 mb-4",children:(s=this.state.error)==null?void 0:s.message}),m.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 text-white px-6 py-3 rounded-lg font-medium touch-manipulation",children:"Reload Page"}),m.jsxs("details",{className:"mt-4 text-left",children:[m.jsx("summary",{className:"cursor-pointer text-sm text-gray-500",children:"Error Details"}),m.jsx("pre",{className:"mt-2 text-xs bg-gray-100 p-4 rounded overflow-auto",children:(i=this.state.error)==null?void 0:i.stack})]})]})}):this.props.children}}const v6=document.getElementById("root");if(!v6)throw new Error("Root element not found");H1.createRoot(v6).render(m.jsx(PA.StrictMode,{children:m.jsx(_R,{children:m.jsx(wR,{})})}));
